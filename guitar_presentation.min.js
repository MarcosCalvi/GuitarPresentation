var b4w="object"===typeof b4w?b4w:function(a){var r={};a.module=r;var n={};a.sa=function(a,b){var t=r[a];t&&(t.dn=null);n[b||"__b4w_default"]=null};a.register=function(a,b){r[a]||(r[a]=b)};a.require=function(a,b){if(!r[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";n[b]||(n[b]=function(a){return function(b){var d=r[b];if(!d)throw Error('Module "'+b+'" not found');d.dn||(d.dn={});d.dn[a]||(d.dn[a]={},d(d.dn[a],n[a]));return d.dn[a]}}(b));return n[b](a)};a.module_check=function(a){return r[a]?
!0:!1};a.get_namespace=function(a){for(var b in n)if(n[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.app=function(a,r){function n(){var a=A.pr();document.addEventListener("visibilitychange",function(){document.hidden?(a=A.pr(),A.pause()):a||A.dj()},!1)}function d(){var a=0,b=O.We(),e=A.pr(),c=!0;A.Ep(function(){if(0==a%10){var d=b.getBoundingClientRect();d.top>window.innerHeight||0>d.bottom?(c&&(e=A.pr()),A.pause(),c=!1):e||c||(A.dj(),c=!0)}a++})}function b(a,b,e,c){var d=document.createElement("canvas"),f=document.getElementById(a);f||(R.error('Warning: canvas container "'+a+'" not found, appending to body'),
f=document.body);d.style.position="absolute";d.style.left=0;d.style.top=0;d.style.width=f.offsetWidth+"px";d.style.height=f.offsetHeight+"px";d.width=f.offsetWidth*window.devicePixelRatio;d.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",d.style.left=0,d.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(d);if(!A.Ug(d,a))return e&&G("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
c),!1;a&&O.sv(a,"LAST");return!0}function t(a,b){a?(b&&(document.getElementById(b).style.display="block"),U=document.getElementById(a)):(U=document.createElement("div"),U.innerHTML=0,U.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",O.sv(U,"JUST_AFTER_CANVAS"))}function p(a,b){var e=String(a);b&&(e+="/"+String(b));U.innerHTML=e}function B(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function m(a,b,e){var c=Math.max(D.rV(a),1),d=ba.In(a,u);b=J.lc(d,b,Z);b[2]=0;F.normalize(b,b);F.scale(b,c*e,b);e=ba.Bf(a,ha);F.add(e,b,e);D.Vc(a,e)}function x(a,b){var e=D.mJ(a,ca);if(e.up!=e.down){var c=D.En(a,H)[1],e=(e.down-c)/(e.down-e.up),c=D.lJ(a,ca),e=Math.max(e,2/c.max);D.nJ(a,0,e*b)}}function g(a,b,e,c){ba.ah(a,5*b,5*e,5*c)}function l(a,b,e){var c=D.wD(a),d=Math.abs(b);e=Math.pow(d*e,1-Math.pow(d*e,.15));ba.ah(a,0,0,0>b?.001<c?-c*e:0:e/(1-e)*c)}function h(a,b,e,c){for(var d=
e*b;0<a;--a)e+=d,c+=d,d=e*b;return c}function w(a,b,e,c,d){d?(d=D.bZ(a,Z),a=D.Bf(a),a=F.dist(d,a)+c,c=0<b?h(b,-e,a,c):h(-b,e/(1-e),a,c)):c-=2*b*e;return c}function f(a,b,c,d,f){function k(a,T,b,da){if(1==b){D.Oh(a,K);var e=ca?.003*K.trans:.003*K.rot;b=E.ag(a,T,0);E.Nh(a,T,0).gesture===E.nt?(Fa+="X"==da?-b*e:0,Za+="Y"==da?-b*e:0):E.Nh(a,T,0).gesture===E.lt&&(a=ca?.003*K.rot:7.5E-4*K.trans,mb+="X"==da?-b*a:0,jb+="Y"==da?-b*a:0)}}function u(a){D.Oh(a,K);Xa-=.05*K.zoom}function h(a){D.Oh(a,K);Aa-=.002*
K.trans}function n(a){D.Oh(a,K);Xa+=.05*K.zoom}function R(a){D.Oh(a,K);Aa+=.002*K.trans}function p(a,T,b,da){if(1==b){b=E.ag(a,T,1);D.Oh(a,K);if(ca)e=.003*K.trans,ga=7.5E-4*K.rot;else var e=.003*K.rot,ga=7.5E-4*K.trans;if(1===E.Nh(a,T,0).which)Ba+="X"==da?-b*e:0,Oa+="Y"==da?-b*e:0;else if(2===E.Nh(a,T,0).which||3===E.Nh(a,T,0).which)zb+="X"==da?-b*ga:0,cb+="Y"==da?-b*ga:0}}function A(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function U(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function z(a){return a[0]&&
(a[1]||-.1>a[2])}function t(a){return a[0]&&(a[1]||.1<a[2])}function O(a){return a[0]&&(a[1]||a[2]||a[3])}function L(a,T,b){if(1==b)switch(b=E.ag(a,T,0),D.Oh(a,K),T){case "FORWARD":B?va[0]=1:ca?(T=D.En(a,H)[1],T=Math.abs(T)>=Math.PI/4?J.pi:J.$c,m(a,T,.5*K.trans*b)):N?l(a,-K.zoom,b):g(a,0,0,-K.trans*b);break;case "BACKWARD":B?va[0]=-1:ca?(T=D.En(a,H)[1],T=Math.abs(T)>=Math.PI/4?J.Zk:J.ad,m(a,T,.5*K.trans*b)):N?l(a,K.zoom,b):g(a,0,0,K.trans*b);break;case "UP":ca?x(a,30*-K.zoom*b):B||g(a,0,K.trans*b,
0);break;case "DOWN":ca?x(a,30*K.zoom*b):B||g(a,0,-K.trans*b,0);break;case "LEFT":B?va[1]=1:ca?m(a,J.Kx,.5*K.trans*b):g(a,-K.trans*b,0,0);break;case "RIGHT":B?va[1]=-1:ca?m(a,J.oi,.5*K.trans*b):g(a,K.trans*b,0,0);break;case "ROT_LEFT":N?D.vs(a,.75*-K.rot*b,0):D.Kq(a,.75*K.rot*b,0);break;case "ROT_RIGHT":N?D.vs(a,.75*K.rot*b,0):D.Kq(a,.75*-K.rot*b,0);break;case "ROT_UP":N?D.vs(a,0,.75*-K.rot*b):D.Kq(a,0,.75*K.rot*b);break;case "ROT_DOWN":N?D.vs(a,0,.75*K.rot*b):D.Kq(a,0,.75*-K.rot*b)}else switch(T){case "FORWARD":case "BACKWARD":B&&
(va[0]=0);break;case "LEFT":case "RIGHT":B&&(va[1]=0)}B&&(e.MC(B,va[0],va[1]),a=D.Ju(a,M),e.Ew(B,a[0],a[1]))}aa=a;v=b;fa=c;var G=q.IA();C(G);var N=!1,B=null,ca=!1;switch(D.Wl(G)){case D.Jb:N=!a;break;case D.od:B=q.Lu();break;case D.xg:return;case D.cd:ca=!0}var K=D.Oh(G,Q);a=E.bu();if(e.cB(G)){var r=E.Vz(G,null,!0);E.ua(G,"CAMERA_COLLISION",E.qf,[r],null,function(a,T){var b=E.Nh(a,T,0).coll_dist;if(0>b){var da=E.Nh(a,T,0).coll_norm,e=Z;F.scale(da,-.25*b,e);b=ba.Bf(a,ha);F.add(b,e,b);ba.nY(a,b)}})}if(B){var r=
ba.Bf(G),wa=ba.In(G),wa=J.zz(wa);r[2]-=.5;e.Kw(B,r,wa);I.sQ(G,B);var va=new Float32Array(2),xa=!0;e.Dw(B,e.lE);E.nn(G,"TOGGLE_CHAR_MOVE_TYPE",E.vg,E.lO,function(){xa=!xa;e.Dw(B,xa?e.lE:e.KN)})}var Ka=y.FR(),r=Ka.length?Ka[Ka.length-1]:0,Na,da,T,ga,Mb,Pa,eb,Sa,ia,Ta;b?Na=da=T=ga=Mb=Pa=b=r=eb=Sa=ia=Ta=E.Wz(0):(Na=E.Pc(E.BE),da=E.Pc(E.zE),T=E.Pc(E.uE),ga=E.Pc(E.vE),Mb=E.Pc(E.rO),Pa=E.Pc(E.mO),b=E.cu(y.bt,r),r=E.cu(y.dt,r),eb=E.Pc(E.AE),Sa=E.Pc(E.wE),ia=E.Pc(E.xE),Ta=E.Pc(E.yE));var wa=E.mn(y.Ys,Ka),
ka=E.mn(y.Zs,Ka),W=E.mn(y.$s,Ka),Ka=E.mn(y.at,Ka);ca||(E.ua(G,"FORWARD",E.ub,[a,Na,ka],z,L),E.ua(G,"BACKWARD",E.ub,[a,da,ka],t,L));N?(E.ua(G,"ROT_UP",E.ub,[a,eb,Mb,Ka],A,L),E.ua(G,"ROT_DOWN",E.ub,[a,Sa,Pa,Ka],U,L),E.ua(G,"ROT_LEFT",E.ub,[a,ia,T,W],A,L),E.ua(G,"ROT_RIGHT",E.ub,[a,Ta,ga,W],U,L)):ca?(E.ua(G,"LEFT",E.ub,[a,ia,T,wa],A,L),E.ua(G,"RIGHT",E.ub,[a,Ta,ga,wa],U,L),E.ua(G,"FORWARD",E.ub,[a,eb,Na,ka],A,L),E.ua(G,"BACKWARD",E.ub,[a,Sa,da,ka],U,L),E.ua(G,"UP",E.ub,[a,Pa,Ka],t,L),E.ua(G,"DOWN",E.ub,
[a,Mb,Ka],z,L)):(E.ua(G,"UP",E.ub,[a,Mb,b],O,L),E.ua(G,"DOWN",E.ub,[a,Pa,r],O,L),E.ua(G,"LEFT",E.ub,[a,T,wa],z,L),E.ua(G,"RIGHT",E.ub,[a,ga,wa],t,L),E.ua(G,"ROT_UP",E.ub,[a,eb,Ka],z,L),E.ua(G,"ROT_DOWN",E.ub,[a,Sa,Ka],t,L),E.ua(G,"ROT_LEFT",E.ub,[a,ia,W],z,L),E.ua(G,"ROT_RIGHT",E.ub,[a,Ta,W],t,L));if(!c){var Qa=0;c=E.Zz(d);var Ca=0,Ka=E.eA(d);E.ua(G,"MOUSE_WHEEL",E.fp,[c],null,function(a,T,b){1==b&&(T=E.ag(a,T,0),D.Oh(a,K),N||ca?Qa=w(a,T,K.zoom,Qa,N):(K.trans*=1+T*K.zoom,D.oY(a,K)))});E.ua(G,"TOUCH_ZOOM",
E.fp,[Ka],null,function(a,T,b){1==b&&(b=E.ag(a,T,0),D.Oh(a,K),E.Nh(a,T,0)===E.mt&&(Ca=w(a,b,.03*K.zoom,Ca,N)))});E.ua(G,"ZOOM_INTERPOL",E.qf,[a],null,function(a,T){if(N||ca)if(1E-5<Math.abs(Qa)||1E-5<Math.abs(Ca)){var b=E.ag(a,T,0),da=J.vc(Qa,0,b,.1*V);Qa-=da;b=J.vc(Ca,0,b,.15*V);Ca-=b;ca?x(a,-(da+b)):(da=D.wD(a)+da+b,da=Math.max(da,.001),D.dZ(a,da))}else Ca=Qa=0})}var Ba=0,Oa=0,zb=0,cb=0,Aa=0,Xa=0;N?(E.ua(G,"GMPD_PAN_Y_POS",E.ub,[b],null,n),E.ua(G,"GMPD_PAN_Y_NEG",E.ub,[r],null,u),E.ua(G,"GMPD_PAN_X_POS",
E.ub,[wa],function(a){return-.1>a[0]},h),E.ua(G,"GMPD_PAN_X_NEG",E.ub,[wa],function(a){return.1<a[0]},R)):ca&&(E.ua(G,"GMPD_PAN_X_POS",E.ub,[W],function(a){return-.1>a[0]},h),E.ua(G,"GMPD_PAN_X_NEG",E.ub,[W],function(a){return.1<a[0]},R));if(f){f=E.on("X",window);c=E.on("Y",window);b=E.rq(d);var r=E.rq(window),vb=!1,wa=function(a){a[2]?vb=!0:a[0]||(vb=!1);return vb&&a[0]};E.ua(G,"MOUSE_X",E.qf,[r,f,b],wa,p,"X");E.ua(G,"MOUSE_Y",E.qf,[r,c,b],wa,p,"Y");f=y.ia(y.bd,window);y.uD(f,!1)}else f=E.on("X",
d),c=E.on("Y",d),b=E.rq(d),E.ua(G,"MOUSE_X",E.qf,[b,f],null,p,"X"),E.ua(G,"MOUSE_Y",E.qf,[b,c],null,p,"Y");var Fa=0,Za=0,mb=0,jb=0;f=E.gu("X",d);d=E.gu("Y",d);E.ua(G,"TOUCH_X",E.qf,[f],null,k,"X");E.ua(G,"TOUCH_Y",E.qf,[d],null,k,"Y");E.ua(G,"ROT_TRANS_INTERPOL",E.qf,[a],null,function(a,T){if(1E-5<Math.abs(Ba)||1E-5<Math.abs(Oa)||1E-5<Math.abs(Fa)||1E-5<Math.abs(Za)||1E-5<Math.abs(zb)||1E-5<Math.abs(cb)||1E-5<Math.abs(mb)||1E-5<Math.abs(jb)||1E-5<Math.abs(Aa)||1E-5<Math.abs(Xa)){var b=E.ag(a,T,0),
da=J.vc(Ba,0,b,.08*V),ga=J.vc(Oa,0,b,.08*V);Ba-=da;Oa-=ga;var c=J.vc(Fa,0,b,.12*V),d=J.vc(Za,0,b,.12*V);Fa-=c;Za-=d;var z=J.vc(zb,0,b,.08*V),f=J.vc(cb,0,b,.08*V);zb-=z;cb-=f;var k=J.vc(mb,0,b,.12*V),u=J.vc(jb,0,b,.12*V);mb-=k;jb-=u;var v=J.vc(Aa,0,b,.08*V),b=J.vc(Xa,0,b,.08*V);Aa-=v;Xa-=b;N?(D.vs(a,da+c,ga+d),ga=D.wD(a),D.cZ(a,ga*(z+k+v),ga*(f+u+b))):ca?(da+c&&m(a,J.oi,.2*(da+c)),ga+d&&(f=D.En(a,H)[1],m(a,Math.abs(f)>Math.PI/4?J.Zk:J.ad,.2*(ga+d))),D.nJ(a,z+k+v,0)):(D.Kq(a,.5*(da+c),.5*(ga+d)),B&&
(z=D.Ju(a,M),e.Ew(B,z[0],z[1])))}});E.nn(G,"DEC_STEREO_DIST",E.vg,E.pO,function(a){var T=D.QI(a);D.JL(a,.9*T)});E.nn(G,"INC_STEREO_DIST",E.vg,E.sO,function(a){var T=D.QI(a);D.JL(a,1.1*T)})}function C(a){var b=D.Wl(a),e=E.Uz(function(){var e=D.Wl(a),c=e!=b;b=e;return c});E.ua(a,"CHANGE_MOVE_STYLE",E.qf,[e],null,function(){K();f(aa,v,fa)})}function K(){var a=q.IA();E.bq(a,"TOGGLE_CHAR_MOVE_TYPE")&&q.Lu()&&I.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
e=0;e<b.length;e++)E.as(a,b[e])}function G(a,b,e,c){var d=document.createElement("div"),f=document.createElement("div"),k=document.createElement("div");if(c)for(var u=0;u<c.length;u++){var v=document.getElementById(c[u]);v&&v.parentNode.removeChild(v)}d.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";k.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;k.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
e+'">'+e.replace("https://www.","")+"</a>";d.appendChild(f);d.appendChild(k);document.body.appendChild(d)}function L(a,b,e,c,d){function f(){var u=performance.now()-k;d(b+u*(e-b)/c);(u>=c||!a.parentNode)&&A.pX(f)}var k=performance.now();A.Ep(f)}r("animation");var D=r("camera"),N=r("config"),I=r("constraints"),O=r("container"),E=r("controls"),c=r("data"),k=r("debug"),y=r("input"),A=r("main"),e=r("physics"),R=r("print"),q=r("scenes"),ba=r("transform"),J=r("util"),F=r("vec3"),V=1,U=null,aa=!1,v=!1,fa=
!1,M=new Float32Array(2),H=new Float32Array(2),Z=new Float32Array(3),ha=new Float32Array(3);new Float32Array(3);var u=new Float32Array(4),Q={},ca={};a.Ug=function(a){function e(){var a=b(q,V,z,h),c=O.Fn();if(a){var f=O.We();O.wk();J&&(t(l,H),A.WX(p));g&&(n(),d());m&&A.Ep(function(){f.style.height=f.clientWidth/m+"px"});v&&A.Ep(function(){O.wk()});x&&A.Ep(function(){O.EA()});w&&N.DC();y==N.rp?k.FM(function(a,b){0==a?(R.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),N.hn(N.al)):1.5>b?(R.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),N.hn(N.sp)):(R.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),N.hn(N.al));u(c,!0)}):u(c,!0)}else u(c,!1)}function f(a){a.keyCode==E.qO&&(A.pr()?A.dj():A.pause())}function u(){}a=a||{};var v=!1,q=null,h=null,l=null,m=0,H=null,F=!0,w=!1,g=!0,z=!0,M=!1,J=!1,U=!1,x=!1,y=N.get("quality"),C;for(C in a)switch(C){case "canvas_container_id":q=a.canvas_container_id;break;case "callback":u=a.callback;break;case "autoresize":v=a.autoresize;break;case "show_hud_debug_info":U=a.show_hud_debug_info;
break;case "sfx_mix_mode":M=a.sfx_mix_mode;break;case "show_fps":J=a.show_fps;break;case "track_container_position":x=a.track_container_position;break;case "fps_wrapper_id":H=a.fps_wrapper_id;break;case "fps_elem_id":l=a.fps_elem_id;break;case "error_purge_elements":h=a.error_purge_elements;break;case "report_init_failure":z=a.report_init_failure;break;case "pause_invisible":g=a.pause_invisible;break;case "key_pause_enabled":F=a.key_pause_enabled;break;case "force_container_ratio":m=a.force_container_ratio;
break;case "min_capabilities":w=a.min_capabilities;break;case "quality":y=a.quality;break;default:N.set(C,a[C])}y!=N.rp&&N.set("quality",y);F&&document.addEventListener("keydown",f,!1);N.set("show_hud_debug_info",U);N.set("sfx_mix_mode",M);var V=U||M||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){c.sa()},!1)};a.wk=function(){R.Bb("app.resize_to_container","container.resize_to_container");O.wk()};a.v7=function(a,
b){var e=B(a);e.addEventListener("mouseup",function(){b(e.value)},!1)};a.u7=function(a,b){var e=B(a);e.addEventListener("change",function(){var a=e.checked;b(void 0!=a?a:e.value)},!1)};a.w7=function(a,b){var e=B(a);e.addEventListener("keypress",function(a){b(a.keyCode,e.value)},!1)};a.GT=f;a.N2=K;a.X6=function(a){R.Kh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=q.IA();D.UC(b,a)};a.a3=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,f){if(1==f)switch(f=E.ag(a,b,0),b){case "FORWARD":d?e.Yo(a,1):ba.ah(a,0,-1*f,0);break;case "BACKWARD":d?e.Yo(a,-1):ba.ah(a,0,1*f,0);break;case "LEFT":d?e.Xo(a,-1):ba.ah(a,1*f,0,0);break;case "RIGHT":d?e.Xo(a,1):ba.ah(a,-1*f,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&e.Yo(a,0);break;case "LEFT":case "RIGHT":d&&e.Xo(a,0)}}var d=e.Ye(a)||e.Ze(a),f=E.bu(),k=E.Pc(E.BE),u=E.Pc(E.zE),v=E.Pc(E.uE),q=E.Pc(E.vE),h=E.Pc(E.AE),l=E.Pc(E.wE),m=E.Pc(E.xE),n=E.Pc(E.yE);E.ua(a,
"FORWARD",E.ub,[f,k,h],b,c);E.ua(a,"BACKWARD",E.ub,[f,u,l],b,c);E.ua(a,"LEFT",E.ub,[f,v,m],b,c);E.ua(a,"RIGHT",E.ub,[f,q,n],b,c)};a.P2=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],e=0;e<b.length;e++)E.as(a,b[e])};a.Y2=function(){R.N("app.enable_controls() deprecated")};a.O2=function(){R.N("app.disable_controls() deprecated")};a.Z2=function(){E.nn(null,"CAMERA_SHOT",E.vg,E.nO,function(){k.pW()});E.nn(null,"LIGHT_SHOT",E.vg,E.oO,function(){k.sW()});E.nn(null,"TELEMETRY",E.vg,E.tO,function(){k.kC()})};
a.L6=function(a,b,e){function c(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",c,!1),document.removeEventListener("webkitfullscreenchange",c,!1),document.removeEventListener("mozfullscreenchange",c,!1),document.removeEventListener("MSFullscreenChange",c,!1),e())}b=b||function(){};e=e||function(){};document.addEventListener("fullscreenchange",
c,!1);document.addEventListener("webkitfullscreenchange",c,!1);document.addEventListener("mozfullscreenchange",c,!1);document.addEventListener("MSFullscreenChange",c,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():R.error("B4W App: request fullscreen method is not supported")};a.h3=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&R.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.e2=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.K6=G;a.Q4=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),e={},c=0;c<b.length;c++){var d=b[c].split("="),f=d[0];1<d.length?(d=
d[1],a?f in e?e[f].push(d):e[f]=[d]:e[f]=d):a?f in e||(e[f]=[]):e[f]=""}return e};a.iT=function(a,b,e,c,d,f,k,u){function v(d){a&&(q[b]=f+d+k,e>c&&d<=c||e<c&&d>=c)&&(q[b]=f+c+k,u())}if(a&&b&&isFinite(e)&&isFinite(c)&&isFinite(d)){f=f||"";k=k||"";u=u||function(){};var q=a.style,h=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==q[b])if(void 0!=q["webkit"+h])b="webkit"+h;else if(void 0!=q["ms"+h])b="ms"+h;else if(void 0!=q["moz"+h])b="moz"+h;else return;L(a,e,c,d,v)}};a.OQ=function(a,b,e,c,d,f){function k(d){a&&
(0<=d&&a.setAttribute(b,d),e>c&&d<=c||e<c&&d>=c)&&(a.setAttribute(b,c),f())}a&&b&&isFinite(e)&&isFinite(c)&&isFinite(d)&&(f=f||function(){},L(a,e,c,d,k))};a.kX=function(b){if(b.length){var e=b.shift(),c=e.elem,d=e.prop,f=e.from,k=e.to,u=e.duration,v=e.opt_prefix,q=e.opt_suffix,h=function(){e.cb&&e.cb();a.kX(b)};"css"==e.type?a.iT(c,d,f,k,u,v,q,h):"attr"==e.type&&a.OQ(c,d,f,k,u,h)}};a.Y6=function(a){V=a};a.I3=function(){return V}};b4w.module.animation=function(a,r){var n=r("__animation"),d=r("__armature"),b=r("__obj_util"),t=r("__print"),p=r("__tsr");a.pd=n.pd;a.UE=n.UE;a.VE=n.VE;a.WE=n.WE;a.XE=n.XE;a.YE=n.YE;a.ZE=n.ZE;a.ot=n.ot;a.bl=n.bl;a.LE=n.LE;a.Qy=n.Qy;a.Ry=n.Ry;a.OE=n.OE;a.NE=n.NE;a.ME=n.ME;a.KE=n.KE;a.eE=n.eE;a.fE=n.fE;a.Fx=n.Fx;var B=p.create();a.Ac=function(a){return n.Ac(a)};a.$H=function(a){return n.oK(a)?n.$H(a):[]};a.P3=function(a,b){if(!n.Ac(a))return null;b=b||n.pd;return n.BU(a,b)};a.apply=function(a,b,d){if(d>
n.ot)t.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=d||n.pd;if(n.Ac(a)){var l=n.Tu(a,b);if(-1!=l&&l!=d){t.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+l+'").');return}}n.pN(a,b)?n.apply(a,null,b,d):t.error('No fcurves in action "'+b+'"')}};a.C1=function(a,b,d){if(d>n.ot)t.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=
d||n.pd;var l=b[0];if(n.Ac(a)){var h=n.Tu(a,l);if(-1!=h&&h!=d){t.error('Animation "'+l+'" is already applied to object "'+a.name+'" (slot "'+h+'").');return}}n.pN(a,l)?n.apply(a,b.slice(1),l,d):t.error('No fcurves in action "'+l+'"')}};a.remove=function(a){n.remove(a)};a.UK=function(a,b){n.Ac(a)&&(b=b||n.pd,n.UK(a,b))};a.Dt=function(a){n.Dt(a)};a.play=function(a,b,d){n.Ac(a)?(d=d||n.pd,n.play(a,b,d),n.NZ(a,0,d,!0)):t.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){n.Ac(a)&&
(b=b||n.pd,n.stop(a,b))};a.ak=function(a,b){if(!n.Ac(a))return!1;b=b||n.pd;return n.ak(a,b)};a.ro=function(a,b,d){n.Ac(a)&&(d=d||n.pd,n.ro(a,b,d))};a.RC=function(a,b){n.Ac(a)&&n.RC(a,b)};a.k7=function(a,b){if(n.Ac(a)){b=b||n.pd;var d=n.LA(a,b),l=n.KA(a,b);n.ro(a,d+l-n.uO,b)}};a.Zq=function(a,b){if(!n.Ac(a))return 0;b=b||n.pd;return n.jI(a,b)};a.HL=function(a,b,d){n.Ac(a)&&(d=d||n.pd,n.HL(a,b||1,d))};a.NI=function(a,b){if(!n.Ac(a))return 0;b=b||n.pd;return a.ha[b]?n.NI(a,b):0};a.LA=function(a,b){return n.Ac(a)&&
(b=b||n.pd,a.ha[b])?n.LA(a,b):-1};a.KA=function(a,b){return n.Ac(a)&&(b=b||n.pd,a.ha[b])?n.KA(a,b):-1};a.ks=function(a,b,d){n.Ac(a)&&(d=d||n.pd,n.ks(a,b,d))};a.dI=function(a,b){if(!n.Ac(a))return null;b=b||n.pd;return n.dI(a,b)};a.BF=function(a,b,d,l){l=l||n.pd;n.Ac(a)&&n.BF(a,b,d,l)};a.MH=function(a){return n.MH(a)};a.F3=function(a,n,g){t.Bb("get_bone_translation","armature.get_bone_tsr");if(!b.Ri(a))return null;if(!d.zR(a,n))return t.error('There is no bone: "',n,'" in "',a.name,'".'),null;g||(g=
new Float32Array(3));d.Iu(a,n,!1,B);g[0]=B[0];g[1]=B[1];g[2]=B[2];return g};a.a4=function(){t.N("get_first_armature_object() deprecated");return null};a.Tu=function(a,b){return n.Ac(a)&&b?n.Tu(a,b):-1};a.aI=function(a,b){return n.Ac(a)?n.aI(a,b):null};a.CF=function(a,b){return n.CF(a,b)};a.J4=function(a){return a.k.Bh};a.FL=function(a,d,g){b.Ri(a)?(d=Math.min(Math.max(d,0),1),a.k.Bh!=d&&n.FL(a,d,g||0)):t.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,r){function n(a,b){var e=a.ha[b];e&&e.DA&&e.Jq&&(e.Jq=!1,e.DA(a,b))}function d(a,b,e){e=a.ha[e];e.type=30;var c=b.va,d=b.Za-c+1;e.start=c;e.length=d;e.wf=c;e.xi=b.name;for(d=c=0;d<a.Yc.length;d++){var f=a.Yc[d];if(f==b)break;else c+=f.Za-f.va+1}e.oN=c}function b(a,b){a.type=50;a.xi=b.name;a.start=b.va;a.length=b.Za-a.start;b.ve||(a.length+=b.wB)}function t(a){return a.replace(/_B4W_BAKED$/,"")}function p(a,b){return{ao:a,action:b}}function B(a,b,e){if(a.animation_data){var c=
a.animation_data.action;c&&60==c.s.type&&b.push(p(e,c))}a=a.nodes;for(c=0;c<a.length;c++){var d=a[c];if(d.node_group){var f=d.node_group.node_tree;if(f){var z=e.slice();z.push(d.name);B(f,b,z)}}}}function m(a){return H.Rc(a)&&a.k.Yc?!0:!1}function x(a,b,e){var c=a.ha;if(-1==e)for(e=0;8>e;e++){var d=c[e];d&&(d.wf=b,l(a,0,e,!0))}else if(d=c[e])d.wf=b,l(a,0,e,!0)}function g(a,b,e){if(-1==b)for(b=0;8>b;b++){var c=a[b];c&&e(c)}else(c=a[b])&&e(c)}function l(a,b,e,c){D(a,b,e,c);n(a,e);a.k.wi&&(O(a,b),I(a,
b))}function h(a,b,e,d){var z=e.frame_range;if(z[0]>z[1])return u.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;var k=e.s,v=a.ha[d];v.xi=e.name;v.az=z;v.sF=k.xK;v.qF=k.VF;v.Bi.set(k.Bi);v.start=z[0];v.length=z[1]-z[0];v.wf=z[0];switch(k.type){case 10:if(H.Ri(a)){v.type=10;var q=w(a,b,e);if(!q){for(var q=a.k.Dg,z=[],h=[],da=e.s.YB,T=0;T<da;T++){for(var ga in q){var l=q[ga],n=l.hx,F=e.s.qz[ga];F?qa.copy(F.subarray(8*T,8*T+8),n):qa.identity(n);l.ix=!1}l=E(q);z.push(l.trans);
h.push(l.Db)}q={trans:z,Db:h};f(a,b,e,q)}v.trans=q.trans;v.Db=q.Db;b=q;v=a.k;q=v.zo;z=a.ha[d];ga=z.hD;a:{h=v.Pw;for(da=0;da<h.length;da+=2)if(e==h[da]){h=h[da+1];break a}h=null}if(h)z.hD=h;else{for(z=0;z<q.length;z++){h=q[z].zi;da=[];T=[];l=b.trans;n=b.Db;for(F=0;F<l.length;F++){var m=c(l[F],n[F],h);da.push(m.trans);T.push(m.Db)}ga.push({trans:da,Db:T})}v.Pw.push(e,ga)}v.wi&&(e=v.To,d>e[1]?(b=e[1],e[1]=d,e[0]=b):d>e[0]&&d<e[1]&&(e[0]=d),C(a))}break;case 40:H.fm(a)&&(v.volume=k.qb.volume||null,v.pitch=
k.qb.pitch||null,v.type=40);break;case 70:H.On(a)&&(v.color=k.qb.color||null,v.Ii=k.qb.energy||null,v.type=70);break;case 60:if("MESH"==a.type){v.type=60;ga=w(a,b,e);if(!ga){ga=[];z=[];h=[];da=[];T=[];l=e.s;n=b?b[0]:null;for(q in l.qb){F=b;m=q.match(/"(.*?)"/)[1];if(F&&1<F.length){for(var g=F[1],R=2;R<F.length;R++)g=g+"%join%"+F[R];g+="%join%"+m}else g=m;F=g;for(m=0;m<a.I.length;m++)for(g=a.I[m].U,R=0;R<g.length;R++){var p=g[R];if(!n||-1!=p.td.indexOf(n)){var M=p.dh,J=G(q,F,l,z,ga,p.eh),M=G(q,F,l,
da,h,M);(J||M)&&T.push(p)}}}ga={l_:ga,values:z,CX:h,DX:da,Yv:T};f(a,b,e,ga)}v.eh=ga.l_;v.iK=ga.values;v.dh=ga.CX;v.hK=ga.DX;v.Yv=ga.Yv}break;case 20:if(q=k.qb.tsr){v.type=20;ga=w(a,b,e);if(!ga){ga=e.s.YB;z=[];h=[];for(da=0;da<ga;da++)z.push(q.subarray(8*da,8*da+4)),h.push(q.subarray(8*da+4,8*da+8));ga={trans:z,Db:h};f(a,b,e,ga)}v.trans=ga.trans;v.Db=ga.Db;Z.ZB(a)&&Z.$Z(a,v.trans[0],v.Db[0])}else return u.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:H.rr(a)&&
(v.Ii=k.qb["light_settings.environment_energy"]||null,v.he=k.qb.horizon_color||null,v.pe=k.qb.zenith_color||null,v.Pq=k.qb["mist_settings.intensity"]||null,v.fog_depth=k.qb["mist_settings.depth"]||null,v.fog_start=k.qb["mist_settings.start"]||null,v.fog_height=k.qb["mist_settings.height"]||null,v.IH=k.qb.b4w_fog_color||null,v.type=80)}H.Ri(a)&&10!=k.type&&K(a,d);return!0}function w(a,b,e){a=a.yt;b=b?b.join("%join%"):null;for(var c=0;c<a.length;c+=3)if(e==a[c]&&b==a[c+1])return a[c+2];return null}
function f(a,b,e,c){a.yt.push(e,b?b.join("%join%"):null,c)}function C(a){var b=a.k.To;if(-1!=b[0]&&-1!=b[1]){var e=a.ha;a=e[b[1]].wf;var c=Math.floor(a),d=a-c,b=e[b[0]];a=b.wf;c=Math.floor(a);b.wf=c+d}}function K(a,b){var e=a.k.To,c=e[1];e[0]=-1;e[1]=-1;if(-1!=b)for(var d=a.ha;0<=c;c--){var f=d[c];if(f&&10==f.type)if(c>e[1])e[1]=c;else{c>e[0]&&(e[1]=c);break}}}function G(a,b,e,c,d,f){if(!f)return!1;for(var z=!1,k=0;k<f.length;k+=2)b==f[k]&&(d.push(f[k+1]),c.push(new Float32Array(e.qb[a])),z=!0);return z}
function L(a){a=a.s;for(var b in a.qb)if(-1!=b.indexOf("nodes"))return!0;return!1}function D(a,b,e,c){if((e=a.ha[e])&&null!=e.type&&(e.play||c)){var d=a.k,f=e.wf,k=e.start,v=e.length,f=f+e.speed*b*S.sd(),u=e.type,da=e.speed;if(0<=da&&f>=k+v||0>da&&f<k)switch(c||(e.Jq=!0),e.behavior){case 10:f=0<=da?(f-k)%v+k:k+v-1E-6;break;case 20:f=0<=da?k:k+v-1E-6;e.play=!1;break;case 30:f=0<=da?k+v-1E-6:k,e.play=!1}e.wf=f;switch(u){case 10:if(!d.wi){c=N(e);b=c[0];var T=c[1];c=c[2];d.ke=e.Db[b];d.Be=e.Db[T];d.oe=
e.trans[b];d.Ee=e.trans[T];d.Ue=c;c=d.zo;e=e.hD;for(var ga=0;ga<c.length;ga++){var q=c[ga],h=e[ga];q.ke=h.Db[b];q.Be=h.Db[T];q.oe=h.trans[b];q.Ee=h.trans[T];q.Ue=d.Ue}Y.D(a)}break;case 20:c=N(e);var d=P,T=c[0],ga=c[1],q=c[2],h=e.trans,l=h[T][1],f=h[T][2],k=h[ga][1],v=h[ga][2];d[0]=(1-q)*h[T][0]+q*h[ga][0];d[1]=(1-q)*l+q*k;d[2]=(1-q)*f+q*v;T=z;f=c[0];ga=c[1];q=c[2];h=e.Db;l=ma;l[0]=h[f][0];l[1]=h[f][1];l[2]=h[f][2];l[3]=h[f][3];f=Ea;f[0]=h[ga][0];f[1]=h[ga][1];f[2]=h[ga][2];f[3]=h[ga][3];Q.slerp(l,
f,q,T);ga=c[2];q=e.trans;c=(1-ga)*q[c[0]][3]+ga*q[c[1]][3];a.parent&&a.lw&&(ga=ea,qa.ci(d,c,T,ga),qa.multiply(a.lw,ga,ga),qa.fc(ga,d),qa.Xd(ga,T),c=qa.Yd(ga));e.LD&&(ga=la,Y.Bf(a,ga),sa.Xw(d,ga,b,e.LD,d));e.sC&&(ga=ma,Y.In(a,ga),sa.gM(T,ga,b,e.sC,T));f=e.Bi;f[0]&&Y.Lw(a,d);f[1]&&Y.Jw(a,T);f[2]&&Y.aD(a,c);Y.D(a);ha.H(a);break;case 30:c=e.wf-e.start;0>c&&(c=0);c>=e.length&&(c=e.length);a=Math.floor(c);b=a+1;c-=a;10!=e.behavior&&b==e.length&&(b=--a,c=1);e=e.oN;oa[0]=a+e;oa[1]=b+e;oa[2]=c;c=oa;d.qx=c[0];
d.rx=c[2];break;case 40:c=N(e);b=c[0];d=c[1];c=c[2];e.volume&&ua.sY(a,(1-c)*e.volume[b]+c*e.volume[d]);e.pitch&&ua.bX(a,(1-c)*e.pitch[b]+c*e.pitch[d]);break;case 50:b=10==e.behavior?(f-k)/S.sd():f/S.sd();Z.lY(a,e.xi,b);break;case 60:c=N(e);b=c[0];d=c[1];c=c[2];h=e.iK;l=e.eh;a=e.hK;T=e.dh;ga=e.Yv;for(e=0;e<l.length;e++)for(f=h[e],q=l[e],k=(1-c)*f[b]+c*f[d],f=0;f<ga.length;f++)ga[f].Zi[q]=k;for(e=0;e<T.length;e++)for(h=a[e],q=T[e],h=za.lerp(h.subarray(3*b,3*b+3),h.subarray(3*d,3*d+3),c,P),f=0;f<ga.length;f++)ga[f].ze[3*
q]=h[0],ga[f].ze[3*q+1]=h[1],ga[f].ze[3*q+2]=h[2];break;case 70:c=N(e);b=c[0];d=c[1];c=c[2];f=e.Bi;(v=e.Ii)&&f[0]&&M.cY(a.Sc,(1-c)*v[b]+c*v[d]);(e=e.color)&&f[1]&&(P[0]=(1-c)*e[3*b]+c*e[3*d],P[1]=(1-c)*e[3*b+1]+c*e[3*d+1],P[2]=(1-c)*e[3*b+2]+c*e[3*d+2],M.bY(a.Sc,P));k=a.I;for(e=0;e<k.length;e++)ja.KZ(a,k[e].xb);break;case 80:c=N(e);b=c[0];d=c[1];c=c[2];f=e.Bi;k=a.I;da=ja.Ma(k[0].xb,pa.Pb);v=e.Ii;v=f[0]?(1-c)*v[b]+c*v[d]:da.Ii;u=e.he;f[1]?(P[0]=(1-c)*u[3*b]+c*u[3*d],P[1]=(1-c)*u[3*b+1]+c*u[3*d+1],
P[2]=(1-c)*u[3*b+2]+c*u[3*d+2],u=P):u=da.he;var n=e.pe;f[2]?(la[0]=(1-c)*n[3*b]+c*n[3*d],la[1]=(1-c)*n[3*b+1]+c*n[3*d+1],la[2]=(1-c)*n[3*b+2]+c*n[3*d+2],da=la):da=da.pe;n=e.Pq;f[3]&&(T=(1-c)*n[b]+c*n[d]);n=e.fog_depth;f[4]&&(ga=(1-c)*n[b]+c*n[d]);n=e.fog_start;f[5]&&(q=(1-c)*n[b]+c*n[d]);n=e.fog_height;f[6]&&(h=(1-c)*n[b]+c*n[d]);e=e.IH;f[7]&&(z[0]=(1-c)*e[3*b]+c*e[3*d],z[1]=(1-c)*e[3*b+1]+c*e[3*d+1],z[2]=(1-c)*e[3*b+2]+c*e[3*d+2],l=z);for(e=0;e<k.length;e++)b=a.I[e].xb,(f[0]||f[1]||f[2])&&ja.OC(b,
v,u,da),f[3]&&ja.tL(b,T),f[4]&&ja.rL(b,ga),f[5]&&ja.uL(b,q),f[6]&&ja.sL(b,h),f[7]&&ja.SC(b,l);break;default:sa.q("Unknown animation type:"+u)}}}function N(a){var b=a.az[0],e=a.az[1]-b,b=a.wf-b;0>b&&(b=0);b>=e&&(b=e);b/=a.sF;e=Math.floor(b);a=a.qF[e]?b-e:0;b=Math.ceil(e+a);oa[0]=e;oa[1]=b;oa[2]=a;return oa}function I(a,b){var e=a.k,c=e.Bh,d=e.To,f=d[0],d=d[1];if(-1!=d){if(-1!=f){var k=a.ha[f];if(k.play||0==b){var u=N(k),q=u[0],da=u[1];e.Ue=u[2];var u=k.Db[q],T=k.Db[da],q=k.trans[q],da=k.trans[da]}else c=
1}else c=1;d=a.ha[d];if(d.play||0==b){var f=N(d),ga=f[0],h=f[1];e.Ue=f[2]}else if(-1!=f&&k.play)c=0;else return;f=d.Db[ga];k=d.Db[h];ga=d.trans[ga];h=d.trans[h];if(1==c)e.ke.set(f),e.Be.set(k),e.oe.set(ga),e.Ee.set(h);else if(0==c)e.ke.set(u),e.Be.set(T),e.oe.set(q),e.Ee.set(da);else{for(d=0;d<u.length;d+=4){for(var l=z,n=ma,F=0;4>F;F++)l[F]=u[d+F],n[F]=f[d+F];Q.slerp(l,n,c,l);for(F=0;4>F;F++)e.ke[d+F]=l[F];for(F=0;4>F;F++)l[F]=T[d+F],n[F]=k[d+F];Q.slerp(l,n,c,l);for(F=0;4>F;F++)e.Be[d+F]=l[F]}sa.YF(q,
ga,c,e.oe);sa.YF(da,h,c,e.Ee)}Y.D(a);v.XZ(a)}}function O(a,b){var e=a.k,c=e.Bh,d=e.Cp;if(0!=d){var c=e.Bp-c,f=d*b;sa.sign(c)==sa.sign(d)&&Math.abs(f)<Math.abs(c)?e.Bh+=f:(e.Bh=e.Bp,e.Cp=0)}}function E(a){var b=[],e=[],c=new Float32Array(4),d=new Float32Array(4),f;for(f in a){var z=a[f],k=c,v=d,da=z.Rt,T=da[da.length-1],ga=T.ND;T.ix||qa.identity(ga);for(T=da.length-1;0<=T;T--){var u=da[T],q=u.ND;if(u.ix)ga=q;else{var h=u.Mk,l=u.hx;qa.invert(h,ea);qa.multiply(l,ea,ea);qa.multiply(h,ea,ea);qa.multiply(ga,
ea,q);ga=q;u.ix=!0}}da=u.ND;k[0]=da[0];k[1]=da[1];k[2]=da[2];k[3]=da[3];v[0]=da[4];v[1]=da[5];v[2]=da[6];v[3]=da[7];Q.normalize(v,v);z=z.Dj;for(k=0;4>k;k++)v=4*z+k,b[v]=c[k],e[v]=d[k]}return{trans:b,Db:e}}function c(a,b,e){var c=[],d=[];new Float32Array(4);new Float32Array(4);for(var f in e)for(var z=e[f],k=z.Dj,z=z.mA,v=0;4>v;v++){var da=4*z+v,T=4*k+v;c[da]=a[T];d[da]=b[T]}c=new Float32Array(c);d=new Float32Array(d);return{trans:c,Db:d}}function k(a){var b=a.s,e;if(b.qz)e=10;else if(b.qb)if("volume"in
b.qb||"pitch"in b.qb)e=40;else if(L(a))e=60;else{var c;a:{if(a.s.qb){c=a.fcurves;for(var d in c)if("color"==d&&!c[d][3]){c=!0;break a}if("energy"==d){c=!0;break a}}c=!1}if(c)e=70;else if(c=a.s.qb,"light_settings.environment_energy"in c||"horizon_color"in c||"zenith_color"in c||"mist_settings.intensity"in c||"mist_settings.depth"in c||"mist_settings.start"in c||"mist_settings.height"in c||"b4w_fog_color"in c)e=80;else{a:{if(a.s.qb)for(e in a=a.fcurves,a)if("location"==e||"rotation_quaternion"==e||
"scale"==e){e=!0;break a}e=!1}e=e?20:0}}else e=0;b.type=e}function L(a){if(a=a.s.qb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function y(a,b){b[0]=b[1]=b[2]=0;for(var e in a)"location"==e?b[0]=1:"rotation_quaternion"==e?b[1]=1:"scale"==e&&(b[2]=1)}function A(a,b){b[0]=b[1]=0;for(var e in a)"energy"==e?b[0]=1:"color"==e&&(b[1]=1)}function e(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var e in a)"light_settings.environment_energy"==e?b[0]=1:"horizon_color"==e?b[1]=1:"zenith_color"==
e?b[2]=1:"mist_settings.intensity"==e?b[3]=1:"mist_settings.depth"==e?b[4]=1:"mist_settings.start"==e?b[5]=1:"mist_settings.height"==e?b[6]=1:"b4w_fog_color"==e&&(b[7]=1)}function R(a,b,e,c,d,f,z){var k=a+(b-a)/2,v=q(k,c,d,f,z)-e;return.02>Math.abs(v)?k:0<v?R(a,k,e,c,d,f,z):R(k,b,e,c,d,f,z)}function q(a,b,e,c,d){var f=1-a;return b*f*f*f+3*e*f*f*a+3*c*f*a*a+d*a*a*a}function ba(a,b){var e={type:null,xi:null,az:null,sF:0,qF:null,Bi:new Int8Array(8),Db:null,trans:null,hD:[],play:!1,behavior:20,wf:0,start:0,
length:0,LD:0,sC:0,Jq:!1,oN:null,speed:1,volume:null,pitch:null,color:null,Ii:null,pe:null,he:null,Pq:null,fog_depth:null,fog_start:null,fog_height:null,IH:null,iK:[],eh:[],hK:[],dh:[],Yv:null};if(!a.ha.length)for(var c=0;8>c;c++)a.ha.push(null);a.ha[b]=e;-1==ya.indexOf(a)&&ya.push(a)}function J(a,b){Y.D(a);ha.H(a);l(a,0,b,!0)}function F(a,e,c,f){f=f||0;if(H.Rc(a)){var z=V(a,c);if(z)return ba(a,f),d(a,z,f),J(a,f),!0;if((z=U(a,c))&&"EMITTER"==z.fw){ba(a,f);e=z.name;c=f;for(var z=a.I,k=0;k<z.length;k++)for(var v=
z[k].U,q=0;q<v.length;q++){var l=v[q].gb;l&&l.name==e&&b(a.ha[c],l)}J(a,f);return!0}}if(z=sa.Dd("name",c,na)||sa.Dd("name",c+"_B4W_BAKED",na)){ba(a,f);if(h(a,e,z,f))return J(a,f),!0;a.ha[f]=null}u.error('Unsupported object: "'+a.name+'" or animation name: "'+c+'"');return!1}function V(a,b){for(var e=0;e<a.Yc.length;e++){var c=a.Yc[e];if(c.name===b)return c}return null}function U(a,b){for(var e=a.I,c=0;c<e.length;c++)for(var d=e[c].U,f=0;f<d.length;f++){var z=d[f].gb;if(z&&z.name===b)return z}return null}
function aa(a){a=a.modifiers;for(var b=0;b<a.length;b++){var e=a[b];if("ARMATURE"==e.type)return e.object}return null}var v=r("__armature"),fa=r("__config"),M=r("__lights"),H=r("__obj_util"),Z=r("__particles"),ha=r("__physics"),u=r("__print"),Q=r("__quat"),ca=r("__reformer"),ja=r("__scenes"),ua=r("__sfx"),pa=r("__subscene"),S=r("__time"),Y=r("__transform"),qa=r("__tsr"),sa=r("__util"),za=r("__vec3"),X=fa.ll,ta=fa.Ci;a.uO=1E-6;a.LE=0;a.Qy=10;a.Ry=20;a.OE=30;a.NE=40;a.ME=50;a.KE=60;a.PO=70;a.OO=80;
a.pd=0;a.UE=1;a.VE=2;a.WE=3;a.XE=4;a.YE=5;a.ZE=6;a.ot=7;a.bl=-1;a.eE=10;a.fE=20;a.Fx=30;var oa=Array(3),P=new Float32Array(3),la=new Float32Array(3),z=new Float32Array(4),ma=new Float32Array(4),Ea=new Float32Array(4),ea=qa.create();new Float32Array(16);var ya=[],na=[];a.vI=function(){return sa.trunc((ta.Br-50)/4)};a.MH=function(a){return a/S.sd()};a.update=function(a){for(var b=0;b<ya.length;b++){for(var e=ya[b],c=0;8>c;c++)D(e,a,c);e.k.wi&&(O(e,a),I(e,a))}for(b=0;b<ya.length;b++)for(e=ya[b],c=0;8>
c&&e.ha.length;c++)n(e,c)};a.AU=function(){return na};a.$H=function(a){var b=[];if(m(a))for(var e=0;e<a.Yc.length;e++)b.push(a.Yc[e].name);for(var c=[],e=0;e<na.length;e++){var d=na[e],f=d.s;20==f.type?c.push(d):60==d.s.type&&"MESH"==a.type?c.push(d):10==f.type&&"ARMATURE"==a.type?c.push(d):40==f.type&&"SPEAKER"==a.type?c.push(d):80==f.type&&"WORLD"==a.type&&c.push(d)}for(e=0;e<c.length;e++)b.push(t(c[e].name));if(Z.ZB(a)&&Z.mK(a))for(a=a.I,e=0;e<a.length;e++)for(c=a[e].U,d=0;d<c.length;d++)(f=c[d].gb)&&
b.push(f.name);return b};a.sM=t;a.aI=function(a,b){var e=a.ha[b];return e?e.type:0};a.Dt=function(a){for(var e=0,c=a.I,f=0;f<c.length;f++)for(var z=c[f].U,k=0;k<z.length;k++){var v=z[k].gb;v&&"EMITTER"==v.fw&&!z[k].Zf&&(ba(a,e),b(a.ha[e],v),J(a,e),a.ha[e].behavior=v.ve?10:a.kl,e++)}c=a.Jg.slice();for(f=0;f<c.length;f++)k=c[f],z=k.ao,k=k.action,ba(a,e),h(a,z,k,e)?(J(a,e),a.ha[e].behavior=a.kl,e++):a.ha[e]=null;m(a)&&(ba(a,e),d(a,a.Yc[0],e),J(a,e),a.ha[e].behavior=a.kl)};a.ez=function(a){switch(a){case "CYCLIC":return 10;
case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:sa.q("Wrong animation behavior")}};a.DU=function(a){var b=[];a=a.data.materials;for(var e=0;e<a.length;e++){var c=a[e],d=c.node_tree;d&&B(d,b,[c.name])}return b};a.pJ=p;a.play=function(a,b,e){g(a.ha,e,function(a){a.play=!0;a.DA=b?b:null;a.Jq=!1});a.k.wi&&C(a)};a.stop=function(a,b){g(a.ha,b,function(a){a.play=!1;a.DA=null;a.Jq=!1})};a.ak=function(a,b){var e=a.ha;if(-1==b)for(var c=0;8>c;c++){if(e[c]&&e[c].play)return!0}else if(e=e[b])return e.play;
return!1};a.ro=x;a.RC=function(a,b){b=b||0;g(a.ha,b,function(e){x(a,e.start,b)})};a.jI=function(a,b){var e=a.ha[b];return e&&e.wf?e.wf:0};a.DV=function(a,b){var e=a.ha[b];return e&&10==e.behavior};a.ks=function(a,b,e){g(a.ha,e,function(a){a.behavior=b})};a.dI=function(a,b){var e=a.ha[b];return e&&e.behavior};a.BF=function(a,b,e,c){g(a.ha,c,function(a){a.LD=b||0;a.sC=e||0})};a.UK=function(a,b){if(-1==b)for(var e=0;8>e;e++)a.ha[e]=null;else a.ha[b]=null;a.k.wi&&K(a,b)};a.NZ=l;a.oK=function(a){if("ARMATURE"==
a.type||a.Ft||"WORLD"==a.type)return!0;for(var b=0;b<a.Jg.length;b++){var e=a.Jg[b].action.s.type;if(20==e||10==e||40==e&&"SPEAKER"==a.type||70==e&&"LAMP"==a.type||60==e&&"MESH"==a.type)return!0}return Z.ZB(a)&&Z.mK(a)||"MESH"==a.type&&a.Yc.length?!0:!1};a.eG=function(a,b){if("ARMATURE"==b.type||aa(a)||"WORLD"==b.type)return!0;for(var e=0;e<b.Jg.length;e++){var c=b.Jg[e].action.s.type;if(20==c||10==c||40==c&&"SPEAKER"==b.type||60==c&&"MESH"==b.type)return!0}return Z.bR(a)&&Z.aR(a)||"MESH"==b.type&&
a.data.b4w_vertex_anim.length?!0:!1};a.Ac=function(a){return Boolean(a.ha.length)};a.lR=E;a.ST=c;a.dQ=function(a){function b(a,T){for(var e=0;e<T;e++){var c=a.subarray(8*e+4,8*e+8);Q.normalize(c,c)}}function c(a,T){if(-1<a.indexOf("location"))var b=0,e=T;else-1<a.indexOf("rotation_quaternion")?(b=4,e=0==T?3:T-1):-1<a.indexOf("scale")?(b=3,e=0):(b=0,e=T);return b+e}function d(a,T,b,e,c){if(-1<b.search(f)){a=T;b=b.split('"')[1];var da=z}else 8==c?(b="tsr",da=z):da=1<c?new Float32Array(c):0;if(!a[b]){c=
a;T=b;if("object"==typeof da&&da.length)for(var ga=da.length,k=new Float32Array(e*ga),v=0;v<e;v++)for(var q=0;q<ga;q++)k[v*ga+q]=da[q];else if("number"==typeof da)for(k=new Float32Array(e),v=0;v<e;v++)k[v]=da;else sa.q("Wrong storage default value");c[T]=k}return a[b]}var f=new RegExp(/pose.bones\[\".+\"\]/g),z=qa.create(),v=a.s={type:0,YB:0,xK:0,qb:null,qz:null,VF:null,Bi:new Int8Array(8)};v.xK=1/X.Nl;var u=a.fcurves,q={},da={},T=0,ga;for(ga in u){var h=u[ga],l;for(l in h){var n=h[l],F=n.uf;ca.xR(n,
a);n=n.num_channels;T||(T=F.length);for(var n=d(q,da,ga,T,n),H=n.length/T,w=c(ga,l|0),m=0;m<T;m++)n[m*H+w]=F[m]}}if(sa.Yq(q)){for(var g in q)"tsr"==g&&b(q[g],T);v.qb=q}if(sa.Yq(da)){for(var R in da)b(da[R],T);v.qz=da}v.YB=T;v.VF=a.UP;"tsr"in q&&y(u,v.Bi);("color"in q||"energy"in q)&&A(u,v.Bi);("light_settings.environment_energy"in q||"horizon_color"in q||"zenith_color"in q||"mist_settings.intensity"in q||"mist_settings.depth"in q||"mist_settings.start"in q||"mist_settings.height"in q||"b4w_fog_color"in
q)&&e(u,v.Bi);k(a);na.push(a)};a.CU=function(a,b){return(b-a)*X.Nl+1};a.DQ=function(a,b,e,c,d,f){var z=new Float32Array(2),k=new Float32Array(2),v=new Float32Array(2),da=new Float32Array(2),T=b[1],ga=b[2],u=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var h=0,l=0,n=null;d<=f;d++)if(d<T)for(var F=0;F<X.Nl;F++)e[h++]=ga;else if(d>u)for(F=0;F<X.Nl;F++)e[h++]=a;else{var H=b[l],w=3;0===H&&(w+=2);0===n&&(w+=2);var m=2===H?0:1;if(b[l+1]==b[l+w+1])n=H,l+=w;else{F=0;d==b[l+1]&&(m&&(c[h]=1),e[h]=
b[l+2],h++,F++);if(d==u)for(;F<X.Nl;F++)e[h++]=a;else for(z[0]=b[l+1],z[1]=b[l+2],0!==H?(k[0]=0,k[1]=0):0===n?(k[0]=b[l+5],k[1]=b[l+6]):(k[0]=b[l+3],k[1]=b[l+4]),0!==H?(v[0]=0,v[1]=0):(v[0]=b[l+w+3],v[1]=b[l+w+4]),da[0]=b[l+w+1],da[1]=b[l+w+2];F<X.Nl;F++){var g=d+F/X.Nl;switch(H){case 0:var p=z,M=k,J=v,A=da,U=[],y=[],C=void 0,S=void 0,V=void 0,C=void 0;U[0]=p[0]-M[0];U[1]=p[1]-M[1];y[0]=A[0]-J[0];y[1]=A[1]-J[1];V=A[0]-p[0];C=Math.abs(U[0]);S=Math.abs(y[0]);0!=C+S&&C+S>V&&(C=V/(C+S),M[0]=p[0]-C*U[0],
M[1]=p[1]-C*U[1],J[0]=A[0]-C*y[0],J[1]=A[1]-C*y[1]);m&&(c[h]=1);e[h]=q(R(0,1,g,z[0],k[0],v[0],da[0]),z[1],k[1],v[1],da[1]);h++;break;case 1:m&&(c[h]=1);p=z[0];M=z[1];J=(da[1]-M)/(da[0]-p);e[h]=J*g+(M-J*p);h++;break;case 2:m&&(c[h]=1);e[h]=b[l+2];h++;break;default:sa.q("Unknown keyframe interpolation mode: "+H)}}d+1==b[l+w+1]&&(n=H,l+=w)}}};a.apply=F;a.zQ=function(a,b,e,c){c=c||0;var d=sa.Dd("uuid",e,na);if(d){ba(a,c);if(h(a,b,d,c)){J(a,c);return}a.ha[c]=null}u.error('Unsupported object: "'+a.name+
'" or animation uuid: "'+e+'"')};a.pN=function(a,b){var e=sa.Dd("name",b,na)||sa.Dd("name",b+"_B4W_BAKED",na);if(e){if(0==e.s.type)return!1}else if(!(U(a,b)||H.Rc(a)&&V(a,b)))return!1;return!0};a.Tu=function(a,b){for(var e=a.ha,c=0;c<e.length;c++){var d=e[c];if(d&&t(d.xi)==t(b))return c}return-1};a.BU=function(a,b){var e=a.ha[b];return e&&e.xi?t(e.xi):null};a.remove=function(a){a.ha.length=0;a=ya.indexOf(a);-1!=a&&ya.splice(a,1)};a.oX=function(a){for(var b=na.length-1;0<=b;b--)na[b].VP==a&&na.splice(b,
1)};a.CF=function(a,b){if(!a.ha.length)return F(a,b,0)?0:-1;for(var e=0;e<a.ha.length;e++)if(!a.ha[e])return F(a,b,e)?e:-1};a.FL=function(a,b,e){a.k.Cp=(b-a.k.Bh)/e;a.k.Bp=b};a.HL=function(a,b,e){g(a.ha,e,function(a){a.speed=b})};a.NI=function(a,b){return a.ha[b].speed};a.LA=function(a,b){return a.ha[b].start};a.KA=function(a,b){return a.ha[b].length};a.sa=function(){ya.length=0;na.length=0};a.XT=function(a){var b=(a[0]||a[1]||a[2]).uf.length,e=z,c=P,d=Boolean(a[0]);d||(a[0]={uf:new Float32Array(b),
num_channels:8});var f=Boolean(a[1]);f||(a[1]={uf:new Float32Array(b),num_channels:8});var k=Boolean(a[2]);k||(a[2]={uf:new Float32Array(b),num_channels:8});a[3]={uf:new Float32Array(b),num_channels:8};for(var v=0;v<b;v++)c[0]=d?a[0].uf[v]:0,c[1]=f?a[1].uf[v]:0,c[2]=k?a[2].uf[v]:0,sa.Pj(c,e),a[0].uf[v]=e[3],a[1].uf[v]=e[0],a[2].uf[v]=e[1],a[3].uf[v]=e[2]};a.fI=aa;a.CY=function(a,b){for(var e=7,c=0,d=0;d<na.length;d++){var f=na[d];if(f.name==b){c=f.s.type;break}}0==c&&(V(a,b)?c=30:(d=U(a,b))&&"EMITTER"==
d.fw&&(c=50));for(d=0;8>d;d++)if(f=a.ha[d]){if(f.type==c)return d}else d<e&&(e=d);return e}};b4w.module.__armature=function(a,r){function n(a){a=a.k;for(var b=a.zo,d=a.Ov,h=0;h<b.length;h++){for(var l=b[h],n=d[h],w=0;w<n.length;w+=2)for(var m=n[w],g=n[w+1],p=0;4>p;p++)l.ke[m+p]=a.ke[g+p],l.Be[m+p]=a.Be[g+p],l.oe[m+p]=a.oe[g+p],l.Ee[m+p]=a.Ee[g+p];l.Ue=a.Ue}}function d(a,b,h,l){var n=a.UM,w=a.Mk,m=a.jx,p=a.vK;p?(p=p.jx,b?t.multiply(p,n,m):(b=g,t.invert(p,b),t.multiply(b,m,n))):b?t.copy(n,m):t.copy(m,n);n=x;t.invert(w,n);t.multiply(m,n,n);w=a.Dj;h[4*w]=n[0];h[4*w+1]=n[1];h[4*w+2]=n[2];h[4*
w+3]=n[3];l[4*w]=n[4];l[4*w+1]=n[5];l[4*w+2]=n[6];l[4*w+3]=n[7];a=a.uH;for(w=0;w<a.length;w++)m=a[w],m.ic||d(m,!0,h,l)}var b=r("__util"),t=r("__tsr"),p=r("__quat"),B=r("__mat4"),m=r("__vec3"),x=t.create(),g=t.create(),l=new Float32Array(4),h=new Float32Array(4),w=new Float32Array(4);a.Pk=function(a,d){for(var h=a.data.bones,l=a.pose.bones,n={},w=0;w<l.length;w++){var p=l[w],g=p.bone,O=g.name,E=n[O]={Dj:0,wN:-1,vK:null,uH:[],Rt:[],ic:null,MD:t.create(),UM:t.create(),Mk:t.create(),jx:t.create(),hx:t.create(),
ND:t.create(),ix:!1,BM:new Float32Array(3)},O=new Float32Array(g.matrix_local),c=new Float32Array(16);B.invert(O,c);var p=new Float32Array(p.matrix_basis),k=E.BM;m.subtract(b.yf(g.tail_local),b.yf(g.head_local),k);b.m_(k,c,k);t.Mi(O,E.Mk);t.Mi(p,E.hx);t.copy(E.Mk,E.jx)}for(w=0;w<h.length;w++){O=h[w].name;p=b.Dd("name",O,l);E=n[O];g=p.parent_recursive;E.Rt.push(E);for(c=0;c<g.length;c++)p=g[c],p=p.name,p=n[p],E.Rt.push(p);g.length?(p=g[0],p=p.name,p=n[p],E.vK=p,t.invert(p.Mk,x),t.multiply(x,E.Mk,E.MD),
p.uH.push(E)):t.copy(E.Mk,E.MD);E.Dj=w;E.name=O;t.multiply(E.MD,E.hx,E.UM)}d.k.Dg=n};a.Iu=function(a,b,d,n){var m=a.k,D=m.Ue;b=m.Dg[b];var B=b.Dj;a=b.Mk;var I=m.oe,O=m.Ee,E=m.ke,m=m.Be,c=I[4*B+1],k=I[4*B+2],y=I[4*B+3],A=O[4*B+1],e=O[4*B+2],R=O[4*B+3];l[0]=(1-D)*I[4*B]+D*O[4*B];l[1]=(1-D)*c+D*A;l[2]=(1-D)*k+D*e;l[3]=(1-D)*y+D*R;h[0]=E[4*B];h[1]=E[4*B+1];h[2]=E[4*B+2];h[3]=E[4*B+3];w[0]=m[4*B];w[1]=m[4*B+1];w[2]=m[4*B+2];w[3]=m[4*B+3];p.slerp(h,w,D,h);D=x;t.mY(l,D);t.Ck(h,D);d?(d=g,t.translate(a,b.BM,
d),t.multiply(D,d,D)):t.multiply(D,a,D);t.copy(D,n)};a.OX=function(a,b,h){var l=a.k;b=l.Dg[b];var w=l.oe,m=l.ke;t.copy(h,b.jx);d(b,!1,w,m);l.Ue=0;n(a)};a.XZ=n;a.CZ=d;a.zR=function(a,b){return b in a.k.Dg}};b4w.module.__util=function(a,r){function n(a){return 0<a?1:0>a?-1:0}function d(a,b,e){var c=a[0],d=a[1];a=a[2];var da=Math.cos(c/2),T=Math.cos(d/2),f=Math.cos(a/2),z=Math.sin(c/2),d=Math.sin(d/2),k=Math.sin(a/2);if(-1<V.indexOf(b))var v=Math.cos((c+a)/2),q=Math.sin((c+a)/2),u=Math.cos((c-a)/2),h=Math.sin((c-a)/2),l=Math.cos((a-c)/2),n=Math.sin((a-c)/2);switch(b){case Ea:e[0]=T*q;e[1]=d*u;e[2]=d*h;e[3]=T*v;break;case ea:e[0]=d*h;e[1]=T*q;e[2]=d*u;e[3]=T*v;break;case ya:e[0]=d*u;e[1]=d*h;e[2]=T*q;e[3]=
T*v;break;case 3:e[0]=T*q;e[1]=d*n;e[2]=d*l;e[3]=T*v;break;case na:e[0]=d*l;e[1]=T*q;e[2]=d*n;e[3]=T*v;break;case Ha:e[0]=d*n;e[1]=d*l;e[2]=T*q;e[3]=T*v;break;case 6:e[0]=z*T*f+da*d*k;e[1]=da*d*f-z*T*k;e[2]=da*T*k+z*d*f;e[3]=da*T*f-z*d*k;break;case 7:e[0]=da*T*k+z*d*f;e[1]=z*T*f+da*d*k;e[2]=da*d*f-z*T*k;e[3]=da*T*f-z*d*k;break;case 8:e[0]=da*d*f-z*T*k;e[1]=da*T*k+z*d*f;e[2]=z*T*f+da*d*k;e[3]=da*T*f-z*d*k;break;case 9:e[0]=z*T*f-da*d*k;e[1]=da*T*k-z*d*f;e[2]=da*d*f+z*T*k;e[3]=da*T*f+z*d*k;break;case 10:e[0]=
da*d*f+z*T*k;e[1]=z*T*f-da*d*k;e[2]=da*T*k-z*d*f;e[3]=da*T*f+z*d*k;break;case 11:e[0]=da*T*k-z*d*f,e[1]=da*d*f+z*T*k,e[2]=z*T*f-da*d*k,e[3]=da*T*f+z*d*k}return e}function b(a,b,e){var c=a[0],d=a[1],f=a[2];a=a[3];switch(b){case Ea:e[0]=Math.atan2(c*d+f*a,d*a-c*f);e[1]=Math.acos(1-2*(d*d+f*f));e[2]=Math.atan2(c*d-f*a,c*f+d*a);break;case ea:e[0]=Math.atan2(c*a+d*f,f*a-c*d);e[1]=Math.acos(1-2*(c*c+f*f));e[2]=Math.atan2(d*f-c*a,c*d+f*a);break;case ya:e[0]=Math.atan2(c*f+d*a,c*a-d*f);e[1]=Math.acos(1-2*
(c*c+d*d));e[2]=Math.atan2(c*f-d*a,c*a+d*f);break;case 3:e[0]=Math.atan2(c*f-d*a,c*d+f*a);e[1]=Math.acos(1-2*(d*d+f*f));e[2]=Math.atan2(c*f+d*a,f*a-c*d);break;case na:e[0]=Math.atan2(c*d-f*a,c*a+d*f);e[1]=Math.acos(1-2*(c*c+f*f));e[2]=Math.atan2(c*d+f*a,c*a-d*f);break;case Ha:e[0]=Math.atan2(d*f-c*a,c*f+d*a);e[1]=Math.acos(1-2*(c*c+d*d));e[2]=Math.atan2(c*a+d*f,d*a-c*f);break;case 6:e[0]=Math.atan2(2*(c*a-d*f),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*f+d*a));e[2]=Math.atan2(2*(f*a-c*d),1-2*(d*d+f*f));break;
case 7:b=c*d+f*a;.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=2*Math.atan2(c,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=-2*Math.atan2(c,a)):(e[0]=Math.atan2(2*(d*a-c*f),1-2*(d*d+f*f)),e[1]=Math.asin(2*(c*d+f*a)),e[2]=Math.atan2(2*(c*a-d*f),1-2*(c*c+f*f)));break;case 8:e[0]=Math.atan2(2*(f*a-c*d),1-2*(c*c+f*f));e[1]=Math.asin(2*(c*a+d*f));e[2]=Math.atan2(2*(d*a-c*f),1-2*(c*c+d*d));break;case 9:e[0]=Math.atan2(2*(c*a+d*f),1-2*(c*c+f*f));e[1]=Math.asin(2*(f*a-c*d));e[2]=Math.atan2(2*(c*f+d*a),1-2*(d*d+f*f));
break;case 10:e[0]=Math.atan2(2*(c*f+d*a),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*a-d*f));e[2]=Math.atan2(2*(c*d+f*a),1-2*(c*c+f*f));break;case 11:b=d*a-c*f,.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=-2*Math.atan2(f,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=2*Math.atan2(f,a)):(e[0]=Math.atan2(2*(c*d+f*a),1-2*(d*d+f*f)),e[1]=Math.asin(2*(d*a-c*f)),e[2]=Math.atan2(2*(c*a+d*f),1-2*(c*c+d*d)))}return e}function t(a,b,e){var c=b.length,d=U;d[0]=a[0];d[1]=a[1];d[2]=a[2];q.normalize(d,d);c?(a=Q,a[0]=b[0],a[1]=b[1],
a[2]=b[2],a[3]=b[3],b=q.cross(a,d,fa),q.normalize(b,b),q.cross(d,b,a),c=ca,c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=b[0],c[7]=b[1],c[8]=b[2],R.fromMat3(c,e),e[3]=0<e[3]?e[3]+3.1E-5:e[3]-3.1E-5,(0<e[3]&&0>a[3]||0>e[3]&&0<a[3])&&R.scale(e,-1,e),R.normalize(e,e)):R.rotationTo(oa,d,e);return e}function p(a,b){b||(b=new Float32Array(4));c.fromMat4(a,ca);var e=ca[0],d=ca[3],f=ca[6],z=ca[1],T=ca[4],ga=ca[7],k=ca[2],v=ca[5],q=ca[8],e=Math.sqrt(e*e+d*d+f*f)||1,z=Math.sqrt(z*z+T*T+ga*
ga)||1,k=Math.sqrt(k*k+v*v+q*q)||1;ca[0]/=e;ca[3]/=e;ca[6]/=e;ca[1]/=z;ca[4]/=z;ca[7]/=z;ca[2]/=k;ca[5]/=k;ca[8]/=k;R.fromMat3(ca,b);R.normalize(b,b);return b}function B(a){var b=a[0],e=a[1],c=a[2],d=a[3],f=Math.sqrt(b*b+e*e+c*c),f=1/f;a[0]=b*f;a[1]=e*f;a[2]=c*f;a[3]=d*f}function m(a,b){var e=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var c in a)e=m(a[c],e);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(c=
0;c<a.length;c++)e=x(a[c],e);break;case Array:for(c=0;c<a.length;c++)e=m(a[c],e);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:e=x(0,e);break;default:G("Wrong object constructor")}else e=x(0,e);return e;case "number":return x(a,e);case "boolean":return x(a|0,e);case "string":return g(a,e);case "function":case "undefined":return x(0,e)}}function x(a,b){var e=b;S[0]=a;e=(e<<5)-e+Y[0];e&=e;e=(e<<5)-e+Y[1];return e&e}function g(a,
b){for(var e=b,c=0;c<a.length;c++)e=(e<<5)-e+a.charCodeAt(c),e&=e;return e}function l(a){return(34*a+1)*a%289}function h(a){return a-Math.floor(a)}function w(a){return f((34*a+5)*a)}function f(a){return a-289*Math.floor(a/289)}function C(a){return a-7*Math.floor(a/7)}function K(a,b,e){a<b&&(a=b);a>e&&(a=e);return a}function G(a){a&&A.error.apply(A,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function L(a,b,e){a-=b;e-=b;return b+(a-Math.floor(a/e)*e)}function D(a){return L(a,0,2*Math.PI)}function N(a,b){if(a&&b){var e=a instanceof Array;if(e!=b instanceof Array)return!1;var c=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(c!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(e){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(!I(a[e],b[e]))return!1}else if(c){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(a[e]!=b[e])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var d in a)if(!I(a[d],b[d]))return!1;for(d in b)if(!(d in a))return!1}return!0}return!(a||b)}function I(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return N(a,b);default:return!0}}function O(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var e=[],c=0;c<a.length;c++){var d=a[c];""!=d&&"."!=d&&(".."!=d||!b&&!e.length||e.length&&".."==e[e.length-1]?
e.push(d):e.length&&e.pop())}a=e.join("/");for(c=0;c<b;c++)a="/"+a;return a||"."}function E(){var a=[{}];a.length=0;return a}var c=r("__mat3"),k=r("__mat4"),y=r("__math"),A=r("__print"),e=r("__tsr"),R=r("__quat"),q=r("__vec3"),ba=r("__vec4"),J=0,F={},V=[Ea,ea,ya,na,Ha],U=new Float32Array(3),aa=new Float32Array(3),v=new Float32Array(3),fa=new Float32Array(3),M=new Float32Array(3),H=new Float32Array(3),Z=new Float32Array(3),ha=new Float32Array(3),u=new Float32Array(4),Q=new Float32Array(4),ca=new Float32Array(9),
ja=new Float32Array(16),ua=new Float32Array(16),pa=R.create(),S=new Float64Array(1),Y=new Uint32Array(S.buffer),qa=new Float32Array([0,0,0]),sa=new Float32Array([0,0,0,1]),za=new Float32Array([0,0,0,1,0,0,0,1]),X=new Float32Array([1,1,1]),ta=new Float32Array([1,0,0]),oa=new Float32Array([0,1,0]),P=new Float32Array([0,0,1]),la=new Float32Array([-1,0,0]),z=new Float32Array([0,-1,0]),ma=new Float32Array([0,0,-1]),Ea=0,ea=1,ya=2,na=4,Ha=5,Da=Math.floor(44488.07041494893),Ra=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.aF=qa;a.$m=sa;a.f1=za;a.Xy=X;a.oi=ta;a.pi=oa;a.ad=P;a.Kx=la;a.Zk=z;a.$c=ma;a.bF=Ea;a.iF=ea;a.jF=ya;a.dF=3;a.fF=na;a.lF=Ha;a.cF=6;a.hF=7;a.Yy=8;a.eF=9;a.gF=10;a.kF=11;a.VN=Ra;a.Lx=1;a.tp=2;a.uj=4;a.rE=4;
a.Rh=function(a){return"undefined"!=typeof a};a.JJ=function(a,b,e){for(var c=[],d=e.length,f=0;f<d;f++){var T=e[f];T[a]==b&&c.push(T)}return c};a.yf=function(a){return new Float32Array(a)};a.cU=function(a,b){var e=a.length,c=new Float32Array(e+b.length);c.set(a);c.set(b,e);return c};a.tZ=function(a,b){var e=a.length,c=new Uint32Array(e+b.length);c.set(a);c.set(b,e);return c};a.GR=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.EQ=function(a,b){var e=
[],c={},d=b.length,f,T;for(f=0;f<d;f++)c[b[f]]=!0;d=a.length;for(f=0;f<d;f++)T=a[f],T in c&&e.push(T);return e};a.sign=n;a.S5=function(a,b,e){for(var c=e.length,d=0;d<c;d++)if(e[d][a]==b)return!0;return!1};a.Dd=function(a,b,e){for(var c=0;c<e.length;c++){var d=e[c];if(d[a]===b)return d}return null};a.P5=function(a,b,e,c,d){for(var f=0;f<d.length;f++){var T=d[f];if(T[a]==b&&T[e]==c)return T}return null};a.WU=function(a,b){for(var e=0;e<a.length;e++)if(a[e].uuid==b)return e;return-1};a.yQ=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]==b)return;a.push(b)};a.m2=function(a){for(var b=0;b<a.length-1;b++)for(var e=a[b],c=b+1;c<a.length;c++)if(e==a[c])return!1;return!0};a.kZ=function(a,b,e,c){c||(c=new Float32Array(16));k.identity(c);c[12]=a;c[13]=b;c[14]=e};var ra=1;a.lX=function(){ra=(69069*ra+5)%Math.pow(2,32);return Math.round(ra/65536)%32768/32767};a.SY=function(a){ra=a};a.og=function(a){var b=a[0]%Da*48271-3399*Math.floor(a[0]/Da);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.rv=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.Pj=function(a,b){var e=U;e[0]=a[2];e[1]=a[1];e[2]=a[0];d(e,11,b);return b};a.$B=d;a.NK=b;a.LT=function(a){var b=c.create(),e=Math.cos(a[0]),d=Math.cos(a[1]),f=Math.cos(a[2]),z=Math.sin(a[0]),T=Math.sin(a[1]);a=Math.sin(a[2]);var ga=e*f,k=e*a,v=z*f,q=z*a;b[0]=d*f;b[1]=d*a;b[2]=-T;b[3]=T*v-k;b[4]=T*q+ga;b[5]=d*z;b[6]=T*ga+q;b[7]=T*k-v;b[8]=d*e;return b};a.sw=function(a,e){var c=b(a,11,U);e[0]=c[2];e[1]=c[1];e[2]=c[0];return e};a.lc=function(a,b,e){e||
(e=new Float32Array(3));q.transformQuat(b,a,e);return e};a.pA=function(a,b,e){e||(e=new Float32Array(4));a=q.normalize(a,U);var c=q.dot(b,a);a=q.cross(b,a,v);c=Math.acos(c);e[0]=a[0]*Math.sin(c/2);e[1]=a[1]*Math.sin(c/2);e[2]=a[2]*Math.sin(c/2);e[3]=Math.cos(c/2);return e};a.lZ=function(a,b,e,c){c||(c=new Float32Array(4));q.transformQuat(e,b,c);c[3]=-q.dot(a,c)};a.vT=function(a){var b=e.R(a.k.n),c=U;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;q.transformQuat(c,b,c);v[0]=0;v[1]=0;v[2]=-1;break;
case "MESH":c[0]=0;c[1]=0;c[2]=1;q.transformQuat(c,b,c);v[0]=0;v[1]=0;v[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,q.transformQuat(c,b,c),v[0]=0,v[1]=1,v[2]=0}c[1]=0;q.normalize(c,c);a=q.dot(c,v);return Math.acos(a)*(0<-c[0]*v[2]?-1:1)};a.YF=function(a,b,e,c){if(0!=e){c=c||[];for(var d=0;d<a.length;d++)c[d]=(1-e)*a[d]+e*b[d]}};a.uZ=function(){J++;return J.toString(10)};a.ws=function(a){F[a]||(F[a]=0);var b=a+F[a];F[a]++;return b};a.Ig=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.Wq=function(a,b,e){b=b||E();var c=b.length,d=a.length/3;e=e||new Float32Array(4*d);for(var f=0;f<d;++f){var T=U;T[0]=a[3*f];T[1]=a[3*f+1];T[2]=a[3*f+2];var z;c?(z=Q,z[0]=b[4*f],z[1]=b[4*f+1],z[2]=b[4*f+2],z[3]=b[4*f+3]):z=b;t(T,z,e.subarray(4*f,4*(f+1)))}return e};a.RI=t;a.Eh=function(a){return JSON.parse(JSON.stringify(a))};a.P=function(b){if(!(b instanceof Object))return b;var e;e=b.constructor;switch(e){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:e=
new e(b);break;case Array:e=new e(b.length);for(var c=0;c<b.length;c++)e[c]=a.P(b[c]);break;default:for(c in e=new e,b)e[c]=a.P(b[c])}return e};a.fq=function(a){var b=a instanceof Array?[]:{},e;for(e in a)if(a[e]instanceof Object){var c=a[e].constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[e]=new c(a[e]);break;case Array:b[e]=a[e].slice(0);break;default:b[e]=a[e]}}else b[e]=a[e];return b};a.EB=
p;a.XJ=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.WJ=function(a){u[0]=.577350269189626;u[1]=.577350269189626;u[2]=.577350269189626;u[3]=0;ba.transformMat4(u,a,u);return ba.length(u)};a.xn=function(a,b){var e=b.left,c=b.right,d=b.top,f=b.bottom,T=b.near,z=b.far;e[0]=a[3]+a[0];e[1]=a[7]+a[4];e[2]=a[11]+a[8];e[3]=a[15]+a[12];c[0]=a[3]-a[0];c[1]=a[7]-a[4];c[2]=a[11]-a[8];c[3]=a[15]-a[12];d[0]=a[3]-a[1];d[1]=a[7]-a[5];d[2]=a[11]-a[9];d[3]=a[15]-a[13];f[0]=a[3]+
a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];T[0]=a[3]+a[2];T[1]=a[7]+a[6];T[2]=a[11]+a[10];T[3]=a[15]+a[14];z[0]=a[3]-a[2];z[1]=a[7]-a[6];z[2]=a[11]-a[10];z[3]=a[15]-a[14];B(e);B(c);B(d);B(f);B(T);B(z)};a.NY=function(a,b,e){return e<-y.ng(a,b.near)||e<-y.ng(a,b.left)||e<-y.ng(a,b.right)||e<-y.ng(a,b.top)||e<-y.ng(a,b.bottom)||e<-y.ng(a,b.far)?!0:!1};a.FT=function(a,b,e,c,d){var f=q.dot(e,b.far),T=q.dot(c,b.far),z=q.dot(d,b.far),f=Math.sqrt(f*f+T*T+z*z);if(f<-y.ng(a,b.near)||f<-y.ng(a,b.far))return!0;
f=q.dot(e,b.left);T=q.dot(c,b.left);z=q.dot(d,b.left);if(Math.sqrt(f*f+T*T+z*z)<-y.ng(a,b.left))return!0;f=q.dot(e,b.right);T=q.dot(c,b.right);z=q.dot(d,b.right);if(Math.sqrt(f*f+T*T+z*z)<-y.ng(a,b.right))return!0;f=q.dot(e,b.top);T=q.dot(c,b.top);z=q.dot(d,b.top);if(Math.sqrt(f*f+T*T+z*z)<-y.ng(a,b.top))return!0;f=q.dot(e,b.bottom);T=q.dot(c,b.bottom);z=q.dot(d,b.bottom);return Math.sqrt(f*f+T*T+z*z)<-y.ng(a,b.bottom)?!0:!1};a.jo=function(a,b,e,c){c||(c=0);for(var d=a.length,f=0;f<d;f+=3){var T=
a[f],z=a[f+1],k=a[f+2];e[c+f]=b[0]*T+b[4]*z+b[8]*k+b[12];e[c+f+1]=b[1]*T+b[5]*z+b[9]*k+b[13];e[c+f+2]=b[2]*T+b[6]*z+b[10]*k+b[14]}};a.N8=function(a,b,e,c){c||(c=0);for(var d=a.length,f=0;f<d;f+=3){var T=a[f],z=a[f+1],k=a[f+2];e[c+f]=b[0]*T+b[4]*z+b[8]*k;e[c+f+1]=b[1]*T+b[5]*z+b[9]*k;e[c+f+2]=b[2]*T+b[6]*z+b[10]*k}return e};a.OK=function(a,b,e,c){c=c||0;for(var d=a.length,f=0;f<d;f+=4){pa[0]=a[f];pa[1]=a[f+1];pa[2]=a[f+2];pa[3]=a[f+3];var T=0<pa[3];R.multiply(b,pa,pa);(T&&0>pa[3]||!T&&0<pa[3])&&ba.scale(pa,
-1,pa);e[c+f]=pa[0];e[c+f+1]=pa[1];e[c+f+2]=pa[2];e[c+f+3]=pa[3]}};a.m_=function(a,b,e){e||(e=new Float32Array(3));u[0]=a[0];u[1]=a[1];u[2]=a[2];u[3]=0;ba.transformMat4(u,b,u);e[0]=u[0];e[1]=u[1];e[2]=u[2]};a.r3=function(a,b){var e=a.length;e||G("flatten(): Wrong or empty array");var c=a[0].length;c||G("flatten(): Wrong or empty subarray");b||(b=new Float32Array(e*c));for(var d=0;d<e;d++)for(var f=0;f<c;f++)b[d*c+f]=a[d][f];return b};a.n_=function(a){for(var b=[],e=0;e<a.length;e+=3){var c=new Float32Array([a[e],
a[e+1],a[e+2]]);b[e/3]=c}return b};a.Kt=function(b,e,c,d){if(d<c)return c;var f=c+Math.floor((d-c)/2);return b[f]>e?a.Kt(b,e,c,f-1):b[f]<e?a.Kt(b,e,f+1,d):f};a.Gj=function(a,b){for(var e=0;e<a.length;e++)if(a[e]!=b[e])return!1;return!0};a.x2=function(a,b,e){for(var c=0;c<a.length;c++)if(Math.abs(a[c]-b[c])>e)return!1;return!0};a.U6=function(a,b,e){e||(e=new Float32Array(16));for(var c=0;12>c;c++)e[c]=a[c]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.oZ=function(a,b,e,c,d){d||(d=new Float32Array(16));
b=k.fromRotationTranslation(e,c,ja);k.multiply(b,a,d);return d};a.Wc=function(a,b,e,c,d){d||(d=new Float32Array(3));e=k.fromRotationTranslation(e,c,ja);1!==b&&(c=k.identity(ua),b=q.set(b,b,b,U),k.scale(c,b,c),k.multiply(e,c,e));q.transformMat4(a,e,d);return d};a.x8=function(a,b,e,c,d){d||(d=new Float32Array(4));b=k.fromRotationTranslation(e,c,ja);ba.transformMat4(a,b,d);return d};a.F5=function(a,b,e,c,d){d||(d=new Float32Array(3));b=k.fromRotationTranslation(e,c,ja);k.invert(b,b);q.transformMat4(a,
b,d);return d};a.v8=function(a,b,e){e||(e=new Float32Array(16));k.fromRotationTranslation(b,a,e);a=a[3];for(b=0;12>b;b++)e[b]*=a;return e};a.c6=function(b,e,c){a.XJ(b,e);e[3]=a.WJ(b);p(b,c)};a.J1=function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e]);return JSON.stringify(b)};a.FX=function(a,b,e,c){c||(c=new Float32Array(3));var d=U;q.subtract(b,a,d);q.transformQuat(d,e,d);q.subtract(b,d,c)};a.rU=function(){var a=U;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),
d=new Float32Array(16),f=new Float32Array(16),T=new Float32Array(16);k.lookAt(a,[-1,0,0],[0,-1,0],b);k.scale(b,[-1,1,1],b);k.scale(b,[-1,1,-1],e);k.lookAt(a,[0,-1,0],[0,0,-1],c);k.scale(c,[1,1,-1],c);k.scale(c,[1,-1,-1],d);k.lookAt(a,[0,0,-1],[0,-1,0],f);k.scale(f,[-1,1,1],f);k.scale(f,[-1,1,-1],T);return[b,e,c,d,f,T]};a.vU=function(){var a=U;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),f=new Float32Array(16),T=new Float32Array(16);
k.lookAt(a,[1,0,0],[0,-1,0],b);k.scale(b,[-1,1,-1],e);k.lookAt(a,[0,1,0],[0,0,1],c);k.scale(c,[1,-1,-1],d);k.lookAt(a,[0,0,1],[0,-1,0],f);k.scale(f,[-1,1,-1],T);return[b,e,c,d,f,T]};a.oR=function(a){return m(a,0)};a.hJ=m;a.t5=g;a.tW=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.MK=function(a,b){b||(b=a);var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<e?(b[3]=2*Math.acos(a[3]),e=1/Math.sqrt(e),
b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Lb=function(a){return a*Math.PI/180};a.df=function(a){return 180*a/Math.PI};a.jD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],e=Math.floor(a[0]+b),c=Math.floor(a[1]+b),d=.211324865405187*e+.211324865405187*c,b=a[0]-e+d;a=a[1]-c+d;var f=b>a?1:0,T=1-f,d=b+.211324865405187-f,z=a+.211324865405187-T,k=b+-.577350269189626,v=a+-.577350269189626,
e=e%289,c=c%289,q=l(l(c)+e),T=l(l(c+T)+e+f),u=l(l(c+1)+e+1),e=Math.max(.5-(b*b+a*a),0),c=Math.max(.5-(d*d+z*z),0),f=Math.max(.5-(k*k+v*v),0),n=2*h(.024390243902439*q)-1,F=2*h(.024390243902439*T)-1,w=2*h(.024390243902439*u)-1,q=Math.abs(n)-.5,T=Math.abs(F)-.5,u=Math.abs(w)-.5,n=n-Math.floor(n+.5),F=F-Math.floor(F+.5),w=w-Math.floor(w+.5),e=e*e*e*e*(1.79284291400159-.85373472095314*(n*n+q*q)),c=c*c*c*c*(1.79284291400159-.85373472095314*(F*F+T*T)),f=f*f*f*f*(1.79284291400159-.85373472095314*(w*w+u*u));
return 130*(e*(n*b+q*a)+c*(F*d+T*z)+f*(w*k+u*v))};a.lG=function(a){var b=1/7,e=b/2,c=f(Math.floor(a[0])),d=f(Math.floor(a[1])),z=h(a[0]);a=h(a[1]);var T=z-.5,k=z-1.5,z=a-.5;a-=1.5;var v=w(c),q=w(c+1),u=v,c=q,v=w(v+d),q=w(q+d),u=w(u+d+1),c=w(c+d+1),d=T+.7*(C(v)*b+e),l=k+.7*(C(q)*b+e),T=T+.7*(C(u)*b+e),k=k+.7*(C(c)*b+e),v=z+.7*(C(Math.floor(v*b))*b+e),z=z+.7*(C(Math.floor(q*b))*b+e),u=a+.7*(C(Math.floor(u*b))*b+e),b=a+.7*(C(Math.floor(c*b))*b+e);return Math.min(d*d+v*v,l*l+z*z,T*T+u*u,k*k+b*b)};a.rC=
function(a,b,e,c,d){d||(d=new Float32Array(4));a=q.transformQuat(b,a,U);b=e[0];var f=e[1];e=e[2];var T=ca;T[0]=f*f+e*e;T[1]=-f*b;T[2]=-e*b;T[3]=-b*f;T[4]=b*b+e*e;T[5]=-e*f;T[6]=-b*e;T[7]=-f*e;T[8]=b*b+f*f;q.transformMat3(a,T,a);q.normalize(a,a);R.rotationTo(c,a,d);return d};a.zz=function(a,b){b||(b=new Float32Array(4));var e=u,c=Q,e=R.setAxisAngle([0,0,1],Math.PI,R.create()),c=R.setAxisAngle([1,0,0],Math.PI/2,R.create());R.multiply(e,c,e);R.multiply(a,e,b);return b};a.sa=function(){J=0;F={}};a.V=
K;a.vc=function(a,b,e,c){e=Math.exp(-e/c);return(1-e)*a+e*b};a.Xw=function(a,b,e,c,d){d||(d=new Float32Array(a.length));e=Math.exp(-e/c);for(c=0;c<d.length;c++)d[c]=(1-e)*a[c]+e*b[c];return d};a.gM=function(a,b,e,c,d){d||(d=new Float32Array(a.length));R.slerp(a,b,Math.exp(-e/c),d)};a.nB=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.ek=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};
a.Sz=function(a,b){var e=c.fromQuat(a,ca),d=U;d[0]=e[6];d[1]=e[7];d[2]=e[8];d=q.cross(P,d,d);q.normalize(d,d);var f=e[4];!b&&0<f&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);v[0]=e[0];v[1]=e[1];v[2]=e[2];q.normalize(v,v);e=Q;R.rotationTo(v,d,e);R.multiply(e,a,a)};a.cI=function(a,b,e,c){e=e*b-.5;var d=c*b-.5;c=e-Math.floor(e);var f=d-Math.floor(d);e=Math.floor(e);var d=Math.floor(d),T=b-1,z=a[d*b+e],k=a[d*b+Math.min(e+1,T)],v=a[Math.min(d+1,T)*b+e];a=a[Math.min(d+1,T)*b+Math.min(e+1,T)];return(z*(1-c)+k*c)*(1-f)+
(v*(1-c)+a*c)*f};a.ym=function(a){for(var b=0,e=0;3>e;e++)0<(a&1<<e)&&b++;return b};a.$K=function(a){for(var b=[0,0,0],e=0;3>e;e++)0<(a&1<<e)&&(b[2-e]=1);return b};a.oo=function(a,b){var e=0;(1==b||2==b)&&0<(a&4)&&e++;2==b&&0<(a&2)&&e++;return e};a.GA=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.Yq=function(a){var b=0,e;for(e in a)a.hasOwnProperty(e)&&b++;return b};a.PK=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.kJ=function(a,b,e){e||(e=new Float32Array(3));e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=0;q.normalize(e,e)};a.mZ=function(a,b,e){var c=a[0],d=a[1];a=a[2];var f=b[0],T=b[1],z=b[2];b=b[3];var k=T*a-z*d,v=z*c-f*a,q=f*d-T*c,u=T*q-z*v,z=z*k-f*q,f=f*v-T*k;e[0]=c+2*k*b+2*u;e[1]=d+2*v*b+2*z;e[2]=a+2*q*b+2*f};a.assert=function(a){a||G("Assertion failed")};a.q=G;a.Bg=L;a.vi=D;a.QA=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.VY=function(a,b){for(var e in a){var c=
!0,d=a[e],f=b[e];switch(typeof d){case "number":case "string":case "boolean":c=d==f;break;case "object":c=N(d,f)}if(!c)return!1}return!0};a.qC=function(a,b){var e=a[0],c=a[2],d=a[3];b[0]=a[1];b[1]=c;b[2]=d;b[3]=e};a.RH=function(a){a+=1;132651<a&&A.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var e=Math.floor(a/51);return new Float32Array([b/51,e/51,a%51/51])};a.yB=function(a,b,e,c){u.set(a);u[3]=b;a=Q;U[0]=e[3];U[1]=e[4];U[2]=e[5];a.set(U);a[3]=0;a=ba.dot(u,a);if(0==a)return null;
b=Q;q.copy(e,U);b.set(U);b[3]=1;a=-ba.dot(u,b)/a;c[0]=e[0]+a*e[3];c[1]=e[1]+a*e[4];c[2]=e[2]+a*e[5];return c};a.aV=function(a,b,e,c){var d=b[0]-a[0],f=e[0]-a[0],T=b[1]-a[1],z=e[1]-a[1];b=b[2]-a[2];a=e[2]-a[2];c[0]=T*a-b*z;c[1]=f*b-d*a;c[2]=d*z-T*f;return c};a.A2=function(a,b){for(var e=0;e<a.length;e++)b[e]=a[e];return b};a.JC=function(a,b,e){var c=U,d=q.dot(a,b);-.9999999>d?(q.cross(ta,a,c),1E-6>q.length(c)&&q.cross(oa,a,c),q.normalize(c,c),R.setAxisAngle(c,Math.PI,e)):(q.cross(a,b,c),e.set(c),e[3]=
1+d,R.normalize(e,e));return e};a.ul=function(a,b,e){if(b==e)return e-a;a=D(a);b=D(b);e=D(e);b=2*Math.PI-b;e=D(e+b);a=D(a+b);return a>e?(e-=a,a=2*Math.PI-a,-e>a?a:e):0};a.Dm=function(a,b,e){isFinite(b)&&isFinite(e)&&(a=K(a,b,e));return a*a*(3-2*a)};a.lerp=function(a,b,e){return b+a*(e-b)};a.FQ=function(a,b){for(var e=0;e<a.length;e++)for(var c=0;c<b.length;c++)if(b[c]==a[e])return!0;return!1};a.J2=function(a){for(var b=Array(a),e=0;e<a;e++)b[e]=0;return b};a.uN=function(a,b){for(var e=Math.max(a.length,
b.length),c=0;c<e;c++){var d=n((c>=a.length?0:a[c])-(c>=b.length?0:b[c]));if(d)return d}return 0};a.Vk=function(a){return a.join(".")};a.qM=function(a){return a.split(".").map(function(a){return a|0})};a.a8=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.U5=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.aj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=O(b[1]),b.join("://")):O(a)};
a.aq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.ET=function(a,b,e,c){c[0]=a[0];c[1]=b[0];c[2]=e[0];c[3]=a[1];c[4]=b[1];c[5]=e[1];c[6]=a[2];c[7]=b[2];c[8]=e[2];return c};a.Lj=E;a.Mq=function(a){a=Math.round(32767.5*(a+1)-32768);return K(a?a:0,-32768,32767)};a.Q7=function(a){return K((a+32768)/32767.5-1,-1,1)};a.sZ=function(a){return K(Math.round(255*a),0,255)};a.A8=function(a){return K(a/255,0,1)};a.xT=function(a,b,e,c){var d=q.subtract(e,b,U),f=q.subtract(c,e,aa),T=q.subtract(b,
c,v);b=q.subtract(a,b,fa);e=q.subtract(a,e,M);a=q.subtract(a,c,H);c=q.cross(d,f,Z);if(0<=q.dot(q.cross(c,d,ha),b)&&0<=q.dot(q.cross(c,f,ha),e)&&0<=q.dot(q.cross(c,T,ha),a))return T=q.length(c),f=q.dot(c,b),Math.abs(f/T);d=q.scale(d,K(q.dot(d,b)/q.length(d),0,1),ha);b=q.length(q.subtract(b,d,ha));f=q.scale(f,K(q.dot(f,e)/q.length(f),0,1),ha);f=q.length(q.subtract(e,f,ha));T=q.scale(T,K(q.dot(T,a)/q.length(T),0,1),ha);T=q.length(q.subtract(a,T,ha));return Math.min(Math.min(b,f),T)}};b4w.module.__vec3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,n=Math.random;a.create=function(){var a=new r(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new r(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,n){var p=new r(3);p[0]=a;p[1]=b;p[2]=n;return p};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,n,p){p[0]=a;p[1]=b;p[2]=n;return p};a.add=function(a,b,n){n[0]=a[0]+b[0];n[1]=a[1]+b[1];n[2]=a[2]+b[2];
return n};a.subtract=function(a,b,n){n[0]=a[0]-b[0];n[1]=a[1]-b[1];n[2]=a[2]-b[2];return n};a.sub=a.subtract;a.multiply=function(a,b,n){n[0]=a[0]*b[0];n[1]=a[1]*b[1];n[2]=a[2]*b[2];return n};a.mul=a.multiply;a.divide=function(a,b,n){n[0]=a[0]/b[0];n[1]=a[1]/b[1];n[2]=a[2]/b[2];return n};a.div=a.divide;a.min=function(a,b,n){n[0]=Math.min(a[0],b[0]);n[1]=Math.min(a[1],b[1]);n[2]=Math.min(a[2],b[2]);return n};a.max=function(a,b,n){n[0]=Math.max(a[0],b[0]);n[1]=Math.max(a[1],b[1]);n[2]=Math.max(a[2],
b[2]);return n};a.scale=function(a,b,n){n[0]=a[0]*b;n[1]=a[1]*b;n[2]=a[2]*b;return n};a.scaleAndAdd=function(a,b,n,p){p[0]=a[0]+b[0]*n;p[1]=a[1]+b[1]*n;p[2]=a[2]+b[2]*n;return p};a.distance=function(a,b){var n=b[0]-a[0],p=b[1]-a[1],B=b[2]-a[2];return Math.sqrt(n*n+p*p+B*B)};a.dist=a.distance;a.squaredDistance=function(a,b){var n=b[0]-a[0],p=b[1]-a[1],B=b[2]-a[2];return n*n+p*p+B*B};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],n=a[1];a=a[2];return Math.sqrt(b*b+n*n+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],n=a[1];a=a[2];return b*b+n*n+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var n=a[0],p=a[1],B=a[2],n=n*n+p*p+B*B;0<n&&(n=1/Math.sqrt(n),b[0]=a[0]*n,b[1]=a[1]*n,b[2]=a[2]*n);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,n){var p=a[0],B=a[1];a=a[2];var m=b[0],x=b[1];b=b[2];
n[0]=B*b-a*x;n[1]=a*m-p*b;n[2]=p*x-B*m;return n};a.lerp=function(a,b,n,p){var B=a[0],m=a[1];a=a[2];p[0]=B+n*(b[0]-B);p[1]=m+n*(b[1]-m);p[2]=a+n*(b[2]-a);return p};a.u5=function(a,b,n,p,B,m){var x=B*B,g=x*(2*B-3)+1,l=x*(B-2)+B,h=x*(B-1);B=x*(3-2*B);m[0]=a[0]*g+b[0]*l+n[0]*h+p[0]*B;m[1]=a[1]*g+b[1]*l+n[1]*h+p[1]*B;m[2]=a[2]*g+b[2]*l+n[2]*h+p[2]*B;return m};a.UF=function(a,b,n,p,B,m){var x=1-B,g=x*x,l=B*B,h=g*x,g=3*B*g,x=3*l*x;B*=l;m[0]=a[0]*h+b[0]*g+n[0]*x+p[0]*B;m[1]=a[1]*h+b[1]*g+n[1]*x+p[1]*B;m[2]=
a[2]*h+b[2]*g+n[2]*x+p[2]*B;return m};a.random=function(a,b){a=a||1;var t=2*n()*Math.PI,p=2*n()-1,B=Math.sqrt(1-p*p)*a;b[0]=Math.cos(t)*B;b[1]=Math.sin(t)*B;b[2]=p*a;return b};a.transformMat4=function(a,b,n){var p=a[0],B=a[1];a=a[2];var m=b[3]*p+b[7]*B+b[11]*a+b[15],m=m||1;n[0]=(b[0]*p+b[4]*B+b[8]*a+b[12])/m;n[1]=(b[1]*p+b[5]*B+b[9]*a+b[13])/m;n[2]=(b[2]*p+b[6]*B+b[10]*a+b[14])/m;return n};a.transformMat3=function(a,b,n){var p=a[0],B=a[1];a=a[2];n[0]=p*b[0]+B*b[3]+a*b[6];n[1]=p*b[1]+B*b[4]+a*b[7];
n[2]=p*b[2]+B*b[5]+a*b[8];return n};a.transformQuat=function(a,b,n){var p=a[0],B=a[1],m=a[2];a=b[0];var x=b[1],g=b[2];b=b[3];var l=b*p+x*m-g*B,h=b*B+g*p-a*m,w=b*m+a*B-x*p,p=-a*p-x*B-g*m;n[0]=l*b+p*-a+h*-g-w*-x;n[1]=h*b+p*-x+w*-a-l*-g;n[2]=w*b+p*-g+l*-x-h*-a;return n};a.rotateX=function(a,b,n,p){var B=[],m=[];B[0]=a[0]-b[0];B[1]=a[1]-b[1];B[2]=a[2]-b[2];m[0]=B[0];m[1]=B[1]*Math.cos(n)-B[2]*Math.sin(n);m[2]=B[1]*Math.sin(n)+B[2]*Math.cos(n);p[0]=m[0]+b[0];p[1]=m[1]+b[1];p[2]=m[2]+b[2];return p};a.rotateY=
function(a,b,n,p){var B=[],m=[];B[0]=a[0]-b[0];B[1]=a[1]-b[1];B[2]=a[2]-b[2];m[0]=B[2]*Math.sin(n)+B[0]*Math.cos(n);m[1]=B[1];m[2]=B[2]*Math.cos(n)-B[0]*Math.sin(n);p[0]=m[0]+b[0];p[1]=m[1]+b[1];p[2]=m[2]+b[2];return p};a.rotateZ=function(a,b,n,p){var B=[],m=[];B[0]=a[0]-b[0];B[1]=a[1]-b[1];B[2]=a[2]-b[2];m[0]=B[0]*Math.cos(n)-B[1]*Math.sin(n);m[1]=B[0]*Math.sin(n)+B[1]*Math.cos(n);m[2]=B[2];p[0]=m[0]+b[0];p[1]=m[1]+b[1];p[2]=m[2]+b[2];return p};a.forEach=function(){var d=a.create();return function(a,
n,p,B,m,x){n||(n=3);p||(p=0);for(B=B?Math.min(B*n+p,a.length):a.length;p<B;p+=n)d[0]=a[p],d[1]=a[p+1],d[2]=a[p+2],m(d,x,d),a[p]=d[0],a[p+1]=d[1],a[p+2]=d[2];return a}}();a.o1=function(d,b){var n=a.fromValues(d[0],d[1],d[2]),p=a.fromValues(b[0],b[1],b[2]);a.normalize(n,n);a.normalize(p,p);n=a.dot(n,p);return 1<n?0:Math.acos(n)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,n=Math.random;a.create=function(){var a=new r(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new r(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,n,p){var B=new r(4);B[0]=a;B[1]=b;B[2]=n;B[3]=p;return B};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,n,p,B){B[0]=a;B[1]=b;B[2]=n;B[3]=p;return B};a.add=function(a,b,n){n[0]=
a[0]+b[0];n[1]=a[1]+b[1];n[2]=a[2]+b[2];n[3]=a[3]+b[3];return n};a.subtract=function(a,b,n){n[0]=a[0]-b[0];n[1]=a[1]-b[1];n[2]=a[2]-b[2];n[3]=a[3]-b[3];return n};a.sub=a.subtract;a.multiply=function(a,b,n){n[0]=a[0]*b[0];n[1]=a[1]*b[1];n[2]=a[2]*b[2];n[3]=a[3]*b[3];return n};a.mul=a.multiply;a.divide=function(a,b,n){n[0]=a[0]/b[0];n[1]=a[1]/b[1];n[2]=a[2]/b[2];n[3]=a[3]/b[3];return n};a.div=a.divide;a.min=function(a,b,n){n[0]=Math.min(a[0],b[0]);n[1]=Math.min(a[1],b[1]);n[2]=Math.min(a[2],b[2]);n[3]=
Math.min(a[3],b[3]);return n};a.max=function(a,b,n){n[0]=Math.max(a[0],b[0]);n[1]=Math.max(a[1],b[1]);n[2]=Math.max(a[2],b[2]);n[3]=Math.max(a[3],b[3]);return n};a.scale=function(a,b,n){n[0]=a[0]*b;n[1]=a[1]*b;n[2]=a[2]*b;n[3]=a[3]*b;return n};a.scaleAndAdd=function(a,b,n,p){p[0]=a[0]+b[0]*n;p[1]=a[1]+b[1]*n;p[2]=a[2]+b[2]*n;p[3]=a[3]+b[3]*n;return p};a.distance=function(a,b){var n=b[0]-a[0],p=b[1]-a[1],B=b[2]-a[2],m=b[3]-a[3];return Math.sqrt(n*n+p*p+B*B+m*m)};a.dist=a.distance;a.squaredDistance=
function(a,b){var n=b[0]-a[0],p=b[1]-a[1],B=b[2]-a[2],m=b[3]-a[3];return n*n+p*p+B*B+m*m};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],n=a[1],p=a[2];a=a[3];return Math.sqrt(b*b+n*n+p*p+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],n=a[1],p=a[2];a=a[3];return b*b+n*n+p*p+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var n=a[0],p=a[1],B=a[2],m=a[3],x=n*n+p*p+B*B+m*m;0<x&&(x=1/Math.sqrt(x),b[0]=n*x,b[1]=p*x,b[2]=B*x,b[3]=m*x);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,n,p){var B=a[0],m=a[1],x=a[2];a=a[3];p[0]=B+n*(b[0]-B);p[1]=m+n*(b[1]-m);p[2]=x+n*(b[2]-x);p[3]=a+n*(b[3]-a);return p};a.random=function(d,b){d=d||1;b[0]=n();b[1]=n();b[2]=n();b[3]=n();a.normalize(b,b);a.scale(b,d,b);return b};a.transformMat4=function(a,b,n){var p=a[0],B=a[1],m=
a[2];a=a[3];n[0]=b[0]*p+b[4]*B+b[8]*m+b[12]*a;n[1]=b[1]*p+b[5]*B+b[9]*m+b[13]*a;n[2]=b[2]*p+b[6]*B+b[10]*m+b[14]*a;n[3]=b[3]*p+b[7]*B+b[11]*m+b[15]*a;return n};a.transformQuat=function(a,b,n){var p=a[0],B=a[1],m=a[2],x=b[0],g=b[1],l=b[2];b=b[3];var h=b*p+g*m-l*B,w=b*B+l*p-x*m,f=b*m+x*B-g*p,p=-x*p-g*B-l*m;n[0]=h*b+p*-x+w*-l-f*-g;n[1]=w*b+p*-g+f*-x-h*-l;n[2]=f*b+p*-l+h*-g-w*-x;n[3]=a[3];return n};a.forEach=function(){var d=a.create();return function(a,n,p,B,m,x){n||(n=4);p||(p=0);for(B=B?Math.min(B*
n+p,a.length):a.length;p<B;p+=n)d[0]=a[p],d[1]=a[p+1],d[2]=a[p+2],d[3]=a[p+3],m(d,x,d),a[p]=d[0],a[p+1]=d[1],a[p+2]=d[2],a[p+3]=d[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,r){var n=r("__vec3"),d=r("__vec4"),b=r("__mat3"),t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=n.create(),d=n.fromValues(1,0,0),m=n.fromValues(0,1,0);return function(x,g,l){var h=n.dot(x,g);if(-.9999999>h)return n.cross(d,x,b),1E-6>n.length(b)&&n.cross(m,x,b),n.normalize(b,b),a.setAxisAngle(b,Math.PI,l),l;if(.9999999<h)return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l;n.cross(x,
g,b);l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=1+h;return a.normalize(l,l)}}();a.setAxes=function(){var d=b.create();return function(b,n,x,g){d[0]=n[0];d[3]=n[1];d[6]=n[2];d[1]=x[0];d[4]=x[1];d[7]=x[2];d[2]=-b[0];d[5]=-b[1];d[8]=-b[2];return a.normalize(a.fromMat3(d,g),g)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,d){b*=.5;var n=Math.sin(b);d[0]=n*a[0];d[1]=n*a[1];d[2]=n*a[2];d[3]=Math.cos(b);
return d};a.add=d.add;a.multiply=function(a,b,d){var n=a[0],g=a[1],l=a[2];a=a[3];var h=b[0],w=b[1],f=b[2];b=b[3];d[0]=n*b+a*h+g*f-l*w;d[1]=g*b+a*w+l*h-n*f;d[2]=l*b+a*f+n*w-g*h;d[3]=a*b-n*h-g*w-l*f;return d};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,d){b*=.5;var n=a[0],g=a[1],l=a[2];a=a[3];var h=Math.sin(b);b=Math.cos(b);d[0]=n*b+a*h;d[1]=g*b+l*h;d[2]=l*b-g*h;d[3]=a*b-n*h;return d};a.rotateY=function(a,b,d){b*=.5;var n=a[0],g=a[1],l=a[2];a=a[3];var h=Math.sin(b);b=Math.cos(b);d[0]=n*
b-l*h;d[1]=g*b+a*h;d[2]=l*b+n*h;d[3]=a*b-g*h;return d};a.rotateZ=function(a,b,d){b*=.5;var n=a[0],g=a[1],l=a[2];a=a[3];var h=Math.sin(b);b=Math.cos(b);d[0]=n*b+g*h;d[1]=g*b-n*h;d[2]=l*b+a*h;d[3]=a*b-l*h;return d};a.calculateW=function(a,b){var d=a[0],n=a[1],g=a[2];b[0]=d;b[1]=n;b[2]=g;b[3]=Math.sqrt(Math.abs(1-d*d-n*n-g*g));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,d,n){var g=a[0],l=a[1],h=a[2];a=a[3];var w=b[0],f=b[1],C=b[2];b=b[3];var t,G,L;G=g*w+l*f+h*C+a*b;0>G&&(G=-G,w=-w,f=-f,
C=-C,b=-b);1E-6<1-G?(t=Math.acos(G),L=Math.sin(t),G=Math.sin((1-d)*t)/L,d=Math.sin(d*t)/L):G=1-d;n[0]=G*g+d*w;n[1]=G*l+d*f;n[2]=G*h+d*C;n[3]=G*a+d*b;return n};a.Z7=function(){var b=a.create(),d=a.create();return function(n,x,g,l,h,w){a.slerp(n,l,h,b);a.slerp(x,g,h,d);a.slerp(b,d,2*h*(1-h),w);return w}}();a.invert=function(a,b){var d=a[0],n=a[1],g=a[2],l=a[3],h=d*d+n*n+g*g+l*l,h=h?1/h:0;b[0]=-d*h;b[1]=-n*h;b[2]=-g*h;b[3]=l*h;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,b){var d=a[0]+a[4]+a[8];if(0<d)d=Math.sqrt(d+1),b[3]=.5*d,d=.5/d,b[0]=(a[5]-a[7])*d,b[1]=(a[6]-a[2])*d,b[2]=(a[1]-a[3])*d;else{var n=0;a[4]>a[0]&&(n=1);a[8]>a[3*n+n]&&(n=2);var g=(n+1)%3,l=(n+2)%3,d=Math.sqrt(a[3*n+n]-a[3*g+g]-a[3*l+l]+1);b[n]=.5*d;d=.5/d;b[3]=(a[3*g+l]-a[3*l+g])*d;b[g]=(a[3*g+n]+a[3*n+g])*d;b[l]=(a[3*l+n]+a[3*n+l])*d}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new r(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],t=a[2],p=a[5];d[1]=a[3];d[2]=a[6];d[3]=b;d[5]=a[7];d[6]=t;d[7]=p}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=a[4],x=a[5],g=a[6],l=a[7],h=a[8],w=h*m-x*l,f=-h*B+x*g,C=
l*B-m*g,K=b*w+t*f+p*C;if(!K)return null;K=1/K;d[0]=w*K;d[1]=(-h*t+p*l)*K;d[2]=(x*t-p*m)*K;d[3]=f*K;d[4]=(h*b-p*g)*K;d[5]=(-x*b+p*B)*K;d[6]=C*K;d[7]=(-l*b+t*g)*K;d[8]=(m*b-t*B)*K;return d};a.adjoint=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=a[4],x=a[5],g=a[6],l=a[7],h=a[8];d[0]=m*h-x*l;d[1]=p*l-t*h;d[2]=t*x-p*m;d[3]=x*g-B*h;d[4]=b*h-p*g;d[5]=p*B-b*x;d[6]=B*l-m*g;d[7]=t*g-b*l;d[8]=b*m-t*B;return d};a.determinant=function(a){var d=a[3],b=a[4],t=a[5],p=a[6],B=a[7],m=a[8];return a[0]*(m*b-t*B)+a[1]*
(-m*d+t*p)+a[2]*(B*d-b*p)};a.multiply=function(a,d,b){var t=a[0],p=a[1],B=a[2],m=a[3],x=a[4],g=a[5],l=a[6],h=a[7];a=a[8];var w=d[0],f=d[1],C=d[2],K=d[3],G=d[4],L=d[5],D=d[6],N=d[7];d=d[8];b[0]=w*t+f*m+C*l;b[1]=w*p+f*x+C*h;b[2]=w*B+f*g+C*a;b[3]=K*t+G*m+L*l;b[4]=K*p+G*x+L*h;b[5]=K*B+G*g+L*a;b[6]=D*t+N*m+d*l;b[7]=D*p+N*x+d*h;b[8]=D*B+N*g+d*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var t=a[0],p=a[1],B=a[2],m=a[3],x=a[4],g=a[5],l=a[6],h=a[7];a=a[8];var w=d[0];d=d[1];b[0]=t;b[1]=p;b[2]=B;
b[3]=m;b[4]=x;b[5]=g;b[6]=w*t+d*m+l;b[7]=w*p+d*x+h;b[8]=w*B+d*g+a;return b};a.rotate=function(a,d,b){var t=a[0],p=a[1],B=a[2],m=a[3],x=a[4],g=a[5],l=a[6],h=a[7];a=a[8];var w=Math.sin(d);d=Math.cos(d);b[0]=d*t+w*m;b[1]=d*p+w*x;b[2]=d*B+w*g;b[3]=d*m-w*t;b[4]=d*x-w*p;b[5]=d*g-w*B;b[6]=l;b[7]=h;b[8]=a;return b};a.scale=function(a,d,b){var t=d[0];d=d[1];b[0]=t*a[0];b[1]=t*a[1];b[2]=t*a[2];b[3]=d*a[3];b[4]=d*a[4];b[5]=d*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.lU=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.jU=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=b;d[2]=0;d[3]=-b;d[4]=t;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.kU=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=b+b,x=t+t,g=p+p,b=b*m,l=t*m,t=t*x,h=p*m,w=
p*x,p=p*g,m=B*m,x=B*x,B=B*g;d[0]=1-t-p;d[3]=l-B;d[6]=h+x;d[1]=l+B;d[4]=1-b-p;d[7]=w-m;d[2]=h-x;d[5]=w+m;d[8]=1-b-t;return d};a.normalFromMat4=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=a[4],x=a[5],g=a[6],l=a[7],h=a[8],w=a[9],f=a[10],C=a[11],K=a[12],G=a[13],L=a[14],D=a[15],N=b*x-t*m,I=b*g-p*m,O=b*l-B*m,E=t*g-p*x,c=t*l-B*x,k=p*l-B*g,y=h*G-w*K,A=h*L-f*K,h=h*D-C*K,e=w*L-f*G,w=w*D-C*G,f=f*D-C*L,C=N*f-I*w+O*e+E*h-c*A+k*y;if(!C)return null;C=1/C;d[0]=(x*f-g*w+l*e)*C;d[1]=(g*h-m*f-l*A)*C;d[2]=(m*w-x*
h+l*y)*C;d[3]=(p*w-t*f-B*e)*C;d[4]=(b*f-p*h+B*A)*C;d[5]=(t*h-b*w-B*y)*C;d[6]=(G*k-L*c+D*E)*C;d[7]=(L*O-K*k-D*I)*C;d[8]=(K*c-G*O+D*N)*C;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.iU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new r(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];
d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],t=a[2],p=a[3],B=a[6],m=a[7],x=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=b;d[6]=a[9];d[7]=a[13];d[8]=t;d[9]=B;d[11]=a[14];d[12]=p;d[13]=
m;d[14]=x}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=a[4],x=a[5],g=a[6],l=a[7],h=a[8],w=a[9],f=a[10],C=a[11],K=a[12],G=a[13],L=a[14],D=a[15],N=b*x-t*m,I=b*g-p*m,O=b*l-B*m,E=t*g-p*x,c=t*l-B*x,k=p*l-B*g,y=h*G-w*K,A=h*L-f*K,e=h*D-C*K,R=w*L-f*G,q=w*D-C*G,ba=f*D-C*L,J=N*ba-I*q+O*R+E*e-c*A+k*y;if(!J)return null;
J=1/J;d[0]=(x*ba-g*q+l*R)*J;d[1]=(p*q-t*ba-B*R)*J;d[2]=(G*k-L*c+D*E)*J;d[3]=(f*c-w*k-C*E)*J;d[4]=(g*e-m*ba-l*A)*J;d[5]=(b*ba-p*e+B*A)*J;d[6]=(L*O-K*k-D*I)*J;d[7]=(h*k-f*O+C*I)*J;d[8]=(m*q-x*e+l*y)*J;d[9]=(t*e-b*q-B*y)*J;d[10]=(K*c-G*O+D*N)*J;d[11]=(w*O-h*c-C*N)*J;d[12]=(x*A-m*R-g*y)*J;d[13]=(b*R-t*A+p*y)*J;d[14]=(G*I-K*E-L*N)*J;d[15]=(h*E-w*I+f*N)*J;return d};a.adjoint=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=a[4],x=a[5],g=a[6],l=a[7],h=a[8],w=a[9],f=a[10],C=a[11],K=a[12],G=a[13],L=a[14],D=
a[15];d[0]=x*(f*D-C*L)-w*(g*D-l*L)+G*(g*C-l*f);d[1]=-(t*(f*D-C*L)-w*(p*D-B*L)+G*(p*C-B*f));d[2]=t*(g*D-l*L)-x*(p*D-B*L)+G*(p*l-B*g);d[3]=-(t*(g*C-l*f)-x*(p*C-B*f)+w*(p*l-B*g));d[4]=-(m*(f*D-C*L)-h*(g*D-l*L)+K*(g*C-l*f));d[5]=b*(f*D-C*L)-h*(p*D-B*L)+K*(p*C-B*f);d[6]=-(b*(g*D-l*L)-m*(p*D-B*L)+K*(p*l-B*g));d[7]=b*(g*C-l*f)-m*(p*C-B*f)+h*(p*l-B*g);d[8]=m*(w*D-C*G)-h*(x*D-l*G)+K*(x*C-l*w);d[9]=-(b*(w*D-C*G)-h*(t*D-B*G)+K*(t*C-B*w));d[10]=b*(x*D-l*G)-m*(t*D-B*G)+K*(t*l-B*x);d[11]=-(b*(x*C-l*w)-m*(t*C-B*
w)+h*(t*l-B*x));d[12]=-(m*(w*L-f*G)-h*(x*L-g*G)+K*(x*f-g*w));d[13]=b*(w*L-f*G)-h*(t*L-p*G)+K*(t*f-p*w);d[14]=-(b*(x*L-g*G)-m*(t*L-p*G)+K*(t*g-p*x));d[15]=b*(x*f-g*w)-m*(t*f-p*w)+h*(t*g-p*x);return d};a.determinant=function(a){var d=a[0],b=a[1],t=a[2],p=a[3],B=a[4],m=a[5],x=a[6],g=a[7],l=a[8],h=a[9],w=a[10],f=a[11],C=a[12],K=a[13],G=a[14];a=a[15];return(d*m-b*B)*(w*a-f*G)-(d*x-t*B)*(h*a-f*K)+(d*g-p*B)*(h*G-w*K)+(b*x-t*m)*(l*a-f*C)-(b*g-p*m)*(l*G-w*C)+(t*g-p*x)*(l*K-h*C)};a.multiply=function(a,d,b){var t=
a[0],p=a[1],B=a[2],m=a[3],x=a[4],g=a[5],l=a[6],h=a[7],w=a[8],f=a[9],C=a[10],K=a[11],G=a[12],L=a[13],D=a[14];a=a[15];var N=d[0],I=d[1],O=d[2],E=d[3];b[0]=N*t+I*x+O*w+E*G;b[1]=N*p+I*g+O*f+E*L;b[2]=N*B+I*l+O*C+E*D;b[3]=N*m+I*h+O*K+E*a;N=d[4];I=d[5];O=d[6];E=d[7];b[4]=N*t+I*x+O*w+E*G;b[5]=N*p+I*g+O*f+E*L;b[6]=N*B+I*l+O*C+E*D;b[7]=N*m+I*h+O*K+E*a;N=d[8];I=d[9];O=d[10];E=d[11];b[8]=N*t+I*x+O*w+E*G;b[9]=N*p+I*g+O*f+E*L;b[10]=N*B+I*l+O*C+E*D;b[11]=N*m+I*h+O*K+E*a;N=d[12];I=d[13];O=d[14];E=d[15];b[12]=N*t+
I*x+O*w+E*G;b[13]=N*p+I*g+O*f+E*L;b[14]=N*B+I*l+O*C+E*D;b[15]=N*m+I*h+O*K+E*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var t=d[0],p=d[1];d=d[2];var B,m,x,g,l,h,w,f,C,K,G,L;a===b?(b[12]=a[0]*t+a[4]*p+a[8]*d+a[12],b[13]=a[1]*t+a[5]*p+a[9]*d+a[13],b[14]=a[2]*t+a[6]*p+a[10]*d+a[14],b[15]=a[3]*t+a[7]*p+a[11]*d+a[15]):(B=a[0],m=a[1],x=a[2],g=a[3],l=a[4],h=a[5],w=a[6],f=a[7],C=a[8],K=a[9],G=a[10],L=a[11],b[0]=B,b[1]=m,b[2]=x,b[3]=g,b[4]=l,b[5]=h,b[6]=w,b[7]=f,b[8]=C,b[9]=K,b[10]=G,b[11]=L,
b[12]=B*t+l*p+C*d+a[12],b[13]=m*t+h*p+K*d+a[13],b[14]=x*t+w*p+G*d+a[14],b[15]=g*t+f*p+L*d+a[15]);return b};a.scale=function(a,d,b){var t=d[0],p=d[1];d=d[2];b[0]=a[0]*t;b[1]=a[1]*t;b[2]=a[2]*t;b[3]=a[3]*t;b[4]=a[4]*p;b[5]=a[5]*p;b[6]=a[6]*p;b[7]=a[7]*p;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,d,b,t){var p=b[0],B=b[1];b=b[2];var m=Math.sqrt(p*p+B*B+b*b),x,g,l,h,w,f,C,K,G,L,D,N,I,O,E,c,k,y,A,e;if(1E-7>Math.abs(m))return null;
m=1/m;p*=m;B*=m;b*=m;x=Math.sin(d);g=Math.cos(d);l=1-g;d=a[0];m=a[1];h=a[2];w=a[3];f=a[4];C=a[5];K=a[6];G=a[7];L=a[8];D=a[9];N=a[10];I=a[11];O=p*p*l+g;E=B*p*l+b*x;c=b*p*l-B*x;k=p*B*l-b*x;y=B*B*l+g;A=b*B*l+p*x;e=p*b*l+B*x;p=B*b*l-p*x;B=b*b*l+g;t[0]=d*O+f*E+L*c;t[1]=m*O+C*E+D*c;t[2]=h*O+K*E+N*c;t[3]=w*O+G*E+I*c;t[4]=d*k+f*y+L*A;t[5]=m*k+C*y+D*A;t[6]=h*k+K*y+N*A;t[7]=w*k+G*y+I*A;t[8]=d*e+f*p+L*B;t[9]=m*e+C*p+D*B;t[10]=h*e+K*p+N*B;t[11]=w*e+G*p+I*B;a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);
return t};a.rotateX=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var p=a[4],B=a[5],m=a[6],x=a[7],g=a[8],l=a[9],h=a[10],w=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=p*d+g*t;b[5]=B*d+l*t;b[6]=m*d+h*t;b[7]=x*d+w*t;b[8]=g*d-p*t;b[9]=l*d-B*t;b[10]=h*d-m*t;b[11]=w*d-x*t;return b};a.rotateY=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var p=a[0],B=a[1],m=a[2],x=a[3],g=a[8],l=a[9],h=a[10],w=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=p*d-g*t;b[1]=B*d-l*t;b[2]=m*d-h*t;b[3]=x*d-w*t;b[8]=p*t+g*d;b[9]=B*t+l*d;b[10]=m*t+h*d;b[11]=x*t+w*d;return b};a.rotateZ=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var p=a[0],B=a[1],m=a[2],x=a[3],g=a[4],l=a[5],h=a[6],w=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=p*d+g*t;b[1]=B*d+l*t;b[2]=m*d+h*t;b[3]=x*d+w*t;b[4]=g*d-p*t;b[5]=l*d-B*t;b[6]=h*d-m*t;b[7]=w*d-x*t;return b};
a.lU=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.kU=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.jU=function(a,d,b){var t=d[0],p=d[1];d=d[2];var B=Math.sqrt(t*t+p*p+d*d),m;if(1E-7>Math.abs(B))return null;B=1/B;t*=B;p*=B;d*=B;B=Math.sin(a);a=Math.cos(a);m=1-a;b[0]=t*t*m+a;b[1]=p*t*m+d*
B;b[2]=d*t*m-p*B;b[3]=0;b[4]=t*p*m-d*B;b[5]=p*p*m+a;b[6]=d*p*m+t*B;b[7]=0;b[8]=t*d*m+p*B;b[9]=p*d*m-t*B;b[10]=d*d*m+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.u3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=t;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=t;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.v3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=0;d[2]=-b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=b;d[9]=0;d[10]=t;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.w3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=t;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,b){var t=a[0],p=a[1],B=a[2],m=a[3],x=t+t,g=p+p,l=B+B;a=t*x;var h=t*g,t=t*l,w=p*g,p=p*l,B=B*l,x=m*x,g=m*g,m=m*l;b[0]=1-(w+B);b[1]=h+m;b[2]=t-g;b[3]=0;b[4]=h-m;b[5]=1-(a+B);b[6]=p+x;b[7]=0;b[8]=t+g;b[9]=p-x;b[10]=1-(a+w);b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];
b[15]=1;return b};a.s3=function(a,d,b,t){var p=a[0],B=a[1],m=a[2],x=a[3],g=p+p,l=B+B,h=m+m;a=p*g;var w=p*l,p=p*h,f=B*l,B=B*h,m=m*h,g=x*g,l=x*l,x=x*h,h=b[0],C=b[1];b=b[2];t[0]=(1-(f+m))*h;t[1]=(w+x)*h;t[2]=(p-l)*h;t[3]=0;t[4]=(w-x)*C;t[5]=(1-(a+m))*C;t[6]=(B+g)*C;t[7]=0;t[8]=(p+l)*b;t[9]=(B-g)*b;t[10]=(1-(a+f))*b;t[11]=0;t[12]=d[0];t[13]=d[1];t[14]=d[2];t[15]=1;return t};a.t3=function(a,d,b,t,p){var B=a[0],m=a[1],x=a[2],g=a[3],l=B+B,h=m+m,w=x+x;a=B*l;var f=B*h,B=B*w,C=m*h,m=m*w,x=x*w,l=g*l,h=g*h,g=
g*w,w=b[0],K=b[1];b=b[2];var G=t[0],L=t[1];t=t[2];p[0]=(1-(C+x))*w;p[1]=(f+g)*w;p[2]=(B-h)*w;p[3]=0;p[4]=(f-g)*K;p[5]=(1-(a+x))*K;p[6]=(m+l)*K;p[7]=0;p[8]=(B+h)*b;p[9]=(m-l)*b;p[10]=(1-(a+C))*b;p[11]=0;p[12]=d[0]+G-(p[0]*G+p[4]*L+p[8]*t);p[13]=d[1]+L-(p[1]*G+p[5]*L+p[9]*t);p[14]=d[2]+t-(p[2]*G+p[6]*L+p[10]*t);p[15]=1;return p};a.fromQuat=function(a,d){var b=a[0],t=a[1],p=a[2],B=a[3],m=b+b,x=t+t,g=p+p,b=b*m,l=t*m,t=t*x,h=p*m,w=p*x,p=p*g,m=B*m,x=B*x,B=B*g;d[0]=1-t-p;d[1]=l+B;d[2]=h-x;d[3]=0;d[4]=l-
B;d[5]=1-b-p;d[6]=w+m;d[7]=0;d[8]=h+x;d[9]=w-m;d[10]=1-b-t;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,b,t,p,B,m){var x=1/(d-a),g=1/(t-b),l=1/(p-B);m[0]=2*p*x;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=2*p*g;m[6]=0;m[7]=0;m[8]=(d+a)*x;m[9]=(t+b)*g;m[10]=(B+p)*l;m[11]=-1;m[12]=0;m[13]=0;m[14]=B*p*2*l;m[15]=0;return m};a.perspective=function(a,d,b,t,p){a=1/Math.tan(a/2);var B=1/(b-t);p[0]=a/d;p[1]=0;p[2]=0;p[3]=0;p[4]=0;p[5]=a;p[6]=0;p[7]=0;p[8]=0;p[9]=0;p[10]=(t+b)*B;p[11]=-1;p[12]=
0;p[13]=0;p[14]=2*t*b*B;p[15]=0;return p};a.u6=function(a,d,b,t){var p=Math.tan(a.upDegrees*Math.PI/180),B=Math.tan(a.downDegrees*Math.PI/180),m=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var x=2/(m+a),g=2/(p+B);t[0]=x;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=g;t[6]=0;t[7]=0;t[8]=-((m-a)*x*.5);t[9]=(p-B)*g*.5;t[10]=b/(d-b);t[11]=-1;t[12]=0;t[13]=0;t[14]=b*d/(d-b);t[15]=0;return t};a.ortho=function(a,d,b,t,p,B,m){var x=1/(a-d),g=1/(b-t),l=1/(p-B);m[0]=-2*x;m[1]=0;m[2]=0;m[3]=
0;m[4]=0;m[5]=-2*g;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=2*l;m[11]=0;m[12]=(a+d)*x;m[13]=(t+b)*g;m[14]=(B+p)*l;m[15]=1;return m};a.lookAt=function(n,d,b,t){var p,B,m,x,g,l,h,w,f=n[0],C=n[1];n=n[2];m=b[0];x=b[1];B=b[2];h=d[0];b=d[1];p=d[2];if(1E-7>Math.abs(f-h)&&1E-7>Math.abs(C-b)&&1E-7>Math.abs(n-p))return a.identity(t);d=f-h;b=C-b;h=n-p;w=1/Math.sqrt(d*d+b*b+h*h);d*=w;b*=w;h*=w;p=x*h-B*b;B=B*d-m*h;m=m*b-x*d;(w=Math.sqrt(p*p+B*B+m*m))?(w=1/w,p*=w,B*=w,m*=w):m=B=p=0;x=b*m-h*B;g=h*p-d*m;l=d*B-b*p;(w=Math.sqrt(x*
x+g*g+l*l))?(w=1/w,x*=w,g*=w,l*=w):l=g=x=0;t[0]=p;t[1]=x;t[2]=d;t[3]=0;t[4]=B;t[5]=g;t[6]=b;t[7]=0;t[8]=m;t[9]=l;t[10]=h;t[11]=0;t[12]=-(p*f+B*C+m*n);t[13]=-(x*f+g*C+l*n);t[14]=-(d*f+b*C+h*n);t[15]=1;return t};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.iU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,r){function n(a,b){for(var d=a[1],h=1,l=2;l<a.length;l++)4!=l&&8!=l&&Math.abs(a[l])>Math.abs(d)&&(d=a[l],h=l);for(var g=Math.floor(h/3),h=h%3,d=.5*Math.atan(2*d/(a[3*g+g]-a[3*h+h])),l=0;l<b.length;l++)b[l]=0==l||4==l||8==l?1:0;b[h+3*g]=-Math.sin(d);b[g+3*h]=Math.sin(d);b[g+3*g]=Math.cos(d);b[h+3*h]=Math.cos(d);return b}function d(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var d=a.content[b];0<b;){var h=(b+1>>1)-1,l=a.content[h];if(a.zm(d)<a.zm(l))a.content[h]=
d,a.content[b]=l,b=h;else break}}function t(a,b){for(var d=a.content.length,h=a.content[b],l=a.zm(h);;){var g=b+1<<1,m=g-1,p=null;if(m<d){var n=a.zm(a.content[m]);n<l&&(p=m)}g<d&&a.zm(a.content[g])<(null===p?l:n)&&(p=g);if(null!==p)a.content[b]=a.content[p],a.content[p]=h,b=p;else break}}var p=r("__mat3"),B=r("__vec3"),m=new Float32Array(3),x=new Float32Array(9),g=new Float32Array(9),l=new Float32Array(9),h=new Float32Array(9);a.B4=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.C4=function(a,b){b=b||new Float32Array(3);return B.copy(a,b)};a.DL=function(a,b){B.copy(b,a)};a.XC=function(a,b){B.normalize(b,m);a[3]=m[0];a[4]=m[1];a[5]=m[2]};a.T1=function(a,b,d){d=d||new Float32Array(3);d[0]=a[0]+a[3]*b;d[1]=a[1]+a[4]*b;d[2]=a[2]+a[5]*b};a.pR=function(a,b){b[0]=0;b[1]=0;for(var d=b[2]=0;d<a.length;d+=3)b[0]+=a[d],b[1]+=a[d+1],b[2]+=a[d+2];return B.scale(b,3/a.length,b)};a.iR=function(a,b,d){for(var h=0;h<d.length;h++)d[h]=0;for(h=0;h<a.length;h+=3){var l=a[h]-b[0],
g=a[h+1]-b[1],m=a[h+2]-b[2];d[0]+=l*l;d[1]+=l*g;d[2]+=l*m;d[4]+=g*g;d[5]+=g*m;d[8]+=m*m}d[3]=d[1];d[6]=d[2];d[7]=d[5];for(h=0;h<d.length;h++)d[h]*=3/a.length;return d};a.ZT=function(a,b){var m=p.copy(a,x);if(5E-4>d(m))return p.identity(b);var t=n(m,g),G=p.transpose(t,l);p.multiply(m,G,h);p.multiply(t,h,m);for(var L=p.copy(t,b),D=1;5E-4<=d(m)&&100>D;)t=n(m,g),G=p.transpose(t,l),p.multiply(m,G,h),p.multiply(t,h,m),p.multiply(t,L,L),D++;return L};a.ng=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.UQ=function(a){return{content:[],zm:a}};a.WF=function(a,d){a.content.push(d);b(a,a.content.length-1)};a.VQ=function(a){var b=a.content[0],d=a.content.pop();0<a.content.length&&(a.content[0]=d,t(a,0));return b};a.S1=function(a,d){var h=a.content.indexOf(d),l=a.content.pop();h!==a.content.length-1&&(a.content[h]=l,a.zm(l)<a.zm(d)?b(h):t(h))};a.WQ=function(a,d){b(a,a.content.indexOf(d))}};b4w.module.__print=function(a){function r(a,b){var d=[];-1<a[0].indexOf("%c")?d.push(a[0].replace("%c","%c"+b+": ")):d.push(b+": "+a[0]);for(var h=1;h<a.length;h++)d.push(a[h]);return d}function n(){p++;var a=r(arguments,"B4W ERROR");console.error.apply(console,a)}function d(a){a in m||(m[a]=a,n([a]))}function b(a,b){d(a+"() is deprecated, use "+b+"() instead.")}var t=!1,p=0,B=0,m={};a.pY=function(a){t=a};a.Zd=function(){console.log.apply(console,arguments)};a.log=function(){if(t){var a=r(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=n;a.N=d;a.Bb=b;a.Kh=function(a,g){switch(1<g.length){case !0:d(a+"() is deprecated, use "+g.slice(0,-1).join("(), ")+"() or "+g[g.length-1]+"() instead.");break;case !1:b(a,g[0])}};a.KT=function(){d('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){B++;var a=r(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=r(arguments,"B4W INFO");console.info.apply(console,a)};a.NT=function(){p++;
var a=r(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.OT=function(){B++;var a=r(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){t&&console.time.apply(console,arguments)};a.timeEnd=function(){t&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.gV=function(){return B};a.KU=function(){return p};a.DG=function(){p=B=0}};b4w.module.print=b4w.module.__print;b4w.module.__tsr=function(a,r){function n(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function d(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function t(a,b,d,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=b;f[4]=d[0];f[5]=d[1];f[6]=d[2];f[7]=d[3];return f}function p(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function B(a,b,d){var f=b[0],h=b[1],l=b[2],g=b[3],c=b[4],k=b[5],w=b[6];
b=b[7];var m=a[0]*g,e=a[1]*g,R=a[2]*g;a=b*m+k*R-w*e;var g=b*e+w*m-c*R,q=b*R+c*e-k*m,m=-c*m-k*e-w*R;d[0]=a*b+m*-c+g*-w-q*-k;d[1]=g*b+m*-k+q*-c-a*-w;d[2]=q*b+m*-w+a*-k-g*-c;d[0]+=f;d[1]+=h;d[2]+=l;return d}var m=r("__mat4"),x=r("__quat"),g=r("__util"),l=r("__vec3"),h=Math.sin(-Math.PI/4),w=-h,f=new Float32Array(3),C=new Float32Array(4);new Float32Array(4);var K=new Float32Array(16);a.create=n;a.clone=function(a){var d=n();b(a,d);return d};a.x3=function(a,b,d,f,h,l,g,c){var k=n();k[0]=a;k[1]=b;k[2]=
d;k[3]=f;k[4]=h;k[5]=l;k[6]=g;k[7]=c;return k};a.Al=d;a.w2=function(a){var f=d();b(a,f);return f};a.y3=function(a,b,f,h,l,g,w,c){var k=d();k[0]=a;k[1]=b;k[2]=f;k[3]=h;k[4]=l;k[5]=g;k[6]=w;k[7]=c;return k};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.ci=t;a.ff=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Hf=function(a,b){b[3]=a;return b};a.mY=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.Ck=function(a,b){b[4]=a[0];b[5]=a[1];
b[6]=a[2];b[7]=a[3];return b};a.F=function(a){return a.subarray(0,3)};a.fc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Yd=function(a){return a[3]};a.fV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.R=function(a){return a.subarray(4,8)};a.Xd=p;a.invert=function(a,b){var d=1/a[3];if(!d)return null;var f=a[0],h=a[1],l=a[2];C[0]=a[4];C[1]=a[5];C[2]=a[6];C[3]=a[7];x.invert(C,C);var g=C[0],c=C[1],k=C[2],w=C[3],f=f*d,h=h*d,m=l*d,l=w*f+c*m-k*h,e=w*h+k*f-g*m,R=w*m+g*h-c*f,f=-g*f-c*h-
k*m;b[0]=-(l*w+f*-g+e*-k-R*-c);b[1]=-(e*w+f*-c+R*-g-l*-k);b[2]=-(R*w+f*-k+l*-c-e*-g);b[3]=d;b[4]=g;b[5]=c;b[6]=k;b[7]=w;return b};a.MM=function(a,b){var d=a[3];m.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var f=0;12>f;f++)b[f]*=d};a.Mi=function(a,b){var d=g.XJ(a,f),h=g.WJ(a),l=g.EB(a,C);t(d,h,l,b)};a.multiply=function(a,b,d){B(b,a,d);d[3]=a[3]*b[3];var f=a[4],h=a[5],l=a[6];a=a[7];var g=b[4],c=b[5],k=b[6];b=b[7];d[4]=f*b+a*g+h*k-l*c;d[5]=h*b+a*c+l*g-f*k;d[6]=l*b+a*k+f*c-h*g;d[7]=
a*b-f*g-h*c-l*k;return d};a.oZ=function(a,b,d){var f=b[3];b=m.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),K);for(var h=0;12>h;h++)b[h]*=f;m.multiply(b,a,d);return d};a.Wc=B;a.w8=function(a,b,d){var f=b[3],h=a[0]-b[0],l=a[1]-b[1],g=a[2]-b[2];a=b[4];var c=b[5],k=b[6];b=b[7];var w=a*a+c*c+k*k+b*b,w=w?1/w:0;a=-a*w;c=-c*w;k=-k*w;b*=w;var w=b*h+c*g-k*l,m=b*l+k*h-a*g,e=b*g+a*l-c*h,h=-a*h-c*l-k*g;d[0]=w*b+h*-a+m*-k-e*-c;d[1]=m*b+h*-c+e*-a-w*-k;d[2]=e*b+h*-k+w*-c-m*-a;d[0]/=f;d[1]/=f;d[2]/=f;return d};
a.Ro=function(a,b,d,f){f||(f=0);var h=a.length,l=b[0],g=b[1],c=b[2],k=b[3],w=b[4],m=b[5],e=b[6];b=b[7];for(var R=0;R<h;R+=3){var q=a[R]*k,p=a[R+1]*k,J=a[R+2]*k,F=b*q+m*J-e*p,V=b*p+e*q-w*J,U=b*J+w*p-m*q,q=-w*q-m*p-e*J;d[f+R]=F*b+q*-w+V*-e-U*-m;d[f+R+1]=V*b+q*-m+U*-w-F*-e;d[f+R+2]=U*b+q*-e+F*-m-V*-w;d[f+R]+=l;d[f+R+1]+=g;d[f+R+2]+=c}};a.nZ=function(a,b,d){var f=0,f=0,h=a.length,l=b[3],g=b[4],c=b[5],k=b[6];b=b[7];for(var w=0;w<h;w+=3){var m=a[w]*l,e=a[w+1]*l,R=a[w+2]*l,q=b*m+c*R-k*e,p=b*e+k*m-g*R,J=
b*R+g*e-c*m,m=-g*m-c*e-k*R;d[f+w]=q*b+m*-g+p*-k-J*-c;d[f+w+1]=p*b+m*-c+J*-g-q*-k;d[f+w+2]=J*b+m*-k+q*-c-p*-g}};a.xd=function(a,b,d){var f=b[3],h=b[4],l=b[5],g=b[6];b=b[7];var c=a[0]*f,k=a[1]*f,w=a[2]*f;a=b*c+l*w-g*k;var f=b*k+g*c-h*w,m=b*w+h*k-l*c,c=-h*c-l*k-g*w;d[0]=a*b+c*-h+f*-g-m*-l;d[1]=f*b+c*-l+m*-h-a*-g;d[2]=m*b+c*-g+a*-l-f*-h};a.qZ=function(a,b,d,f){f||(f=0);var h=a.length,l=b[3],g=b[4],c=b[5],k=b[6];b=b[7];for(var w=0;w<h;w+=4){var m=a[w]*l,e=a[w+1]*l,R=a[w+2]*l,q=b*m+c*R-k*e,p=b*e+k*m-g*
R,J=b*R+g*e-c*m,m=-g*m-c*e-k*R;d[f+w]=q*b+m*-g+p*-k-J*-c;d[f+w+1]=p*b+m*-c+J*-g-q*-k;d[f+w+2]=J*b+m*-k+q*-c-p*-g;d[f+w+3]=a[w+3]}};a.pZ=function(a,b,d){b=p(b,C);x.multiply(b,a,d)};a.RM=function(a,b,d,f){f=f||0;b=p(b,C);g.OK(a,b,d,f)};a.translate=function(a,b,d){var f=a[3],h=a[4],l=a[5],w=a[6],c=a[7],k=b[0]*f,g=b[1]*f,m=b[2]*f;b=c*k+l*m-w*g;var f=c*g+w*k-h*m,e=c*m+h*g-l*k,k=-h*k-l*g-w*m;d[0]=a[0]+b*c+k*-h+f*-w-e*-l;d[1]=a[1]+f*c+k*-l+e*-h-b*-w;d[2]=a[2]+e*c+k*-w+b*-l-f*-h;d[3]=a[3];d[4]=a[4];d[5]=
a[5];d[6]=a[6];d[7]=a[7];return d};a.mB=function(a,b,d,f){l.lerp(a.subarray(0,3),b.subarray(0,3),d,f.subarray(0,3));var h=a[3];f[3]=h+d*(b[3]-h);x.slerp(a.subarray(4,8),b.subarray(4,8),d,f.subarray(4,8));return f};a.j3=function(a,b,d,f){var h=a.subarray(0,3),l=b.subarray(0,3),w=f.subarray(0,3);w[0]=l[0]*(d+1)-h[0]*d;w[1]=l[1]*(d+1)-h[1]*d;w[2]=l[2]*(d+1)-h[2]*d;f[3]=b[3]*(d+1)-a[3]*d;a=a.subarray(4,8);b=b.subarray(4,8);h=f.subarray(4,8);h[0]=b[0]*(d+1)-a[0]*d;h[1]=b[1]*(d+1)-a[1]*d;h[2]=b[2]*(d+1)-
a[2]*d;h[3]=b[3]*(d+1)-a[3]*d;x.normalize(h,h);return f};a.zV=function(a,b,d,f,h){h[0]=a[0]+b*d[0];h[1]=a[1]+b*d[1];h[2]=a[2]+b*d[2];h[3]=a[3];d=f[0];var l=f[1];f=f[2];var w=a[4],c=a[5],k=a[6],g=a[7];h[4]=.5*(d*g+l*k-f*c);h[5]=.5*(l*g+f*w-d*k);h[6]=.5*(f*g+d*c-l*w);h[7]=.5*(-d*w-l*c-f*k);h[4]=a[4]+h[4]*b;h[5]=a[5]+h[5]*b;h[6]=a[6]+h[6]*b;h[7]=a[7]+h[7]*b;a=h[4];b=h[5];d=h[6];l=h[7];a=a*a+b*b+d*d+l*l;0<a&&(a=1/Math.sqrt(a),h[4]*=a,h[5]*=a,h[6]*=a,h[7]*=a)};a.u8=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];var d=a[4],f=a[5],l=a[6],g=a[7];b[4]=d*w+g*h;b[5]=f*w+l*h;b[6]=l*w-f*h;b[7]=g*w-d*h};a.t8=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__config=function(a,r){function n(){return b4w.module_check(a.Ae.Ot)}function d(){for(var d=a.Ae,n=null,m=document.getElementsByTagName("script"),x=0;x<m.length;x++){for(var g=m[x].src,l=0;l<d.EJ.length;l++)if(0<=g.indexOf(d.EJ[l])){n=g;break}if(null!==n)break}n||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),n=document.location.href);d=n.indexOf("?");0<=d&&(n=n.substring(0,d));return n.substring(0,n.lastIndexOf("/"))}var b=r("__print"),
t=r("__util");a.sp=1;a.al=2;a.Zm=3;a.TE=4;a.rp=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.MG=t.P(a.context);a.A={alpha_sort:!0,alpha_sort_threshold:.1,km:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,KH:1,eU:5,background_color:[0,0,0,0],canvas_resolution_factor:1,Po:3,allow_cors:!1,JH:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,M2:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,CN:!1,Nq:!0,gw:!0,jd:!0,water_dynamic:!0,Dk:!0,Ow:!0,gN:!0,precision:"highp",quality:a.al,At:!0,IW:!1,cD:!1,qA:!1,vN:!1,is_mobile_device:!1,hB:!1,Iz:!1,U7:!1,gs:!1,allow_hidpi:!1,XL:!1,MB:!1,enable_selectable:!0,enable_outlining:!0,Pi:!0,Jn:!1,HH:!1,BB:[0,0],Hq:!1,KK:!0,Qw:!1,url_params:null,cc:!0,Cc:4,mq:!1,cL:!1,dL:!1,FC:!1,yG:!1,oJ:!1,media_auto_activation:!0,YJ:4,Kv:!1,gl_debug:!1,sG:!1,vF:!1,cz:!1,nq:"dds",P7:"16x",srgb_type:"SRGB_SIMPLE",dz:!1};a.rH=t.P(a.A);
a.ll={Du:-1,NH:!1,Nl:1};a.controls={EW:1/120};a.Pd={path:"",SW:"B4W_ASSETS_PATH=assets/",jX:"B4W_PROJ_ASSETS_PATH=assets/",xW:15,prevent_caching:!0,LB:!1,lA:!1,qw:!1};a.GF=t.P(a.Pd);a.Ae={shaders_path:"",xY:"../shaders/",VL:"include/",O7:"postprocessing/",Ot:"built_in_data",EJ:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js guitar_presentation.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.qV={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Qi:.064,Bj:.035,xk:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],Sm:.11,Wj:.062,Cj:.004}};a.C={enabled:!0,max_fps:60,zs:"",d_:"B4W_URANIUM_PATH=uranium.js",wz:!1,ping:!1,Is:!0};a.wK=t.P(a.C);a.qo={fr:1024,iu:256,jH:32,kT:128,jT:256,yK:.25,$W:.5,ZW:1};a.gL=t.P(a.qo);a.W={bE:!0,Rv:!1,LF:!1,zG:!1,xH:!1};a.TL=t.P(a.W);a.Uc={outlining_overview_mode:!1,bj:[1,.4,.05],mk:.2,nk:3.8,ok:1};
a.yq={enabled:!1,$Y:0,ZY:0,BY:"COLOR"};a.qH=t.P(a.yq);a.Ci={wW:8,Mv:64,IB:8,Nv:8,JB:15,ZJ:0,Br:128,Vi:1024,FB:4096,Bc:4096,KB:[4096,4096]};a.LG=t.P(a.Ci);a.hn=function(){var b=a.A,d=a.C,m=a.qo;switch(b.quality){case a.Zm:b.shadows=!0;b.Dk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Nq=!0;b.gw=!0;b.jd=!0;m.fr=2048;m.iu=512;b.Po=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Ow=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Pi=!0;b.Cc=16;b.srgb_type="SRGB_PROPER";d.max_fps=120;break;case a.al:b.shadows=!0;b.Dk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Nq=!0;b.gw=!0;b.jd=!0;m.fr=1024;m.iu=256;b.Po=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Ow=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Pi=!0;b.srgb_type="SRGB_SIMPLE";
b.Cc=4;d.max_fps=60;break;case a.sp:b.shadows=!1;b.Dk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Nq=!1;b.gw=!1;b.jd=!1;m.fr=512;m.iu=256;b.Po=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.Ow=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Pi=!1;b.srgb_type="SRGB_SIMPLE";b.Cc=1;d.max_fps=60;break;case a.rp:t.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(d,n){switch(d){case "allow_cors":a.A.allow_cors=n;break;case "allow_hidpi":a.A.allow_hidpi=n;break;case "alpha":a.context.alpha=n;break;case "alpha_sort":a.A.alpha_sort=n;break;case "alpha_sort_threshold":a.A.alpha_sort_threshold=n;break;case "anaglyph_use":b.KT();a.A.stereo=n?"ANAGLYPH":a.A.stereo;break;case "animation_framerate":a.ll.Du=n;break;case "anisotropic_filtering":a.A.anisotropic_filtering=n;break;case "antialiasing":a.A.antialiasing=n;break;case "assets_dir":case "assets_path":a.Pd.path=
n;break;case "assets_dds_available":a.Pd.lA=n;break;case "assets_pvr_available":a.Pd.qw=n;break;case "assets_min50_available":a.Pd.LB=n;break;case "audio":a.W.bE=n;break;case "background_color":a.A.background_color=n;break;case "bloom":a.A.bloom=n;break;case "built_in_module_name":a.Ae.Ot=n;break;case "canvas_resolution_factor":a.A.canvas_resolution_factor=n;break;case "console_verbose":a.A.console_verbose=n;break;case "compositing":a.A.compositing=n;break;case "dof":a.A.dof=n;break;case "do_not_load_resources":a.A.do_not_load_resources=
n;break;case "god_rays":a.A.god_rays=n;break;case "stereo":a.A.stereo=n;break;case "max_fps":a.A.max_fps=n;break;case "max_fps_physics":a.C.max_fps=n;break;case "media_auto_activation":a.A.media_auto_activation=n;break;case "motion_blur":a.A.motion_blur=n;break;case "physics_enabled":a.C.enabled=n;break;case "physics_uranium_path":a.C.zs=n;break;case "physics_calc_fps":a.C.wz=n;break;case "physics_use_workers":a.C.Is=n;break;case "precision":a.A.precision=n;break;case "prevent_caching":a.Pd.prevent_caching=
n;break;case "quality":a.A.quality=n;break;case "reflections":a.A.reflections=n;break;case "refractions":a.A.refractions=n;break;case "sfx_mix_mode":a.W.Rv=n;break;case "shaders_dir":case "shaders_path":a.Ae.shaders_path=n;break;case "shadows":a.A.shadows=n;break;case "show_hud_debug_info":a.A.show_hud_debug_info=n;break;case "smaa":a.A.smaa=n;break;case "smaa_search_texture_path":a.Ae.smaa_search_texture_path=n;break;case "smaa_area_texture_path":a.Ae.smaa_area_texture_path=n;break;case "ssao":a.A.ssao=
n;break;case "debug_view":a.A.debug_view=n;break;case "enable_selectable":a.A.enable_selectable=n;break;case "enable_outlining":a.A.enable_outlining=n;break;case "outlining_overview_mode":a.Uc.outlining_overview_mode=n;break;case "glow_materials":a.A.Pi=n;break;case "url_params":a.A.url_params=n;break;case "use_min50":a.A.use_min50=n;break;case "gl_debug":a.A.gl_debug=n;break;case "srgb_type":a.A.srgb_type=n;break;default:b.error("Unknown config property: "+d)}};a.get=function(d){switch(d){case "allow_cors":return a.A.allow_cors;
case "allow_hidpi":return a.A.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.A.alpha_sort;case "alpha_sort_threshold":return a.A.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.A.stereo;case "animation_framerate":return a.ll.Du;case "anisotropic_filtering":return a.A.anisotropic_filtering;case "antialiasing":return a.A.antialiasing;case "assets_dir":case "assets_path":return a.Pd.path;case "assets_dds_available":return a.Pd.lA;case "assets_pvr_available":return a.Pd.qw;
case "assets_min50_available":return a.Pd.LB;case "audio":return a.W.bE;case "background_color":return a.A.background_color;case "bloom":return a.A.bloom;case "built_in_module_name":return a.Ae.Ot;case "canvas_resolution_factor":return a.A.canvas_resolution_factor;case "console_verbose":return a.A.console_verbose;case "compositing":return a.A.compositing;case "dof":return a.A.dof;case "do_not_load_resources":return a.A.do_not_load_resources;case "is_mobile_device":return a.A.is_mobile_device;case "god_rays":return a.A.god_rays;
case "stereo":return a.A.stereo;case "max_fps":return a.A.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.A.media_auto_activation;case "motion_blur":return a.A.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.zs;case "physics_calc_fps":return a.C.wz;case "physics_use_workers":return a.C.Is;case "precision":return a.A.precision;case "prevent_caching":return a.Pd.prevent_caching;case "quality":return a.A.quality;case "reflections":return a.A.reflections;
case "refractions":return a.A.refractions;case "sfx_mix_mode":return a.W.Rv;case "shaders_dir":case "shaders_path":return a.Ae.shaders_path;case "shadows":return a.A.shadows;case "show_hud_debug_info":return a.A.show_hud_debug_info;case "smaa":return a.A.smaa;case "smaa_search_texture_path":return a.Ae.smaa_search_texture_path;case "smaa_area_texture_path":return a.Ae.smaa_area_texture_path;case "ssao":return a.A.ssao;case "debug_view":return a.A.debug_view;case "enable_selectable":return a.A.enable_selectable;
case "enable_outlining":return a.A.enable_outlining;case "outlining_overview_mode":return a.Uc.outlining_overview_mode;case "glow_materials":return a.A.Pi;case "url_params":return a.A.url_params;case "use_min50":return a.A.use_min50;case "gl_debug":return a.A.gl_debug;case "srgb_type":return a.A.srgb_type;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.MG)a.context[b]=a.MG[b];for(b in a.rH)a.A[b]=a.rH[b];for(b in a.GF)a.Pd[b]=a.GF[b];for(b in a.wK)a.C[b]=a.wK[b];
for(b in a.gL)a.qo[b]=a.gL[b];for(b in a.TL)a.W[b]=a.TL[b];for(b in a.qH)a.yq[b]=a.qH[b]};a.DC=function(){for(var b in a.LG)a.Ci[b]=a.LG[b]};a.tJ=n;a.fY=function(){var b=a.Ae,t=a.C;n()||""!=b.shaders_path||(b.shaders_path=d()+"/"+b.xY);t.enabled&&""==t.zs&&(t.zs=d()+"/"+t.d_.replace("B4W_URANIUM_PATH=",""))};a.Hu=function(b){var n=a.Pd;if(n.path)return n.path;var m=n.SW,x="B4W_ASSETS_PATH=";b&&(m=n.jX,x="B4W_PROJ_ASSETS_PATH=",m=m.replace("__NAME__",b));m=m.replace(x,"");return m=m.replace("__JS__",
d())}};b4w.module.__lights=function(a,r){function n(a){t.scale(a.color,a.Ii,a.lq)}r("__print");var d=r("__tsr"),b=r("__util"),t=r("__vec3"),p=new Float32Array(3);new Float32Array(3);a.QV=function(a,m){var x=a.data,g=m.Sc={name:"",type:x.type,DK:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),lq:new Float32Array(3),qT:0,UD:!1,Do:0,Zw:0,dq:.1,cq:30,VH:!1,gK:!1,BT:!1,Km:!0,Mm:!0,Ii:1,distance:25,o3:"INVERSE_SQUARE"};g.name=m.name;g.Km=x.use_diffuse;g.Mm=x.use_specular;var l=b.lc(d.R(m.k.n),
b.ad,p);t.normalize(l,l);g.direction.set(l);g.color[0]=x.color[0];g.color[1]=x.color[1];g.color[2]=x.color[2];g.Ii=g.qT=x.energy;n(g);g.distance=x.distance;g.UD=x.use_sphere;g.dq=x.clip_start;g.cq=x.clip_end;if("POINT"===g.type||"SPOT"===g.type)g.distance=x.distance;"SPOT"===g.type?(g.Zw=x.spot_blend,g.Do=x.spot_size):"POINT"===g.type&&(g.Do=Math.PI/2);g.VH=x.b4w_generate_shadows;g.BT=x.b4w_dynamic_intensity};a.bY=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];n(a)};a.m7=function(a,
b){a.Zw=b};a.l7=function(a,b){a.distance=b};a.n7=function(a,b){a.Do=b};a.cY=function(a,b){a.Ii=b;n(a)};a.LZ=function(a){var m=a.Sc;if(m){b.lc(d.R(a.k.n),b.ad,m.direction);t.normalize(m.direction,m.direction);if("SUN"==m.type){a=Math.acos(t.dot(m.DK,b.Xy));var n=Math.acos(t.dot(m.direction,b.Xy));m.gK=Math.floor(a/.025)!=Math.floor(n/.025)?!0:!1}t.copy(m.direction,m.DK)}}};b4w.module.__obj_util=function(a,r){function n(a){a={type:a,Qe:0,n:m.Al(),Ex:m.Al(),pivot:new Float32Array(3),Tb:new Float32Array(3),Xj:0,Yj:0,vv:!1,wv:!1,Hj:null,gh:0,Kk:!1,lf:g.create(),use_panning:!1,tb:0,Tk:1,Sk:1,Uk:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Cd:!1,dof_object:null,lb:null,ka:null,sb:null,zc:null,yc:null,ae:null,Jh:!0,Wh:{mk:1,nk:1,ok:0},Rd:-1,Ed:-1,mc:new Float32Array(4),Pl:0,Jl:0,Pn:!1,zr:new Float32Array(3),
Ar:0,af:-1,Yg:0,Zg:0,tn:!1,Ce:!1,ce:!1,me:!1,be:!1,Hd:!1,Gd:!1,jh:"",nf:!1,Vf:!1,jd:!1,Ph:!1,yk:!1,dw:!1,Uc:!1,cw:!1,ew:!1,dm:!1,Tn:!1,Rq:!1,Tm:0,rh:0,sh:0,Lg:0,Kg:0,Fg:0,Ui:"",we:{uB:"",tB:"",dC:""},pl:!1,Zp:new Float32Array(3),Cg:!1,Pp:!1,Rp:"",Qp:!1,Ue:0,qx:0,rx:0,$g:0,Ol:!1,Yc:!1,Ge:!1,di:[],ck:!1,wi:!1,Bh:1,Cp:0,Bp:1,To:new Int8Array([-1,-1]),zo:[],Ov:[],Pw:[],ke:null,Be:null,oe:null,Ee:null,Dg:null,zi:null,Sr:null,Hp:null,Gp:null,ol:null,O:p.Qd(),Ta:p.Qd(),xa:p.Gh(),kb:p.Gh(),aa:p.Hg(),pb:p.Hg(),
zd:p.du(),QF:p.du(),Np:null,Lp:null,Mp:null,Vo:!0,Nf:!1,kw:0};g.copy(x.ad,a.lf);return a}function d(a){if(!(a instanceof Object))return a;var b=null,h=null,l=null,g=null,m=null,n=null;a.ya&&(b=a.ya,a.ya=null);a.Ld&&(h=a.Ld,a.Ld=null);a.Eg&&(l=a.Eg,a.Eg=null);a.ib&&(g=a.ib,a.ib=null);a.yb&&(m=a.yb,a.yb=null);a.He&&(n=a.He,a.He=null);var p;p=a.constructor;switch(p){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:p=
new p(a);break;case Array:p=new p(a.length);for(var t=0;t<a.length;t++)p[t]=d(a[t]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:p=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:p=null;break;case Function:p=a;break;default:for(t in p=new p,a)p[t]=d(a[t])}b&&(p.ya=b,a.ya=b);h&&(p.Ld=h,a.Ld=h);l&&(p.Eg=l,a.Eg=l);g&&(p.ib=g,a.ib=g);m&&(p.yb=m,a.yb=m);n&&(p.He=x.Lj(),a.He=n);return p}function b(a,b){for(var d=a.I,h=0;h<d.length;h++){var l=d[h];if(l.xb==b)return l}return null}
function t(a){return a.rk?a.parent:a.parent?t(a.parent):null}var p=r("__boundings"),B=r("__config"),m=r("__tsr"),x=r("__util"),g=r("__vec3"),l=r("__vec4"),h=B.A;new Float32Array(4);new Float32Array(4);new Float32Array(4);m.create();m.create();a.np=-1;a.tq=n;a.Jz=function(a){var b=n(a.type);b.Qe=a.Qe;m.copy(a.n,b.n);m.copy(a.Ex,b.Ex);g.copy(a.pivot,b.pivot);g.copy(a.Tb,b.Tb);b.Xj=a.Xj;b.Yj=a.Yj;b.vv=a.vv;b.wv=a.wv;a.Hj&&(b.Hj=g.clone(a.Hj));b.gh=a.gh;b.Kk=a.Kk;g.copy(a.lf,b.lf);b.use_panning=a.use_panning;
b.tb=a.tb;b.Tk=a.Tk;b.Sk=a.Sk;b.Uk=a.Uk;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Cd=a.Cd;b.dof_object=a.dof_object;b.lb=x.P(a.lb);b.ka=x.P(a.ka);b.sb=x.P(a.sb);b.zc=x.P(a.zc);b.yc=x.P(a.yc);b.ae=a.ae;b.Jh=a.Jh;b.Wh.mk=a.Wh.mk;b.Wh.nk=a.Wh.nk;b.Wh.ok=a.Wh.ok;b.Rd=a.Rd;b.Ed=a.Ed;b.mc=a.mc;
b.Pl=a.Pl;b.Jl=a.Jl;b.Pn=a.Pn;g.copy(a.zr,b.zr);b.Ar=a.Ar;b.af=a.af;b.Yg=a.Yg;b.Zg=a.Zg;b.tn=a.tn;b.Ce=a.Ce;b.ce=a.ce;b.me=a.me;b.be=a.be;b.Hd=a.Hd;b.Gd=a.Gd;b.jh=a.jh;b.nf=a.nf;b.Vf=a.Vf;b.jd=a.jd;b.Ph=a.Ph;b.yk=a.yk;b.dw=a.dw;b.Uc=a.Uc;b.cw=a.cw;b.ew=a.ew;b.dm=a.dm;b.Tn=a.Tn;b.Rq=a.Rq;b.Tm=a.Tm;b.rh=a.rh;b.sh=a.sh;b.Lg=a.Lg;b.Kg=a.Kg;b.Fg=a.Fg;b.Ui=a.Ui;b.we=a.we;b.pl=a.pl;g.copy(a.Zp,b.Zp);b.Cg=a.Cg;b.Pp=a.Pp;b.Rp=a.Rp;b.Qp=a.Qp;b.Ue=a.Ue;b.qx=a.qx;b.rx=a.rx;b.$g=a.$g;b.Ol=a.Ol;b.Yc=a.Yc;b.Ge=
a.Ge;b.di=x.P(a.di);b.ck=a.ck;b.wi=a.wi;b.Bh=a.Bh;b.Cp=a.Cp;b.Bp=a.Bp;b.To.set(a.To);b.zo=x.P(a.zo);b.Ov=x.P(a.Ov);b.Pw=x.P(a.Pw);b.ke=x.P(a.ke);b.Be=x.P(a.Be);b.oe=x.P(a.oe);b.Ee=x.P(a.Ee);b.Dg=x.P(a.Dg);b.zi=x.P(a.zi);b.Sr=x.P(a.Sr);b.Hp=x.P(a.Hp);b.Gp=x.P(a.Gp);b.ol=x.P(a.ol);p.ln(a.O,b.O);p.ln(a.Ta,b.Ta);p.Rz(a.xa,b.xa);p.Rz(a.kb,b.kb);p.Pz(a.aa,b.aa);p.Pz(a.pb,b.pb);b.Np=x.P(a.Np);b.Lp=x.P(a.Lp);b.Mp=x.P(a.Mp);b.Vo=a.Vo;b.Nf=a.Nf;b.kw=a.kw;return b};a.sq=function(a,b,d){d||(d=a);return{name:a,
qj:x.GA(),pm:d,type:b,Ej:!1,Ea:!1,nr:!1,Cs:!1,k:null,ic:null,W:null,Sc:null,Ft:null,anchor:null,yn:null,Qv:null,I:[],Yc:[],Pe:x.Lj(),Oz:x.Lj(),ha:[],Zr:[],ig:[],yt:[],mh:null,Am:[],parent:null,rk:!1,Kr:"",xx:null,lw:null,Lm:!1,$b:"",$t:"AUTO",Xe:!1,dg:!1,cm:!1,cG:!1,C:null,v:null,Xf:null,kf:null,zn:null,qG:null,jC:[],hh:{Nr:"NO_COLLISION",Es:!1,nN:!1,Uh:0,tN:0,sN:0,nH:0,aL:0,hW:!1,iW:!1,jW:!1,kW:!1,lW:!1,mW:!1,jq:0,hq:0,kq:0,TD:!1,Wt:"BOX",As:!1},qK:{ex:0,cC:0,Gf:0,xC:0},kl:0,Jg:[],VB:!1,fK:!1,Pv:[]}};
a.Qz=function(a){return a instanceof Array?a.slice():a};a.B2=function(a){for(var b=[],h=0;h<a.length;h++){var l=a[h],g={},m;for(m in l)l[m]==l.Ta?g.Ta=d(l.Ta):l[m]==l.pb?g.pb=d(l.pb):g[m]=l[m];b.push(g)}return b};a.Zt=d;a.Ea=function(a){return a.Ea};a.lr=function(a){return"MESH"==a.type&&a.Ea};a.Fp=function(a,b){a.I.push({xb:b,tv:!1,U:[],Xh:[],Ei:null,eD:[],im:0,nK:!1,ba:[],WL:[]})};a.Bt=function(a,d,h){b(a,d).U.push(h)};a.J6=function(a,b){for(var d=a.I,h=0;h<d.length;h++)if(d[h].xb==b){d.splice(h,
1);break}};a.ja=b;a.bN=function(a,b){for(var d=0;d<a.length;d++)l.copy(b,a[d].k.mc)};a.KC=function(a,b,d){for(var h=0;h<a.I.length;h++){var l=a.I[h];d&&l.xb!=d||(l.tv=b)}};a.Su=function(a,b){for(var d=[],l=b?h.YJ-1:h.YJ,g=0;g<a.length;g++){var m=a[g];m.Sc.VH&&d.length<l&&d.push(m)}return d.length?d:a[0]?[a[0]]:[]};a.DW=function(a,b){m.identity(b.n);b.Hj=null;a.k=b};a.uG=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var d=b.material-1,h=a.data.materials;if(0<=d&&d<h.length&&
("ADD"==h[d].game_settings.alpha_blend||"ALPHA"==h[d].game_settings.alpha_blend||"ALPHA_SORT"==h[d].game_settings.alpha_blend))return!0}return!1};a.JR=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,h=0;h<d.length;h++)for(var l=d[h].hb.Hi,g=0;g<l.length;g++){var m=l[g];if("USE_MODEL_TSR_INVERSE"==m[0]&&"1"==m[1])return!0}return!1};a.SH=function(a,b){return a+"*"+b};a.Pu=function(a){return a.rk?null:a.parent};a.Sg=t;a.OA=function(a,b){for(var d=[],h=0;h<b.length;h++){var l=b[h];t(l)==
a&&d.push(l)}return d};a.TA=function(a){return a.k.Qe};a.Rc=function(a){return"MESH"===a.type};a.Ri=function(a){return"ARMATURE"===a.type};a.fm=function(a){return"SPEAKER"===a.type};a.wa=function(a){return"CAMERA"===a.type};a.On=function(a){return"LAMP"===a.type};a.$j=function(a){return"EMPTY"===a.type};a.zJ=function(a){return"LINE"===a.type};a.rr=function(a){return"WORLD"===a.type}};b4w.module.__boundings=function(a,r){function n(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function d(){return{G:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),Ja:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function t(a,b){for(var c=a[0],d=a[1],f=a[2],h=a[0],k=a[1],l=a[2],g=3;g<a.length;g+=3)var v=a[g],m=a[g+1],M=a[g+2],c=Math.max(c,v),d=Math.max(d,m),f=Math.max(f,M),
h=Math.min(h,v),k=Math.min(k,m),l=Math.min(l,M);b.max_x=c;b.max_y=d;b.max_z=f;b.min_x=h;b.min_y=k;b.min_z=l;return b}function p(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,f=a.max_z,h=a.min_x,k=a.min_y,l=a.min_z;b[0]=h;b[1]=k;b[2]=l;b[3]=c;b[4]=k;b[5]=l;b[6]=c;b[7]=d;b[8]=l;b[9]=h;b[10]=d;b[11]=l;b[12]=h;b[13]=k;b[14]=f;b[15]=c;b[16]=k;b[17]=f;b[18]=c;b[19]=d;b[20]=f;b[21]=h;b[22]=d;b[23]=f;return b}function B(){return{G:new Float32Array(3),Xa:0}}function m(a,b){b.G[0]=a.G[0];b.G[1]=
a.G[1];b.G[2]=a.G[2];b.Xa=a.Xa}function x(){return{Ha:new Float32Array(3),Ia:new Float32Array(3),Ja:new Float32Array(3),G:new Float32Array(3)}}function g(a,b){G.copy(a.Ha,b.Ha);G.copy(a.Ia,b.Ia);G.copy(a.Ja,b.Ja);G.copy(a.G,b.G);return b}function l(a){var b=x();g(a,b);return b}function h(a,b,c,d){return{Ha:new Float32Array(a),Ia:new Float32Array(b),Ja:new Float32Array(c),G:new Float32Array([d[0],d[1],d[2]])}}function w(a,b){var d=L.pR(a,c),d=b?L.iR(a,d,y):D.identity(y),d=L.ZT(d,k);G.copy(a,I);G.transformMat3(I,
d,I);for(var f=I[0],l=f,g=I[1],m=g,U=I[2],n=U,v=0,fa=0,M=0,H=0,w=0,p=0,u=3;u<a.length;u+=3)I[0]=a[u],I[1]=a[u+1],I[2]=a[u+2],G.transformMat3(I,d,I),v=I[0],fa=I[1],M=I[2],v>f&&(f=v),v<l&&(l=v),fa>g&&(g=fa),fa<m&&(m=fa),M>U&&(U=M),M<n&&(n=M);g-=m;U-=n;f=Math.max(f-l,1E-9);g=Math.max(g,1E-9);U=Math.max(U,1E-9);l=D.identity(y);l[0]=0!=f?1/f:1E8;l[4]=0!=g?1/g:1E8;l[8]=0!=U?1/U:1E8;D.transpose(d,A);I[0]=a[0];I[1]=a[1];I[2]=a[2];G.transformMat3(I,d,I);G.transformMat3(I,l,I);G.transformMat3(I,A,I);v=I[0];
fa=I[0];M=I[1];H=I[1];w=I[2];p=I[2];for(u=3;u<a.length;u+=3)I[0]=a[u],I[1]=a[u+1],I[2]=a[u+2],G.transformMat3(I,d,I),G.transformMat3(I,l,I),G.transformMat3(I,A,I),v=Math.max(v,I[0]),fa=Math.min(fa,I[0]),M=Math.max(M,I[1]),H=Math.min(H,I[1]),w=Math.max(w,I[2]),p=Math.min(p,I[2]);u=Math.sqrt((v-fa)*(v-fa)+(M-H)*(M-H)+(w-p)*(w-p))/2;u=Math.min(u,1);E[0]=(v+fa)/2;E[1]=(M+H)/2;E[2]=(w+p)/2;v=E;l=D.identity(y);l[0]=f;l[4]=g;l[8]=U;G.transformMat3(v,d,v);G.transformMat3(v,l,v);G.transformMat3(v,A,v);l=[d[0],
d[3],d[6]];fa=[d[1],d[4],d[7]];d=[d[2],d[5],d[8]];G.scale(l,f*u,l);G.scale(fa,g*u,fa);G.scale(d,U*u,d);return h(l,fa,d,v)}function f(a,b,c){G.add(b,c,a.G);G.scale(a.G,.5,a.G);a.Xa=G.distance(a.G,b);return a}var C=r("__tsr"),K=r("__util"),G=r("__vec3"),L=r("__math"),D=r("__mat3"),N=new Float32Array(24),I=new Float32Array(3),O=new Float32Array(3),E=new Float32Array(3),c=new Float32Array(3),k=new Float32Array(9),y=new Float32Array(9),A=new Float32Array(9);new Float32Array(9);a.Qd=n;a.du=d;a.ln=b;a.Q1=
function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.B_=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.vl=function(a){var c=n();b(a,c);return c};a.jR=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.wA=function(a,b){var c=a.max_y,d=a.max_z,f=a.min_x,h=a.min_y,k=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,
f);a.min_y=Math.min(b.min_y,h);a.min_z=Math.min(b.min_z,k)};a.PF=t;a.tl=function(a,b,c){c||(c=n());a=p(a,N);C.Ro(a,b,a);return t(a,c)};a.EH=p;a.S7=function(a,b,c){c||(c=n());var d=b.min_x,f=b.max_x,h=b.min_y,k=b.max_y,l=b.min_z;b=b.max_z;if(d>=a.max_x||f<=a.min_x||h>=a.max_y||k<=a.min_y||l>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,f);c.min_y=Math.max(a.min_y,h);c.max_y=Math.min(a.max_y,k);
c.min_z=Math.max(a.min_z,l);c.max_z=Math.min(a.max_z,b);return c};a.h8=function(a,b,c){c||(c=n());var d=a.max_x-a.min_x,f=a.max_y-a.min_y,h=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*f;c.max_y=a.max_y+.5*(b-1)*f;c.min_z=a.min_z-.5*(b-1)*h;c.max_z=a.max_z+.5*(b-1)*h;return c};a.Tp=function(a,b,c){c||(c=B());C.Wc(a.G,b,c.G);b=C.Yd(b);c.Xa=a.Xa*(0>b?-b:b);return c};a.Sp=function(a,b,c){c||(c=x());C.Wc(a.G,b,c.G);G.copy(a.Ha,c.Ha);G.copy(a.Ia,c.Ia);
G.copy(a.Ja,c.Ja);C.xd(c.Ha,b,c.Ha);C.xd(c.Ia,b,c.Ia);C.xd(c.Ja,b,c.Ja);return c};a.rz=function(a,b,c){c||(c=d());C.Wc(a.G,b,c.G);G.copy(a.Ha,c.Ha);G.copy(a.Ia,c.Ia);G.copy(a.Ja,c.Ja);C.xd(c.Ha,b,c.Ha);C.xd(c.Ia,b,c.Ia);C.xd(c.Ja,b,c.Ja);return c};a.uz=function(a,b){var c=B();G.copy(b,c.G);c.Xa=a;return c};a.EX=function(a,b,c,f,h){var k=d();G.copy(a,k.G);G.copy(b,k.Ha);G.copy(c,k.Ia);G.copy(f,k.Ja);G.scale(k.Ha,h[0],k.Ha);G.scale(k.Ia,h[1],k.Ia);G.scale(k.Ja,h[2],k.Ja);return k};a.Gh=B;a.Rz=m;a.Hg=
x;a.Pz=g;a.eq=l;a.wl=function(a){var b=B();m(a,b);return b};a.Op=h;a.TQ=function(){var a;a||(a=B());G.set(0,0,0,a.G);a.Xa=1E12;return a};a.MT=function(a,b){var c=G.subtract(b.G,a.G,G.create());0==G.length(c)&&G.set(1,0,0,c);var d=G.normalize(c,G.create()),c=G.scale(d,a.Xa,G.create());G.add(c,a.G,c);var f=G.scale(d,-a.Xa,G.create());G.add(f,a.G,f);var h=G.scale(d,b.Xa,G.create());G.add(h,b.G,h);var k=G.scale(d,-b.Xa,G.create());G.add(k,b.G,k);c=[c,f,h,k];d=G.normalize(d,G.create());f=c[0];h=c[0];for(k=
1;k<c.length;k++){var l=G.dot(c[k],d);l<G.dot(f,d)&&(f=c[k]);l>G.dot(h,d)&&(h=c[k])}d=[f,h];c=d[0];d=d[1];a.G=G.scale(G.add(c,d,G.create()),.5,G.create());a.Xa=G.length(G.subtract(d,c,G.create()))/2};a.AA=function(a,b){G.add(a.G,a.Ia,I);G.add(I,a.Ha,I);G.add(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.add(a.G,a.Ia,I);G.add(I,a.Ha,I);G.subtract(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.add(a.G,a.Ia,I);G.subtract(I,a.Ha,I);G.add(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.add(a.G,a.Ia,I);G.subtract(I,a.Ha,I);G.subtract(I,a.Ja,
I);b.push(I[0],I[1],I[2]);G.subtract(a.G,a.Ia,I);G.add(I,a.Ha,I);G.add(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.subtract(a.G,a.Ia,I);G.add(I,a.Ha,I);G.subtract(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.subtract(a.G,a.Ia,I);G.subtract(I,a.Ha,I);G.add(I,a.Ja,I);b.push(I[0],I[1],I[2]);G.subtract(a.G,a.Ia,I);G.subtract(I,a.Ha,I);G.subtract(I,a.Ja,I);b.push(I[0],I[1],I[2])};a.au=w;a.fS=function(a){var b=d();G.copy(a.Ha,b.Ha);G.copy(a.Ia,b.Ia);G.copy(a.Ja,b.Ja);G.copy(a.G,b.G);return b};a.qq=function(a){var b=B(),c=
0,c=G.length(a.Ha),d=G.length(a.Ia),f=G.length(a.Ja),c=c>d?c:d;b.G=a.G;b.Xa=f>c?f:c;return b};a.gR=function(a,b){var d=l(a),f=C.fc(b,c);G.subtract(d.G,f,d.G);return d};a.oB=function(a,b){var c=G.length(a.Ha),d=G.length(a.Ia),f=G.length(a.Ja);return.75*b.Xa*b.Xa*b.Xa>c*d*f};a.RF=function(a,b){var c=b.max_z,d=b.min_z,f=Math.max(0,c-d-2*a);return{Xa:a,height:f,G:new Float32Array([0,0,(c+d)/2])}};a.TF=function(a,b){var c=b.max_z,d=b.min_z,f=Math.max(0,c-d);return{Xa:a,height:f,G:new Float32Array([0,0,
(c+d)/2])}};a.SF=function(a,b){var c=b.max_z,d=b.min_z,f=Math.max(0,c-d);return{Xa:a,height:f,G:new Float32Array([0,0,(c+d)/2])}};a.b2=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.mX=function(a){for(var b=0,c=0,d=0,f=0,h=0,k=0,l=0,g=0,v=0,m=0,M=0,H=0,n=0,A=0,u=0;u<a.submeshes.length;u++){var Q=a.submeshes[u];if(Q.position.length){b=f=Q.position[0];c=h=Q.position[1];d=k=Q.position[2];break}}for(u=0;u<a.submeshes.length;u++){for(var Q=
a.submeshes[u],y=Q.position,l=m=Q.position[0],g=M=Q.position[1],v=H=Q.position[2],p=0;p<y.length/3;p++)var E=y[3*p],C=y[3*p+1],S=y[3*p+2],b=Math.max(E,b),c=Math.max(C,c),d=Math.max(S,d),f=Math.min(E,f),h=Math.min(C,h),k=Math.min(S,k),l=Math.max(E,l),g=Math.max(C,g),v=Math.max(S,v),m=Math.min(E,m),M=Math.min(C,M),H=Math.min(S,H),n=Math.max(Math.sqrt(E*E+C*C+S*S),n),A=Math.max(Math.sqrt(E*E+C*C),A);y=Q.boundings.bb;y.max_x=l;y.min_x=m;y.max_y=g;y.min_y=M;y.max_z=v;y.min_z=H;y=N;y[0]=m;y[1]=M;y[2]=H;
y[3]=l;y[4]=M;y[5]=H;y[6]=l;y[7]=g;y[8]=H;y[9]=m;y[10]=g;y[11]=H;y[12]=m;y[13]=M;y[14]=v;y[15]=l;y[16]=M;y[17]=v;y[18]=l;y[19]=g;y[20]=v;y[21]=m;y[22]=g;y[23]=v;l=w(y,!1);Q.boundings.be_cen=l.G;Q.boundings.be_ax=[l.Ha[0],l.Ia[1],l.Ja[2]]}u=a.b4w_boundings.bb;u.max_x=b;u.min_x=f;u.max_y=c;u.min_y=h;u.max_z=d;u.min_z=k;u=a.b4w_boundings.bb_src;u.max_x=b;u.min_x=f;u.max_y=c;u.min_y=h;u.max_z=d;u.min_z=k;a.b4w_boundings.bs_rad=n;a.b4w_boundings.bc_rad=A;y=N;y[0]=f;y[1]=h;y[2]=k;y[3]=b;y[4]=h;y[5]=k;y[6]=
b;y[7]=c;y[8]=k;y[9]=f;y[10]=c;y[11]=k;y[12]=f;y[13]=h;y[14]=d;y[15]=b;y[16]=h;y[17]=d;y[18]=b;y[19]=c;y[20]=d;y[21]=f;y[22]=c;y[23]=d;l=w(y,!1);a.b4w_boundings.be_cen=l.G;a.b4w_boundings.be_ax=[l.Ha[0],l.Ia[1],l.Ja[2]]};a.SU=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),d=a.subarray(12,15),h=a.subarray(18,21);a=G.subtract(c,b,I);G.normalize(a,a);var k=K.aV(b,c,d,O),k=G.cross(k,a,k);G.normalize(k,k);var l=G.create(),g=G.create();G.subtract(c,b,E);g[0]=G.dot(E,a);g[1]=G.dot(E,k);c=G.create();
G.subtract(d,b,E);c[0]=G.dot(E,a);c[1]=G.dot(E,k);d=G.create();G.subtract(h,b,E);d[0]=G.dot(E,a);d[1]=G.dot(E,k);h=B();d=[l,g,c,d];l=f(h,d[0],d[1]);for(h=2;h<d.length;h++)if(G.distance(l.G,d[h])>l.Xa){for(var m=l,l=d,g=d[h],c=h-1,m=f(m,g,l[0]),v=1;v<=c;v++)if(G.distance(m.G,l[v])>m.Xa){for(var n=m,m=l,M=g,H=l[v],A=v-1,n=f(n,M,H),y=0;y<=A;y++)if(G.distance(n.G,m[y])>n.Xa){var u=M,Q=H,w=m[y],p=G.subtract(Q,w,E),p=G.squaredLength(p),C=G.subtract(u,w,E),x=G.squaredLength(C),C=G.subtract(u,Q,E),S=G.squaredLength(C),
C=p*(x+S-p),Y=x*(S+p-x),p=S*(p+x-S),x=C+Y+p;G.copy(u,n.G);G.scale(n.G,C/x,n.G);G.scaleAndAdd(n.G,Q,Y/x,n.G);G.scaleAndAdd(n.G,w,p/x,n.G);n.Xa=G.distance(n.G,u)}m=n}l=m}h=l;a=G.scale(a,h.G[0],E);G.scaleAndAdd(a,k,h.G[1],a);G.add(a,b,h.G);return h}};b4w.module.__particles=function(a,r){function n(){l.q("_rand() undefined")}function d(a,b,d,h,l,m){var c=a.ou,k=a.Ng,n=a.time;a=a.EK;for(var A=0;A<c.length;A+=4){var e=c[A];if(n>a&&n>=e&&e>a||n<a&&(e>a||n>=e))for(e=0;8>e;e++)k[8*A+e]=h[e],C[e]=h[e];else for(e=0;8>e;e++)C[e]=k[8*A+e];e=K;e[0]=b[3*A];e[1]=b[3*A+1];e[2]=b[3*A+2];g.Wc(e,C,e);l[3*A]=e[0];l[3*A+1]=e[1];l[3*A+2]=e[2];var w=f;w[0]=d[4*A];w[1]=d[4*A+1];w[2]=d[4*A+2];w[3]=d[4*A+3];g.pZ(w,C,w);m[4*A]=w[0];m[4*A+1]=w[1];m[4*A+2]=w[2];m[4*A+3]=
w[3];for(e=1;4>e;e++)l[3*(A+e)]=l[3*A],l[3*(A+e)+1]=l[3*A+1],l[3*(A+e)+2]=l[3*A+2],m[4*(A+e)]=w[0],m[4*(A+e)+1]=w[1],m[4*(A+e)+2]=w[2],m[4*(A+e)+3]=w[3]}}function b(a){a?(l.SY(a),n=function(){return l.lX()}):n=function(){return Math.random()}}var t=r("__config"),p=r("__batch"),B=r("__geometry"),m=r("__textures"),x=r("__time"),g=r("__tsr"),l=r("__util"),h=r("__vec3"),w=t.A,f=new Float32Array(4),C=new Float32Array(8),K=new Float32Array(3),G=[];a.update=function(){for(var a=0;a<G.length;a++)for(var b=
G[a],f=b.I,h=0;h<f.length;h++)for(var l=b,g=f[h].U,c=0;c<g.length;c++){var k=g[c],m=k.gb;m&&m.nx&&!k.Zf&&(d(m,m.positions,m.EM,l.k.n,m.mC,m.yD),m.eK=!0)}};a.ZB=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,f=0;f<d.length;f++)if(d[f].gb)return!0;return!1};a.mK=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,f=0;f<d.length;f++){var h=d[f].gb;if(h&&"EMITTER"==h.fw)return!0}return!1};a.bR=function(a){return 0<a.particle_systems.length};a.aR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.mV=function(a){for(var b=0;b<a.particle_systems.length;b++){var d=a.particle_systems[b].settings;if("HAIR"==d.type&&d.b4w_dynamic_grass)return!0}return!1};a.xV=function(a,b,d){var f=a.gb={name:b.name,fw:b.settings.type,time:0,EK:-1,nx:!1,va:0,Za:0,KM:0,wB:0,OJ:0,ve:0,Uh:0,WB:0,bJ:0,Ll:0,zf:0,DN:0,size:0,xF:0,wF:0,HG:0,GG:new Float32Array(16),eK:!1,positions:null,mC:null,EM:null,yD:null,ou:null,nA:null,Ng:null,rK:null,IM:0,JM:0};f.va=b.settings.frame_start;
f.Za=b.settings.frame_end;f.KM=(f.Za-f.va)/x.sd();f.wB=b.settings.lifetime;f.OJ=f.wB/x.sd();f.ve=b.settings.b4w_cyclic?1:0;f.Uh=b.settings.mass;f.WB=b.settings.normal_factor;f.bJ=9.81*b.settings.effector_weights.gravity;f.Ll=b.settings.b4w_fade_in/x.sd();f.zf=b.settings.b4w_fade_out/x.sd();f.DN=b.settings.effector_weights.wind;f.nx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var h,g,c;a.gr?(h=d.halo.size,g=d.halo.hardness,30>g?(g=.5,c=.9):40>g?(g=.1,c=1):50>g?(g=0,c=.8):(g=0,c=.5)):(h=b.settings.particle_size,
c=g=1);f.size=h;f.xF=g;f.wF=c;d.use_nodes&&"BILLBOARD"==b.settings.render_type&&(p.ef(a,"NODES",1),p.ef(a,"PARTICLE_BATCH",1),a.Vj=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&w.At&&(b=b[0].texture,h=[],m.hR(b.color_ramp,m.SE,h),h=new Uint8Array(h.map(function(a){return l.V(255*a,0,255)})),h=m.OG(h,m.SE),p.Aj(a,h,"u_color_ramp_tex",b.name),p.ef(a,"USE_COLOR_RAMP",1));d=d.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(d[0]&&"STRAND"==d[0].texture_coords&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=d[0].texture.color_ramp.elements;b=Math.min(4*d.length,a.length);for(h=0;h<b;h+=4)g=d[h/4],a[h]=g.position,a[h+1]=g.color[0],a[h+2]=g.color[1],a[h+3]=g.color[2];f.HG=d.length}f.GG.set(a)};a.sU=function(a,f,g,m){var w=a.gb,p=m.n;m=g.settings.count;var c=g.settings.frame_start/x.sd(),k=g.settings.frame_end/x.sd(),y=g.settings.lifetime/x.sd(),A=g.settings.lifetime_random,e=g.settings.emit_from,
R=g.settings.factor_random;if(g.settings.use_rotations)var q=g.settings.angular_velocity_mode,C=g.settings.angular_velocity_factor;else q="NONE",C=0;var J=g.settings.b4w_randomize_emission,F=g.settings.b4w_cyclic;w.IM=g.settings.billboard_tilt;w.JM=g.settings.billboard_tilt_random;b(g.seed);var V;f=B.FH(f,["a_position","a_tbn_quat"],null);switch(e){case "VERT":var U=f.Z[0].a_position;V=f.Z[0].a_tbn_quat;g=U.length/3;f=[];for(e=0;e<m;e++){var t=Math.round((g-1)*n());f.push(t);f.push(t);f.push(t);f.push(t)}g=
[];for(e=0;e<f.length;e++)g.push(U[3*f[e]]),g.push(U[3*f[e]+1]),g.push(U[3*f[e]+2]);U=new Float32Array(g);g=[];for(e=0;e<f.length;e++)g.push(V[4*f[e]]),g.push(V[4*f[e]+1]),g.push(V[4*f[e]+2]),g.push(V[4*f[e]+3]);V=new Float32Array(g);break;case "FACE":U=[];V=[];e=[];l.rv(0,e);g=B.HA(f,m,!1,e);l.rv(0,e);f=B.HA(f,m,!0,e);for(e=0;e<g.length;e++)U.push(g[e][0],g[e][1],g[e][2]),U.push(g[e][0],g[e][1],g[e][2]),U.push(g[e][0],g[e][1],g[e][2]),U.push(g[e][0],g[e][1],g[e][2]),V.push(f[e][0],f[e][1],f[e][2],
f[e][3]),V.push(f[e][0],f[e][1],f[e][2],f[e][3]),V.push(f[e][0],f[e][1],f[e][2],f[e][3]),V.push(f[e][0],f[e][1],f[e][2],f[e][3]);U=new Float32Array(U);V=new Float32Array(V);break;case "VOLUME":l.q("Particle emission from volume is not supported");break;default:l.q("Wrong emit from option")}V=[U,V];U=V[0];V=V[1];w.positions=new Float32Array(U);w.EM=new Float32Array(V);w.mC=new Float32Array(U.length);w.yD=new Float32Array(V.length);f=[];k=(k-c)/m;for(g=0;g<m;g++)e=J?k*g+10*k*(.5-n()):k*g,F||(e+=c),
f.push(e),f.push(e),f.push(e),f.push(e);c=new Float32Array(f);w.ou=new Float32Array(c);w.nA=new Float32Array(c);if(w.nx){w.Ng=new Float32Array(8*c.length);for(J=0;J<8*c.length;J++)for(F=0;8>F;F++)w.Ng[8*J+F]=p[F];d(w,U,V,p,U,V)}p=B.Df("EMITTER_PARTICLES");J=l.Ig();J.a_position=U;J.a_tbn_quat=V;p.Z[0]=J;a.Ih=B.Us;a=[];for(J=0;J<m;J++)a.push(4*J,4*J+2,4*J+1,4*J,4*J+3,4*J+2);a=new Uint16Array(a);p.ma=a;p.pa.a_p_bb_vertex=B.QH(m);p.Ka=U.length/3;a=[];A*=y;for(J=0;J<m;J++)F=A*n(),a.push(y-F),a.push(y-
F),a.push(y-F),a.push(y-F);y=p.pa;A=[];for(J=0;J<m;J++)F=Math.random(),A.push(a[4*J],c[4*J],F),A.push(a[4*J+1],c[4*J+1],F),A.push(a[4*J+2],c[4*J+2],F),A.push(a[4*J+3],c[4*J+3],F);A=new Float32Array(A);y.a_p_data=A;y=p.pa;A=[];for(a=0;a<m;a++){c=[n()-.5,n()-.5,n()-.5];h.normalize(c,c);A.push(R*c[0]);A.push(R*c[1]);A.push(R*c[2]);switch(q){case "NONE":A.push(0);break;case "SPIN":case "VELOCITY":A.push(C);break;case "RAND":A.push(2*C*(n()-.5));break;default:l.q("Undefined velocity factor")}c=A.slice(-4);
for(J=0;12>J;J++)A.push(c[J%4])}m=new Float32Array(A);y.a_p_vels=m;w.rK=new Float32Array(p.pa.a_p_data);return p};a.lY=function(a,b,d){a=a.I;for(var f=0;f<a.length;f++)for(var h=a[f].U,l=0;l<h.length;l++){var c=h[l].gb;c&&c.name==b&&!h[l].Zf&&(c.EK=c.time,c.time=d)}};a.fX=function(a){for(var b=a.Ka,d=a.Z[0].a_position,f=[],h=[],l=0;l<b;l++)h.push(d[3*l]),f.push(d[3*l+1]),h.push(d[3*l+2]);f=new Float32Array(f);h=new Float32Array(h);a.pa.a_lf_dist=f;a.pa.a_lf_bb_vertex=h;return a};a.H7=function(a,b,
d){a=a.I;for(var f=0;f<a.length;f++)for(var h=a[f].U,l=0;l<h.length;l++){var c=h[l].gb;c&&c.name==b&&(c.size=d)}};a.t7=function(a,b,d){a=a.I;for(var f=0;f<a.length;f++)for(var h=a[f].U,l=0;l<h.length;l++){var c=h[l].gb;c&&c.name==b&&(c.WB=d)}};a.e7=function(a,b,d){a=a.I;for(var f=0;f<a.length;f++)for(var h=a[f].U,l=0;l<h.length;l++){var c=h[l],k=c.gb;if(k&&k.name==b){var g=k.ou;if(1==d)var m=g;else if(0==d)for(var m=k.nA,e=0;e<m.length;e+=4)m[e]=1E4,m[e+1]=m[e],m[e+2]=m[e],m[e+3]=m[e];else for(var n=
4/d,m=k.nA,q=0,e=0;e<m.length;e+=4)e>=q?(m[e]=g[e],q+=n):m[e]=1E4,m[e+1]=m[e],m[e+2]=m[e],m[e+3]=m[e];c=c.Ba;if(c.ld.a_p_data){k=k.rK;for(e=0;e<k.length;e+=3)k[e+1]=m[Math.round(e/3)];B.EZ(c,k)}}}};a.$Z=function(a,b,d){a=a.I;for(var f=0;f<a.length;f++)for(var h=a[f].U,l=0;l<h.length;l++){var c=h[l].gb;if(c&&c.nx)for(var k=0;k<8*c.ou.length;k++)c.Ng[8*k]=b[0],c.Ng[8*k+1]=b[1],c.Ng[8*k+2]=b[2],c.Ng[8*k+3]=b[3],c.Ng[8*k+4]=d[0],c.Ng[8*k+5]=d[1],c.Ng[8*k+6]=d[2],c.Ng[8*k+7]=d[3]}};a.SZ=function(a,b,d){for(var f=
[],h=0;h<d;h++)f.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.pa.a_tbn_quat=new Float32Array(f);if(b.Lr){f=[];for(h=0;h<d;h++)f.push(h,h,h,h);a.pa[b.Lr.name]=new Float32Array(f)}};a.RZ=function(a){-1==G.indexOf(a)&&G.push(a)};a.qX=function(a){a=G.indexOf(a);-1!=a&&G.splice(a,1)};a.sa=function(){G.length=0}};b4w.module.__batch=function(a,r){function n(a){a={type:a,Eb:"",id:0,gq:-1,kk:"",ku:-1,qn:-1,wq:0,xf:0,El:[],ya:[],Ld:[],Eg:[],td:[],Ij:[],rj:null,Zc:{},yb:null,hb:{tg:null,Te:null,Hi:[],jg:[],status:X.Wy,fU:0,o_:0,KF:0,GM:0},ik:"",Kp:[],Ba:null,He:z.Lj(),Ge:!1,Gi:!1,lu:!1,Gr:0,om:0,Cv:0,Dv:0,jd:!1,Zu:0,er:0,ge:new Float32Array(3),ue:new Float32Array(16),Ag:!1,Kb:!1,Ua:!1,th:!1,Xb:!1,Fe:!1,Vf:!1,Ce:!1,me:!1,ce:!1,be:!1,Hd:!1,Gd:!1,ru:!1,Ih:la.Wm,of:!1,Zf:!1,Mj:!1,Gg:!1,af:ua.np,Yg:0,Zg:0,Rd:-1,Ed:-1,
dv:!1,hv:0,ev:0,iv:0,jv:0,gv:new Float32Array(3),fv:new Float32Array(3),gr:!1,yj:0,Oj:0,Gl:1,lo:0,Co:0,qs:1,eo:0,Fl:0,il:1,Zv:0,Cr:0,kg:0,vw:0,Td:new Float32Array(2),Gk:new Float32Array(3),gi:new Float32Array(3),Em:new Float32Array(3),Uf:new Float32Array(4),Li:new Float32Array(4),hm:null,Un:null,vr:null,ur:null,Vj:!1,wireframe_edge_color:ma.create(),sj:!1,water_dynamic:!1,Ms:!1,Ax:!1,Bx:0,Cx:0,zx:0,ap:.1,uo:0,wo:0,An:0,Cu:new Float32Array(2),Bu:new Float32Array(2),Oq:new Float32Array(2),so:new Float32Array(3),
vo:new Float32Array(3),$i:null,uk:!1,gb:null,Fv:0,jl:null,Lr:null,Zi:[],eh:[],ze:[],dh:[],O:null,Ta:null,xa:null,kb:null,pb:null,aa:null,Nf:!1,Tf:!0,qJ:0,bo:new Float32Array(3)};a.Uf[3]=1;a.Ua=!0;a.Fv=1;return a}function d(a){var b=n(a.type);b.Eb=a.Eb;b.id=a.id;b.gq=a.gq;b.kk=a.kk;b.ku=a.ku;b.qn=a.qn;b.wq=a.wq;b.xf=a.xf;b.El=[];b.ya=a.ya.slice();b.Ld=a.Ld.slice();b.Eg=a.Eg.slice();b.td=a.td.slice();b.Ij=a.Ij.slice();b.rj=z.P(a.rj);b.Zc=z.P(a.Zc);b.yb=a.yb;b.hb=z.P(a.hb);b.ik=a.ik;b.Kp=sa.WR(a.Kp);
b.Ba=a.Ba;b.Ge=a.Ge;b.Gi=a.Gi;b.lu=a.lu;b.Gr=a.Gr;b.om=a.om;b.Cv=a.Cv;b.Dv=a.Dv;b.Zu=a.Zu;b.er=a.er;b.ge=a.ge;b.ue=a.ue;b.Ag=a.Ag;b.Kb=a.Kb;b.Ua=a.Ua;b.th=a.th;b.Xb=a.Xb;b.Fe=a.Fe;b.Vf=a.Vf;b.Ce=a.Ce;b.me=a.me;b.ce=a.ce;b.be=a.be;b.Hd=a.Hd;b.Gd=a.Gd;b.jd=a.jd;b.ru=a.ru;b.Ih=a.Ih;b.of=a.of;b.Zf=a.Zf;b.Mj=a.Mj;b.Gg=a.Gg;b.af=a.af;b.Yg=a.Yg;b.Zg=a.Zg;b.Rd=a.Rd;b.Ed=a.Ed;b.dv=a.dv;b.hv=a.hv;b.ev=a.ev;b.iv=a.iv;b.jv=a.jv;ma.copy(a.gv,b.gv);ma.copy(a.fv,b.fv);b.gr=a.gr;b.yj=a.yj;b.Oj=a.Oj;b.Gl=a.Gl;b.lo=
a.lo;b.Co=a.Co;b.qs=a.qs;b.eo=a.eo;b.Fl=a.Fl;b.il=a.il;b.Zv=a.Zv;b.Cr=a.Cr;b.kg=a.kg;b.vw=a.vw;b.Td[0]=a.Td[0];b.Td[1]=a.Td[1];ma.copy(a.Gk,b.Gk);ma.copy(a.gi,b.gi);ma.copy(a.Em,b.Em);Ea.copy(a.Uf,b.Uf);Ea.copy(a.Li,b.Li);b.hm=z.P(a.hm);a.Un&&(b.Un=new Float32Array(a.Un),b.vr=new Float32Array(a.vr),b.ur=new Float32Array(a.ur));b.Vj=a.Vj;ma.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.sj=a.sj;b.water_dynamic=a.water_dynamic;b.Ms=a.Ms;b.Ax=a.Ax;b.Bx=a.Bx;b.Cx=a.Cx;b.zx=a.zx;b.ap=a.ap;b.uo=
a.uo;b.wo=a.wo;b.An=a.An;b.Cu.set(a.Cu);b.Bu.set(a.Bu);b.Oq.set(a.Oq);ma.copy(a.so,b.so);ma.copy(a.vo,b.vo);b.$i=z.P(a.$i);b.uk=a.uk;b.gb=z.P(a.gb);b.Fv=a.Fv;a.jl&&(b.jl=new Float32Array(a.jl));b.Lr=z.P(a.Lr);b.Zi=z.P(a.Zi);b.eh=z.P(a.eh);b.ze=z.P(a.ze);b.dh=z.P(a.dh);b.O=H.vl(a.O);b.Ta=H.vl(a.Ta);b.aa=H.eq(a.aa);b.pb=H.eq(a.pb);b.xa=H.wl(a.xa);b.kb=H.wl(a.kb);b.Nf=a.Nf;b.Tf=a.Tf;b.bo=a.bo;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.Eb=a.Kb?a.th?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.Eb=a.me?"CAST":"RECEIVE";break;case "COLOR_ID":a.Eb=a.th?"COLOR_ID_XRAY":"COLOR_ID"}}function t(a,b,c){var e=[],d=m(c,b,!b.tn,!1),f=a.data,h=f.materials,k=Array(h.length),l=Array(h.length),v=[],u=za.ec(c,ta.Pb),g=!1;u&&(g=u.yr.length?!0:!1);for(var H=0;H<d.length;H++)for(var F=d[H],M=0;M<h.length;M++){var U=h[M];if(!la.gJ(f,M))if("PHYSICS"==F&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)v.push(la.BA(f,M,[],b.zi,{},null));else if(!U.b4w_lens_flares||g){var w=n(F);
"MAIN"==F?k[M]=w:"DEBUG_VIEW"==F&&(l[M]=w);w.gq=a.b4w_cluster_data.cluster_id;if(q(w,U)){"SHADOW"==F&&k[M]&&(w.Fe=k[M].Fe);w.Ih=b.Ge||b.Vf?la.Us:la.Wm;E(w,b);for(var S=w,J=a.particle_systems,Q=0;Q<J.length;Q++){var p=J[Q].settings.b4w_vcol_from_name,Y=J[Q].settings.b4w_vcol_to_name;""!==p&&""!==Y&&(S.Zc[p]={Tl:!1,src:[{name:p,eg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==w.type)w.kk=a.uuid;w.Mj=a.b4w_do_not_cull;"MAIN"==w.type&&(w.Gg=a.b4w_caustics);A(w,"DISABLE_FOG",("COLOR_ID"!=F&&"SHADOW"!=F&&a.b4w_disable_fogging)|
0);var fa=la.BA(f,M,w.Ij,b.zi,w.Zc,w.rj);!U.use_tangent_shading||"a_shade_tangs"in fa.Z[0]||(A(w,"CALC_TBN",1),y(w,"a_tbn_quat"));U.b4w_lens_flares&&(fa=pa.fX(fa));ba(w);e.push({za:w,bf:b,Jt:b,Jf:fa,fg:[U.name],Id:[a]})}}}if(v.length){w=n("PHYSICS");w.Eb="NAVMESH";w.kk=a.uuid;for(var fa=la.tM(v),V=[],H=0;H<h.length;H++)V.push(h[H].name);ba(w);e.push({za:w,bf:b,Jt:b,Jf:fa,fg:V,Id:[a]})}for(H=0;H<l.length;H++)l[H]&&(l[H].qn=k[H].id,ba(l[H]));var C=a.particle_systems;if(0<C.length&&e.length){for(var ja=
!1,Z=!1,H=0;H<C.length;H++){var t=C[H],aa=t.settings;aa.use_render_emitter&&(ja=!0);"HAIR"!=aa.type||"OBJECT"!=aa.render_type&&"GROUP"!=aa.render_type&&t.transforms.length||(Z=!0);if(ja&&Z)break}var O=e[0].za.Zc,oa;if(Z){var D;if(1<h.length){for(var r={},ca=0;ca<C.length;ca++){var sa=C[ca].settings;if("HAIR"==sa.type&&("OBJECT"==sa.render_type||"GROUP"==sa.render_type)){var G=sa.b4w_vcol_from_name,K=sa.b4w_vcol_to_name;""!==G&&""!==K&&(r[G]=z.P(O[G]))}}"a_bending_col_main"in O&&(r.a_bending_col_main=
z.P(O.a_bending_col_main));"a_bending_col_detail"in O&&(r.a_bending_col_detail=z.P(O.a_bending_col_detail));D=la.FH(f,[],r)}else D=e[0].Jf;oa=D}else oa=null;for(var B=oa,Ea=a.nb,I=[],N=a.particle_systems,L=a.data,ya=0;ya<N.length;ya++){var wb=N[ya],Va=wb.settings;if(Va.count)if("EMITTER"==Va.type){if("DYNAMIC"==b.type){var Ga=n("PARTICLES");Ga.xa=b.xa;Ga.O=b.O;Ga.aa=b.aa;Ga.kb=b.kb;Ga.Ta=b.Ta;Ga.pb=b.pb;var xb,Sc=L.materials,Xb=wb.settings.material-1;Xb>=Sc.length&&(ha.warn('Wrong material used for rendering particle system "'+
wb.name+'"'),Xb=0);xb=Sc[Xb];"HALO"===wb.settings.render_type&&"HALO"===xb.type&&(Ga.gr=!0);x(Ga,xb);var na=Ga,Ha=a,Da=wb.settings;switch(Da.b4w_billboard_align){case "VIEW":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:z.q("Wrong billboard align value")}A(na,"BILLBOARD",0);var ra=Da.b4w_enable_soft_particles&&
ua.uG(Ha,Da);A(na,"SOFT_PARTICLES",0<Da.b4w_particles_softness&&ra&&ea.pu?1:0);A(na,"SOFT_STRENGTH",X.M(Da.b4w_particles_softness));X.ga(na.hb,"WORLD_SPACE","WORLD"==Da.b4w_coordinate_system?1:0);Ga.Vf=!0;Ga.Mj=a.b4w_do_not_cull;Ga.kk=Ea.name+"_"+Va.uuid;pa.xV(Ga,wb,xb);var Ra=pa.sU(Ga,L,wb,Ea.k);pa.SZ(Ra,Ga,Va.count);pa.RZ(Ea);E(Ga,Ea.k);ba(Ga);I.push({za:Ga,bf:b,Jt:b,Jf:Ra,fg:[xb.name],Id:[a]})}}else if("HAIR"==Va.type){var wa=z.rv(wb.seed),Ka=qa.vG(ea.BB)&&!Va.b4w_initial_rand_rotation&&!Va.b4w_hair_billboard,
xa=4;Ka&&(xa=8);if(wb.transforms.length)var va=wb.transforms;else for(var Na=la.HA(B,Va.count,!1,wa),va=new Float32Array(Na.length*xa),kb=0;kb<Na.length;kb++){var Yc=.75+.5*z.og(wa);va[kb*xa]=Na[kb][0];va[kb*xa+1]=Na[kb][1];va[kb*xa+2]=Na[kb][2];va[kb*xa+3]=Yc;Ka&&(va[kb*xa+4]=1,va[kb*xa+5]=0,va[kb*xa+6]=0,va[kb*xa+7]=0)}var zc=za.ec(c,ta.ri)?!0:!1;if("OBJECT"==Va.render_type){var mc=[m(c,Va.dupli_object.nb.k,!b.tn,!0)],Sb=R(a,b,O,B,[Va.dupli_object],mc,[va],Va,wb,zc,wa,!1);I.push.apply(I,Sb)}else if("GROUP"==
Va.render_type){for(var Pb=Va.dupli_group.objects,mc=[],kb=0;kb<Pb.length;kb++){var nc=m(c,Pb[kb].nb.k,!b.tn,!0);mc.push(nc)}for(var Ec=!1,Hb=[],kb=0;kb<Pb.length;kb++)Hb.push(Pb[kb].nb);if(Va.use_whole_group){for(var oc,pb=va,db=Hb,bc=Ka,Zc=xa,Cb={},Tb=new Float32Array([0,0,0,1]),gb=0;gb<pb.length;gb+=Zc)for(var ob=0;ob<db.length;ob++){var Fc=ma.create();ma.scale(P.F(db[ob].k.n),P.Yd(db[ob].k.n),Fc);var pc=ma.clone([pb[gb],pb[gb+1],pb[gb+2]]);Cb[ob]||(Cb[ob]=new Float32Array(pb.length));bc&&(Cb[ob][gb+
4]=Tb[0]=pb[gb+4],Cb[ob][gb+5]=Tb[1]=pb[gb+5],Cb[ob][gb+6]=Tb[2]=pb[gb+6],Cb[ob][gb+7]=Tb[3]=pb[gb+7],z.qC(Tb,Tb),z.mZ(Fc,Tb,Fc));ma.add(pc,Fc,pc);Cb[ob][gb]=pc[0];Cb[ob][gb+1]=pc[1];Cb[ob][gb+2]=pc[2];Cb[ob][gb+3]=pb[gb+3]}oc=Cb;Ec=!0}else{var Gc;if(Va.use_group_count){for(var Ib=va,qc=Hb,cc=Va.dupli_weights,Ya=wa,dc=Ka,Jb=xa,rb={},rc=[],sb=0;sb<qc.length;sb++)for(var Kb=qc[sb],Ub=Kb.pm||Kb.name,wc=0;wc<cc.length;wc++){var Hc=cc[wc];Ub==Hc.name&&rc.push(Hc)}cc.length!=rc.length&&ha.error("dupli weights match failed");
for(sb=0;sb<Ib.length;sb+=Jb){for(var Ja,gc=rc,Db=[0],Eb=0;Eb<gc.length;Eb++)Db[Eb+1]=Db[Eb]+gc[Eb].count;for(var Ac=Db[Db.length-1]*z.og(Ya),Vb=0,Eb=0;Eb<Db.length;Eb++)if(Ac>=Db[Eb]&&Ac<Db[Eb+1]){Vb=Eb;break}Ja=Vb;rb[Ja]=rb[Ja]||[];rb[Ja].push(Ib[sb],Ib[sb+1],Ib[sb+2],Ib[sb+3]);dc&&rb[Ja].push(Ib[sb+4],Ib[sb+5],Ib[sb+6],Ib[sb+7])}for(Ja in rb)rb[Ja]=new Float32Array(rb[Ja]);Gc=rb}else{for(var lb=va,hb=wa,Ia=Ka,Zb=xa,Fb=Hb.length,La={},Ma=0;Ma<lb.length;Ma+=Zb){var nb=Math.floor(Fb*z.og(hb));La[nb]=
La[nb]||[];La[nb].push(lb[Ma],lb[Ma+1],lb[Ma+2],lb[Ma+3]);Ia&&La[nb].push(lb[Ma+4],lb[Ma+5],lb[Ma+6],lb[Ma+7])}for(nb in La)La[nb]=new Float32Array(La[nb]);Gc=La}oc=Gc}Sb=R(a,b,O,B,Pb,mc,oc,Va,wb,zc,wa,Ec);I.push.apply(I,Sb)}"INSTANCE"==Va.b4w_wind_bend_inheritance&&Ea.k.nf&&ha.warn('Emitter object "'+Ea.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else z.q("Unknown particle settings type")}ja?
e.push.apply(e,I):e=I}return e}function p(a){for(var b=[],c=[],e={},d=0;d<a.length;d++){var f=a[d].za,h=null;if(f.id in e){var k=e[f.id],l=c[k].za;J(f,function(a){J(l,function(b){z.VY(a,b)&&1!=a.qJ&&(h=c[k])})});if(!h){do f.id++;while(e[f.id])}}h||(h={za:f,pK:[],OF:[],vM:[],Id:[],TK:[],fg:[]},e[f.id]=c.length,c.push(h));if(a[d].Jf&&a[d].Jf.Ka){h.pK.push(a[d].bf);h.OF.push(a[d].Jt);h.vM.push(a[d].Jf);for(var v=0;v<a[d].Id.length;v++)f=a[d].Id[v],-1==h.TK.indexOf(f.uuid)&&(h.Id.push(f),h.TK.push(f.uuid));
for(v=0;v<a[d].fg.length;v++)f=a[d].fg[v],-1==h.fg.indexOf(f)&&h.fg.push(f)}h.fg.sort()}for(d=0;d<c.length;d++){var f=c[d].za,u=c[d].pK,g=c[d].OF,q=c[d].vM;a=ua.Jz(g[0]);if("STATIC"==a.type)for(v=0;v<u.length;v++){var m=u[v],F=g[v],e=q[v],M=P.identity(va);m.Cg&&!m.Pp?(m=P.fc(m.n,Da),P.ff(m,M)):P.copy(m.n,M);F.dm?e.Ef||(F.Cg?la.XY(e,M):la.cx(e,M)):la.cx(e,M);if(F.dm)A(f,"AU_QUALIFIER","GLSL_IN");else if(1<c[d].Id.length){m={};if(F.nf||F.Cg)m.au_center_pos=[M[0],M[1],M[2]];F.nf&&(m.au_wind_bending_amp=
[F.rh],m.au_wind_bending_freq=[F.sh],m.au_detail_bending_amp=[F.Kg],m.au_detail_bending_freq=[F.Lg],m.au_branch_bending_amp=[F.Fg]);la.WY(e,m);A(f,"AU_QUALIFIER","GLSL_IN")}else a.Zp.set(M.subarray(0,3)),F.Zp.set(M.subarray(0,3)),A(f,"AU_QUALIFIER","uniform")}if(0==q.length)e=la.Df(z.ws("%empty"));else if(1==q.length)e=q[0];else{e=[];for(v=0;v<q.length;v++)la.IV(q[v])||e.push(v);if(e.length<q.length)for(v=0;v<e.length;v++)la.dx(q[e[v]]);e=la.tM(q)}if(1<c[d].Id.length){q=[];for(v=0;v<c[d].Id.length;v++)H.AA(c[d].Id[v].nb.k.QF,
q);H.PF(q,a.Ta);H.ln(a.Ta,a.O);a.pb=H.au(z.yf(q),!0);H.Pz(a.pb,a.aa);a.kb=H.qq(a.pb);H.Rz(a.kb,a.xa)}a.Nf=H.oB(a.aa,a.xa);"STATIC"==a.type&&a.Pn&&(v=c[d].Id[0].b4w_cluster_data,v.cluster_center&&v.cluster_radius?(a.zr.set(v.cluster_center),a.Ar=v.cluster_radius):(a.zr.set(a.kb.G),a.Ar=a.kb.Xa));"PARTICLES"!=f.type&&(v=e.Kf,f.O=H.vl(v.O),f.aa=H.eq(v.aa),f.xa=a.xa.Xa<v.xa.Xa?"STATIC"==a.type?H.wl(a.kb):H.wl(a.xa):H.wl(v.xa),"STATIC"==a.type?(f.pb=f.aa,f.Ta=f.O,f.kb=f.xa):(v=a.n,f.pb=H.Sp(f.aa,v),f.kb=
H.Tp(f.xa,v),f.Ta=H.tl(f.O,v)),f.Nf=H.oB(f.aa,f.xa));b.push({za:f,k:a,Jf:e,fg:c[d].fg,Id:c[d].Id})}return b}function B(a,b,c,e){a.Np=H.TF(b,e);a.Lp=H.RF(c,e);a.Mp=H.SF(b,e)}function m(a,b,c,e){var d=[];e||(b.yk&&za.ec(a,ta.pf)||b.Uc&&za.ec(a,ta.yg))&&d.push("COLOR_ID");c&&(d.push("MAIN"),d.push("NODES_GLOW"),za.ec(a,ta.rf)&&d.push("DEBUG_VIEW"),za.ec(a,ta.tf)&&d.push("SHADOW"),za.ec(a,ta.ri)&&d.push("GRASS_MAP"));d.push("PHYSICS");if(b.me||b.Hd)for(a=null,b.me&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Hd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?z.EQ(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function x(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)G(a,b,"MAIN");else{h(a,b);c=b.game_settings.alpha_blend;a.th=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.kg=b.offset_z;a.gi.set([1,1,1]);var e=b.texture_slots;Ea.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.Uf);if(b.b4w_lens_flares){V(a,"lens_flares.glslv","lens_flares.glslf");y(a,"a_position");y(a,"a_texcoord");var d=oa.fe(e[0]),k=e[0].texture;U(a,d,"u_sampler",k.name)}else{V(a,"main.glslv","main_stack.glslf");b.use_shadeless||(c=ja.Yz(b.uuid,b.name,{Fe:b.use_shadeless,Aq:b.diffuse_shader,rs:b.specular_shader,Nm:b.use_tangent_shading}),a.hb.jg=ja.Xt(c));var v=w("use_map_color_diffuse",e),q=w("use_map_color_spec",e),m=w("use_map_normal",e),H=w("use_map_mirror",e),F=w("use_stencil",e);c=v[0];
q=q[0];m=m[0];H=H[0];v=v[1];e=F[0]&&w("use_rgb_to_intensity",e)[0];if(c){k=c.texture;switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}d=oa.fe(c);U(a,d,"u_colormap0",k.name);a.Fl=c.diffuse_color_factor;a.il=c.use_map_alpha?c.alpha_factor:0;a.gi.set(c.scale)}F=c&&c==q;q&&(F||(k=q.texture,d=oa.fe(q),U(a,d,"u_specmap0",k.name)),a.Co=q.specular_color_factor);if(m&&(k=m.texture,y(a,"a_tbn_quat"),
d=oa.fe(m),U(a,d,"u_normalmap0",k.name),a.Zv=m.normal_factor,k.b4w_use_map_parallax&&ea.gw)){var d=X.M(k.b4w_parallax_steps),M=X.M(k.b4w_parallax_lod_dist);A(a,"PARALLAX",1);A(a,"PARALLAX_STEPS",d);A(a,"PARALLAX_LOD_DIST",M);a.eo=k.b4w_parallax_scale}H&&(k=H.texture,d=oa.fe(H),U(a,d,"u_mirrormap",k.name),a.Cr=H.mirror_factor);if(H=c&&v&&e?1:0)d=oa.fe(v),k=v.texture,U(a,d,"u_colormap1",k.name),d=oa.fe(e),k=e.texture,U(a,d,"u_stencil0",k.name);(k=c||q||m)&&a.gi.set(k.scale);A(a,"TEXTURE_SPEC",void 0==
q?0:1);A(a,"ALPHA_AS_SPEC",F?1:0);A(a,"TEXTURE_STENCIL_ALPHA_MASK",H);y(a,"a_position");y(a,"a_tbn_quat");(c||q||m)&&y(a,"a_texcoord");if(b.b4w_water){a.sj=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Kb?(ha.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.Ms=!1):a.Ms="REFLECT"!=a.Eb?b.b4w_water_shore_smoothing:!1;V(a,"water.glslv","water.glslf");H=ja.Yz(b.uuid,b.name,{Fe:!1,Aq:b.diffuse_shader,rs:b.specular_shader,Nm:b.use_tangent_shading});
a.hb.jg=ja.Xt(H);y(a,"a_position");ea.CN?(y(a,"a_polyindex"),a.Ua=!0,ma.set(0,0,0,a.wireframe_edge_color),u.XA()?A(a,"DEBUG_WIREFRAME",1):A(a,"DEBUG_WIREFRAME",2)):A(a,"DEBUG_WIREFRAME",0);F=b.texture_slots;H=w("use_map_normal",F);d=w("use_map_mirror",F)[0];H.length&&(M=oa.fe(H[0]),k=H[0].texture,U(a,M,"u_normalmap0",k.name),a.ap=b.b4w_water_norm_uv_velocity);A(a,"NUM_NORMALMAPS",H.length);a.$i=Array(H.length);for(k=0;k<H.length;k++)a.$i[k]=new Float32Array(2),a.$i[k].set([H[k].scale[0],H[k].scale[1]]);
d&&(M=oa.fe(d),k=d.texture,U(a,M,"u_mirrormap",k.name),a.Cr=d.mirror_factor);d=null;if(ea.Nq)for(k=0;k<F.length;k++){var n=F[k];if(!0===n.texture.b4w_water_foam){d=n;break}}d&&(A(a,"FOAM",1),M=oa.fe(d),k=d.texture,U(a,M,"u_foam",k.name),a.An=b.b4w_foam_factor,a.Cu.set(k.b4w_foam_uv_freq),a.Bu.set(k.b4w_foam_uv_magnitude),a.Oq[0]=d.scale[0],a.Oq[1]=d.scale[1]);for(k=0;k<F.length;k++)if(n=F[k],!0===n.texture.b4w_shore_dist_map){var S=n;break}S&&ea.At&&(F=oa.fe(S),k=S.texture,U(a,F,"u_shore_dist_map",
k.name),A(a,"SHORE_PARAMS",1),S=n.texture.b4w_shore_boundings,A(a,"MAX_SHORE_DIST",X.M(n.texture.b4w_max_shore_dist)),A(a,"SHORE_MAP_SIZE_X",X.M(S[0]-S[1])),A(a,"SHORE_MAP_SIZE_Y",X.M(S[2]-S[3])),A(a,"SHORE_MAP_CENTER_X",X.M((S[0]+S[1])/2)),A(a,"SHORE_MAP_CENTER_Y",X.M((S[2]+S[3])/2)));b.b4w_generated_mesh?(A(a,"GENERATED_MESH",1),a.Ax=!0,a.Bx=b.b4w_water_num_cascads,a.Cx=b.b4w_water_subdivs,a.zx=b.b4w_water_detailed_dist):(y(a,"a_tbn_quat"),(d||H.length)&&y(a,"a_texcoord"),A(a,"GENERATED_MESH",0));
if(b.b4w_water_dynamic){var n=X.M(b.b4w_water_dst_noise_scale0),S=X.M(b.b4w_water_dst_noise_scale1),H=X.M(b.b4w_water_dst_noise_freq0),F=X.M(b.b4w_water_dst_noise_freq1),k=X.M(b.b4w_water_dir_min_shore_fac),d=X.M(b.b4w_water_dir_freq),M=X.M(b.b4w_water_dir_noise_scale),J=X.M(b.b4w_water_dir_noise_freq),Q=X.M(b.b4w_water_dir_min_noise_fac),p=X.M(b.b4w_water_dst_min_fac),fa=X.M(b.b4w_water_waves_hor_fac);A(a,"DST_NOISE_SCALE_0",n);A(a,"DST_NOISE_SCALE_1",S);A(a,"DST_NOISE_FREQ_0",H);A(a,"DST_NOISE_FREQ_1",
F);A(a,"DIR_MIN_SHR_FAC",k);A(a,"DIR_FREQ",d);A(a,"DIR_NOISE_SCALE",M);A(a,"DIR_NOISE_FREQ",J);A(a,"DIR_MIN_NOISE_FAC",Q);A(a,"DST_MIN_FAC",p);A(a,"WAVES_HOR_FAC",fa)}C(a,b);K(a,b);a.so.set(b.b4w_shallow_water_col);a.vo.set(b.b4w_shore_water_col);a.uo=b.b4w_shallow_water_col_fac;a.wo=b.b4w_shore_water_col_fac;A(a,"ABSORB",X.M(b.b4w_water_absorb_factor));A(a,"SSS_STRENGTH",X.M(b.b4w_water_sss_strength));A(a,"SSS_WIDTH",X.M(b.b4w_water_sss_width))}"HALO"===b.type&&(V(a,"halo.glslv","halo.glslf"),g(a,
b),a.Ij=["a_position"]);b.use_tangent_shading&&(A(a,"USE_TBN_SHADING",1),y(a,"a_shade_tangs"));A(a,"TEXCOORD",0);A(a,"NORMAL_TEXCOORD",0);c&&l(a,c,"TEXTURE_COLOR0_CO");v&&l(a,v,"TEXTURE_COLOR1_CO");e&&l(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");q&&l(a,q,"TEXTURE_SPEC_CO");m&&l(a,m,"TEXTURE_NORM_CO");A(a,"SHADELESS",b.use_shadeless?1:0);a.Fe=b.use_shadeless}c=b.game_settings.alpha_blend;A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(A(a,"VERTEX_COLOR",1),y(a,"a_color")):A(a,"VERTEX_COLOR",0);a.yj=b.ambient;a.Gl=b.diffuse_intensity;a.Oj=b.emit;a.Em.set(b.specular_color);a.qs=b.specular_alpha;C(a,b);K(a,b);b.b4w_wettable?A(a,"WETTABLE",1):A(a,"WETTABLE",0);f(a,b);b.b4w_refractive&&!a.Kb?(ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.uk=!1):a.uk=b.b4w_refractive;a.vw=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=G(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(h(a,b),a.Kb)c=!1;else{q=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==q?G(a,b,"SHADOW"):V(a,"shadow.glslv","shadow.glslf");Ea.set(0,0,0,b.alpha,a.Uf);y(a,"a_position");y(a,"a_tbn_quat");A(a,"ALPHA","OPAQUE"===q?0:1);a.gi.set([1,1,1]);if((c=w("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===q){switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.gi.set(c.scale);
A(a,"TEXTURE_COLOR",1);y(a,"a_texcoord");q=oa.fe(c);c=c.texture;"IMAGE"!=q.source&&"ENVIRONMENT_MAP"!=q.source&&"CANVAS"!=q.source&&"NONE"!=q.source||U(a,q,"u_colormap0",c.name)}else A(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.Es=b.b4w_use_ghost,a.$b=b.b4w_collision_id,a.jq=b.b4w_collision_margin,a.hq=b.b4w_collision_group,a.kq=b.b4w_collision_mask,a.Pl=b.physics.friction,a.Jl=b.physics.elasticity,c=!0):b.b4w_water?(a.sj=!0,a.x_=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)c=!1;else{h(a,b);a.of=!1;a.Ua=!0;a.Kb=!1;q=b.game_settings.alpha_blend;a.th=b.b4w_render_above_all&&"OPAQUE"!=q&&"CLIP"!=q;b.use_nodes&&"CLIP"==q?G(a,b,"COLOR_ID"):V(a,"color_id.glslv","color_id.glslf");Ea.set(0,0,0,b.alpha,a.Uf);y(a,"a_position");A(a,"ALPHA","OPAQUE"===q?0:1);a.gi.set([1,1,1]);c=w("use_map_color_diffuse",b.texture_slots)[0];q="CLIP"===q?1:0;A(a,"ALPHA_CLIP",q);if(c&&q){switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.gi.set(c.scale);A(a,"TEXTURE_COLOR",1);y(a,"a_texcoord");q=oa.fe(c);c=c.texture;"IMAGE"!=q.source&&"ENVIRONMENT_MAP"!=q.source&&"CANVAS"!=q.source&&"NONE"!=q.source||U(a,q,"u_colormap0",c.name)}else A(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(h(a,b),a.Kb=!1,a.of=!1,a.Ua=!0,V(a,"grass_map.glslv","grass_map.glslf"),y(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,q=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.Zc.a_grass_size={Tl:!0,src:[]},c?(a.Zc.a_grass_size.src.push({name:c,eg:4}),A(a,"DYNAMIC_GRASS_SIZE",1)):A(a,"DYNAMIC_GRASS_SIZE",0),a.Zc.a_grass_color={Tl:!0,src:[]},q?(a.Zc.a_grass_color.src.push({name:q,eg:7}),A(a,"DYNAMIC_GRASS_COLOR",1)):A(a,"DYNAMIC_GRASS_COLOR",0),A(a,"GRASS_TEXTURE_SIZE",X.M(na.fr)),c=!0);break;case "DEBUG_VIEW":c=O(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.gr)V(a,"particle_system.glslv","particle_system_stack.glslf"),
A(a,"HALO_PARTICLES",1),g(a,b);else{q={Fe:!1,Aq:b.diffuse_shader,rs:b.specular_shader,Nm:b.use_tangent_shading};if(b.use_nodes){V(a,"particle_system.glslv","particle_system.glslf");G(a,b,"PARTICLES");c=!0;break a}V(a,"particle_system.glslv","particle_system_stack.glslf");q=ja.Yz(b.uuid,b.name,q);a.hb.jg=ja.Xt(q);if(c=w("use_map_color_diffuse",c)[0]){A(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.Fl=c.diffuse_color_factor;a.il=c.use_map_alpha?c.alpha_factor:0;q=oa.fe(c);U(a,q,"default"+String(a.ya.length),c.texture.name)}}Ea.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Uf);a.yj=b.ambient;a.Gl=b.diffuse_intensity;a.Oj=b.emit;a.Em.set(b.specular_color);a.qs=b.specular_alpha;y(a,"a_position");y(a,"a_tbn_quat");c=b.game_settings.alpha_blend;A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);C(a,b);K(a,b);h(a,b);c=b.game_settings.alpha_blend;a.th=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.kg=b.offset_z;c=!0}break;default:z.q("Wrong batch type: "+a.type)}return c}function g(a,b){var c=b.halo;A(a,"NUM_RINGS",c.ring_count);A(a,"NUM_LINES",c.line_count);A(a,"NUM_STARS",c.star_tip_count);A(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.hv=c.size;a.ev=c.hardness/20;a.gv.set(c.b4w_halo_rings_color);a.fv.set(c.b4w_halo_lines_color);a.iv=1/b.b4w_halo_stars_blend_height;a.jv=b.b4w_halo_stars_min_height;
a.dv=!0}function l(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":A(a,c,"TEXTURE_COORDS_UV_ORCO");A(a,"TEXCOORD",1);break;case "NORMAL":A(a,c,"TEXTURE_COORDS_NORMAL");A(a,"NORMAL_TEXCOORD",1);break;default:A(a,c,"TEXTURE_COORDS_NONE")}}function h(a,b){var c=b.game_settings,e=c.alpha_blend;switch(e){case "ALPHA_SORT":a.Kb=!0;a.of=!0;a.Ua=!0;a.Ag=!1;break;case "ALPHA":a.Kb=!0;a.of=!1;a.Ua=!0;a.Ag=!1;break;case "CLIP":a.Kb=!1;a.of=!1;a.Ua=!0;a.Ag=!0;break;case "ADD":a.Kb=!0;a.of=!1;a.Ua=!1;a.Ag=
!1;break;case "OPAQUE":a.Kb=!1;a.of=!1;a.Ua=!0;a.Ag=!1;break;default:z.q("Unknown alpha blend mode: "+e)}a.Xb=c.use_backface_culling}function w(a,b){for(var c=[],e=b.length,d=0;d<e;d++){var f=b[d];1==f[a]&&f.texture&&f.texture.s&&c.push(f)}return c}function f(a,b){var c=b.raytrace_transparency;a.Li[0]=c.fresnel;a.Li[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.lo=c.reflect_factor;a.Li[2]=c.fresnel;a.Li[3]=1-c.fresnel_factor/5}function C(a,b){var c,e=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;e=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;e=b.specular_hardness;break;default:ha.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Gk[0]=b.specular_intensity;a.Gk[1]=c;a.Gk[2]=e}function K(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Td[0]=0;a.Td[1]=0;break;case "OREN_NAYAR":a.Td[0]=b.roughness;a.Td[1]=0;break;case "FRESNEL":a.Td[0]=
b.diffuse_fresnel;a.Td[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Td[0]=b.darkness;a.Td[1]=0;break;case "TOON":a.Td[0]=b.diffuse_toon_size;a.Td[1]=b.diffuse_toon_smooth;break;default:ha.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Td[0]=0,a.Td[1]=0}}function G(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var e;switch(c){case "MAIN":V(a,"main.glslv","main.glslf");e=!1;break;case "GLOW":V(a,"main.glslv","main.glslf");e=!0;break;case "SHADOW":V(a,
"shadow.glslv","shadow.glslf");e=!1;break;case "COLOR_ID":V(a,"color_id.glslv","color_id.glslf"),e=!1}var d=b.node_tree;c=ja.$R(d,b.uuid,!1,b.name,c);if(!c.Wa)return ha.error('Failed to create node graph for material "'+b.name+'", disable nodes'),I(a,b),!0;a.ik=c.id;a.Vj=!0;A(a,"NODES",1);A(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);y(a,"a_position");b.use_orco_tex_coord&&y(a,"a_orco_tex_coord");h(a,b);a.kg=b.offset_z;var k=b.game_settings.alpha_blend;e?(A(a,"ALPHA",1),A(a,"ALPHA_CLIP",
0)):(A(a,"ALPHA","OPAQUE"===k?0:1),A(a,"ALPHA_CLIP","CLIP"===k?1:0));a.th=b.b4w_render_above_all&&"OPAQUE"!=k&&"CLIP"!=k;a.Oj=b.emit;a.yj=b.ambient;f(a,b);b.b4w_wettable?A(a,"WETTABLE",1):A(a,"WETTABLE",0);var z=null,l=!1;Q.oa(c.Wa,function(c,e){switch(e.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=e.data.name,f=e.data.value;a.rj||(a.rj={});a.rj[f]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=e.data.name;a.Zc[d]={Tl:!0,
src:[{name:e.data.value}]};f=0;if("GEOMETRY_VC"==e.type)f=7;else for(var h=0;h<e.fb.length;h++){var k="RGB".indexOf(e.fb[h].identifier);-1<k&&(f|=1<<2-k)}a.Zc[d].src[0].eg=f;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":y(a,"a_tbn_quat");break;case "TEX_COORD_OB":A(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":A(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":e.data.value.Nm&&(A(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&y(a,"a_shade_tangs"));
y(a,"a_tbn_quat");l=!0;break;case "BSDF_BEGIN":l=!0;y(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=e.data.name;f=e.data.sz;h=e.data.value;U(a,h,d,f);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":A(a,"CALC_TBN_SPACE",1);y(a,"a_tbn_quat");e.data&&(d=e.data.name,f=e.data.sz,h=e.data.value,U(a,h,d,f));break;case "NORMAL_MAP":y(a,"a_tbn_quat");switch(Number(e.Rb[0][1])){case ja.DO:A(a,"CALC_TBN_SPACE",1);break;case ja.CO:case ja.BO:A(a,"USE_MODEL_TSR",1)}break;case "LAMP":e.data&&
(a.hm=e.data);break;case "B4W_REFRACTION":a.Kb?a.uk=!0:(a.uk=!1,ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));A(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":z||(z=e.data.jb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&e.data&&(a.Lr=e.data);break;case "VECT_TRANSFORM":switch(Number(e.Rb[1][1])){case ja.TP:A(a,"USE_MODEL_TSR_INVERSE",1);break;case ja.SP:A(a,"USE_VIEW_TSR",1);break;case ja.RP:A(a,"USE_MODEL_TSR",1);break;case ja.QP:A(a,
"USE_MODEL_TSR",1);A(a,"USE_VIEW_TSR",1);break;case ja.PP:A(a,"USE_VIEW_TSR_INVERSE",1);break;case ja.OP:A(a,"USE_MODEL_TSR_INVERSE",1),A(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":A(a,"USE_MODEL_TSR",1);a.bo[1]=b.pass_index;a.bo[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":A(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":A(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":y(a,"a_tbn_quat"),u.XA()?A(a,"USE_DERIVATIVES_EXT",1):ha.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});z&&U(a,z,"u_nodes_texture");l||(a.Fe=!0);e=a.hb.jg=ja.Xt(c.Wa);L(d,a);d=a.eh;c=a.dh;for(k=0;k<e.length;k++){var v=e[k];switch(v.id){case "VALUE":var g=v.hw[0];if(g)for(var q=0;q<d.length;q+=2)if(d[q]==g){v.Rb.push(["VALUE_IND",d[q+1]]);break}break;case "RGB":if(g=v.hw[0])for(q=0;q<c.length;q+=2)if(c[q]==g){v.Rb.push(["RGB_IND",c[q+1]]);break}}}A(a,"NUM_VALUES",a.Zi.length);A(a,"NUM_RGBS",a.ze.length);return!0}function L(a,b){var c=[],e=[],d=[],f=[];D(a,"",c,e,d,f);b.Zi=c;
b.eh=e;b.ze=d;b.dh=f}function D(a,b,c,e,d,f){for(var h=0;h<a.nodes.length;h++){var k=a.nodes[h];if("VALUE"==k.type){var z=N(b,k.name);c.push(k.outputs[0].default_value);e.push(z,e.length/2)}else"RGB"==k.type?(z=N(b,k.name),k=k.outputs[0].default_value.slice(0,3),d.push(k[0],k[1],k[2]),f.push(z,f.length/2)):"GROUP"==k.type&&D(k.node_group.node_tree,N(b,k.name),c,e,d,f)}}function N(a,b){var c;return c=(a?a+"%join%":"")+b}function I(a,b){switch(a.type){case "SHADOW":V(a,"shadow.glslv","shadow.glslf");
break;case "COLOR_ID":V(a,"color_id.glslv","color_id.glslf");break;default:V(a,"main.glslv","main_stack.glslf")}A(a,"SHADELESS",1);y(a,"a_position");y(a,"a_tbn_quat");Ea.set(1,0,1,1,a.Uf);if(b){var c=b.game_settings.alpha_blend;A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"VERTEX_COLOR",0);a.kg=b.offset_z;h(a,b)}return!0}function O(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;V(a,"debug_view.glslv","debug_view.glslf");y(a,"a_position");y(a,"a_tbn_quat");y(a,"a_polyindex");
a.Ua=!0;ma.set(0,0,0,a.wireframe_edge_color);return!0}function E(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.dm?A(a,"AU_QUALIFIER","GLSL_IN"):A(a,"AU_QUALIFIER","uniform"),A(a,"STATIC_BATCH",0)):(A(a,"AU_QUALIFIER","GLSL_IN"),A(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(u.XA()?A(a,"WIREFRAME_QUALITY",1):A(a,"WIREFRAME_QUALITY",0),a.Gi?(A(a,"DEBUG_SPHERE",1),a.lu?A(a,"DEBUG_SPHERE_DYNAMIC",1):A(a,"DEBUG_SPHERE_DYNAMIC",0)):A(a,"DEBUG_SPHERE",0),A(a,"ALPHA",1));b.Ge&&(a.Ge=b.Ge);b.nf?(""!==b.Ui?
(a.Zc.a_bending_col_main={Tl:!0,src:[{name:b.Ui,eg:4}]},y(a,"a_bending_col_main"),""!==b.we.uB&&""!==b.we.tB&&""!==b.we.dC?(a.Zc.a_bending_col_detail={Tl:!0,src:[{name:b.we.uB,eg:4},{name:b.we.tB,eg:2},{name:b.we.dC,eg:1}]},y(a,"a_bending_col_detail"),y(a,"a_tbn_quat"),A(a,"DETAIL_BEND",1)):A(a,"DETAIL_BEND",0),A(a,"MAIN_BEND_COL",1)):A(a,"MAIN_BEND_COL",0),b.pl?A(a,"BEND_CENTER_ONLY",1):A(a,"BEND_CENTER_ONLY",0),A(a,"WIND_BEND",1)):A(a,"WIND_BEND",0);A(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Pp|0);
b.Cg?A(a,"BILLBOARD",1):A(a,"BILLBOARD",0);b.Cg&&b.dm?A(a,"HAIR_BILLBOARD",1):A(a,"HAIR_BILLBOARD",0);b.Qp?A(a,"BILLBOARD_SPHERICAL",1):A(a,"BILLBOARD_SPHERICAL",0);switch(b.Rp){case "RANDOM":A(a,"BILLBOARD_RANDOM",1);A(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":A(a,"BILLBOARD_RANDOM",0);A(a,"BILLBOARD_JITTERED",1);break;default:A(a,"BILLBOARD_RANDOM",0),A(a,"BILLBOARD_JITTERED",0)}b.jd&&ea.At?A(a,"DYNAMIC_GRASS",1):A(a,"DYNAMIC_GRASS",0);a.jd=b.jd;"PARTICLES"!=a.type&&(a.Vf=b.Vf);a.Ce=b.Ce;
a.me=b.me;a.ce=b.ce&&!a.Fe&&!(a.Kb&&ea.qA);a.be=b.be;a.Hd=b.Hd;a.Gd=b.Gd;a.bo[0]=b.kw;a.af=b.af;a.Yg=b.Yg;a.Zg=b.Zg;a.Rd=b.Rd;a.Ed=b.Ed;b.ck?(y(a,"a_influence"),A(a,"SKINNED",1),ea.Qw?(A(a,"DISABLE_TANGENT_SKINNING",1),A(a,"FRAMES_BLENDING",0)):(A(a,"DISABLE_TANGENT_SKINNING",0),b.Ol?A(a,"FRAMES_BLENDING",1):A(a,"FRAMES_BLENDING",0)),A(a,"MAX_BONES",b.$g)):(A(a,"SKINNED",0),A(a,"FRAMES_BLENDING",0),A(a,"DISABLE_TANGENT_SKINNING",0));b.Yc?(A(a,"VERTEX_ANIM",1),ea.vN?A(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):A(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):A(a,"VERTEX_ANIM",0);b.ck&&b.Yc&&z.q("Skinning and vertex animation are mutually exlusive")}}function c(a,b,c){if(b.length){for(var e=ua.Su(b,ea.ssao&&c.b4w_enable_ssao),d=a.hb,f=a.hm,h=0,z=0;z<a.hb.jg.length;z++){var l=a.hb.jg[z];if("LIGHTING_LAMP"==l.id){var v=b[h++%b.length],u=v.Sc,g=ua.ja(v,c);if("SPOT"==u.type||"POINT"==u.type)var q=Math.cos(u.Do/2);if("SPOT"==u.type)var m=u.Zw*(1-q);v=e.indexOf(v);l.Rb=[["LAMP_TYPE",u.type],["LAMP_IND",
g.im],["LAMP_SPOT_SIZE",X.M(q||.01)],["LAMP_SPOT_BLEND",X.M(m||.01)],["LAMP_LIGHT_DIST",X.M(u.distance)],["LAMP_USE_SPHERE",u.UD?1:0],["LAMP_SHADOW_MAP_IND",v]]}else if("LAMP"==l.id&&f)for(var g=l.Rb[0][1],H=0;H<b.length;H++)if(v=b[H],f[v.qj]==g){u=v.Sc;if("SPOT"==u.type||"POINT"==u.type)q=Math.cos(u.Do/2);"SPOT"==u.type&&(m=u.Zw*(1-q));l.Rb.push(["LAMP_TYPE",u.type],["LAMP_SPOT_SIZE",X.M(q||.01)],["LAMP_SPOT_BLEND",X.M(m||.01)],["LAMP_LIGHT_DIST",X.M(u.distance)],["LAMP_USE_SPHERE",u.UD?1:0])}}if(f){c=
0;for(var F in f)c++;a.Un=new Float32Array(3*c);a.vr=new Float32Array(3*c);a.ur=new Float32Array(3*c);X.ga(d,"NUM_LAMP_LIGHTS",c);for(z=0;z<b.length;z++)k(a,b[z])}}}function k(a,b){if(b.qj in a.hm){var c=a.hm[b.qj];a.Un.set(P.F(b.k.n),3*c);a.vr.set(b.Sc.direction,3*c);a.ur.set(b.Sc.lq,3*c)}}function y(a,b){var c=a.Ij;-1==c.indexOf(b)&&c.push(b);a.Ij=c.sort()}function A(a,b,c){X.ga(a.hb,b,c)}function e(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.Eb?a.Ba=la.uM(b,la.Wm,[]):(0<b.ib.length&&la.YY(b,b.Z[0]),
a.Jf=b);else{var c=a.Ih;a.dv&&"PARTICLES"!=a.type&&(b=la.RT(b));a.Ax&&(b=S.pU(a.Bx,a.Cx,a.zx));c=la.uM(b,c,a.Zc);a.Ba=c;a.Vf||a.of||a.Ge||(c.ie=null,c.nc.length=0);c=b.Z.length;a.Gr=b.Ka*c;var e;a:switch(a.Ih){case la.Wm:case la.hp:case la.Us:e=!0;break a;default:e=!1}e?la.HV(b)?a.om=b.ma.length/3*c:a.om=b.Ka/3*c:a.om=0}}function R(a,b,c,e,d,f,h,k,l,v,u,g){var m=a.nb,H=[],F=k.b4w_dynamic_grass;if(!v&&F)return H;for(var M="INSTANCE"==k.b4w_wind_bend_inheritance,w="INSTANCE"==k.b4w_shadow_inheritance,
S="INSTANCE"==k.b4w_reflection_inheritance,U=[],J=[],y=0;y<d.length;y++){var X=d[y].nb.k,Q=ua.Jz(b);Q.Cg=k.b4w_hair_billboard;Q.Rp=k.b4w_hair_billboard_type;Q.Qp="SPHERICAL"==k.b4w_hair_billboard_geometry;Q.jd=F;Q.dm=!0;M?(Q.nf=X.nf,Q.Tm=X.Tm,Q.sh=X.sh,Q.Lg=X.Lg,Q.Ui=X.Ui,Q.Kg=X.Kg,Q.Fg=X.Fg,Q.rh=X.rh,Q.we=X.we,Q.pl=!1):(Q.nf=m.k.nf,Q.Tm=m.k.Tm,Q.sh=m.k.sh,Q.Lg=m.k.Lg,Q.Ui=m.k.Ui,Q.Kg=m.k.Kg,Q.Fg=m.k.Fg,Q.rh=m.k.rh,Q.we=m.k.we,Q.pl=!0);w?(Q.Ce=X.Ce,Q.me=X.me,Q.ce=X.ce):(Q.Ce=m.k.Ce,Q.me=m.k.me,Q.ce=
m.k.ce);S?(Q.be=X.be,Q.Hd=X.Hd,Q.Gd=X.Gd,Q.Rd=X.Rd,Q.Ed=X.Ed,Q.jh=X.jh):(Q.be=m.k.be,Q.Hd=m.k.Hd,Q.Gd=m.k.Gd,Q.Rd=m.k.Rd,Q.Ed=m.k.Ed,Q.jh=m.k.jh);U.push(Q);var p=h[y];p||(p=new Float32Array);g&&z.rv(l.seed,u);var fa=new Float32Array(3),V=new Float32Array([0,0,0,1]),C=[],R=qa.vG(ea.BB)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,ja=4;R&&(ja=8);for(var x=0;x<p.length;x+=ja){fa[0]=p[x];fa[1]=p[x+1];fa[2]=p[x+2];var Z=p[x+3]*P.Yd(X.n);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var ta=
new Float32Array([z.og(u),z.og(u),z.og(u)]);ma.normalize(ta,ta);break;case "Z":ta=new Float32Array([0,0,1]);break;default:z.q("Unsupported random rotation type: "+k.b4w_rotation_type)}Y.setAxisAngle(ta,k.b4w_rand_rotation_strength*(2*Math.PI*z.og(u)-Math.PI),V)}else R&&(V.set(p.subarray(x+4,x+8)),z.qC(V,V),k.use_whole_group||(k.use_rotation_dupli?Y.multiply(V,P.R(X.n),V):Y.multiply(V,Ha,V)));var t=P.ci(fa,Z,V,P.create());C.push(t)}J.push(C)}for(var aa={},O=0,y=0;y<d.length;y++)for(var oa=d[y].data.materials,
x=0;x<oa.length;x++)oa[x].name in aa?aa[oa[x].name]++:(aa[oa[x].name]=1,O++);for(var O=O?O:1,D={},y=0;y<d.length;y++){var r=d[y],ca=f[y],Q=U[y],sa={};Q.nf&&(sa.au_wind_bending_amp=[Q.rh],sa.au_wind_bending_freq=[Q.sh],sa.au_detail_bending_freq=[Q.Lg],sa.au_detail_bending_amp=[Q.Kg],sa.au_branch_bending_amp=[Q.Fg],Q.rh=0,Q.sh=0,Q.Lg=0,Q.Kg=0,Q.Fg=0);C=J[y];if(C.length){for(var G=r.data,oa=G.materials,K=Array(oa.length),B=Array(oa.length),x=0;x<oa.length;x++)if(!la.gJ(G,x))for(var wb=0;wb<ca.length;wb++){var Va=
ca[wb],Ga=n(Va),za=oa[x];"MAIN"==Va?K[x]=Ga:"DEBUG_VIEW"==Va&&(B[x]=Ga);Ga.gq=a.b4w_cluster_data.cluster_id;if(q(Ga,za)){"SHADOW"==Va&&K[x]&&(Ga.Fe=K[x].Fe);Ga.Ih=la.Wm;E(Ga,Q);Ga.kk=k.uuid;Ga.Mj=a.b4w_do_not_cull||k.b4w_dynamic_grass;"MAIN"==Ga.type&&(Ga.Gg=a.b4w_caustics);A(Ga,"DISABLE_FOG",("COLOR_ID"!=Va&&"SHADOW"!=Va&&a.b4w_disable_fogging)|0);"JITTERED"==k.b4w_hair_billboard_type&&(Ga.Cv=k.b4w_hair_billboard_jitter_amp,Ga.Dv=k.b4w_hair_billboard_jitter_freq);F&&(Ga.Zu=k.b4w_dynamic_grass_scale_threshold);
M||(delete Ga.Zc.a_bending_col_main,delete Ga.Zc.a_bending_col_detail);var Ea=la.BA(G,x,Ga.Ij,b.zi,Ga.Zc,Ga.rj),pa=m.k.n,I=!0;if(1<aa[za.name]){var N=0,L;for(L in Ea.Z)N++;I=Ea.ma.length*C.length*N*aa[za.name]>2E5*O}var ya=ea.vF&&I&&"PHYSICS"!=Ga.type;if(ya){Ga.qJ=k.use_whole_group?2:1;var na=z.P(Ea);la.fG(Ea,na,C);na.Ef={So:C,ax:pa,mM:"STATIC"==b.type,us:sa,um:{},tu:F};if(Q.nf&&Q.pl){var Da=ma.fromValues(0,0,0);P.Wc(Da,m.k.n,Da);for(var ra=[],Ra=0;Ra<C.length;Ra++)ra.push(Da[0],Da[1],Da[2]);na.Ef.um.a_emitter_center=
{Gc:3,data:ra}}la.fG(Ea,Ea,C);"STATIC"==b.type&&la.$Q(na.Kf,pa)}else{var wa=na=la.qW(Ea,sa,C),xa=C;wa.pa.au_center_pos=new Float32Array(3*wa.Ka);for(var Ka=xa.length,va=wa.Ka/Ka,Na=0;Na<Ka;Na++)for(var mc=xa[Na],Sb=3*va*Na,Pb=0;Pb<va;Pb++)wa.pa.au_center_pos[Sb+3*Pb]=mc[0],wa.pa.au_center_pos[Sb+3*Pb+1]=mc[1],wa.pa.au_center_pos[Sb+3*Pb+2]=mc[2];na=wa;if(Q.nf&&Q.pl){var nc=na,Ec=m.k.n;nc.pa.a_emitter_center=new Float32Array(3*nc.Ka);var Hb=ma.fromValues(0,0,0);P.Wc(Hb,Ec,Hb);for(var oc=0;oc<nc.Ka;oc++)nc.pa.a_emitter_center[3*
oc]=Hb[0],nc.pa.a_emitter_center[3*oc+1]=Hb[1],nc.pa.a_emitter_center[3*oc+2]=Hb[2];na=nc}}var pb=k.b4w_vcol_from_name,db=k.b4w_vcol_to_name,bc=Ga,Zc=c,Cb=!M,Tb=G,gb=[];if(""!==pb&&""!==db){var ob,Fc=db,pc=bc.Zc,Gc=[],Ib=void 0;for(Ib in pc)for(var qc=pc[Ib].src,cc=0,Ya=0;Ya<qc.length;Ya++){var dc=qc[Ya].eg;Fc==qc[Ya].name&&Gc.push(Ib,dc,cc);cc+=z.ym(dc)}ob=Gc;if(0<ob.length)for(var Jb=0;Jb<ob.length;Jb+=3)gb.push({Iq:pb,vu:7,iw:ob[Jb],jw:ob[Jb+1],su:ob[Jb+2]});else la.kV(bc.Ij,"a_color")&&db==Tb.active_vcol_name&&
gb.push({Iq:pb,vu:7,iw:"a_color",jw:7,su:0})}Cb&&("a_bending_col_main"in Zc&&gb.push({Iq:"a_bending_col_main",vu:4,iw:"a_bending_col_main",jw:4,su:0}),"a_bending_col_detail"in Zc&&gb.push({Iq:"a_bending_col_detail",vu:7,iw:"a_bending_col_detail",jw:7,su:0}));for(var rb=na,rc=C,sb=e,Kb=gb,Ub=Ga.Zc,wc=ya,Hc=!1,Ja=0;Ja<Kb.length;Ja++){var gc=Kb[Ja].Iq,Db=sb.pa[gc];if(Db&&0<Db.length){Hc=!0;break}}if(wc)var Eb=rb.Ef.um;if(Hc){var Ac,Vb=m.k.O,lb=sb.Z[0].a_position,hb=rc,Ia=D,Zb=new Float32Array(3),Fb=
new Float32Array(3),La=new Uint32Array(hb.length);if(!("verts_indices"in Ia)){Ia.Ai=new Float32Array(3);Ia.yi=new Float32Array(3);Ia.YD=new Uint32Array(lb.length/3);Ia.Hr=new Uint32Array(lb.length/3);Ia.Ai[0]=(Vb.max_x-Vb.min_x)/20;Ia.Ai[1]=(Vb.max_y-Vb.min_y)/20;Ia.Ai[2]=(Vb.max_z-Vb.min_z)/20;Ia.yi[0]=Vb.min_x;Ia.yi[1]=Vb.min_y;Ia.yi[2]=Vb.min_z;for(var Ma=0;Ma<lb.length/3;Ma++){var nb=z.trunc((lb[3*Ma]-Ia.yi[0])/Ia.Ai[0]),Oc=z.trunc((lb[3*Ma+1]-Ia.yi[1])/Ia.Ai[1]),Ic=z.trunc((lb[3*Ma+2]-Ia.yi[2])/
Ia.Ai[2]),nb=z.V(nb,0,19),Oc=z.V(Oc,0,19),Ic=z.V(Ic,0,19);Ia.YD[Ma]=Ma;Ia.Hr[Ma]=Ic*Math.pow(20,2)+20*Oc+nb}la.JY(Ia.Hr,Ia.YD,la.Uy,!0);Ia.Om=new Uint32Array(Math.pow(20,3));for(Ma=0;Ma<Ia.Hr.length;Ma++)Ia.Om[Ia.Hr[Ma]]++;delete Ia.Hr;for(Ma=1;Ma<Ia.Om.length;Ma++)Ia.Om[Ma]+=Ia.Om[Ma-1]}for(var tb=0;tb<hb.length;tb++){Zb[0]=hb[tb][0];Zb[1]=hb[tb][1];Zb[2]=hb[tb][2];for(var Bc=1E10,Wb=-1,ec=z.trunc((Zb[0]-Ia.yi[0])/Ia.Ai[0]),fd=z.trunc((Zb[1]-Ia.yi[1])/Ia.Ai[1]),$c=z.trunc((Zb[2]-Ia.yi[2])/Ia.Ai[2]),
ec=z.V(ec,0,19),fd=z.V(fd,0,19),$c=z.V($c,0,19),Tc=$c*Math.pow(20,2)+20*fd+ec,ad=Ia.Om[Tc],ub=0==Tc?0:Ia.Om[Tc-1];ub<ad;ub++){var Pc=Ia.YD[ub];Fb[0]=lb[3*Pc];Fb[1]=lb[3*Pc+1];Fb[2]=lb[3*Pc+2];ma.sub(Fb,Zb,Fb);var qb=ma.sqrLen(Fb);qb<=Bc&&(Bc=qb,Wb=Pc)}if(-1==Wb)for(ub=0;ub<lb.length/3;ub++)Fb[0]=lb[3*ub],Fb[1]=lb[3*ub+1],Fb[2]=lb[3*ub+2],ma.sub(Fb,Zb,Fb),qb=ma.sqrLen(Fb),qb<=Bc&&(Bc=qb,Wb=ub);La[tb]=Wb}Ac=La;for(var gd=rb.Ka/rc.length,Ja=0;Ja<Kb.length;Ja++){var Wa=Kb[Ja].iw,$a=Kb[Ja].jw,gc=Kb[Ja].Iq,
Uc=Kb[Ja].vu,Db=sb.pa[gc];switch(Wa){case "a_bending_col_main":var hc=1;break;case "a_bending_col_detail":hc=3;break;case "a_color":hc=3;break;default:for(var Qb=hc=0;Qb<Ub[Wa].src.length;Qb++)hc+=z.ym(Ub[Wa].src[Qb].eg)}if(Db&&0<Db.length){var bd=z.ym(Uc),zd=z.ym($a),Qc=Uc&$a,xc=z.$K(Qc);Qc!=$a&&ha.error("Wrong color extraction from "+gc+" to "+Wa+".");if(wc)for(Eb[Wa]={Gc:hc,data:[]},Qb=0;Qb<rc.length;Qb++)for(Jc=Ac[Qb],ic=Jc*bd,Bb=0;Bb<xc.length;Bb++)xc[Bb]&&(Kc=z.oo(Uc,Bb),Eb[Wa].data.push(Db[ic+
Kc]));else{if("a_bending_col_main"==Wa||"a_bending_col_detail"==Wa)rb.pa[Wa]=new Float32Array(rb.Ka*zd);for(Qb=0;Qb<rc.length;Qb++){var Jc=Ac[Qb],ic=Jc*bd,hd=Qb*gd*hc;if(-1!=Jc)for(var Lc=0;Lc<gd;Lc++)for(var sc=Lc*hc,Bb=0;Bb<xc.length;Bb++)if(xc[Bb]){var Kc=z.oo(Uc,Bb);rb.pa[Wa][hd+sc+(Kb[Ja].su+z.oo($a,Bb))]=Db[ic+Kc]}}}}else rb.pa[Wa]=new Float32Array(0)}}na=rb;A(Ga,"USE_INSTANCED_PARTCLS",na.Ef?1:0);ba(Ga);H.push({za:Ga,bf:b,Jt:Q,Jf:na,fg:[za.name],Id:[a]})}}for(x=0;x<B.length;x++)B[x]&&(B[x].qn=
K[x].id,ba(B[x]))}}return H}function q(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=ja.tG(b));return c=c&&x(a,b)}function ba(a){J(a,function(a){a.id=0;a.id=z.oR(a)})}function J(a,b){for(var c=null,e=null,d=[],f=0;f<a.ya.length;f++){var h=a.ya[f],k=h.Sf;k&&(c||(c={}),c[f]=k,h.Sf=null);if(k=h.Sa)e||(e={}),e[f]=k,h.Sa=null;d.push(h.jk);h.jk=0}var h=a.O,k=a.aa,z=a.xa,l=a.Ta,v=a.pb,u=a.kb;a.O=null;a.aa=null;a.xa=null;a.Ta=null;a.pb=null;a.kb=null;var g=a.He;a.He=null;b(a);a.He=g;a.O=h;a.aa=k;a.xa=z;a.Ta=l;a.pb=
v;a.kb=u;if(c)for(f in c)a.ya[f].Sf=c[f];if(e)for(f in e)a.ya[f].Sa=e[f];for(f=0;f<a.ya.length;f++)a.ya[f].jk=d[f]}function F(a,b,c,d){var f=n("DEBUG_VIEW");V(f,"debug_view.glslv","debug_view.glslf");f.Gi=!0;f.Ua=!0;f.kk=b;f.lu=c;E(f,a);ba(f);if(d.Nf){c?(c=d.aa,P.ff(d.aa.G,va)):(c=d.pb,P.ff(c.G,va));var h=ma.create();a=S.Gu(1,h);b=ma.fromValues(ma.length(c.Ha),ma.length(c.Ia),ma.length(c.Ja));la.eL(a,b,h);var h=ma.normalize(c.Ha,Da),k=ma.normalize(c.Ia,Ra);c=ma.normalize(c.Ja,ra);!b[0]&&b[1]&&b[2]?
ma.cross(k,c,h):!b[1]&&b[0]&&b[2]?ma.cross(c,h,k):!b[2]&&b[0]&&b[1]&&ma.cross(h,k,c);b=z.ET(h,k,c,xa);ca.invert(b,b);b=Y.fromMat3(b,wa);P.Ck(b,va);P.Hf(1,va);la.cx(a,va)}else c?(b=d.xa,a=S.Gu(b.Xa,b.G)):(b=d.kb,a=S.Gu(b.Xa,ma.create()),P.identity(va),P.ff(b.G,va),la.cx(a,va));f.O=H.vl(d.O);f.aa=H.eq(d.aa);f.xa=H.wl(d.xa);f.Ta=H.vl(d.Ta);f.pb=H.eq(d.pb);f.kb=H.wl(d.kb);la.dx(a,1,!0);a.pa.a_polyindex=la.yu(a);e(f,a);return f}function V(a,b,c){a.hb.tg=b;a.hb.Te=c;X.TX(a.hb)}function U(a,b,c,e){e=e||
"";-1==a.Ld.indexOf(c)&&(a.ya.push(b),a.Ld.push(c),a.Eg.push(e),oa.pv(b));a.yb&&sa.IF(a)}function aa(a){a.hb||z.q("No shaders info for batch "+a.name);a.yb=X.EU(a.hb);var b=a.hb;if(b.status===X.Wy){var c=a.yb.attributes,e=a.Ba.ld,d;for(d in c)e[d]||z.q('missing data for "'+d+'" attribute')}b.status&X.RN&&ha.error("Texture limit exceeded for shader - "+b.Te+', materials: "'+a.td.join(", ")+'". Maximum texture count: '+ya.IB+", actual texture count: "+b.GM);b.status&X.QN&&ha.error("Fragment uniform limit exceeded for shader - "+
b.Te+', materials: "'+a.td.join(", ")+'". Maximum fragment uniform count: '+ya.Mv+", actual fragment uniform count: "+b.fU);b.status&X.UN&&ha.error("Vertex uniform limit exceeded for shader - "+b.tg+', materials: "'+a.td.join(", ")+'". Maximum vertex uniform count: '+ya.Br+", actual vertex uniform count: "+b.o_);b.status&X.TN&&ha.error("Vertex attribute limit exceeded for shader - "+b.tg+', materials: "'+a.td.join(", ")+'". Maximum attribute count: '+ya.JB+", actual attribute count: "+b.KF);b.status&
X.SN&&("MAIN"!=a.type||a.Vj||ha.error("Varying limit exceeded for shader - "+a.hb.Te+', materials: "'+a.td.join(", ")+'"'),"MAIN"==a.type&&a.Vj||"NODES_GLOW"==a.type)&&(e=c=0,a.rj&&(c=z.Yq(a.rj)),a.Zc&&(e=z.Yq(a.Zc)),ha.error("Varying limit exceeded for node shader - "+a.hb.Te+", uv: "+c+", vc: "+e+', materials: "'+a.td.join(", ")+'"'));b.status&X.MN&&ha.error("Shader compilation/linking error: "+b.tg+", "+b.Te+', materials: "'+a.td.join(", ")+'"');return a.hb.status===X.Wy?(sa.KQ(a.yb),sa.GQ(a),
sa.IF(a),!0):!1}function v(a,b,c){a=a.I[0].U;for(var e=0;e<a.length;e++)if(a[e].type==c&&!a[e].Zf&&-1!=a[e].td.indexOf(b))return a[e];return null}function fa(a,b,c){a=a.I[0].U;for(var e=0;e<a.length;e++)if(a[e].type==c&&a[e].Zf&&-1!=a[e].td.indexOf(b))return a[e];return null}function M(a,b){a.Uf.set(b.Uf);a.Gl=b.Gl;a.Em.set(b.Em);a.Co=b.Co;a.Gk.set(b.Gk);a.Oj=b.Oj;a.yj=b.yj;a.Fl=b.Fl;a.il=b.il;a.lo=b.lo;a.Li.set(b.Li);a.eo=b.eo;a.so.set(b.so);a.uo=b.uo;a.vo.set(b.vo);a.wo=b.wo;a.An=b.An;a.ap=b.ap}
var H=r("__boundings"),Z=r("__config"),ha=r("__print"),u=r("__extensions"),Q=r("__graph"),ca=r("__mat3"),ja=r("__nodemat"),ua=r("__obj_util"),pa=r("__particles"),S=r("__primitives"),Y=r("__quat"),qa=r("__reformer"),sa=r("__renderer"),za=r("__scenegraph"),X=r("__shaders"),ta=r("__subscene"),oa=r("__textures"),P=r("__tsr"),la=r("__geometry"),z=r("__util"),ma=r("__vec3"),Ea=r("__vec4"),ea=Z.A,ya=Z.Ci,na=Z.qo,Ha=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Da=new Float32Array(3),Ra=new Float32Array(3),
ra=new Float32Array(3),wa=new Float32Array(4),va=P.create(),xa=ca.create();a.C_=Ka;var Ka="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Na={};a.PQ=function(a){return Na[a]||null};a.QQ=function(a,b){Na[a]=b};a.yU=function(a,d,f,h){var k;k=a.s.Wa;for(var l=[],v=0;v<d.length;v++){var u=d[v],g=u.nb,q=g.k;if(!g.nr){var m=ua.Ea(g),g=g.k,M=u.data.b4w_boundings,n=M.bs_rad,Q=M.bs_cen,w=M.bc_rad,U=M.caxis_x,S=M.caxis_y,X=M.caxis_z,y=M.be_ax,J=M.be_cen,A=M.rbb.rbb_c,fa=
M.rbb.rbb_s,M=H.vl(g.ol);g.Cg&&(n=Math.max(Math.abs(M.max_x),Math.abs(M.min_x)),Q=Math.max(Math.abs(M.max_y),Math.abs(M.min_y)),fa=Math.max(Math.abs(M.max_z),Math.abs(M.min_z)),fa=Math.sqrt(n*n+Q*Q+fa*fa),w=Math.sqrt(n*n+Q*Q),M.max_x=M.max_y=M.max_z=fa,M.min_x=M.min_y=M.min_z=-fa,n=fa,Q=[0,0,0],U=[1,0,0],S=[0,1,0],X=[0,0,1],y=[fa,fa,fa],J=[0,0,0],A=[0,0,0],fa=[fa,fa,fa]);H.ln(M,g.O);H.tl(g.O,g.n,g.Ta);g.xa=H.uz(n,z.yf(Q));H.Tp(g.xa,g.n,g.kb);g.aa=m?H.Op(U,S,X,J):H.Op([1,0,0],[0,1,0],[0,0,1],J);ma.scale(g.aa.Ha,
y[0],g.aa.Ha);ma.scale(g.aa.Ia,y[1],g.aa.Ia);ma.scale(g.aa.Ja,y[2],g.aa.Ja);H.Sp(g.aa,g.n,g.pb);m?B(g,w,w,g.O):(g.zd=H.EX(A,U,S,X,fa),H.rz(g.zd,g.n,g.QF));l.push.apply(l,t(u,q,k))}}k=p(l);for(l=0;l<k.length;l++)if(v=k[l].za,v.td=k[l].fg,e(v,k[l].Jf),c(v,f,a),"STATIC"==k[l].k.type&&"COLOR_ID"!=v.type){if(u=z.ws("%meta%"+v.type+"%"+v.td.join("%")+"%"),m=ua.sq(u,"MESH"),ua.DW(m,k[l].k),ua.Fp(m,a),ua.Bt(m,a,v),h.push(m),"MAIN"==v.type)for(q=0;q<k[l].Id.length;q++)u=k[l].Id[q].nb,u.Pv.push(m)}else u=k[l].Id[0].nb,
ua.Bt(u,a,v);if(ea.debug_view){for(l=0;l<k.length;l++)if(f=k[l].k,"DYNAMIC"==f.type&&(u=k[l].Id[0].nb,v=k[l].za,"MAIN"==v.type)){q=ua.ja(u,a);m=q.U;g=!1;for(q=0;q<m.length;q++)m[q].Gi&&(g=!0);g||(f=F(f,u.name,!0,v),ua.Bt(u,a,f))}for(l=0;l<h.length;l++)u=h[l],f=u.k,q=ua.ja(u,a),v=q.U[0],"MAIN"==v.type&&(f=F(f,u.name,!1,v),ua.Bt(u,a,f));for(l=0;l<k.length;l++)v=k[l].za,"DEBUG_VIEW"==v.type&&(v.ku=l)}for(l=0;l<d.length;l++)for(q=ua.ja(d[l].nb,a),m=q.U,q=0;q<m.length;q++)b(m[q]);for(l=0;l<h.length;l++)for(q=
ua.ja(h[l],a),m=q.U,q=0;q<m.length;q++)b(m[q])};a.pQ=function(a,c,f){var h=a.s.cp,k=n("MAIN");V(k,"sky.glslv","sky.glslf");if(c.procedural_skydome)A(k,"PROCEDURAL_SKYDOME",1),k.ru=!0;else{var z=h.Bo,l=za.ec(a.s.Wa,ta.zg).p.qc;U(k,l,"u_sky");z&&(A(k,"WO_SKYTEX",1),z.invert&&A(k,"MTEX_NEGATIVE",1),z.mN&&A(k,"MTEX_RGBTOINT",1),A(k,"BLENDTYPE",z.$F),z.hN&&A(k,"WOMAP_BLEND",1),z.iN&&A(k,"WOMAP_HORIZ",1),z.kN&&A(k,"WOMAP_ZENUP",1),z.jN&&A(k,"WOMAP_ZENDOWN",1));h.Fs&&A(k,"WO_SKYBLEND",1);h.Gs&&A(k,"WO_SKYPAPER",
1);h.Hs&&A(k,"WO_SKYREAL",1)}c.be&&(k.be=!0,c.Hd&&(k.Hd=!0));k.kg=99999;y(k,"a_position");c=S.uU();e(k,c);b(k);f=ua.ja(f,a);k.Mj=!0;k.aa=H.Hg();k.pb=H.Hg();k.O=H.Qd();k.Ta=H.Qd();k.xa=H.Gh();k.kb=H.Gh();ba(k);f.U.push(k);za.ec(a.s.Wa,ta.rf)&&(a=d(k),a.type="DEBUG_VIEW",a.Eb="",O(a),A(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.pa.a_polyindex=la.yu(c),e(a,c),a.qn=k.id,ba(a),f.U.push(a))};a.Xz=function(a,b,c){c=ua.ja(a,c).U;var e=[];za.ec(b,ta.dd);var f=za.ec(b,ta.Nd),k=za.ec(b,ta.nd),h=za.ec(b,ta.yg);b=za.ec(b,
ta.pf);for(var z=0;z<c.length;z++){var l=c[z],v=null;"SHADOW"==l.type&&"RECEIVE"==l.Eb&&l.Ce&&(v=d(l),v.Eb="CAST");"MAIN"!=l.type&&"PARTICLES"!=l.type||!f&&!k||!l.be||(v=d(l),v.Eb="REFLECT",v.uk=!1,v.of&&(v.of=!1,v.Ua=!1),v.gb=l.gb);"COLOR_ID"==l.type&&h&&a.k.Uc&&(b&&a.k.yk?(v=d(l),v.Eb="OUTLINE"):l.Eb="OUTLINE");v&&(v.Zf=!0,ba(v),e.push(v))}c.push.apply(c,e)};a.dY=B;a.z_=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,z.q("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(z.Lb(a));return.5*
(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.RQ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.zZ=I;a.yZ=c;a.aY=k;a.HF=function(a,b){A(a,"CSM_SECTION1",0);A(a,"CSM_SECTION2",0);A(a,"CSM_SECTION3",0);A(a,"NUM_CAST_LAMPS",0);if(b){A(a,"NUM_CAST_LAMPS",b.Xg.length);ea.Kv&&A(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)A(a,"CSM_SECTION"+String(c),1);A(a,"SHADOW_TEX_RES",X.M(b.csm_resolution));A(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?
1:0);A(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else A(a,"SHADOW_TEX_RES",0),A(a,"CSM_FADE_LAST_CASCADE",0),A(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.ef=A;a.MA=function(a,b){return X.JU(a.hb,b)};a.wZ=e;a.xZ=ba;a.Et=V;a.Aj=U;a.yX=function(a,b,c){c=a.Ld.indexOf(c);-1<c&&(a.ya[c]=b)};a.BS=function(a,b){var c=n("MAIN");c.Kb=!0;Ea.set(b[0],b[1],b[2],.5,c.Uf);c.Ih=la.hp;e(c,a);V(c,"main.glslv","main_stack.glslf");A(c,"SHADELESS",1);aa(c);return c};a.Xc=aa;a.xU=function(a,c){for(var d=0;d<
c.length;d++){var f=c[d].nb,k=n("LINE");V(k,"line.glslv","line.glslf");k.Kb=!0;k.Mj=!0;var h=S.wU();e(k,h);b(k);k.O=H.Qd();k.Ta=H.Qd();k.aa=H.Hg();k.pb=H.Hg();k.kb=H.Gh();k.xa=H.Gh();ua.Fp(f,a);ua.ja(f,a).U.push(k);aa(k)}};a.yR=function(a){return a.yb.Mr.length?a.yb.iC.u_cube_fog?!0:!1:!1};a.lS=function(){var a=n("DEPTH_PACK");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");aa(a);return a};a.$z=function(a){var b=n("POSTPROCESSING");
V(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":A(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":A(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":A(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":A(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":A(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":A(b,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":A(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":A(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:z.q("Wrong postprocessing effect: "+a)}b.Xb=!0;b.Ua=!1;a=S.Qc();e(b,a);aa(b);return b};a.FS=function(a){var b=n("SSAO");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");A(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.lM);A(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:
0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=oa.Cl(oa.wh,!1);c.source="NODE_TEX";oa.ys(c,a,0);U(b,c,"u_ssao_special_tex");aa(b);return b};a.GS=function(a){var b=n("SSAO_BLUR");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");A(b,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);aa(b);return b};a.iS=function(a){var b=n("COC");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");A(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":A(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":A(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":A(b,"COC_TYPE","COC_COMBINE")}aa(b);return b};a.mS=function(a){var b=n("DOF");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?A(b,"DOF_TYPE","DOF_BOKEH"):(A(b,"DOF_TYPE","DOF_SIMPLE"),A(b,"DEPTH_RGBA",1));aa(b);return b};a.vS=function(){var a=n("OUTLINE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");aa(a);return a};a.oS=function(){var a=n("GLOW_COMBINE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");aa(a);return a};a.pS=function(a,b,c){var d=n("GOD_RAYS");d.Ua=!1;d.Xb=!0;var f=S.oU();
e(d,f);V(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");A(d,"DEPTH_RGBA",a?1:0);A(d,"WATER_EFFECTS",b?1:0);A(d,"STEPS_PER_PASS",X.M(c,1));aa(d);return d};a.qS=function(){var a=n("GOD_RAYS_COM");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");A(a,"SAFARI_CANVAS_ALPHA_HACK",ea.cL?1:0);aa(a);return a};a.kS=function(a,b){var c=n("SKY");c.Ua=!1;c.Xb=!0;var d=S.qU();e(c,d);if(b.procedural_skydome)V(c,"skybox.glslv",
"proc_skybox.glslf"),A(c,"WATER_EFFECTS",1);else{V(c,"skybox.glslv","tex_skybox.glslf");if(a){d=a.s.cp;if(d.Ww){var f=d.Ww.texture,k=oa.fe(d.Ww);U(c,k,"u_sky_texture",f.name)}d.Bo&&A(c,"WO_SKYTEX",1)}b.aM&&A(c,"MTEX_NEGATIVE",1);b.fM&&A(c,"MTEX_RGBTOINT",1);A(c,"BLENDTYPE",b.$L);b.bM&&A(c,"WOMAP_BLEND",1);b.cM&&A(c,"WOMAP_HORIZ",1);b.eM&&A(c,"WOMAP_ZENUP",1);b.dM&&A(c,"WOMAP_ZENDOWN",1);b.Fs&&A(c,"WO_SKYBLEND",1);b.Gs&&A(c,"WO_SKYPAPER",1);b.Hs&&A(c,"WO_SKYREAL",1)}c.aa=H.Hg();c.pb=H.Hg();c.O=H.Qd();
c.Ta=H.Qd();c.xa=H.Gh();c.kb=H.Gh();aa(c);return c};a.hQ=function(a,b){var c=za.ec(a.s.Wa,ta.zg);c&&(c=c.Ra[0].ra[0].za,ua.ja(b,a).U.push(c))};a.dS=function(a){var b=n("ANTIALIASING");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ea.KK?(A(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),A(b,"AA_QUALITY",a.OH)):A(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");aa(b);return b};a.DS=function(a){var b=n("SMAA"),c=S.Qc();e(b,c);V(b,"postprocessing/smaa.glslv",
"postprocessing/smaa.glslf");A(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");A(b,"SMAA_PASS",a);A(b,"SMAA_PREDICATION",0);A(b,"SMAA_REPROJECTION",0);aa(b);b.Ua=!1;b.Xb=!0;return b};a.jS=function(){var a=n("COMPOSITING");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");aa(a);return a};a.uS=function(){var a=n("MOTION_BLUR");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");aa(a);return a};
a.HS=function(a){var b=n("STEREO");b.Xb=!0;b.Ua=!1;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");A(b,"ANAGLYPH","ANAGLYPH"===a?1:0);aa(b);return b};a.rS=function(){var a=n("LUMINANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");aa(a);return a};a.eS=function(){var a=n("LUMINANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
aa(a);return a};a.sS=function(){var a=n("LUMINANCE_X_BLUR");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");aa(a);return a};a.gS=function(){var a=n("POSTPROCESSING");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");aa(a);return a};a.hS=function(){var a=n("BLOOM");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
aa(a);return a};a.eT=function(){var a=n("VELOCITY");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");aa(a);return a};a.cS=function(){var a=n("ANCHOR_VISIBILITY");a.Ua=!0;a.Xb=!0;a.Ih=la.hp;V(a,"anchors.glslv","anchors.glslf");var b=S.UH(1);e(a,b);A(a,"ANCHOR_NUM",1);aa(a);a.jl=new Float32Array(3);return a};a.wS=function(){var a=n("PERFORMANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
aa(a);return a};a.vZ=function(a,b){var c=b.length/3;if(c!=a.jl.length/3){var d=S.UH(c);e(a,d);A(a,"ANCHOR_NUM",c);aa(a)}a.jl=b};a.b4=function(a){if(!a.I.length)return null;a=a.I[0];return a.U.length?a.U[0]:null};a.Lq=v;a.q3=fa;a.p7=M;a.a2=function(a,b){for(var c=a.I[0].U,e=0;e<c.length;e++)if(c[e].type==b)return!0;return!1};a.BG=function(a){for(var b=a.ya,c=0;c<b.length;c++)oa.wC(b[c]);a.Ba.Tf&&la.RR(a.Ba);a.Tf&&a.He.length&&sa.UR(a);a.yb.Tf&&X.TR(a.yb);a.ik&&(b=ja.yI(a.ik))&&b.AG&&ja.SR(a.ik)};a.vV=
function(a,b,c,e){for(var d=["MAIN","SHADOW","COLOR_ID"],f=!1,k=0;k<d.length;k++){var h=d[k],z=v(a,b,h),l=v(c,e,h);if(z&&l){var f=!0,u=fa(c,e,h);"MAIN"==h&&(M(l,z),u&&M(u,z));for(h=0;h<l.Ld.length;h++){var g=l.Ld[h];if(-1!==Ka.indexOf(g)){var q=z.Ld.indexOf(g);-1!==q&&(q=z.ya[q],oa.wC(l.ya[h]),l.ya[h]=q,oa.pv(q),u&&(g=u.Ld.indexOf(g),-1!==g&&(oa.wC(u.ya[g]),u.ya[g]=q,oa.pv(q))))}}}}f||ha.error("Wrong objects for inheriting material!")};a.WC=function(a,b,c,e){for(var d=0;d<a.I.length;d++)for(var f=
a.I[d].U,k=0;k<f.length;k++){var h=f[k];-1!=h.td.indexOf(b)&&h.Zi&&(h.Zi[c]=e)}};a.VC=function(a,b,c,e,d,f){for(var k=0;k<a.I.length;k++)for(var h=a.I[k].U,z=0;z<h.length;z++){var l=h[z];-1!=l.td.indexOf(b)&&l.ze&&(l.ze[3*c]=e,l.ze[3*c+1]=d,l.ze[3*c+2]=f)}};a.AI=function(a,b){return a.Zi[b]};a.zI=function(a,b,c){c[0]=a.ze[3*b];c[1]=a.ze[3*b+1];c[2]=a.ze[3*b+2];return c};a.Hn=function(a,b){var c;c=b[1];for(var e=2;e<b.length;e++)c+="%join%"+b[e];for(e=0;e<a.length;e+=2)if(a[e]==c)return a[e+1];return null};
a.sa=function(){Na={}}};b4w.module.__extensions=function(a,r){function n(a){if(a in m)return m[a];var b=B.getExtension(a)||null;m[a]=b;t.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function d(a){if(a in m)return m[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=B;break;case "EXT_disjoint_timer_query":(b=B.getExtension("EXT_disjoint_timer_query")||null)||(b=B.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}m[a]=b;t.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=r("__config"),t=r("__print"),p=b.A,B=null,m={};a.If=function(a){B=a};a.II=function(){return n("WEBGL_compressed_texture_s3tc")||n("WEBKIT_WEBGL_compressed_texture_s3tc")||n("MOZ_WEBGL_compressed_texture_s3tc")};a.EI=function(){return n("WEBKIT_WEBGL_compressed_texture_pvrtc")||n("WEBGL_compressed_texture_pvrtc")};a.IU=function(){return p.cc?d("WEBGL_depth_texture"):n("WEBGL_depth_texture")||n("WEBKIT_WEBGL_depth_texture")||
n("MOZ_WEBGL_depth_texture")};a.bI=function(){return n("EXT_texture_filter_anisotropic")||n("WEBKIT_EXT_texture_filter_anisotropic")||n("MOZ_EXT_texture_filter_anisotropic")};a.HU=function(){return n("WEBGL_debug_shaders")};a.Qu=function(){return n("WEBGL_debug_renderer_info")};a.lI=function(){return p.cc?d("OES_element_index_uint"):n("OES_element_index_uint")};a.XA=function(){return p.cc?d("OES_standard_derivatives"):n("OES_standard_derivatives")};a.PA=function(){var a=p.cc?d("EXT_disjoint_timer_query"):
n("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},XH:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},YH:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},WH:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return B.createQuery()},beginQuery:function(b){B.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){B.endQuery(a.TIME_ELAPSED_EXT)},XH:function(a){return B.getQueryParameter(a,B.QUERY_RESULT_AVAILABLE)},YH:function(a){return B.getQueryParameter(a,B.QUERY_RESULT)},WH:function(){return a.GPU_DISJOINT_EXT}}};a.YU=function(){if(p.cc)return d("ANGLE_instanced_arrays");var a=n("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,d,h,m,f){a.drawElementsInstancedANGLE(b,d,h,m,f)},vertexAttribDivisor:function(b,d){a.vertexAttribDivisorANGLE(b,d)},drawArraysInstanced:function(b,
d,h,m){a.drawArraysInstancedANGLE(b,d,h,m)}}};a.YA=function(){if(p.cc)return d("OES_vertex_array_object");var a=n("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.sa=function(){m={}};a.reset=function(){B=null}};b4w.module.__graph=function(a,r){function n(a,b,c){c||(c=null);d(a,b)?R.q("Graph already has node with given ID"):a.X.push(b,c)}function d(a,b){for(var c=a.X,e=0;e<c.length;e+=2)if(c[e]==b)return!0;return!1}function b(a,b,c,e){e||(e=null);d(a,b)&&d(a,c)?a.Qa.push(b,c,e):R.q("Wrong node IDs")}function t(a,b){d(a,b)||R.q("Node not found");for(var c=a.X,e=0;e<c.length;e+=2)c[e]==b&&(c.splice(e,2),e-=2)}function p(a,b,c,e){k(a,b,c)||R.q("Edge not found");a=a.Qa;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==
b&&a[f+1]==c){if(-1==e)a.splice(f,3);else{if(e==d){a.splice(f,3);break}d++}f-=3}}function B(a){a=a.X;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function m(a,b){for(var c=a.X,e=0;e<c.length;e+=2)if(c[e+1]==b)return c[e];return-1}function x(a){var b=[],c={};g(a,c);for(var e=a.X,d=0;d<e.length;d+=2)0==O(a,e[d])&&l(a,e[d],c,b);return{X:b,Qa:a.Qa.slice(0)}}function g(a,b){for(var c=a.X,e=0;e<c.length;e+=2)b[c[e]]=!1}function l(a,b,c,e){if(!c[b]){c[b]=!0;for(var d=0;d<I(a,b);d++)l(a,
E(a,b,d),c,e);e.unshift(b,N(a,b))}}function h(a,b,e,d){if(!e[b]){e[b]=!0;if(10==d||30==d)for(var f=0;f<I(a,b);f++){var k=E(a,b,f);h(a,k,e,d)}if(20==d||30==d)for(f=0;f<O(a,b);f++)k=c(a,b,f),h(a,k,e,d)}}function w(a){for(var b=a.Qa,c=0;c<b.length;c+=3){var e=b[c+1];d(a,b[c])&&d(a,e)||(b.splice(c,3),c-=3)}}function f(a){for(var b=[],c=a.X,e=0;e<c.length;e+=2){var d=c[e];I(a,d)||b.push(d)}return b}function C(a){var b=a.X;a=a.Qa;for(var c=[],e=[],d=[],f=0;f<b.length;f++)d[b[2*f]]=f,c.push(f,b[2*f+1]);
for(f=0;f<a.length;f+=3)e.push(d[a[f]],d[a[f+1]],a[f+2]);return{X:c,Qa:e}}function K(a,b,e){if(e.Fh==e.hk){for(var d=0,f=0;d<e.hk;d++)-1!=e.Di[d]&&(a[f]=d,b[f]=e.Di[d],f++);return!0}if(e.hk>e.$n||e.Ik>e.Jk||e.Mo>e.Oo||e.Lo>e.No)return!1;for(var f=d=-1,k=!1;!k&&G(e,q,d,f);)if(d=q[0],f=q[1],L(e,d,f)){var h;h=e;k={};k.Uq=h.Uq;k.Vq=h.Vq;k.XB=h.XB;k.uu=h.uu;k.hk=h.hk;k.$n=h.$n;k.lk=h.lk;k.Fh=k.bw=h.Fh;k.Lo=h.Lo;k.Mo=h.Mo;k.Ik=h.Ik;k.No=h.No;k.Oo=h.Oo;k.Jk=h.Jk;k.Ap=-1;k.Di=h.Di;k.zl=h.zl;k.Zl=h.Zl;k.$l=
h.$l;k.qm=h.qm;k.rm=h.rm;k.Nw=h.Nw;h.Nw[0]+=1;var k=h=k,l=d,g=f,m=k.Uq,n=k.Vq,w=k.hk,u=k.$n,Q=k.Di,y=k.zl,A=k.Zl,p=k.$l,C=k.qm,S=k.rm;D(l<w);D(g<u);D(k.Fh<w);D(k.Fh<u);w=++k.Fh;k.Ap=l;A[l]||(A[l]=w,k.Lo++,C[l]&&k.Ik++);C[l]||(C[l]=w,k.Mo++,A[l]&&k.Ik++);p[g]||(p[g]=w,k.No++,S[g]&&k.Jk++);S[g]||(S[g]=w,k.Oo++,p[g]&&k.Jk++);Q[l]=g;y[g]=l;for(Q=0;Q<O(m,l);Q++)y=c(m,l,Q),A[y]||(A[y]=w,k.Lo++,C[y]&&k.Ik++);for(Q=0;Q<I(m,l);Q++)y=E(m,l,Q),C[y]||(C[y]=w,k.Mo++,A[y]&&k.Ik++);for(Q=0;Q<O(n,g);Q++)y=c(n,g,
Q),p[y]||(p[y]=w,k.No++,S[y]&&k.Jk++);for(Q=0;Q<I(n,g);Q++)y=E(n,g,Q),S[y]||(S[y]=w,k.Oo++,p[y]&&k.Jk++);k=K(a,b,h);D(1>=h.Fh-h.bw);D(-1!=h.Ap);y=h.Uq;l=h.Vq;g=h.Fh;m=h.Ap;n=h.Di;A=h.zl;w=h.Zl;p=h.$l;u=h.qm;C=h.rm;if(h.bw<g){w[m]==g&&(w[m]=0);for(S=0;S<O(y,m);S++)Q=c(y,m,S),w[Q]==g&&(w[Q]=0);u[m]==g&&(u[m]=0);for(S=0;S<I(y,m);S++)Q=E(y,m,S),u[Q]==g&&(u[Q]=0);y=n[m];p[y]==g&&(p[y]=0);for(S=0;S<O(l,y);S++)Q=c(l,y,S),p[Q]==g&&(p[Q]=0);C[y]==g&&(C[y]=0);for(S=0;S<I(l,y);S++)Q=E(l,y,S),C[Q]==g&&(C[Q]=
0);n[m]=-1;A[y]=-1;h.Fh=h.bw;h.Ap=-1}}return k}function G(a,b,c,e){-1==c&&(c=0);-1==e?e=0:e++;var d=a.Ik,f=a.Jk,k=a.Mo,h=a.Oo,l=a.Lo,g=a.No,q=a.Fh,m=a.hk,u=a.$n,n=a.Di,w=a.zl,y=a.Zl,A=a.$l,p=a.qm,S=a.rm;if(d>q&&f>q)for(;c<m&&(-1!=n[c]||0==p[c]||0==y[c]);)c++,e=0;else if(k>q&&h>q)for(;c<m&&(-1!=n[c]||0==p[c]);)c++,e=0;else if(l>q&&g>q)for(;c<m&&(-1!=n[c]||0==y[c]);)c++,e=0;else if(0==c&&0!=a.lk){for(y=0;y<m&&-1!=n[c=a.lk[y]];)y++;y==m&&(c=m)}else for(;c<m&&-1!=n[c];)c++,e=0;if(d>q&&f>q)for(;e<u&&(-1!=
w[e]||0==S[e]||0==A[e]);)e++;else if(k>q&&h>q)for(;e<u&&(-1!=w[e]||0==S[e]);)e++;else if(l>q&&g>q)for(;e<u&&(-1!=w[e]||0==A[e]);)e++;else for(;e<u&&-1!=w[e];)e++;return c<m&&e<u?(b[0]=c,b[1]=e,!0):!1}function L(a,b,e){var d=a.Uq,f=a.Vq,h=a.$n,l=a.Di,q=a.zl,g=a.Zl,m=a.$l,n=a.qm,w=a.rm;D(b<a.hk);D(e<h);D(-1==l[b]);D(-1==q[e]);if(!(0,a.XB)(N(d,b),N(f,e)))return!1;for(var u=h=0,Q=0,A=0,p=0,C=0,R=0;R<I(d,b);R++){var S=E(d,b,R);if(-1!=l[S]){var Y=l[S];if(!k(f,e,Y)||!y(a.uu,d,b,S,f,e,Y))return!1}else g[S]&&
Q++,n[S]&&h++,g[S]||n[S]||p++}for(R=0;R<O(d,b);R++)if(S=c(d,b,R),-1!=l[S]){if(Y=l[S],!k(f,Y,e)||!y(a.uu,d,S,b,f,Y,e))return!1}else g[S]&&Q++,n[S]&&h++,g[S]||n[S]||p++;for(R=0;R<I(f,e);R++)if(Y=E(f,e,R),-1!=q[Y]){if(S=q[Y],!k(d,b,S))return!1}else m[Y]&&A++,w[Y]&&u++,m[Y]||w[Y]||C++;for(R=0;R<O(f,e);R++)if(Y=c(f,e,R),-1!=q[Y]){if(S=q[Y],!k(d,S,b))return!1}else m[Y]&&A++,w[Y]&&u++,m[Y]||w[Y]||C++;return Q<=A&&h<=u&&p<=C}function D(a){a||R.q("Assertion failed")}function N(a,b){for(var c=a.X,e=0;e<c.length;e+=
2)if(c[e]==b)return c[e+1];return null}function I(a,b){for(var c=a.Qa,e=0,d=0;d<c.length;d+=3)c[d]==b&&e++;return e}function O(a,b){for(var c=a.Qa,e=0,d=0;d<c.length;d+=3)c[d+1]==b&&e++;return e}function E(a,b,c){a=a.Qa;for(var e=0,d=0;d<a.length;d+=3)if(a[d]==b){if(e==c)return a[d+1];e++}return-1}function c(a,b,c){a=a.Qa;for(var e=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(e==c)return a[d];e++}return-1}function k(a,b,c){a=a.Qa;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c)return!0;return!1}function y(a,
b,c,d,f,k,h){for(var l=A(b,c,d),q=A(f,k,h),g=0;g<l;g++){for(var m=!1,n=0;n<q;n++)if(a(e(b,c,d,g),e(f,k,h,n))){m=!0;break}if(!m)return!1}return!0}function A(a,b,c){var e=0;a=a.Qa;for(var d=0;d<a.length;d+=3)a[d]==b&&a[d+1]==c&&e++;return e}function e(a,b,c,e){a=a.Qa;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c){if(d==e)return a[f+2];d++}return null}r("__print");var R=r("__util"),q=[-1,-1];a.Py=-1;a.V_=10;a.Ss=20;a.g1=30;a.create=function(){for(var a=arguments,b=[],c=[],e=0;e<a.length;e++){var d=
a[e];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:R.q("Wrong graph constructor params")}}return{X:b,Qa:c}};a.clone=function(a,b,c){if(b)for(var e=Array(a.X.length),d=0;d<a.X.length;d+=2)e[d]=a.X[d],e[d+1]=b(a.X[d+1]);else e=R.P(a.X);if(c)for(b=Array(a.Qa.length),d=0;d<a.Qa.length;d+=3)b[d]=a.Qa[d],b[d+1]=a.Qa[d+1],b[d+2]=c(a.Qa[d+2]);else b=R.P(a.Qa);return a={X:e,Qa:b}};a.E2=function(a,b){for(var c=[],e=[],d=0;d<a.length;d++)c.push(a[d][0],a[d][1]);
for(d=0;d<b.length;d++)e.push(b[d][0],b[d][1],b[d][2]);return{X:c,Qa:e}};a.zj=n;a.n5=d;a.fd=b;a.pg=t;a.vk=p;a.mo=function(a,b,c,e){k(a,b,c)||R.q("Edge not found");a=a.Qa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==e[0]&&a[d+2][1]==e[1]){a.splice(d,3);break}};a.J=function(a,b){if(-1==m(a,b)){var c=B(a);n(a,c,b);return c}R.q("Non-unique attribute")};a.xX=function(a,b,c,e,d){a=a.Qa;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&a[f+2]==e&&(a[f+2]=d)};a.vQ=function(a,c,e){var d;e=e||
[];d=d||[];for(var f={},k=0;k<a.X.length;k+=2){var h=a.X[k],l=a.X[k+1],q=B(c);n(c,q,l);f[h]=q}for(k=0;k<a.Qa.length;k+=3)l=f[a.Qa[k]],q=f[a.Qa[k+1]],h=a.Qa[k+2],b(c,l,q,h);for(k=0;k<e.length;k+=3)l=f[e[k]],a=e[k+1],h=e[k+2],b(c,l,a,h);for(k=0;k<d.length;k+=3)e=d[k],q=f[d[k+1]],h=d[k+2],b(c,e,q,h)};a.Sl=B;a.bh=m;a.r=function(a,c,e,d){c=m(a,c);e=m(a,e);-1!=c&&-1!=e?b(a,c,e,d):R.q("Attributes not found")};a.oa=function(a,b){for(var c=a.X,e=0;e<c.length&&!b(c[e],c[e+1]);e+=2);};a.sg=function(a,b){for(var c=
a.Qa,e=0;e<c.length&&!b(c[e],c[e+1],c[e+2]);e+=3);};a.ii=function(a,b,c){for(var e=a.Qa,d=0;d<e.length;d+=3)if(e[d+1]==b){var f=e[d];if(c(f,N(a,f),e[d+2]))break}};a.Lk=function(a,b,c){for(var e=a.Qa,d=0;d<e.length;d+=3)if(e[d]==b){var f=e[d+1];if(c(f,N(a,f),e[d+2]))break}};a.DD=x;a.jZ=function(a){a=x(a).X;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.G5=function(){};a.bx=function(a,b,c){d(a,b)||R.q("No such node");var e={};g(a,e);h(a,b,e,c);b=[];for(var f in e)e[f]&&(f=Number(f),b.push(f,
N(a,f)));a={X:b,Qa:a.Qa.slice(0)};w(a);return a};a.Gz=w;a.bV=function(a){for(var b=[],c=a.X,e=0;e<c.length;e+=2){var d=c[e];O(a,d)||b.push(d)}return b};a.$q=f;a.match=function(a,b,c,e){var d={};d.Uq=C(a);d.Vq=C(b);d.XB=c||function(a,b){return a==b};d.uu=e||function(a,b){return a==b};e=a.X.length/2;var f=b.X.length/2;d.hk=e;d.$n=f;d.lk=0;d.Fh=d.bw=0;d.Ik=d.Lo=d.Mo=0;d.Jk=d.No=d.Oo=0;d.Ap=-1;d.Di=Array(e);d.zl=Array(f);d.Zl=Array(e);d.$l=Array(f);d.qm=Array(e);d.rm=Array(f);d.Nw=[1];for(c=0;c<e;c++)d.Di[c]=
-1,d.Zl[c]=0,d.qm[c]=0;for(c=0;c<f;c++)d.zl[c]=-1,d.$l[c]=0,d.rm[c]=0;f=Array(e);e=Array(e);if(K(f,e,d)){for(c=0;c<f.length;c++)f[c]=a.X[2*f[c]],e[c]=b.X[2*e[c]];return[f,e]}return null};a.ZU=function(a,b){for(var c=a.X,e=1;e<c.length;e+=2)if(c[e]==b)return c[e-1];return null};a.Va=N;a.mg=I;a.Mn=O;a.Tg=E;a.Ni=c;a.U3=A;a.Wd=e;a.replace=function(a,b,c){for(var e=a.Qa,d=B(a),f=0;f<b.length;f++){var k=b[f];t(a,k);for(var h=0;h<e.length;h+=3)e[h]==k&&(e[h]=d),e[h+1]==k&&(e[h+1]=d),e[h]==e[h+1]&&(e.splice(h,
3),h-=3)}n(a,d,c)};a.nX=function(a,b,c,e,d){k(a,b,c)||R.q("Edge not found");a=a.Qa;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&(a[f]=e,a[f+1]=d)};a.JT=function(a,b){function c(a,b){if(-1!=l.indexOf(a)){var e=l.slice(l.indexOf(a));if(-1!=d[e[e.length-1]].indexOf(e[0])){q.push([a,e[e.length-1]]);return}}l.push(a);for(e=0;e<b.length;e++)b[e]in d&&c(b[e],d[b[e]])}b||(b=f(a)[0]);var e=a.Qa;if(e.length&&-1!=e.indexOf(b)){for(var d={},k=0,h=0;h<e.length;h+=3)e[h+1]in d?d[e[h+1]].push(e[h]):d[e[h+1]]=
[e[h]],k++;var l=[],q=[];c(b,d[b]);for(h=0;h<q.length;h++)for(var g=k=0;g<e.length;g+=3)q[h][1]==e[g+1]&&q[h][0]==e[g]&&p(a,e[g],e[g+1],k),k++}};a.mT=function(a,b,c){var e=a.X;a=a.Qa;var d;d="digraph debug {\n    node [shape=box];\n";for(var f=0;f<e.length;f+=2){var k=e[f],h=e[f+1],h=b?b(k,h):String(k);d+="    ";d+=String(k)+' [label="'+h.replace(/\"/g,'\\"')+'"];\n'}for(f=0;f<a.length;f+=3)b=a[f],e=a[f+1],h=a[f+2],d+="    ",d+=String(b)+" -> "+String(e),c&&(d+=' [label="'+c(b,e,h)+'"]'),d+=";\n";
return d+="}"}};b4w.module.__nodemat=function(a,r){function n(a,b,c,e,k){var h=Ha.B(),h=m(b,k,h.uuid);if(h in va)return va[h];var v={Wa:null,id:h,AG:!0};c||(Ka={},Na=0);if("SHADOW"!=k&&"COLOR_ID"!=k){b=z.create();for(var u=a.nodes,q=0;q<u.length;q++)if(null==ba(b,u[q],0,e,k))return va[h]=null,v;if(c&&-1==R(a,b,"GROUP_OUTPUT","group"))return v;q=S(b);u=c?a.links:a.links.slice();if(!Y(b,u,q))return v;if(c)return v.Wa=b,v;for(q=0;q<u.length;q++){c=u[q];for(var H=C(c.from_node,b),M=C(c.to_node,b),Q=0;Q<H.length;Q++)for(var X=
0;X<M.length;X++){var A=H[Q],F=M[X],fa=z.Va(b,A),ja=z.Va(b,F);if(!ua(b,A,F,fa,ja,c))return va[h]=null,v}}f(b);"GLOW"==k?q=R(a,b,"B4W_GLOW_OUTPUT","material",!0):(q=R(a,b,"OUTPUT","material",!1,!0),-1==q&&(q=R(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==q&&(b=g(),q=0);K(b);a=z.bx(b,q,z.Ss);d(a,e);p(a,e);l(a);L(a);y(a);w(a,e,k);oa(a)}else e=n(a,b,c,e,"MAIN"),e=z.clone(e.Wa,function(a){var b=Da.fq(a);b.L=Da.P(a.L);b.fb=Da.P(a.fb);return b}),q=R(a,e,"OUTPUT","material",!1,!0),-1==q&&(q=R(a,e,"OUTPUT_MATERIAL",
"material",!1,!0)),x(e,q),a=z.bx(e,q,z.Ss),l(a);v.Wa=a;return va[h]=v}function d(a,c){var e=[];z.oa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||e.push({Fr:a,node:b})});for(var d=0;d<e.length;++d){var f=e[d].Fr,k=e[d].node,h=z.Sl(a);z.zj(a,h,k.data.uW);var l=z.Sl(a);z.zj(a,l,k.data.vW);z.fd(a,h,l,[4,2]);for(var v={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},u=z.Mn(a,f),q=[],g=[],m=[],H={},M=0;M<u;M++){var n=z.Ni(a,f,
M);n in H||(H[n]=0);var w=z.Wd(a,n,f,H[n]++);q.push([n,f,w]);var y=v[w[1]];if(y)switch(y[0]){case "MATERIAL_END":g.push([n,l,[w[0],y[1]]]);break;case "LIGHTING_APPLY":m.push([n,[w[0],y[1]]])}else g.push([n,h,w])}b(a,k.data.value,h,l,m,c);for(M=0;M<q.length;M++)z.mo(a,q[M][0],q[M][1],q[M][2]);for(M=0;M<g.length;M++)z.fd(a,g[M][0],g[M][1],g[M][2]);k=z.mg(a,f);h=[];v=[];u={};for(M=0;M<k;M++)q=z.Tg(a,f,M),q in u||(u[q]=0),w=z.Wd(a,f,q,u[q]++),h.push([f,q,w]),v.push([l,q,w]);for(M=0;M<h.length;M++)z.mo(a,
h[M][0],h[M][1],h[M][2]);for(M=0;M<v.length;M++)z.fd(a,v[M][0],v[M][1],v[M][2]);z.pg(a,f)}}function b(a,b,c,e,d,f){var k={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},h=ba(a,k,0,f,null),l=h;t(a,c,h,"E");t(a,c,h,"A");t(a,c,h,"D");h=Ha.B();h=ea.jc(h,"LAMP",ea.Dc);if(!b.Fe)for(var v,u,q,g=0;g<h.length;g++){q=h[g].Sc;k={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};v=ba(a,k,0,f,null);k={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};u=ba(a,k,0,f,null);t(a,l,u,"color");t(a,l,u,"specular");t(a,v,u,"ldir");
t(a,c,u,"normal");t(a,c,u,"D");t(a,c,u,"S");t(a,v,u,"lcolorint");t(a,c,v,"shadow_factor");l="SPECULAR_"+b.rs;k={name:l,type:l,use_tangent_shading:b.Nm};l=ba(a,k,0,f,null);t(a,v,l,"ldir");t(a,v,l,"lfac");t(a,c,l,"normal");t(a,l,u,"sfactor");t(a,v,l,"norm_fac");t(a,c,l,"sp_params");l="HEMI"==q.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Aq;k={name:l,type:l,use_tangent_shading:b.Nm};q=ba(a,k,0,f,null);t(a,v,q,"ldir");t(a,v,q,"lfac");t(a,c,q,"normal");t(a,v,q,"norm_fac");t(a,q,u,"lfactor");"DIFFUSE_LAMBERT"!=
l&&t(a,c,q,"dif_params");for(v=0;v<d.length;v++)z.fd(a,d[v][0],u,d[v][1]);l=u}t(a,l,e,"color");t(a,l,e,"specular")}function t(a,b,c,e){for(var d=z.Va(a,b),f=z.Va(a,c),k,h=0;h<f.L.length;h++)if(e==f.L[h].identifier){k=h;break}if(void 0!==k){for(var l,h=0;h<d.fb.length;h++)if(e==d.fb[h].identifier){l=h;break}void 0!==l&&z.fd(a,b,c,[l,k])}}function p(a,b){var c=[];z.oa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({Fr:a,node:b})});for(var e=0;e<c.length;++e){var d=c[e].Fr,f=c[e].node,k=z.Sl(a);z.zj(a,
k,f.data.cR);var h=z.Sl(a);z.zj(a,h,f.data.dR);z.fd(a,k,h,[4,2]);for(var l=z.Mn(a,d),v=[],u=[],q={},g=0;g<l;g++){var m=z.Ni(a,d,g),H=z.Va(a,m);m in q||(q[m]=0);var M=z.Wd(a,m,d,q[m]++);v.push([m,d,M]);u.push([m,k,M]);if("BSDF_GLOSSY"==H.type||"BSDF_DIFFUSE"==H.type||"MIX_SHADER"==H.type||"EMISSION"==H.type){u.push([m,k,[1,1]]);u.push([m,k,[2,2]]);u.push([m,k,[3,3]]);u.push([m,k,[4,4]]);u.push([m,k,[5,5]]);u.push([m,k,[6,6]]);u.push([m,k,[7,7]]);u.push([m,k,[8,8]]);var n=[];z.oa(a,function(a,b){"MIX_SHADER"==
b.type&&n.push({Fr:a,node:b})});for(M=0;M<n.length;++M)for(var m=n[M].Fr,H=z.Mn(a,m),w=0;w<H;w++){var y=z.Ni(a,m,w),Q=z.Va(a,y),S=z.Wd(a,y,m,0);0==S[1]||"BSDF_GLOSSY"!=Q.type&&"BSDF_DIFFUSE"!=Q.type&&"MIX_SHADER"!=Q.type&&"EMISSION"!=Q.type||(Q=1==S[1]?3:11,u.push([y,m,[1,Q]]),u.push([y,m,[2,Q+1]]),u.push([y,m,[3,Q+2]]),u.push([y,m,[4,Q+3]]),u.push([y,m,[5,Q+4]]),u.push([y,m,[6,Q+5]]),u.push([y,m,[7,Q+6]]),u.push([y,m,[8,Q+7]]))}}}B(a,f.data.value,k,h,b);for(g=0;g<v.length;g++)z.mo(a,v[g][0],v[g][1],
v[g][2]);for(g=0;g<u.length;g++)z.fd(a,u[g][0],u[g][1],u[g][2]);f=z.mg(a,d);k=[];l=[];v={};for(g=0;g<f;g++)u=z.Tg(a,d,g),u in v||(v[u]=0),M=z.Wd(a,d,u,v[u]++),k.push([d,u,M]),l.push([h,u,M]);for(g=0;g<k.length;g++)z.mo(a,k[g][0],k[g][1],k[g][2]);for(g=0;g<l.length;g++)z.fd(a,l[g][0],l[g][1],l[g][2]);z.pg(a,d)}}function B(a,b,c,e,d){var f=[],k={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},h=ba(a,k,0,d,null),l=h;t(a,c,h,"E");t(a,c,h,"A");t(a,c,h,"D");for(var h=Ha.B(),h=ea.jc(h,"LAMP",ea.Dc),v,u,
q=0;q<h.length;q++){k={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};v=ba(a,k,0,d,null);k={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};u=ba(a,k,0,d,null);t(a,l,u,"color");t(a,l,u,"specular");t(a,v,u,"ldir");t(a,c,u,"normal");t(a,c,u,"D");t(a,c,u,"S");t(a,v,u,"lcolorint");t(a,c,v,"shadow_factor");l=b.eR;k={name:l,type:l};l=ba(a,k,0,d,null);t(a,v,l,"ldir");t(a,v,l,"lfac");t(a,c,l,"normal");t(a,v,l,"norm_fac");t(a,c,l,"bsdf_params");t(a,l,u,"lfactor");t(a,l,u,"sfactor");for(l=0;l<f.length;l++)z.fd(a,f[l][0],
u,f[l][1]);l=u}t(a,c,e,"s_color");t(a,c,e,"metalness");t(a,c,e,"e_color");t(a,c,e,"emission");t(a,l,e,"color");t(a,l,e,"specular")}function m(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function x(a,b){z.sg(a,function(c,e,d){var f=z.Va(a,e);e==b&&"Color"==f.L[d[1]].identifier&&z.mo(a,c,e,d)})}function g(){var a=z.create(),b={data:null,Rb:[],qb:[],L:[{Da:new Float32Array([0,0,0]),identifier:"Color",ab:!1,name:"Color"},{Da:1,identifier:"Alpha",
ab:!1,name:"Alpha"}],fb:[],type:"OUTPUT",li:[]};z.zj(a,0,b);return a}function l(a){z.oa(a,function(b,c){for(var e=c.L,d=c.fb,f=0;f<e.length;f++)h(a,e[f],b,f,1);for(f=0;f<d.length;f++)h(a,d[f],b,f,0)})}function h(a,b,c,e,d){if(b.ab){var f=!0;z.sg(a,function(a,b,k){if(!d&&a==c&&k[0]==e||d&&b==c&&k[1]==e)f=!1});f&&(b.ab=!1)}}function w(a,b,c){var e=[];z.sg(a,function(d,f,k){var h=z.Va(a,d),l=z.Va(a,f),h=Da.ek(h.fb[k[0]].Da),l=Da.ek(l.L[k[1]].Da);if(h!=l){var v,u={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},g={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!l?v=q("vector_to_scalar","B4W_VECTOSCAL",[u],[g]):!h&&l&&(v=q("scalar_to_vector","B4W_SCALTOVEC",[g],[u]));ba(a,v,0,b,c);e.push([d,f,a.X[a.X.length-2],k])}});for(var d=0;d<e.length;++d)z.mo(a,e[d][0],e[d][1],e[d][3]),z.fd(a,e[d][0],e[d][2],[e[d][3][0],0]),z.fd(a,e[d][2],e[d][1],[0,e[d][3][1]])}function f(a){var b=[];z.oa(a,function(c,e){switch(e.type){case "B4W_TRANSLUCENCY":z.sg(a,function(d,f,k){var h=
z.Va(a,f);d==c&&"MATERIAL_EXT"==h.type&&"Translucency"==e.fb[k[0]].name&&b.push(d,f,[k[0]+1,k[1]+1])})}});for(var c=0;c<b.length;c+=3)z.fd(a,b[c],b[c+1],b[c+2])}function C(a,b){var c=[];z.oa(b,function(b,e){e.name==a.name&&c.push(b)});if(c.length)return c;Da.q("Node not found")}function K(a){var b=[];z.oa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var e=b[c],d=b[c+1];if("B4W_PARALLAX"==d.type)G(a,e,d);else if("REROUTE"==d.type){for(var f=
z.Ni(a,e,0),k=z.mg(a,e),h=[],l=[],v=[],u=0;u<k;u++){var q=z.Tg(a,e,u),g=l.indexOf(q),m=0<=g?v[m]:0,H=z.Wd(a,e,q,m);if(H){var H=H[1],M=d.L[0].Da,H=z.Va(a,q).L[H];switch(typeof M){case "number":if("object"==typeof H.Da)for(var n=H.Da,H=0;H<n.length;H++)n[H]=M;else"number"==typeof H.Da&&(H.Da=M);break;case "object":if("object"==typeof H.Da)for(n=H.Da,H=0;H<n.length;H++)n[H]=M[H];else"number"==typeof H.Da&&(H.Da=.35*M[0]+.45*M[1]+.2*M[2])}}M=d.fb;for(H=0;H<M.length;H++)M[H].Da=d.L[0].Da;-1!=g?v[g]+=1:
(l.push(q),v.push(1),h.push(e,q))}if(-1!=f)for(d=z.Wd(a,f,e,0)[0],u=0;u<l.length;u++)for(H=0;H<v[u];H++)k=z.Wd(a,e,l[u],H)[1],z.fd(a,f,l[u],[d,k]);for(u=0;u<h.length;u+=2)z.vk(a,h[u],h[u+1],-1)}}}function G(a,b,c){var e;a:{e=a.Qa;for(var d=0;d<e.length;d+=3)if(e[d+1]==b&&1==e[d+2][1]){e=e[d];break a}e=-1}-1!=e&&(d=z.Va(a,e),c.data=d.data,z.vk(a,e,b,-1),0==z.mg(a,e)&&(b=z.Ni(a,e,0),-1!=b&&z.vk(a,b,e,-1),z.pg(a,e)));c.L.splice(1,1)}function L(a){N(a);E(a);D(a)}function D(a){var b=[],c="",e="",d={};
z.oa(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var k=f.data.value;c?c==k||e||(e=k,d[e]=0):(c=k,d[c]=0);d[k]++}});for(var f in d)if(2>d[f]){for(var h=0;h<b.length;h+=2)b[h+1].data.value==f&&b.splice(h,2);delete d[f];c==f&&(c=e,e="");e==f&&(e="")}if(!(3>b.length)){var h={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},l={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=q("merged_uv","UV_MERGED",
[],[h,l]);f.uv_layer=c;ba(a,f,0,"",void 0);var v=a.X[a.X.length-2];f=a.X[a.X.length-1];if(e){l=q("merged_uv","UV_MERGED",[],[h,l]);l.uv_layer=e;ba(a,l,0,"",void 0);var u=a.X[a.X.length-2],l=a.X[a.X.length-1]}else l=null;for(var g=-1,m=null,h=0;h<b.length;h+=2){var H=b[h],M=b[h+1];k(M,b[1])?(g=v,m=f):l&&(g=u,m=l);for(var n=[],w=z.mg(a,H),y={},Q=0;Q<w;Q++){var S=z.Tg(a,H,Q);S in y||(y[S]=0);var X=z.Wd(a,H,S,y[S]++);n.push(H,S,X);X=X.splice(0,X.length);switch(M.type){case "GEOMETRY_UV":X[0]=0;m.fb[0].ab=
!0;break;case "UVMAP":case "TEX_COORD_UV":X[0]=1,m.fb[1].ab=!0}z.fd(a,g,S,X)}for(var Q=0;Q<n.length;Q+=3)z.vk(a,n[Q],n[Q+1],0);z.pg(a,H)}}}function N(a){var b=[];z.oa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var e=[],d=0;d<b.length;d+=2){for(var f=b[d],k=b[d+1],h=!0,l=0;l<e.length;l++){var v=e[l];if(c(k,
v.vf)){h=[];l=z.mg(a,f);for(g=0;g<l;g++){var u=z.Tg(a,f,g),q=z.Wd(a,f,u,0);h.push(f,u,q);z.fd(a,v.id,u,q)}for(var g=0;g<h.length;g+=3)z.vk(a,h[g],h[g+1],0);z.pg(a,f);h=!1;break}}h&&(v={id:f,vf:k},e.push(v))}}function I(a){for(var b={},c=0;c<a.X.length;c+=2){var e=a.X[c];b[e]={Ip:{},vJ:!1}}for(c=0;c<a.Qa.length;c+=3)b[a.Qa[c+1]].Ip[a.Qa[c]]=!0;for(e in b)O(e,b);for(e in b)b[e]=Object.keys(b[e].Ip).map(function(a){return parseInt(a)});return b}function O(a,b){var c=b[a];if(!c.vJ){var e=Da.P(c),d;for(d in c.Ip){O(d,
b);var c=b[d],f;for(f in c.Ip)e.Ip[f]=!0}e.vJ=!0;b[a]=e}}function E(a){var b=[];z.oa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var e=I(a),d=[],f=0;f<b.length;f+=2){for(var k=b[f],h=b[f+1],l=!0,v=0;v<d.length;v++){var u=d[v];if(!(3<=u.Yn.length||!c(h,u.vf)||-1<e[k].indexOf(u.id)||-1<e[u.id].indexOf(k))){for(var q=!1,g=0;g<u.Yn.length;g++){var m=u.Yn[g].id;if(-1<e[k].indexOf(m)||-1<e[m].indexOf(k)){q=!0;break}}if(!q){for(var v=[],m=z.Mn(a,k),H=
{},g=0;g<m;g++)q=z.Ni(a,k,g),q in H||(H[q]=0),l=z.Wd(a,q,k,H[q]++),v.push(q,k,l);for(var m=[],H=z.mg(a,k),M={},g=0;g<H;g++)q=z.Tg(a,k,g),q in M||(M[q]=0),l=z.Wd(a,k,q,M[q]++),m.push(k,q,l);l=v.concat(m);for(g=0;g<l.length;g+=3)z.vk(a,l[g],l[g+1],0);z.pg(a,k);g={id:k,vf:h,CT:v,DT:m};u.Yn.push(g);l=!1;break}}}l&&(u={id:k,vf:h,Yn:[]},d.push(u))}for(f=0;f<d.length;f++){u=d[f];e=u.Yn.length;for(v=0;v<e;v++){h=u.Yn[v];g=h.vf;k=h.CT;h=h.DT;u.vf.L[v+1].ab=g.L[0].ab;u.vf.L[v+1].Da=g.L[0].Da;u.vf.fb[2*(v+1)].ab=
g.fb[0].ab;u.vf.fb[2*(v+1)].Da=g.fb[0].Da;u.vf.fb[2*(v+1)+1].ab=g.fb[1].ab;u.vf.fb[2*(v+1)+1].Da=g.fb[1].Da;for(g=0;g<k.length;g+=3)q=k[g],l=k[g+2],l[1]+=v+1,z.fd(a,q,u.id,l);for(g=0;g<h.length;g+=3)q=h[g+1],l=h[g+2],l[0]+=2*(v+1),z.fd(a,u.id,q,l);u.vf.Rb.push(["USE_uv"+(v+2),1])}z.pg(a,u.id);z.zj(a,u.id,u.vf)}}}function c(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.tz==b.data.value.tz&&a.data.value.Ln==b.data.value.Ln;default:return!1}}function k(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function y(a){var b=[],c=[];z.oa(a,function(a,e){"GEOMETRY_VC"==e.type&&b.push(a,e);"GEOMETRY_VW"==e.type&&c.push(a,e)});A(a,b);e(a,c)}function A(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=b[c+1],f=!1,k=[],h=[],l=[[],
[],[]],v=z.mg(a,e),u=0;u<v;u++){var g=z.Tg(a,e,u);if("SEPRGB"!=z.Va(a,g).type){f=!1;break}k.push(e,g);for(var q={},m=z.mg(a,g),f=0;f<m;f++){var H=z.Tg(a,g,f);H in q||(q[H]=0);var M=z.Wd(a,g,H,q[H]++);k.push(g,H);l[M[0]].push(e,H,M)}h.push(g);f=!0}if(f){for(u=e=v=0;u<l.length;u++)l[u].length&&(v++,e|=1<<2-u);if(v){d.type+=v;d.fb=[];for(u=0;u<l.length;u++)if(l[u].length)for(d.fb.push({Da:0,identifier:"RGB"[u],ab:!0,name:"RGB"[u]}),f=0;f<l[u].length;f+=3)l[u][f+2][0]=Da.oo(e,u);for(u=0;u<k.length;u+=
2)z.vk(a,k[u],k[u+1],0);for(u=0;u<h.length;u++)z.pg(a,h[u]);for(u=0;u<l.length;u++)for(f=0;f<l[u].length;f+=3)z.fd(a,l[u][f],l[u][f+1],l[u][f+2])}}}}function e(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=!0,f=[],k=z.mg(a,e),h=0;h<k;h++){var l=z.Tg(a,e,h);if("B4W_REFLECT"==z.Va(a,l).type){var u=z.Wd(a,e,l,0),v=z.Wd(a,e,l,1);u&&1==u[1]||v&&1==v[1]?d=!1:f.push(e,l)}else d=!1}for(h=0;h<f.length;h+=2)k=a,u=f[h],l=f[h+1],v=z.Va(k,l),v.type+="_WORLD",z.vk(k,u,l,0),v.L.splice(0,1),u=z.Ni(k,l,0),u!=
z.Py&&(z.Wd(k,u,l,0)[1]=0);d&&z.pg(a,e)}}function R(a,b,c,e,d,f){a=a.nodes;for(var k=null,h=0;h<a.length;h++){var l=a[h];d?"GROUP"==l.type&&l.node_tree_name==c&&(k=l):l.type==c&&(k=l)}return k?C(k,b)[0]:(f||ya.error('No "'+c+'" node in node '+e),-1)}function q(a,b,c,e){return{name:a,type:b,inputs:c,outputs:e}}function ba(a,b,c,e,d){var f=b.name,k=b.type,h=[],l=[],g=[],q=[],m=null,n=[];switch(k){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":l=
Q(b);g=ca(b);ya.warn(k+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":l=Q(b);g=ca(b);break;case "MIX_SHADER":l.push(H(b,"Fac"));var y=H(b,"Shader"),g=y.ab;l.push(y);(y=H(b,"Shader_001"))||(y=H(b,"Shader.001"));var w=y.ab;l.push(y);l.push(u("d_color1","d_color1",[0,0,0],g));l.push(u("d_roughness1","d_roughness1",0,g));l.push(u("s_color1","s_color1",[0,0,0],g));l.push(u("s_roughness1","s_roughness1",0,g));l.push(u("metalness1","metalness1",0,g));l.push(u("normal1","normal1",
[0,0,0],g));l.push(u("e_color1","e_color1",[0,0,0],g));l.push(u("emission1","emission1",0,g));l.push(u("d_color2","d_color2",[0,0,0],w));l.push(u("d_roughness2","d_roughness2",0,w));l.push(u("s_color2","s_color2",[0,0,0],w));l.push(u("s_roughness2","s_roughness2",0,w));l.push(u("metalness2","metalness2",0,w));l.push(u("normal2","normal2",[0,0,0],w));l.push(u("e_color2","e_color2",[0,0,0],w));l.push(u("emission2","emission2",0,w));g=Z(b,"Shader");y=g.ab;g=[g,u("d_color","d_color",[0,0,0],y),u("d_roughness",
"d_roughness",0,y),u("s_color","s_color",[0,0,0],y),u("s_roughness","s_roughness",0,y),u("metalness","metalness",0,y),u("normal","normal",[0,0,0],y),u("e_color","e_color",[0,0,0],y),u("emission","emission",0,y)];break;case "OBJECT_INFO":var l=Q(b),g=[],y=Z(b,"Location"),w=Z(b,"Object Index"),S=Z(b,"Material Index"),X=Z(b,"Random");g.push(y);g.push(w);g.push(S);g.push(X);n.push(["USE_LOCATION_OUT",y.ab|0]);n.push(["USE_OBJ_IND_OUT",w.ab|0]);n.push(["USE_MAT_IND_OUT",S.ab|0]);n.push(["USE_RANDOM_OUT",
X.ab|0]);break;case "UVMAP":(y=b.uv_layer)||(k="EMPTY_UV");"EMPTY_UV"!=k&&(m=U("param_"+k+"_a"),w=U("param_"+k+"_v"),h.push(ja(m)),h.push(ja(w)),q.push(ja(w)),m={name:m,value:y});g=ca(b);break;case "UV_MERGED":m=U("param_UV_MERGED_a");w=U("param_UV_MERGED_v");h.push(ja(m));h.push(ja(w));g.push(Z(b,"UV_geom"));g.push(Z(b,"UV_cycles"));q.push(ja(w));m={name:m,value:b.uv_layer};break;case "CAMERA":l=[];g=ca(b);break;case "COMBRGB":case "COMBHSV":l=Q(b);g=ca(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
k?(P(b,0,0)&&n.push(["READ_R",1]),P(b,1,0)&&n.push(["READ_G",1]),P(b,2,0)&&n.push(["READ_B",1]),P(b,3,0)&&n.push(["READ_A",1])):(P(b,0,-1)&&n.push(["READ_R",1]),P(b,1,-1)&&n.push(["READ_G",1]),P(b,2,-1)&&n.push(["READ_B",1]));l=Q(b);g=ca(b);m={value:b};break;case "PARTICLE_INFO":l=Q(b);g=ca(b);for(y=0;y<b.outputs.length;y++){w=b.outputs[y];S=w.identifier;X=ja("v_param_PART_INFO_"+S.replace(" ",""));if(w.is_linked)switch(S){case "Size":n.push(["PART_INFO_SIZE",na.M(1)]);break;case "Age":n.push(["PART_INFO_AGE",
na.M(1)]);break;case "Lifetime":n.push(["PART_INFO_LT",na.M(1)]);break;case "Location":n.push(["PART_INFO_LOC",na.M(1)]);break;case "Index":var A=ja("a_param_PART_INFO_"+w.identifier.replace(" ","")),m=A;n.push(["PART_INFO_IND",na.M(1)]);break;case "Velocity":n.push(["PART_INFO_VEL",na.M(1)]);break;case "Angular Velocity":n.push(["PART_INFO_A_VEL",na.M(1)])}"Age"!=S&&"Lifetime"!=S&&"Size"!=S&&(h.push(X),q.push(X))}A&&h.push(A);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!aa(b))return!0;k=v(b,c);
if(!k)return ya.error("Geometry output is not supported"),null;switch(k){case "GEOMETRY_UV":(y=b.uv_layer)||(k="EMPTY_UV");"EMPTY_UV"!=k&&(m=U("param_GEOMETRY_UV_a"),w=U("param_GEOMETRY_UV_v"),h.push(ja(m)),h.push(ja(w)),q.push(ja(w)),m={name:m,value:y});g.push(Z(b,"UV"));break;case "GEOMETRY_VC":(y=b.color_layer)||(k="EMPTY_VC");"EMPTY_VC"!=k&&(m=U("param_GEOMETRY_VC_a"),w=U("param_GEOMETRY_VC_v"),h.push(ja(m)),h.push(ja(w)),q.push(ja(w)),m={name:m,value:y});g.push(Z(b,"Vertex Color"));break;case "GEOMETRY_NO":g.push(Z(b,
"Normal"));break;case "GEOMETRY_TRN":k="GEOMETRY_NO";g.push(Z(b,"True Normal"));ya.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":g.push(Z(b,"Front/Back"));break;case "GEOMETRY_VW":g.push(Z(b,"View"));break;case "GEOMETRY_GL":g.push(Z(b,"Global")||Z(b,"Position"));break;case "GEOMETRY_LO":g.push(Z(b,"Local"));break;case "GEOMETRY_OR":y=U("param_GEOMETRY_OR_v");h.push(ja(y));g.push(Z(b,"Orco"));q.push(ja(y));break;case "GEOMETRY_IN":g.push(Z(b,"Incoming"));break;
case "GEOMETRY_BF":g.push(Z(b,"Backfacing"))}break;case "TEX_COORD":if(!aa(b))return!0;k=fa(b,c);switch(k){case "TEX_COORD_UV":(y=b.uv_layer)||(k="EMPTY_UV");"EMPTY_UV"!=k&&(m=U("param_TEX_COORD_UV_a"),w=U("param_TEX_COORD_UV_v"),h.push(ja(m)),h.push(ja(w)),q.push(ja(w)),m={name:m,value:b.uv_layer});g.push(Z(b,"UV"));break;case "TEX_COORD_NO":g.push(Z(b,"Normal"));break;case "TEX_COORD_GE":y=U("param_TEX_COORD_GE_v");h.push(ja(y));g.push(Z(b,"Generated"));q.push(ja(y));break;case "TEX_COORD_OB":g.push(Z(b,
"Object"));break;case "TEX_COORD_CA":g.push(Z(b,"Camera"));break;case "TEX_COORD_WI":g.push(Z(b,"Window"));break;case "TEX_COORD_RE":g.push(Z(b,"Reflection"))}break;case "GROUP":y=b.node_tree_name;switch(y){case "B4W_LINEAR_TO_SRGB":if(!J(b,[1],[1])){m=F(b,e,d);break}k="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!J(b,[1],[1])){m=F(b,e,d);break}k="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!J(b,[1],[1])){m=F(b,e,d);break}k="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!J(b,
[1,1],[1])){m=F(b,e,d);break}k="B4W_REFLECT";break;case "B4W_REFRACTION":if(!J(b,[1,0],[1])){m=F(b,e,d);break}k="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!J(b,[1,1,0,0,0],[1])){m=F(b,e,d);break}w=U("param_B4W_PARALLAX_texture");q.push(ja(w));k="B4W_PARALLAX";break;case "B4W_CLAMP":if(!J(b,[1],[1])){m=F(b,e,d);break}k="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!J(b,[0,0,0,0,0],[0])){m=F(b,e,d);break}k="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!J(b,[],[0])){m=F(b,e,d);break}k="B4W_TIME";break;
case "B4W_SMOOTHSTEP":if(!J(b,[0,0,0],[0])){m=F(b,e,d);break}k="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":k="B4W_GLOW_OUTPUT";break;default:m=F(b,e,d)}l=Q(b);g=ca(b);"B4W_TRANSLUCENCY"==y&&(y=u("TranslucencyParams","TranslucencyParams",[0,0,0,0]),y.ab=g[0].ab,g.push(y));break;case "LAMP":m=b.lamp;if(!m)return ya.error("There is no lamp in node: "+b.name),null;g.push(Z(b,"Color"));g.push(Z(b,"Light Vector"));g.push(Z(b,"Distance"));g.push(Z(b,"Visibility Factor"));m.uuid in Ka?n.push(["LAMP_INDEX",
String(Ka[m.uuid])]):(Ka[m.uuid]=Na,n.push(["LAMP_INDEX",String(Na++)]));m=Ka;break;case "LIGHTING_AMBIENT":l=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0)];g=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":g=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("dif_params","dif_params",[0,0],!0),u("sp_params","sp_params",[0,0],!0),u("shadow_factor","shadow_factor",
0,!0),u("translucency_color","translucency_color",0,!0),u("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":l=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":l=[u("shadow_factor","shadow_factor",0,!0)];g=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("lcolorint","lcolorint",[0,0,0],!0),u("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":l=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal",
"normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0)];g=[u("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":l=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("dif_params","dif_params",[0,0],!0)];g=[u("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":l=
[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("sp_params","sp_params",[0,0],!0)];g=[u("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":l=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("sp_params","sp_params",[0,0],!0)];g=[u("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":l=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("bsdf_params","bsdf_params",[0,0,0,0],!0)];g=[u("lfactor","lfactor",0,!0),u("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":l=[u("color","color",[0,0,0,0],!0),u("specular","specular",[0,0,0],!0),u("lfactor","lfactor",0,!0),u("sfactor","sfactor",0,!0),u("ldir","ldir",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("translucency_params",
"translucency_params",[0,0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("lcolorint","lcolorint",[0,0,0],!0),u("translucency_color","translucency_color",0,!0)];g=[u("color","color",[0,0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "NORMAL":l=Q(b);g=ca(b);y=Z(b,"Normal");q.push(ja(U("param_NORMAL_Normal"),y.Da,3));break;case "MAPPING":y=b.vector_type;k="MAPPING";l.push(H(b,"Vector"));g.push(Z(b,"Vector"));var w=Da.yf(b.rotation),S=Da.yf(b.scale),X=Da.yf(b.translation),A=ma.create(),
p=Da.LT(w);"TEXTURE"==y&&(S[0]=S[0]||1,S[1]=S[1]||1,S[2]=S[2]||1);var Y=new Float32Array([S[0],0,0,0,S[1],0,0,0,S[2]]);ma.multiply(p,Y,A);A=Da.tW(A,Ea.create());switch(y){case "POINT":A[12]=X[0];A[13]=X[1];A[14]=X[2];break;case "TEXTURE":A[12]=X[0];A[13]=X[1];A[14]=X[2];A=Ea.invert(A,A);break;case "NORMAL":Ea.invert(A,A),Ea.transpose(A,A)}switch(y){case "NORMAL":n.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":n.push(["MAPPING_TRS_MATRIX_DEF",1]);n.push(["MAPPING_TRS_MATRIX",na.M(A,16)]);break;case "POINT":0!==
Ra.length(w)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),n.push(["MAPPING_TRS_MATRIX",na.M(A,16)])):(0!==Ra.length(S)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",na.M(S,3)])),0!==Ra.length(X)&&(n.push(["MAPPING_TRANS_DEF",1]),n.push(["MAPPING_TRANS",na.M(X,3)])));break;case "VECTOR":0!==Ra.length(w)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),n.push(["MAPPING_TRS_MATRIX",na.M(A,16)])):0!==Ra.length(S)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",na.M(S,3)]))}b.use_min&&(n.push(["MAPPING_MIN_CLIP_DEF",
1]),n.push(["MAPPING_MIN_CLIP",na.M(b.min,3)]));b.use_max&&(n.push(["MAPPING_MAX_CLIP_DEF",1]),n.push(["MAPPING_MAX_CLIP",na.M(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":m=[];y=[];w=[];S=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("dif_params","dif_params",[0,0],!0),u("sp_params","sp_params",[0,0],!0),u("shadow_factor","shadow_factor",0,!0)];X=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0),
u("normal","normal",[0,0,0],!0)];A=[Z(b,"Color"),Z(b,"Alpha"),Z(b,"Normal")];p=[];Y=H(b,"Color");Y.Da.splice(3);w.push(Y);l.push(Y);Y=H(b,"Spec");Y.Da.splice(3);w.push(Y);l.push(Y);(Y=H(b,"DiffuseIntensity"))||(Y=H(b,"Refl"));Y.Da=b.diffuse_intensity;w.push(Y);l.push(Y);var C=H(b,"Normal");C.Da.splice(3);w.push(C);l.push(C);"MATERIAL_EXT"==k?((Y=H(b,"Emit"))||(Y=u("Emit","Emit",0)),w.push(Y),l.push(Y),(Y=H(b,"Translucency"))?(Y.Da=0,Y.name="Translucency",Y.identifier="Translucency"):Y=u("Translucency",
"Translucency",0),l.push(Y),(Y=H(b,"Translucency"))?(Y.Da=[0,0,0,0],Y.name="TranslucencyParams",Y.identifier="TranslucencyParams"):Y=u("TranslucencyParams","TranslucencyParams",[0,0,0,0]),l.push(Y),g=H(b,"Reflectivity"),Y=H(b,"Ray Mirror"),g?(Y=g,g="Reflectivity"):Y?g="Ray Mirror":(Y=g,g="Reflectivity"),Y||(Y=u(g,g,0)),l.push(Y),X.push(Y),(Y=H(b,"SpecTra"))||(Y=u("SpecTra","SpecTra",0)),l.push(Y),X.push(Y),(Y=H(b,"Alpha"))||(Y=u("Alpha","Alpha",b.alpha)),l.push(Y),X.push(Y),A.push(Z(b,"Diffuse")),
A.push(Z(b,"Spec")),m.push(["MATERIAL_EXT",1]),y.push(["MATERIAL_EXT",1])):(w.push(u("emit_intensity","emit_intensity",0)),X.push(u("reflect_factor","reflect_factor",0)),X.push(u("specular_alpha","specular_alpha",0)),X.push(u("alpha_in","alpha_in",0)),A.push(u("diffuse_out","diffuse_out",0)),A.push(u("spec_out","spec_out",0)),m.push(["MATERIAL_EXT",0]),y.push(["MATERIAL_EXT",0]));p.push(ja(U("param_MATERIAL_alpha"),b.alpha));p.push(ja(U("param_MATERIAL_spec_alpha"),b.specular_alpha));g=A;m.push(["USE_MATERIAL_NORMAL",
C.ab|0]);b.use_diffuse&&(m.push(["USE_MATERIAL_DIFFUSE",1]),y.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&y.push(["USE_MATERIAL_SPECULAR",1]);var Y=[],R=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":C=b.specular_hardness;break;case "WARDISO":C=b.specular_slope;break;case "TOON":C=b.specular_toon_size;R=b.specular_toon_smooth;break;case "BLINN":C=b.specular_ior;R=b.specular_hardness;break;default:ya.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),C=b.specular_hardness}var x,qa;switch(b.diffuse_shader){case "LAMBERT":qa=x=0;break;case "OREN_NAYAR":x=b.roughness;qa=0;break;case "FRESNEL":x=b.diffuse_fresnel;qa=b.diffuse_fresnel_factor;break;case "MINNAERT":x=b.darkness;qa=0;break;case "TOON":x=b.diffuse_toon_size;qa=b.diffuse_toon_smooth;break;default:ya.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),qa=x=0}Y.push(ja(U("param_MATERIAL_diffuse"),[x,qa],2));Y.push(ja(U("param_MATERIAL_spec"),[b.specular_intensity,
C,R],3));m.push(["SHADELESS_MAT",b.use_shadeless?1:0]);C={name:b.name,value:{rs:b.specular_shader,Aq:b.diffuse_shader,Fe:b.use_shadeless,Nm:b.use_tangent_shading}};m={name:b.name,value:{rs:b.specular_shader,Aq:b.diffuse_shader,Fe:b.use_shadeless,Nm:b.use_tangent_shading},uW:{name:"material_begin",type:"MATERIAL_BEGIN",L:w,fb:S,qb:Y,data:C,Rb:m,li:[]},vW:{name:"material_end",type:"MATERIAL_END",L:X,fb:A,qb:p,data:C,Rb:y,li:[]}};break;case "BSDF_DIFFUSE":l=Q(b);n.push(["USE_NORMAL_IN",l[2].ab|0]);g=
Z(b,"BSDF");y=g.ab;g=[g,u("d_color","d_color",[0,0,0],y),u("d_roughness","d_roughness",0,y),u("s_color","s_color",[0,0,0],y),u("s_roughness","s_roughness",0,y),u("metalness","metalness",0,y),u("normal","normal",[0,0,0],y),u("e_color","e_color",[0,0,0],y),u("emisson","emisson",0,y)];break;case "BSDF_GLOSSY":l=Q(b);n.push(["USE_NORMAL_IN",l[2].ab|0]);g=Z(b,"BSDF");y=g.ab;g=[g,u("d_color","d_color",[0,0,0],y),u("d_roughness","d_roughness",0,y),u("s_color","s_color",[0,0,0],y),u("s_roughness","s_roughness",
0,y),u("metalness","metalness",1,y),u("normal","normal",[0,0,0],y),u("e_color","e_color",[0,0,0],y),u("emisson","emisson",0,y)];break;case "EMISSION":l=Q(b);g=Z(b,"Emission");y=g.ab;g=[g,u("d_color","d_color",[0,0,0],y),u("d_roughness","d_roughness",0,y),u("s_color","s_color",[0,0,0],y),u("s_roughness","s_roughness",0,y),u("metalness","metalness",1,y),u("normal","normal",[0,0,0],y),u("e_color","e_color",[0,0,0],y),u("emisson","emisson",1,y)];break;case "MATH":switch(b.operation){case "ADD":k="MATH_ADD";
break;case "SUBTRACT":k="MATH_SUBTRACT";break;case "MULTIPLY":k="MATH_MULTIPLY";break;case "DIVIDE":k="MATH_DIVIDE";break;case "SINE":k="MATH_SINE";break;case "COSINE":k="MATH_COSINE";break;case "TANGENT":k="MATH_TANGENT";break;case "ARCSINE":k="MATH_ARCSINE";break;case "ARCCOSINE":k="MATH_ARCCOSINE";break;case "ARCTANGENT":k="MATH_ARCTANGENT";break;case "POWER":k="MATH_POWER";break;case "LOGARITHM":k="MATH_LOGARITHM";break;case "MINIMUM":k="MATH_MINIMUM";break;case "MAXIMUM":k="MATH_MAXIMUM";break;
case "ROUND":k="MATH_ROUND";break;case "LESS_THAN":k="MATH_LESS_THAN";break;case "GREATER_THAN":k="MATH_GREATER_THAN";break;case "MODULO":k="MATH_MODULO";break;case "ABSOLUTE":k="MATH_ABSOLUTE";break;default:return ya.error("Unsupported MATH operation: "+b.operation),null}n.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);l=Q(b);g=ca(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":k="MIX_RGB_MIX";break;case "ADD":k="MIX_RGB_ADD";break;case "MULTIPLY":k="MIX_RGB_MULTIPLY";break;case "SUBTRACT":k=
"MIX_RGB_SUBTRACT";break;case "SCREEN":k="MIX_RGB_SCREEN";break;case "DIVIDE":k="MIX_RGB_DIVIDE";break;case "DIFFERENCE":k="MIX_RGB_DIFFERENCE";break;case "DARKEN":k="MIX_RGB_DARKEN";break;case "LIGHTEN":k="MIX_RGB_LIGHTEN";break;case "OVERLAY":k="MIX_RGB_OVERLAY";break;case "DODGE":k="MIX_RGB_DODGE";break;case "BURN":k="MIX_RGB_BURN";break;case "HUE":k="MIX_RGB_HUE";break;case "SATURATION":k="MIX_RGB_SATURATION";break;case "VALUE":k="MIX_RGB_VALUE";break;case "COLOR":k="MIX_RGB_COLOR";break;case "SOFT_LIGHT":k=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":k="MIX_RGB_LINEAR_LIGHT";break;default:return ya.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}n.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);l=Q(b);g=ca(b);break;case "OUTPUT":l=Q(b);g=[];break;case "OUTPUT_MATERIAL":Q(b);l=H(b,"Surface");g=l.ab;m=[l,u("d_color","d_color",[0,0,0],g),u("d_roughness","d_roughness",0,g),u("s_color","s_color",[0,0,0],g),u("s_roughness","s_roughness",0,g),u("metalness","metalness",0,g),u("normal","normal",
[0,0,0],g),u("e_color","e_color",[0,0,0],g),u("emission","emission",0,g)];y=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("bsdf_params","bsdf_params",[0,0,0,0],!0),u("shadow_factor","shadow_factor",0,!0),u("s_color","s_color",[0,0,0],!0),u("metalness","metalness",0,!0),u("e_color","e_color",[0,0,0],!0),u("emission","emission",0,!0)];w=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0),u("normal","normal",
[0,0,0],!0),u("s_color","s_color",[0,0,0],!0),u("metalness","metalness",0,!0),u("e_color","e_color",[0,0,0],!0),u("emission","emission",0,!0)];S=[];l=m;g=S;m={name:b.name,value:{eR:"BSDF_COMPUTE"},cR:{name:"bsdf_begin",type:"BSDF_BEGIN",L:m,fb:y,qb:[],data:null,Rb:[],li:[]},dR:{name:"bsdf_end",type:"BSDF_END",L:w,fb:S,qb:[],data:null,Rb:[],li:[]}};break;case "RGB":y=b.name;y={name:"-1",value:y};q.push(y);g.push(Z(b,"Color"));break;case "SEPRGB":case "SEPHSV":l=Q(b);g=ca(b);break;case "TEX_ENVIRONMENT":(y=
b.image)?(k="TEXTURE_ENVIRONMENT","NONE"==b.color_space?n.push(["NON_COLOR",1]):n.push(["NON_COLOR",0]),l.push(H(b,"Vector")),g.push(Z(b,"Color")),w=U("param_TEXTURE_texture"),q.push(ja(w)),m=ra.PG(128),m.source="ENVIRONMENT_MAP",ra.yF(m,y),m={name:w,value:m}):k="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(y=b.image){k="TEXTURE_COLOR";"NONE"==b.color_space?n.push(["NON_COLOR",1]):n.push(["NON_COLOR",0]);n.push(["CONVERT_UV",0]);for(w=0;4>w;++w)w?(Y=u("Vector"+w,"Vector"+w,[0,0,0],!1),S=u("Color"+w,"Color"+
w,[0,0,0],!1),X=u("Alpha"+w,"Alpha"+w,0,!1)):(Y=H(b,"Vector"),S=Z(b,"Color"),X=Z(b,"Alpha")),l.push(Y),g.push(S),g.push(X);w=U("param_TEXTURE_texture");q.push(ja(w));m=ra.Cl(ra.wh,!1);m.repeat="REPEAT"==b.extension;m.source="IMAGE";ra.yF(m,y);m={sz:b.name,name:w,value:m}}else k="TEXTURE_EMPTY";break;case "TEXTURE":k=M(b);if("TEXTURE_EMPTY"==k)g.push(Z(b,"Color")),g.push(Z(b,"Normal")),g.push(Z(b,"Value"));else if("TEXTURE_ENVIRONMENT"==k)l.push(H(b,"Vector")),g.push(Z(b,"Color")),g.push(Z(b,"Value"));
else{if("TEXTURE_NORMAL"==k&&"ENVIRONMENT_MAP"==b.texture.type)return ya.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==k&&(y=!1,(w=b.texture.image)&&"Non-Color"==w.colorspace_settings_name&&(y=!0),n.push(["NON_COLOR",Number(y)]),n.push(["CONVERT_UV",1]));for(w=0;4>w;++w)y="TEXTURE_COLOR"==k?"Color":"Normal",w?(Y=u("Vector"+w,"Vector"+w,[0,0,0],!1),S=u(y+w,y+w,[0,0,0],!1),X=u("Value"+w,"Value"+w,0,!1)):(Y=H(b,"Vector"),S=Z(b,y),X=Z(b,"Value")),l.push(Y),g.push(S),
g.push(X)}"TEXTURE_EMPTY"!=k&&(w=U("param_TEXTURE_texture"),q.push(ja(w)),m=b.texture.s,m={sz:b.texture.name,name:w,value:m});break;case "VALTORGB":l=Q(b);g=ca(b);m={value:b};y=b.color_ramp.interpolation;"CONSTANT"!=y&&"LINEAR"!=y&&ya.warn("Color Ramp node is not fully supported.");break;case "VALUE":k="VALUE";y=b.name;y={name:"-1",value:y};q.push(y);g.push(Z(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":k="VECT_MATH_ADD";break;case "SUBTRACT":k="VECT_MATH_SUBTRACT";break;case "AVERAGE":k=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":k="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":k="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":k="VECT_MATH_NORMALIZE";break;default:return ya.error("Unsupported VECT_MATH operation: "+b.operation),null}l=Q(b);g=ca(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":n.push(["VECTOR_TYPE",na.M(0)]);break;case "VECTOR":n.push(["VECTOR_TYPE",na.M(1)]);break;case "NORMAL":n.push(["VECTOR_TYPE",na.M(2)]);break;default:return ya.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}l=b.convert_from;g=b.convert_to;y=0;if("WORLD"==l)if("WORLD"==g)y=0;else if("OBJECT"==g)y=1;else if("CAMERA"==g)y=2;else return ya.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==l)if("WORLD"==g)y=3;else if("OBJECT"==g)y=4;else if("CAMERA"==g)y=5;else return ya.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==l)if("WORLD"==g)y=6;else if("OBJECT"==g)y=7;else if("CAMERA"==g)y=8;else return ya.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return ya.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;n.push(["CONVERT_TYPE",na.M(y)]);l=Q(b);g=ca(b);break;case "NORMAL_MAP":y=0;switch(b.space){case "TANGENT":y=0;break;case "OBJECT":y=1;break;case "WORLD":y=2;break;case "BLENDER_OBJECT":y=3;break;case "BLENDER_WORLD":y=4;break;default:return ya.error("Unsupported NORMAL_MAP space: "+b.space),null}n.push(["SPACE",na.M(y)]);l.push(H(b,"Strength"));l.push(H(b,"Color"));g.push(Z(b,"Normal"));break;
case "FRESNEL":C=H(b,"Normal");l.push(H(b,"IOR"));l.push(C);g.push(Z(b,"Fac"));n.push(["USE_FRESNEL_NORMAL",C.ab|0]);break;case "LAYER_WEIGHT":C=H(b,"Normal");l.push(H(b,"Blend"));l.push(C);g=ca(b);n.push(["USE_NORMAL_IN",C.ab|0]);break;case "BUMP":C=H(b,"Normal"),n.push(["INVERT",b.invert?1:0]),n.push(["USE_NORMAL_IN",C.ab|0]),Q(b),ca(b);default:l=Q(b),g=ca(b)}k={name:f,type:k,li:h,L:l,fb:g,qb:q,data:m,Rb:n};f=z.Sl(a);z.zj(a,z.Sl(a),k);if(!(k="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{k=b.outputs;for(q=h=0;q<k.length;q++)if(k[q].is_linked&&h++>c){k=!0;break a}k=!1}k=!k}return k||null!=ba(a,b,++c,e,d)?f:null}function J(a,b,c){for(var e=a.inputs,d=a.outputs,f=a.node_tree_name,k=0;k<b.length;k++){var h=e[k],l=b[k];if(!h||h.default_value instanceof Array!=l)return ya.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(k=0;k<c.length;k++)if(b=d[k],e=c[k],!b||b.default_value instanceof Array!=e)return ya.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function F(a,b,c){var e=a.node_group.node_tree,d={},f;for(f in e)if("links"==f||"nodes"==f){d[f]=[];for(var k=0;k<e[f].length;k++){d[f][k]={};for(var h in e[f][k])if("links"==f){d[f][k][h]={};for(var l in e[f][k][h])d[f][k][h][l]=V(e[f][k][h][l])}else d[f][k][h]=V(e[f][k][h])}}else d[f]=V(e[f]);e=a.node_tree_name;if("B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e)f=q("Group input","GROUP_INPUT",[],a.inputs),k=q("Group output",
"GROUP_OUTPUT",a.outputs,[]),h=null,h="B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e&&(da.quality==la.sp||da.JH)?{from_node:f,from_socket:f.outputs[1],to_node:k,to_socket:k.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:k,to_socket:k.inputs[0]},d.nodes=[f,k],d.links=[h];e=a.name;f=d.nodes;k=d.links;for(h=0;h<f.length;h++)f[h].name=pa(f[h].type,e,f[h].name);for(h=0;h<k.length;h++)k[h].from_node.name=pa(k[h].from_node.type,e,k[h].from_node.name),k[h].to_node.name=pa(k[h].to_node.type,e,k[h].to_node.name);
return{JW:n(d,a.node_group.uuid,!0,b,c).Wa,KW:d.links}}function V(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Da.fq(a):a}function U(a){wa[a]||(wa[a]=0);var b=a+"_"+wa[a],b=b.replace(/ /g,"_").replace(/\//g,"_");wa[a]++;return b}function aa(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function v(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var f=c[d];if(f.is_linked&&!(e++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function fa(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var f=c[d];if(f.is_linked&&!(e++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function M(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,e=!1,d=!1,f=0;f<b.length;f++){var k=b[f];if(k.is_linked)switch(k.identifier){case "Color":c=!0;break;case "Normal":e=!0;break;case "Value":d=!0;break;default:Da.q("Unknown texture output")}}if(c)return e&&
ya.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(e)return"TEXTURE_NORMAL";if(d)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function H(a,b){for(var c=a.inputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ha(d)}return null}function Z(a,b){for(var c=a.outputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ha(d)}return null}function ha(a){var b=
a.name,c=a.identifier,e=a.is_linked;a=a.default_value;a=Da.ek(a)?a.slice(0):a;return{name:b,identifier:c,ab:e,Da:a}}function u(a,b,c,e){return{name:a,identifier:b,ab:e,Da:c}}function Q(a){for(var b=[],c=0;c<a.inputs.length;c++){var e=ha(a.inputs[c]);e.Da.length&&e.Da.splice(3);b.push(e)}return b}function ca(a){for(var b=[],c=0;c<a.outputs.length;c++){var e=ha(a.outputs[c]);b.push(e)}return b}function ja(a,b,c){b=null===b||void 0===b?null:na.M(b,c);return{name:a,value:b}}function ua(a,b,c,e,d,f){var k=
[],h=f.from_socket.identifier;f=f.to_socket.identifier;var l=e.fb;for(e=0;e<l.length;e++)if(l[e].identifier==h){k.push(e);break}d=d.L;for(e=0;e<d.length;e++)if(d[e].identifier==f){k.push(e);break}2==k.length&&z.fd(a,b,c,k);return!0}function pa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function S(a){var b=[];z.oa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function Y(a,b,c){for(var e=0;e<c.length;e++){var d=c[e].data.JW,f=c[e].data.KW;if(!d)return!1;
z.oa(d,function(b,c){z.zj(a,z.Sl(a),c)});for(d=0;d<f.length;d++)b.push(f[d]);ta(c[e],b,a)}return!0}function qa(a,b,c,e,d,f){switch(a.type){case "GROUP":a.name==b&&e.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||d.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function sa(a,b,c){for(var e=[],d=0;d<c.length;d++){for(var f=c[d],k=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){k=b[h];break}k?(f.from_node=k.from_node,f.from_socket=k.from_socket):
e.push(f)}for(d=0;d<b.length;d++)a.splice(a.indexOf(b[d]),1);return e}function za(a,b){if(b.length)for(var c=b[0].from_node.name,e=0;e<a.length;e++)a[e].from_node.name==c&&b.push(a[e])}function X(a,b,c,e){for(var d=0;d<e.length;d++){for(var f=e[d],k,h=0;h<c.L.length;h++)if(f.from_socket.identifier==c.L[h].identifier){k=c.L[h].Da;break}for(var h=f,l=b,g=k,u=C(h.to_node,l),v=0;v<u.length;v++)for(var q=z.Va(l,u[v]),m=0;m<q.L.length;m++){var H=q.L[m];if(H.identifier==h.to_socket.identifier){q=H.Da instanceof
Object?0:1;if((g instanceof Object?0:1)==q)H.Da=g;else switch(q){case 0:H=H.Da;H[0]=H[1]=H[2]=g;break;case 1:H.Da=(g[0]+g[1]+g[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function ta(a,b,c){for(var e=a.name,d=[],f=[],k=[],h=[],l=0;l<b.length;l++){var g=b[l];qa(g.from_node,e,g,d,k,h);qa(g.to_node,e,g,f,k,h)}f=sa(b,f,k);d=sa(b,h,d);za(b,f);X(b,c,a,f);if(d.length){var u;z.oa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(e+"*GO*")||(u=b)});X(b,c,u,d)}}function oa(a){var b=[],c=[];z.oa(a,
function(a,e){switch(e.type){case "VALTORGB":b.push(e);break;case "CURVE_VEC":case "CURVE_RGB":c.push(e)}});var e=0,d=a=null,f=b.length+c.length;if(b.length){a=ra.PT(b,ra.LN);for(var k=0;k<b.length;k++)b[k].Rb.push(["NODE_TEX_ROW",na.M((e+.5)/f)]),e++}if(c.length)for(d=ra.TT(c,ra.mE),k=0;k<c.length;k++)c[k].Rb.push(["NODE_TEX_ROW",na.M((e+.5)/f)]),e++;k=null;a&&d?(k=new Uint8Array(a.length+d.length),k.set(a),k.set(d,a.length)):k=a?a:d;a=k?ra.OG(k,ra.mE):null;for(k=0;k<b.length;k++)b[k].data.jb=a;
for(k=0;k<c.length;k++)c[k].data.jb=a}function P(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var la=r("__config");r("__debug");var z=r("__graph"),ma=r("__mat3"),Ea=r("__mat4"),ea=r("__objects"),ya=r("__print"),na=r("__shaders"),Ha=r("__scenes"),Da=r("__util"),Ra=r("__vec3"),ra=r("__textures"),wa={},va={},xa={},Ka={},Na=0;new Float32Array(4);var da=la.A;a.l1=0;a.TP=1;a.SP=2;a.RP=3;a.k1=4;a.QP=5;a.PP=6;a.OP=7;a.j1=8;a.DO=0;
a.CO=1;a.c1=2;a.BO=3;a.b1=4;a.yI=function(a){return va[a]};a.SR=function(a){delete va[a]};a.$R=n;a.Yz=function(a,c,e){var d=Ha.B();a=m(a,"MAIN",d.uuid);if(a in xa)return xa[a];var d=z.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},k=ba(d,f,0,c,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=ba(d,f,0,c,null);b(d,e,k,f,[[k,[8,10]],[k,[9,6]]],c);l(d);return xa[a]=d};a.Xt=function(a){var b=[],c={};wa={};var e=z.DD(a);z.oa(e,function(a,e){var d;d=[];for(var f=[],k=[],h=[],l=[],g=[],u=0;u<
e.L.length;u++){var z=e.L[u];if(z.ab)d.push(null),f.push(null);else{d.push(U("in_"+e.type+"_"+z.identifier.replace(/\./g,"")));var v=na.M(z.Da,0);da.cD&&(0<=e.type.indexOf("MIX_RGB_")&&("Color1"==z.identifier||"Color2"==z.identifier||"Fac"==z.identifier)||0<=e.type.indexOf("MATH_")&&("Value"==z.identifier||"Value_001"==z.identifier||"Value.001"==z.identifier)||0<=e.type.indexOf("VECT_MATH_")&&("Vector_001"==z.identifier||"Vector.001"==z.identifier)||0<=e.type.indexOf("LIGHTING_APPLY")||0<=e.type.indexOf("MATERIAL_END")||
0<=e.type.indexOf("MATERIAL_BEGIN"))&&(z=v,z=z.replace(/(,)/g,"$1 "),z=z.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),z=z.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),v=z=z.replace(/\s+/g,""));f.push(v)}}for(u=0;u<e.fb.length;u++)z=e.fb[u],z.ab?k.push(null):k.push(U("out_"+e.type+"_"+z.identifier.replace(/\./g,"")));for(u=0;u<e.qb.length;u++)z=e.qb[u],h.push(z.name),l.push(z.value);for(u=0;u<e.li.length;u++)g.push(e.li[u].name);d={id:e.type,L:d,iB:f,fb:k,qb:h,hw:l,li:g,Rb:JSON.parse(JSON.stringify(e.Rb))};
b.push(d);c[a]=d});z.sg(e,function(a,b,d){var f=z.Va(e,a);z.Va(e,b);var k=f.fb[d[0]];a=c[a].fb;b=c[b].L;f=a[d[0]]||U("out_"+f.type+"_"+k.identifier.replace(/\./g,""));a[d[0]]=f;b[d[1]]=f});return b};a.tG=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.sa=function(){for(var a in va)delete va[a];for(a in xa)delete xa[a];for(var b in Ka)delete Ka[b];Na=0}};b4w.module.__debug=function(a,r){function n(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(){var a=l.PA();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=A;return b&&b.debug_view_mode==a.jp}function t(a,b,c){var e=l.PA(),d=0;if(e)for(c&&e.endQuery(),c=0;c<a.length;c++){var f=a[c],k=e.XH(f),h=O.getParameter(e.WH());k&&!h&&(d=e.YH(f)/1E6,b&&(d=D.vc(d,b,1,10)),a.splice(c,1),c--)}else d=performance.now()-
a.pop(),b&&(d=D.vc(d,b,1,10));return d}function p(a,b){B(a)||D.q("Structure assertion failed: invalid first object value");B(b)||D.q("Structure assertion failed: invalid second object value");m(a,b)||D.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.nB(a)||a instanceof Array)){for(var c in a)B(a[c])||D.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||D.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)B(b[c])||D.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||D.q("Structure assertion failed: missing key in the second object: "+c),m(a[c],b[c])||D.q("Structure assertion failed: incompatible types for key "+c)}}function B(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function m(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,e=b instanceof Array;if(c&&!e||!c&&e)return!1;
c=D.nB(a);e=D.nB(b);if(c&&!e||!c&&e)return!1}return!0}var x=r("__compat"),g=r("__config"),l=r("__extensions"),h=r("__graph"),w=r("__objects"),f=r("__print"),C=r("__scenes"),K=r("__subscene"),G=r("__textures"),L=r("__time"),D=r("__util"),N=g.A,I={},O=null,E={},c=[],k=-1,y=-1,A=null,e=null,R=!1,q={};a.Ws=0;a.Zx=1;a.Xs=2;a.Yx=3;a.Vs=4;a.Xx=5;a.Wx=6;a.jp=7;a.If=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var e=b[c];e in a&&(I[a[e]]=e)}O=a};a.SX=function(a){A=a};a.S3=function(){return A};a.YT=function(a,b,c,e,d){q[a]||(q[a]={wY:b,Ne:{}});c in q[a].Ne||(q[a].Ne[c]=e);d&&(q[a].Ne[c]=0)};a.gG=function(){var a=0,b;for(b in q)for(var c in q[b].Ne)a+=q[b].Ne[c];return a};a.YL=function(){var a={},b;for(b in q)for(var c in q[b].Ne){var e=q[b].Ne[c];if(e){var d=q[b].wY;d in a||(a[d]={ED:0,Ne:{}});c in a[d].Ne||(a[d].Ne[c]=0);a[d].Ne[c]+=e;a[d].ED+=e}}for(d in a){f.groupCollapsed(d,a[d].ED);for(c in a[d].Ne)f.Zd(c,
a[d].Ne[c]);f.groupEnd()}};a.FK=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,e=0,d=w.jc(C.Mh(),"MESH",w.Dc),k=0;k<d.length;k++)for(var h=0;h<d[k].I.length;h++)for(var l=0;l<d[k].I[h].U.length;l++){var g=D.Eh(d[k].I[h].U[l]),q=g.hb.tg+"/"+g.hb.Te;g["shaders_info.directives"]=g.hb.Hi;g["shaders_info.node_elements"]=g.hb.jg;delete g.hb;for(var m=0;m<b.length;m++)delete g[b[m]];
if(d[k].Ea)e++;else{c++;g.type in a||(a[g.type]={});q in a[g.type]||(a[g.type][q]={});for(var u in g)u in a[g.type][q]||(a[g.type][q][u]=[]),m=JSON.stringify(g[u]),-1==a[g.type][q][u].indexOf(m)&&a[g.type][q][u].push(m)}}f.group("Batches statistics:");f.Zd("STATIC/DYNAMIC count:",c+"/"+e);f.group("STATIC batches diversity:");for(var y in a)for(q in a[y]){b=[];for(u in a[y][q])1<a[y][q][u].length&&b.push([u,a[y][q][u]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){f.groupCollapsed(y+" "+q);for(k=0;k<b.length;k++)f.Zd(b[k][1].length,b[k][0],b[k][1]);f.groupEnd()}}f.groupEnd();f.groupEnd()};a.Dz=function(a){if(N.gl_debug){var b=O.getError();b!=O.NO_ERROR&&(b in I?D.q("GL Error: "+b+", gl."+I[b]+" ("+a+")"):D.q("Unknown GL error: "+b+" ("+a+")"))}};a.AR=function(){if(N.gl_debug||N.sG)switch(O.checkFramebufferStatus(O.FRAMEBUFFER)){case O.FRAMEBUFFER_COMPLETE:break;case O.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case O.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case O.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case O.FRAMEBUFFER_UNSUPPORTED:f.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case O.W_:f.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:f.error("FRAMEBUFFER CHECK FAILED")}};a.ER=function(){if(-1!=
k)return k;O.bindFramebuffer(O.FRAMEBUFFER,O.createFramebuffer());var a=G.Cl(G.fl,!1);G.resize(a,1,1);O.framebufferTexture2D(O.FRAMEBUFFER,O.DEPTH_ATTACHMENT,a.mb,a.rb,0);O.checkFramebufferStatus(O.FRAMEBUFFER)!=O.FRAMEBUFFER_COMPLETE?(k=!0,f.warn("depth-only issue was found")):k=!1;O.bindFramebuffer(O.FRAMEBUFFER,null);return k};a.KR=function(){if(1==N.Cc)return!1;if(-1!=y)return y;O.bindRenderbuffer(O.RENDERBUFFER,O.createRenderbuffer());O.renderbufferStorageMultisample(O.RENDERBUFFER,N.Cc,O.RGBA8,
1,1);var a=O.getRenderbufferParameter(O.RENDERBUFFER,O.RENDERBUFFER_SAMPLES);a!=N.Cc?(y=!0,f.warn("multisample issue was found: requested "+N.Cc+", got "+a),O.getError()==O.INVALID_OPERATION&&f.warn("the error from multisample issue detected, ignoring")):y=!1;O.bindRenderbuffer(O.RENDERBUFFER,null);return y};a.HR=function(){return x.Fz("Firefox")&&O.getError()==O.OUT_OF_MEMORY?(f.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.WK=function(a,b,c){N.gl_debug&&(c=n(c),f.error("shader compilation failed:\n"+
c+"\n"+O.getShaderInfoLog(a)+" ("+b+")"))};a.zX=function(a,b,c,e){N.gl_debug&&(c=n(c),e=n(e),f.error("shader linking failed:\n"+c+"\n\n\n"+e+"\n"+O.getProgramInfoLog(a)+" ("+b+")"))};a.AC=function(a){if(N.show_hud_debug_info||a.type==K.qp)a.sA||a.El.push(d())};a.uX=function(a){"MAIN"==a.type&&b()&&a.El.push(d())};a.BC=function(a){if((N.show_hud_debug_info||a.type==K.qp)&&!a.sA){var b=t(a.El,a.xf,!0);b&&(a.xf=b)}};a.vX=function(a){if("MAIN"==a.type&&b()){var c=t(a.El,a.xf,!0);c&&(a.xf=c)}};a.xJ=b;
a.iX=function(a){var b=t(a.El,a.xf,!1);b&&(a.xf=b)};a.g3=function(a){E[a]=a in E?E[a]+1:1};a.update=function(){for(var a in E)f.log(a,E[a]),E[a]=0};a.zu=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var e=arguments[b];if(D.ek(e))for(var d=0;d<e.length;d++)a.push(e[d]);else a.push(arguments[b])}c.push(a)};a.aK=function(){for(var a=1,b=0;b<c.length;b++){var e=c[b];e[1]==arguments[0]&&a++}e=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.ek(a))for(var d=0;d<a.length;d++)e.push(a[d]);
else e.push(arguments[b]);c.push(e)};var ba=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.GK=function(a){a||(a=1);for(var b=0,e={},d=Math.max(0,performance.now()-1E3*a),k=0;k<c.length;k++){var h=c[k];a=h[0];if(!(a<d)){var l=String(h[1]);e[l]||(e[l]=ba[b++%ba.length]);a=["%c"+(a/1E3).toFixed(6),e[l],l];for(l=2;l<h.length;l++)a.push(h[l]);f.log.apply(this,a)}}c.splice(0)};a.kC=function(a){a||(a=1);for(var b={},e=Math.max(0,performance.now()-1E3*a),d=0;d<c.length;d++){var k=
c[d];a=k[0];if(!(a<e))for(var h=2;h<k.length;h++){var l=String(k[1]);3<k.length&&(l+="_"+String(h-2));b[l]||(b[l]=l+"\n");b[l]+=String(a)+" "+k[h]+"\n"}}a="";for(l in b)a+=b[l]+"\n\n";f.log(a);c.splice(0)};a.c2=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.rG=function(a){if(D.ek(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.K1=function(a,b){a.constructor!=b&&D.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.M1=p;a.N1=function(a){R?p(a,e):R=!0;e=null!=a&&"object"==typeof a?D.fq(a):a};a.GH=function(a,
b,c,e,d){(a=a||null)||D.q("Stage load callback is undefined");b=b||5E3;c=c||0;e=e||100;100<e&&D.q("Max percentage must be less than 100");0>c&&D.q("Min percentage must be greater than 0");c>e&&D.q("Max percentage must be greater than min percentage");var f=L.en(c,e,b,function(b){b=b.toFixed();a(b);100==b&&(L.St(f),d&&d())})};a.h6=function(a){return h.mT(a,function(a,b){var c=b.type+"("+b.name+")",e=b.L,c=c+"\n\nINPUTS:";if(e.length)for(var d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?
c+"linked":c+e[d].Da;else c+="\n---";e=b.fb;c+="\n\nOUTPUTS:";if(e.length)for(d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?c+("linked(default "+e[d].Da+")"):c+"not used";else c+="\n---";d="";switch(b.type){case "GEOMETRY_UV":d="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":d="\ntexture: "+b.data.value.name+"\n("+b.data.value.Kn+")"}""==d&&(d="\n---");return c=c+"\n\nDATA:"+d},function(b,c,e){b=h.Va(a,b);c=h.Va(a,c);return b.fb[e[0]].identifier+"\n==>\n"+
c.L[e[1]].identifier})};a.Mu=function(){return O};a.sa=function(){A=null;q={}};a.reset=function(){O=null}};b4w.module.__compat=function(a,r){function n(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var t=r("__config"),p=r("__debug"),B=r("__extensions"),
m=r("__print"),x=r("__renderer"),g="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.JE=256;var l=t.ll,h=t.A,w=t.yq,f=t.context,C=t.Ci,K=t.W,G=t.C,L=t.Pd;a.tT=function(a){a.getError()==a.INVALID_ENUM&&m.warn("Possible Tegra invalid enum issue detected, ignoring")};a.yL=function(D,r){function I(a){r&&m.warn(a)}C.wW=D.getParameter(D.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
C.Mv=D.getParameter(D.MAX_FRAGMENT_UNIFORM_VECTORS);C.IB=D.getParameter(D.MAX_TEXTURE_IMAGE_UNITS);C.Nv=D.getParameter(D.MAX_VARYING_VECTORS);C.JB=D.getParameter(D.MAX_VERTEX_ATTRIBS);C.ZJ=D.getParameter(D.MAX_VERTEX_TEXTURE_IMAGE_UNITS);C.Br=D.getParameter(D.MAX_VERTEX_UNIFORM_VECTORS);C.Vi=D.getParameter(D.MAX_CUBE_MAP_TEXTURE_SIZE);C.FB=D.getParameter(D.MAX_RENDERBUFFER_SIZE);C.Bc=D.getParameter(D.MAX_TEXTURE_SIZE);C.KB=D.getParameter(D.MAX_VIEWPORT_DIMS);h.cc&&!w.enabled&&(h.mq=!0);h.cc?(h.Cc=
Math.min(h.Cc,D.getParameter(D.MAX_SAMPLES)),n("Firefox")&&(I("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),h.sG=!0),n("Windows")&&n("Chrome")&&(I("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),h.Cc=1)):h.Cc=1;n("Firefox")&&"NONE"!==h.stereo&&(I("Firefox and Stereo rendering detected, disable texture reusage"),h.HH=!0);if(h.cc&&p.KR()||n("Firefox"))I("Firefox detected, disabling multisample"),h.Cc=1;x.VX();var O=Boolean(B.IU());
n("Firefox/28.0")&&(n("Linux")||n("Macintosh"))&&(I("Firefox 28 detected, applying depth hack"),O=!1);n("Windows Phone")||(n("iPad")||n("iPhone")?(I("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),f.alpha||(h.background_color[3]=1),h.dL=!0,h.vN=!0,h.smaa=!1,h.ssao=!1,h.precision="highp",h.hB=!0,Boolean(B.EI())&&L.qw&&(h.nq="pvr")):n("Mac OS X")&&n("Safari")&&
!n("Chrome")&&(I("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),h.cL=!0,K.LF=!0,K.zG=!0));n("Windows")&&(n("Chrome/40")||n("Firefox/33")||n("Firefox/34")||n("Firefox/35")||n("Firefox/36"))&&(I("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),h.Iz=!0);n("Chrome")&&!d()&&t.tJ()&&(I('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
h.yG=!0);n("Mac OS X")&&(h.Kv=!0,I("OS X detected, applying shadows hack."));d()&&(I("Mobile detected, applying various hacks for video textures."),h.is_mobile_device=!0,n("iPad")||n("iPhone")||n("Windows Phone")||(I("Mobile (not iOS) detected, disable playback rate for video textures."),K.xH=!0));(n("Firefox/35.0")||n("Firefox/36.0"))&&n("Windows")&&(I("Windows/Firefox 35/36 detected, applying shadows slink hack"),h.XL=!0);if(n("iPhone")||b()||n("Edge"))I("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
h.gs=!0;10>C.Nv&&(I("Not enough varyings, disable shadows on blend objects"),h.qA=!0);n("Windows Phone")&&(I("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),h.debug_view=!1,h.precision="highp",h.Pi=!1,h.ssao=!1,h.smaa=!1,h.shadows=!1,h.reflections=!1,h.refractions=!1,h.KK=!1);if(n("UCBrowser")||n("Chrome")&&n("Nexus")&&h.is_mobile_device)I("Mobile Nexus Chrome or UCBrowser detected, disable workers."),G.Is=!1;var E=B.Qu();if(E){var c=
D.getParameter(E.UNMASKED_VENDOR_WEBGL),E=D.getParameter(E.UNMASKED_RENDERER_WEBGL),k=/\b4\d{2}\b/;-1<c.indexOf("ARM")&&k.test(E)&&(I("ARM Mali-400 series detected, applying depth and frames blending hacks"),O=!1,l.NH=!0);-1<c.indexOf("ARM")&&-1<E.indexOf("Mali-T604")&&(I('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),h.precision="highp",h.shadows=!1);-1<c.indexOf("ARM")&&-1<E.indexOf("Mali-T760")&&(I('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),h.precision=
"highp",h.ssao=!1,h.Qw=!0,h.cc&&(h.Cc=1,I("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<c.indexOf("Qualcomm")&&-1<E.indexOf("Adreno")&&(I("Qualcomm Adreno detected, applying shader constants hack."),h.cD=!0,-1<E.indexOf("305")&&(I('Qualcomm Adreno305 detected, set "highp" precision.'),h.precision="highp"),-1<E.indexOf("330")&&(I('Qualcomm Adreno330 detected, set "highp" precision.'),h.precision="highp"),-1<E.indexOf("420")&&(I("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
C.Bc=4096,C.Vi=4096));-1<c.indexOf("NVIDIA")&&-1<E.indexOf("Tegra 3")&&(I("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),h.JH=!0);n("Windows")&&n("Chrome")&&!n("Edge")&&(E.match(/NVIDIA GeForce 8..0/)||E.match(/NVIDIA GeForce 9..0/)||E.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(I("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),C.Vi=a.JE,h.FC=!0);-1<E.indexOf("AMD")&&n("Windows")&&n("Chrome")&&
(h.dz=!0);-1<E.indexOf("PowerVR")&&(I("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),h.FC=!0,h.Qw=!0,h.shadows=!1);c="";for(k=0;k<g.length;k++)if(-1<E.indexOf(g[k])){c=g[k];break}c&&(I("Architecture "+c+" detected. Blending between frames and shadows on blend objects will be disabled."),h.Qw=!0,h.qA=!0)}0==C.ZJ&&(I("Vertex textures are not allowed. Disabling vertex textures"),h.At=!1);O||(h.Nq=!1,h.jd=!1,h.water_dynamic=
!1,h.Dk=!1,h.Ow=!1,h.smaa=!1);h.gN=Boolean(B.II())||"pvr"==h.nq;h.pu=O;if(D.getShaderPrecisionFormat)var y=D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.HIGH_FLOAT);D.getShaderPrecisionFormat&&0!==y.precision||(h.precision="mediump");if(b()&&n("Touch")||n("Edge"))I("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),h.Jn=!0;if(b()||n("Edge"))h.oJ=!0;d()&&n("Firefox")&&(m.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
h.MB=!0,C.Bc=4096,C.Vi=4096);n("Edge")&&(I("Microsoft Edge detected, set up new minimal texture size."),h.Hq=!0)};a.Fz=n;a.qu=d;a.AQ=function(){n("Firefox/35.0")&&n("Windows")&&(m.warn("Windows/Firefox 35 detected, forcing context's alpha"),t.context.alpha=!0)};a.or=b};b4w.module.__renderer=function(a,r){function n(a){for(var e=a.p,d=a.Ra,l=null,m=K.fc(e.n,ba),H=0;H<d.length;H++){var y=d[H];if(y.ac){var n=y.yb,y=y.ra;if(n.Zh!=l){k.useProgram(n.Zh);for(var l=a,u=e,w=n,A=w.SM,C=A.length;C--;){var R=A[C];R.Cn(k,R.$e,l,u)}if(w.Er&&!w.Xv)for(w.hC.length||p(w),w=w.hC,C=w.length;C--;)R=w[C],R.Cn(k,R.$e,l,u);l=n.Zh}for(u=0;u<y.length;u++)if(A=y[u],A.ac){w=A.bf;C=A.za;g.uX(C);g.xJ()&&"DEBUG_VIEW"==C.type&&(C.wq=G.vc(B.PQ(C.qn),C.wq,1,15));if(V.alpha_sort&&C.of){var R=w,
A=A.qv,x=m,S=C.Ba,Y=D.dist(x,A.IN),qa=V.alpha_sort_threshold*Math.min(A.SQ,1);if(Y>qa||R.Rq)h.DZ(S,A,R.n,x),D.copy(x,A.IN),R.Rq=!1}R=a;A=C;x=n;qa=x.TM;for(S=qa.length;S--;)Y=qa[S],Y.Cn(k,Y.$e,w,A);if(x.Er&&!x.Xv){x.Mr.length||p(x);qa=x.Mr;for(S=qa.length;S--;)Y=qa[S],Y.Cn(k,Y.$e,w,A);x.Er=!1}k.depthMask(A.Ua);A.Xb?k.enable(k.CULL_FACE):k.disable(k.CULL_FACE);S=A.ya;Y=k;for(qa=0;qa<S.length;qa++){var E=S[qa];Y.activeTexture(Y.TEXTURE0+qa);Y.bindTexture(E.mb,E.rb)}if(R.type==f.zg){w=R;x=x.Im;S=w.p.qc.rb;
Y=w.Dl;for(qa=0;6>qa;qa++)if(E=b(qa),V.Iz?(k.bindTexture(k.TEXTURE_CUBE_MAP,S),k.texImage2D(E,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,c)):(k.uniformMatrix4fv(x.u_cube_view_matrix,!1,Y[qa]),k.uniform4fv(x.u_sky_tex_fac,w.Vw),k.uniform3fv(x.u_sky_tex_color,w.Tw),k.uniform1f(x.u_sky_tex_dvar,w.Uw),k.uniform3fv(x.u_horizon_color,w.he),k.uniform3fv(x.u_zenith_color,w.pe),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,E,S,0),q(A,0)),w.Vv&&3!=qa){var E=w,t=qa,X=F;V.Iz?X.set(c):(k.readPixels(191,
191,1,1,k.RGBA,k.UNSIGNED_BYTE,X),255!=X[0]&&255!=X[1]&&255!=X[2]||k.readPixels(191,220,1,1,k.RGBA,k.UNSIGNED_BYTE,X));var ta=X[0],O=X[1],X=X[2],ta=ta/255,O=O/255,X=X/255;2===t?(E.ue[3]=ta,E.ue[7]=O,E.ue[11]=X):2>t?(E.ue[4*t]=ta,E.ue[4*t+1]=O,E.ue[4*t+2]=X):(E.ue[4*(t-2)]=ta,E.ue[4*(t-2)+1]=O,E.ue[4*(t-2)+2]=X)}R.xq+=6}else q(A,w.qx),R.xq++;g.vX(C);g.xJ()&&"MAIN"==C.type&&B.QQ(C.id,C.xf)}}}}function d(a){if(a){var b=(a.vb?k.COLOR_BUFFER_BIT:0)|(a.Ab?k.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case f.ee:a=
E;break;case f.dd:a=N;break;case f.tf:a=I;break;case f.pf:case f.qi:case f.Um:a=O;break;case f.yg:case f.vp:case f.pt:a=E;break;default:a=V.background_color}}else b=k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT,a=V.background_color;k.colorMask(!0,!0,!0,!0);k.depthMask(!0);k.clearColor(a[0],a[1],a[2],a[3]);k.clear(b)}function b(a){switch(a){case 0:return k.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return k.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return k.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return k.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return k.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return k.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function t(a){var b=l.YA(),c=a.Kp,e=a.Ba,d=e.ld;a.He.length=0;var f=1,h;for(h in d)f=Math.max(f,d[h].frames);for(d=0;d<f;d++){h=b.createVertexArray();R(h);e.cg&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,e.cg);for(var g=0;g<e.Md.length;g++){k.bindBuffer(k.ARRAY_BUFFER,e.Md[g].Rk);for(var u=0;u<c.length;u++){var q=c[u];q.rN==e.Md[g].type&&(k.enableVertexAttribArray(q.$e),k.vertexAttribPointer(q.$e,q.Gc,q.Xu,q.Xu==k.FLOAT?
!1:!0,q.Gm,q.NF+q.LH*d),A(q.$e,q.Eq))}}R(null);a.He.push(h)}}function p(a){var b=a.Im,c=a.TM,e=a.Mr,d=a.SM,f=a.hC;c.length=0;e.length=0;d.length=0;f.length=0;for(var k in b){var h=!1,l=null,g=null;switch(k){case "u_proj_matrix":l=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.wb)};h=!0;break;case "u_view_refl_matrix":l=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.vx)};h=!0;break;case "u_view_tsr":case "u_view_tsr_frag":l=function(a,b,c,e){e.mc?a.uniformMatrix3fv(b,!1,e.Xr):a.uniformMatrix3fv(b,!1,e.mf)};
h=!0;break;case "u_view_tsr_inverse":l=function(a,b,c,e){e.mc?a.uniformMatrix3fv(b,!1,e.uw):a.uniformMatrix3fv(b,!1,e.wx)};h=!0;break;case "u_shadow_cast_billboard_view_tsr":l=function(a,b,c,e){a.uniformMatrix3fv(b,!1,e.ms)};h=!0;break;case "u_view_proj_prev":l=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.nC)};h=!0;break;case "u_view_proj_matrix":l=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.md)};h=!0;break;case "u_view_proj_inverse":l=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.ux)};h=!0;break;case "u_sky_vp_inverse":l=
function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.qg)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,b,c,e){a.uniform3fv(b,K.fc(e.n,ba))};h=!0;break;case "u_camera_quat":l=function(a,b,c,e){a.uniform4fv(b,K.Xd(e.n,J))};h=!0;break;case "u_view_max_depth":l=function(a,b,c,e){a.uniform1f(b,e.far)};h=!0;break;case "u_camera_range":l=function(a,b,c,e){a.uniform2f(b,e.near,e.far)};break;case "u_csm_center_dists":l=function(a,b,c,e){a.uniform4fv(b,e.hu)};break;case "u_height":l=function(a,
b,c,e){a.uniform1f(b,e.height)};h=!0;break;case "u_pcf_blur_radii":l=function(a,b,c,e){a.uniform4fv(b,e.ho)};break;case "u_dof_dist":l=function(a,b,c,e){e.dof_on?a.uniform1f(b,e.dof_distance):a.uniform1f(b,0)};h=!0;break;case "u_dof_front_start":l=function(a,b,c,e){a.uniform1f(b,e.dof_front_start)};h=!0;break;case "u_dof_front_end":l=function(a,b,c,e){a.uniform1f(b,e.dof_front_end)};h=!0;break;case "u_dof_rear_start":l=function(a,b,c,e){a.uniform1f(b,e.dof_rear_start)};h=!0;break;case "u_dof_rear_end":l=
function(a,b,c,e){a.uniform1f(b,e.dof_rear_end)};h=!0;break;case "u_dof_bokeh_intensity":l=function(a,b,c,e){a.uniform1f(b,e.dof_bokeh_intensity)};h=!0;break;case "u_camera_direction":l=function(a,b,c,e){a.uniform3fv(b,e.direction)};h=!0;break;case "u_cam_water_depth":l=function(a,b,c){a.uniform1f(b,c.Az)};h=!0;break;case "u_waves_height":l=function(a,b,c){a.uniform1f(b,c.$D)};break;case "u_waves_length":l=function(a,b,c){a.uniform1f(b,c.aE)};break;case "u_fog_color_density":l=function(a,b,c){a.uniform4fv(b,
c.xe)};break;case "u_fog_params":l=function(a,b,c){a.uniform4fv(b,c.Yf)};break;case "u_underwater_fog_color_density":l=function(a,b,c){a.uniform4fv(b,c.mi)};break;case "u_bloom_key":l=function(a,b,c){a.uniform1f(b,c.Mt)};break;case "u_bloom_edge_lum":l=function(a,b,c){a.uniform1f(b,c.Lt)};break;case "u_time":l=function(a,b,c){a.uniform1f(b,c.time)};h=!0;break;case "u_wind":l=function(a,b,c){a.uniform3fv(b,c.tj)};h=!0;break;case "u_sky_tex_dvar":l=function(a,b,c){a.uniform1f(b,c.Uw)};break;case "u_sky_tex_fac":l=
function(a,b,c){a.uniform4fv(b,c.Vw)};break;case "u_sky_tex_color":l=function(a,b,c){a.uniform3fv(b,c.Tw)};break;case "u_horizon_color":l=function(a,b,c){a.uniform3fv(b,c.he)};break;case "u_zenith_color":l=function(a,b,c){a.uniform3fv(b,c.pe)};break;case "u_environment_energy":l=function(a,b,c){a.uniform1f(b,c.Og)};break;case "u_sky_color":l=function(a,b,c){a.uniform3fv(b,c.Ao)};break;case "u_rayleigh_brightness":l=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":l=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":l=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":l=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":l=function(a,b,c){a.uniform4fv(b,c.yr)};break;case "u_light_directions":l=function(a,b,c){a.uniform3fv(b,c.xB)};break;case "u_light_color_intensities":l=function(a,b,c){a.uniform4fv(b,c.xr)};break;case "u_sun_quaternion":l=function(a,b,c){a.uniform4fv(b,c.xM)};break;case "u_sun_intensity":l=function(a,b,c){a.uniform3fv(b,c.wM)};
break;case "u_sun_direction":l=function(a,b,c){a.uniform3fv(b,c.qD)};break;case "u_debug_view_mode":l=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":l=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":l=function(a,b,c){a.uniform1f(b,c.pH)};break;case "u_subpixel_jitter":l=function(a,b,c){a.uniform2fv(b,c.MV)};h=!0;break;case "u_subsample_indices":l=function(a,b,c){a.uniform4fv(b,c.NV)};h=!0;break;case "u_radial_blur_step":l=
function(a,b,c){a.uniform1f(b,c.tw)};break;case "u_god_rays_intensity":l=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,c){a.uniform1f(b,c.Go)};break;case "u_ssao_blur_discard_value":l=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};h=!0;break;case "u_ssao_influence":l=function(a,b,c){a.uniform1f(b,c.Fo)};break;case "u_ssao_dist_factor":l=function(a,b,c){a.uniform1f(b,c.Eo)};break;case "u_texel_size":l=function(a,b,c){a.uniform2fv(b,
c.AD)};h=!0;break;case "u_normal_offset":l=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":l=function(a,b,c){a.uniform4fv(b,c.px)};h=!0;break;case "u_v_light_r":l=function(a,b,c){a.uniform4fv(b,c.ox)};h=!0;break;case "u_v_light_tsr":l=function(a,b,c){a.uniformMatrix3fv(b,!1,c.VD)};h=!0;break;case "u_p_light_matrix0":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.sm[0])};h=!0;break;case "u_p_light_matrix1":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.sm[1])};h=!0;
break;case "u_p_light_matrix2":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.sm[2])};h=!0;break;case "u_p_light_matrix3":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.sm[3])};h=!0;break;case "u_outline_color":l=function(a,b,c){a.uniform3fv(b,c.bj)};break;case "u_draw_outline":l=function(a,b,c){a.uniform1f(b,c.uA)};h=!0;break;case "u_glow_mask_small_coeff":l=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
h=!0;break;case "u_brightness":l=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":l=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":l=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":l=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":l=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":l=function(a,b,c){a.uniform4fv(b,c.Hl)};break;case "u_chromatic_aberration_coefs":l=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":l=function(a,b,c){a.uniform1f(b,c.$J)};h=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};h=!0;break;case "u_model_tsr":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};h=!0;break;case "u_model_tsr_inverse":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Ex)};h=!0;break;case "u_transb":g=function(a,b,c){a.uniform4fv(b,c.oe)};h=!0;break;case "u_transa":g=function(a,b,c){a.uniform4fv(b,
c.Ee)};h=!0;break;case "u_arm_rel_trans":g=function(a,b,c){a.uniform4fv(b,c.Hp)};h=!0;break;case "u_arm_rel_quat":g=function(a,b,c){a.uniform4fv(b,c.Gp)};h=!0;break;case "u_quat":g=function(a,b,c){a.uniform4fv(b,K.Xd(c.n,J))};h=!0;break;case "u_quatsb":g=function(a,b,c){a.uniform4fv(b,c.ke)};h=!0;break;case "u_quatsa":g=function(a,b,c){a.uniform4fv(b,c.Be)};h=!0;break;case "u_frame_factor":g=function(a,b,c){a.uniform1f(b,c.Ue)};h=!0;break;case "au_center_pos":g=function(a,b,c){a.uniform3fv(b,c.Zp)};
h=!0;break;case "au_wind_bending_amp":g=function(a,b,c){a.uniform1f(b,c.rh)};h=!0;break;case "au_wind_bending_freq":g=function(a,b,c){a.uniform1f(b,c.sh)};h=!0;break;case "au_detail_bending_freq":g=function(a,b,c){a.uniform1f(b,c.Lg)};h=!0;break;case "au_detail_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Kg)};h=!0;break;case "au_branch_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Fg)};h=!0;break;case "u_node_values":g=function(a,b,c,e){a.uniform1fv(b,e.Zi)};h=!0;break;case "u_node_rgbs":g=function(a,
b,c,e){a.uniform3fv(b,e.ze)};h=!0;break;case "u_diffuse_color":g=function(a,b,c,e){a.uniform4fv(b,e.Uf)};h=!0;break;case "u_diffuse_intensity":g=function(a,b,c,e){a.uniform1f(b,e.Gl)};h=!0;break;case "u_diffuse_params":g=function(a,b,c,e){a.uniform2fv(b,e.Td)};h=!0;break;case "u_emit":g=function(a,b,c,e){a.uniform1f(b,e.Oj)};h=!0;break;case "u_ambient":g=function(a,b,c,e){a.uniform1f(b,e.yj)};h=!0;break;case "u_specular_color":g=function(a,b,c,e){a.uniform3fv(b,e.Em)};h=!0;break;case "u_specular_alpha":g=
function(a,b,c,e){a.uniform1f(b,e.qs)};h=!0;break;case "u_specular_params":g=function(a,b,c,e){a.uniform3fv(b,e.Gk)};h=!0;break;case "u_reflect_factor":g=function(a,b,c,e){a.uniform1f(b,e.lo)};h=!0;break;case "u_mirror_factor":g=function(a,b,c,e){a.uniform1f(b,e.Cr)};h=!0;break;case "u_grass_map_dim":g=function(a,b,c,e){a.uniform3fv(b,e.ge)};h=!0;break;case "u_grass_size":g=function(a,b,c,e){a.uniform1f(b,e.er)};h=!0;break;case "u_scale_threshold":g=function(a,b,c,e){a.uniform1f(b,e.Zu)};h=!0;break;
case "u_cube_fog":g=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.ue)};break;case "u_jitter_amp":g=function(a,b,c,e){a.uniform1f(b,e.Cv)};h=!0;break;case "u_jitter_freq":g=function(a,b,c,e){a.uniform1f(b,e.Dv)};h=!0;break;case "u_wireframe_edge_color":g=function(a,b,c,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_cluster_id":g=function(a,b,c,e){a.uniform1f(b,e.gq)};h=!0;break;case "u_batch_debug_id_color":g=function(a,b,c,e){a.uniform1f(b,e.ku)};h=!0;break;case "u_batch_debug_main_render_time":g=
function(a,b,c,e){a.uniform1f(b,e.wq)};h=!0;break;case "u_refr_bump":g=function(a,b,c,e){a.uniform1f(b,e.vw)};h=!0;break;case "u_line_width":g=function(a,b,c,e){a.uniform1f(b,e.Fv)};h=!0;break;case "u_lamp_light_positions":g=function(a,b,c,e){a.uniform3fv(b,e.Un)};break;case "u_lamp_light_directions":g=function(a,b,c,e){a.uniform3fv(b,e.vr)};break;case "u_lamp_light_color_intensities":g=function(a,b,c,e){a.uniform3fv(b,e.ur)};break;case "u_halo_size":g=function(a,b,c,e){a.uniform1f(b,e.hv)};h=!0;
break;case "u_halo_hardness":g=function(a,b,c,e){a.uniform1f(b,e.ev)};h=!0;break;case "u_halo_rings_color":g=function(a,b,c,e){a.uniform3fv(b,e.gv)};h=!0;break;case "u_halo_lines_color":g=function(a,b,c,e){a.uniform3fv(b,e.fv)};h=!0;break;case "u_halo_stars_blend":g=function(a,b,c,e){a.uniform1f(b,e.iv)};h=!0;break;case "u_halo_stars_height":g=function(a,b,c,e){a.uniform1f(b,e.jv)};h=!0;break;case "u_fresnel_params":g=function(a,b,c,e){a.uniform4fv(b,e.Li)};h=!0;break;case "u_texture_scale":g=function(a,
b,c,e){a.uniform3fv(b,e.gi)};h=!0;break;case "u_parallax_scale":g=function(a,b,c,e){a.uniform1f(b,e.eo)};h=!0;break;case "u_color_id":g=function(a,b,c){a.uniform3fv(b,c.Hj)};h=!0;break;case "u_line_points":g=function(a,b,c,e){a.uniform3fv(b,e.V5)};h=!0;break;case "u_diffuse_color_factor":g=function(a,b,c,e){a.uniform1f(b,e.Fl)};h=!0;break;case "u_alpha_factor":g=function(a,b,c,e){a.uniform1f(b,e.il)};h=!0;break;case "u_specular_color_factor":g=function(a,b,c,e){a.uniform1f(b,e.Co)};h=!0;break;case "u_normal_factor":g=
function(a,b,c,e){a.uniform1f(b,e.Zv)};h=!0;break;case "u_normalmap0_scale":g=function(a,b,c,e){a.uniform2fv(b,e.$i[0])};h=!0;break;case "u_normalmap1_scale":g=function(a,b,c,e){a.uniform2fv(b,e.$i[1])};h=!0;break;case "u_normalmap2_scale":g=function(a,b,c,e){a.uniform2fv(b,e.$i[2])};h=!0;break;case "u_normalmap3_scale":g=function(a,b,c,e){a.uniform2fv(b,e.$i[3])};h=!0;break;case "u_foam_factor":g=function(a,b,c,e){a.uniform1f(b,e.An)};h=!0;break;case "u_foam_uv_freq":g=function(a,b,c,e){a.uniform2fv(b,
e.Cu)};h=!0;break;case "u_foam_mag":g=function(a,b,c,e){a.uniform2fv(b,e.Bu)};h=!0;break;case "u_foam_scale":g=function(a,b,c,e){a.uniform2fv(b,e.Oq)};h=!0;break;case "u_water_norm_uv_velocity":g=function(a,b,c,e){a.uniform1f(b,e.ap)};h=!0;break;case "u_shallow_water_col":g=function(a,b,c,e){a.uniform3fv(b,e.so)};h=!0;break;case "u_shore_water_col":g=function(a,b,c,e){a.uniform3fv(b,e.vo)};h=!0;break;case "u_water_shallow_col_fac":g=function(a,b,c,e){a.uniform1f(b,e.uo)};h=!0;break;case "u_water_shore_col_fac":g=
function(a,b,c,e){a.uniform1f(b,e.wo)};h=!0;break;case "u_p_length":g=function(a,b,c,e){a.uniform1f(b,e.gb.KM)};h=!0;break;case "u_p_cyclic":g=function(a,b,c,e){a.uniform1i(b,e.gb.ve)};h=!0;break;case "u_p_max_lifetime":g=function(a,b,c,e){a.uniform1f(b,e.gb.OJ)};h=!0;break;case "u_p_fade_in":g=function(a,b,c,e){a.uniform1f(b,e.gb.Ll)};h=!0;break;case "u_p_fade_out":g=function(a,b,c,e){a.uniform1f(b,e.gb.zf)};h=!0;break;case "u_p_size":g=function(a,b,c,e){a.uniform1f(b,e.gb.size)};h=!0;break;case "u_p_alpha_start":g=
function(a,b,c,e){a.uniform1f(b,e.gb.xF)};h=!0;break;case "u_p_alpha_end":g=function(a,b,c,e){a.uniform1f(b,e.gb.wF)};h=!0;break;case "u_p_nfactor":g=function(a,b,c,e){a.uniform1f(b,e.gb.WB)};h=!0;break;case "u_p_gravity":g=function(a,b,c,e){a.uniform1f(b,e.gb.bJ)};h=!0;break;case "u_p_mass":g=function(a,b,c,e){a.uniform1f(b,e.gb.Uh)};h=!0;break;case "u_p_color_ramp":g=function(a,b,c,e){a.uniform4fv(b,e.gb.GG)};h=!0;break;case "u_p_wind_fac":g=function(a,b,c,e){a.uniform1f(b,e.gb.DN)};h=!0;break;
case "u_p_time":g=function(a,b,c,e){a.uniform1f(b,e.gb.time)};h=!0;break;case "u_p_tilt":g=function(a,b,c,e){a.uniform1f(b,e.gb.IM)};h=!0;break;case "u_p_tilt_rand":g=function(a,b,c,e){a.uniform1f(b,e.gb.JM)};h=!0;break;case "u_position":g=function(a,b,c,e){a.uniform3fv(b,e.jl)};h=!0;break;case "u_va_frame_factor":g=function(a,b,c){a.uniform1f(b,c.rx)};h=!0;break;case "u_refl_plane":g=function(a,b,c){a.uniform4fv(b,c.mc)};h=!0;break;case "u_outline_intensity":g=function(a,b,c){a.uniform1f(b,c.gh)};
h=!0;break;case "u_obj_info":g=function(a,b,c,e){a.uniform3fv(b,e.bo)},h=!0}g&&(g={name:k,Cn:g,$e:b[k]},h?c.push(g):e.push(g));l&&(g={name:k,Cn:l,$e:b[k]},h?d.push(g):f.push(g))}if(e.length||f.length){a=a.iC;for(var q in a)delete a[q];for(q=0;q<e.length;q++)g=e[q],a[g.name]=g;for(q=0;q<f.length;q++)g=f[q],a[g.name]=g}else a.Xv=!0}var B=r("__batch"),m=r("__camera"),x=r("__config"),g=r("__debug"),l=r("__extensions"),h=r("__geometry"),w=r("__quat"),f=r("__subscene"),C=r("__textures"),K=r("__tsr"),G=
r("__util"),L=r("__version"),h=r("__geometry"),D=r("__vec3"),N=[1,1,1,1],I=[1,1,1,1],O=[0,0,0,1],E=[0,0,0,0],c=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var k=null,y=null,A=null,e=null,R=null,q=null,ba=new Float32Array(3),J=w.create(),F=new Uint8Array(4),V=x.A;a.If=function(a){var b=V.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);k=a};a.vn=function(a){if(a.ac)if(a.type==f.an){g.AC(a);var c=a.p;k.bindFramebuffer(k.READ_FRAMEBUFFER,c.Sq);k.bindFramebuffer(k.DRAW_FRAMEBUFFER,c.Ve);var e=0;c.qc&&(e|=k.COLOR_BUFFER_BIT);c.Re&&(e|=k.DEPTH_BUFFER_BIT);k.blitFramebuffer(0,0,c.width,c.height,0,0,c.width,c.height,e,k.NEAREST);g.BC(a);g.Dz("draw resolve")}else if(a.type==f.Ox)g.AC(a),c=a.p,k.bindFramebuffer(k.FRAMEBUFFER,
c.Sq),k.bindTexture(k.TEXTURE_2D,c.qc.rb),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,c.width,c.height,0),g.BC(a),g.Dz("draw copy");else{g.AC(a);c=a.p;k.bindFramebuffer(k.FRAMEBUFFER,c.Ve);a.jz&&(e=c.qc,k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,e.mb,e.rb,0));k.viewport(0,0,c.width,c.height);a.type!=f.nd&&a.type!=f.Ke&&d(a);a.Kb?k.enable(k.BLEND):k.disable(k.BLEND);a.Sd?k.enable(k.DEPTH_TEST):k.disable(k.DEPTH_TEST);switch(a.type){case f.dd:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);k.cullFace(k.BACK);break;case f.Nd:case f.sf:k.disable(k.POLYGON_OFFSET_FILL);k.cullFace(k.FRONT);break;case f.rf:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-4,-4);k.cullFace(k.BACK);break;case f.ee:if(1<V.Cc||V.dL){k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-2,-2);break}default:k.disable(k.POLYGON_OFFSET_FILL),k.cullFace(k.BACK)}if(a.type==f.nd||a.type==f.Ke)for(var c=a.p,e=c.qc.rb,h=0;6>h;h++){var l=b(h);c.Ob=a.Dl[h];K.Mi(c.Ob,c.mf);m.xz(c);k.framebufferTexture2D(k.FRAMEBUFFER,
k.COLOR_ATTACHMENT0,l,e,0);d(a);for(var l=a.Ra,q=0;q<l.length;q++)for(var y=0;y<l[q].ra.length;y++){var w=l[q].ra[y];w.ac=w.tA[h]}n(a)}else n(a);g.BC(a);g.Dz("draw subscene: "+f.pD(a))}};a.clear=function(a){k.bindFramebuffer(k.FRAMEBUFFER,a.p.Ve);d(a)};a.GQ=function(a){var b=a.Kp;b.length=0;var c=a.Ba,e=c.ld,d=a.yb.attributes,f;for(f in d){var k=e[f],l=h.dr(f),q=h.VU(f),m=h.TI(f);b.push({rN:l,Xu:q,$e:d[f],NF:k.offset*m,LH:1<k.frames?k.length*m:0,Gc:k.Gc,Gm:k.Gm*m,Eq:k.Eq})}if("DEBUG"==L.type())for(f in e)l=
h.dr(f),b=h.KX(c.Md,l),b=c.Md[b],k=a.hb.tg+" | "+a.hb.Te,l=e[f].length*e[f].frames*h.TI(f),g.YT(b.nT,k,f,l,f in d);V.cz&&t(a)};a.LQ=t;a.UR=function(a){for(var b=l.YA(),c=0;c<a.He.length;c++)b.deleteVertexArray(a.He[c]);a.He.length=0};a.WR=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.KQ=p;a.IF=function(a){var b=a.yb,c=a.ya;a=a.Ld;k.useProgram(b.Zh);for(var e=0;e<c.length;e++)k.uniform1i(b.Im[a[e]],e)};a.vC=function(a,b,c,e,d,f){e||(e=1);d||(d=1);f||(f=new Uint8Array(4*e*d));
f.length!=4*e*d&&G.q("read_pixels(): Wrong storage");k.bindFramebuffer(k.FRAMEBUFFER,a);k.readPixels(b,c,e,d,k.RGBA,k.UNSIGNED_BYTE,f);k.bindFramebuffer(k.FRAMEBUFFER,null);return f};a.AZ=function(a){var b=a.yb;b.Xv||(k.useProgram(b.Zh),b.Mr.length||p(b),b=b.iC.u_cube_fog,b.Cn(k,b.$e,null,a))};a.tX=function(a,b){var c=k.createFramebuffer();k.bindFramebuffer(k.FRAMEBUFFER,c);if(C.Qn(a)){var e=a.Ie;k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.RENDERBUFFER,e)}else if(C.Sn(a)){var d=
a,e=d.rb,d=d.mb==k.TEXTURE_CUBE_MAP?k.TEXTURE_CUBE_MAP_NEGATIVE_Z:d.mb;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,d,e,0)}C.Qn(b)?(e=b.Ie,k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,e)):C.Sn(b)&&(d=b,e=d.rb,d=d.mb,k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,d,e,0));g.AR();k.bindFramebuffer(k.FRAMEBUFFER,null);return c};a.sX=function(a,b,c,e,d){null==a?(k.bindFramebuffer(k.FRAMEBUFFER,a),k.viewport(0,0,e,d),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)):
(C.Qn(b)?k.deleteRenderbuffer(b.Ie):C.Sn(b)&&k.deleteTexture(b.rb),C.Qn(c)?k.deleteRenderbuffer(c.Ie):C.Sn(c)&&k.deleteTexture(c.rb),k.deleteFramebuffer(a))};a.C5=function(){};a.zT=function(a,b,c,e,d,f){a=a.rb;k.viewport(0,0,c,c);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,b,a,0);b=B.$z("FLIP_CUBEMAP_COORDS");a=b.yb;k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,d);var h=d=0;c!=e&&(d=1/(6*e),h=1/(4*e));k.uniform1i(a.Im.u_tex_number,f);k.uniform2fv(a.Im.u_delta,[d,h]);k.useProgram(a.Zh);
q(b,0);k.bindTexture(k.TEXTURE_2D,null)};a.AT=function(a,b,c,e,d){k.bindFramebuffer(k.FRAMEBUFFER,e);e=a.rb;a=a.mb;k.bindTexture(a,e);k.viewport(0,0,b,c);k.texImage2D(a,0,k.RGBA,b,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,a,e,0);b=B.$z("NONE");c=b.yb;k.activeTexture(k.TEXTURE0);k.bindTexture(a,d);k.useProgram(c.Zh);q(b,0);k.bindFramebuffer(k.FRAMEBUFFER,null);k.bindTexture(a,null)};a.sa=function(){};a.VX=function(){var a=l.YU(),b=l.YA();V.vF=a?!0:!1;
V.cz=b?!0:!1;a?(y=function(b,c,e,d){a.drawElementsInstanced(k.TRIANGLES,b,c,e,d)},A=function(b,c){a.vertexAttribDivisor(b,c)},e=function(b,c,e){a.drawArraysInstanced(k.TRIANGLES,b,c,e)}):(y=function(a,b,c){k.drawElements(k.TRIANGLES,a,b,c)},A=function(){},e=function(a,b){k.drawArrays(k.TRIANGLES,a,b)});b?(R=function(a){b.bindVertexArray(a)},q=function(a,b){var c=a.Ba;R(a.He[b]);c.cg?y(c.count,c.Xl,0,c.am):e(0,c.count,c.am);R(null)}):q=function(a,b){for(var c=a.Ba,d=a.Kp,f=0;f<c.Md.length;f++){k.bindBuffer(k.ARRAY_BUFFER,
c.Md[f].Rk);for(var h=0;h<d.length;h++){var l=d[h];l.rN==c.Md[f].type&&(k.enableVertexAttribArray(l.$e),k.vertexAttribPointer(l.$e,l.Gc,l.Xu,l.Xu==k.FLOAT?!1:!0,l.Gm,l.NF+l.LH*b),A(l.$e,l.Eq))}}c.cg?(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,c.cg),y(c.count,c.Xl,0,c.am)):e(0,c.count,c.am);for(f=0;f<d.length;f++)l=d[f],k.disableVertexAttribArray(l.$e)}};a.reset=function(){R=e=A=y=k=null}};b4w.module.__camera=function(a,r){function n(a,b,c,e,d){P.Vc(a,b);c&&D(a,b,c);O(a,e);E(a,d)}function d(a,b,c,d,f,k,h,l){var g=a.k;P.Vc(a,b);g.pivot.set(c);D(a,b,c);O(a,d);E(a,f);A(a,k);e(a,h);g.use_panning=l}function b(a,b,e,d,f,k,h,l){var g=a.k;P.Vc(a,b);g.Tb.set(e);D(a,b,e);y(a,d);c(a,f);R(a,k);q(a,h);g.Jh=l}function t(a,b,c){var e=a.k,d=la.F(e.n),f=la.R(e.n),e=va;e.set(z.ad);e[3]=0;a=w(a,ya)[1];f=z.lc(f,z.$c,Ha);qa.DL(da,d);qa.XC(da,f);if(!z.yB(e,-b,da,c)||Math.abs(a)<ea)za.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=d[0],c[1]=0,c[2]=d[2];return c}function p(b){for(var c=b.k,e=0;e<b.I.length;e++){var d=b.I[e].ba[0];if(d.type==a.se)switch(c.tb){case a.Jb:var f=la.F(c.n);c.Xj=ma.dist(f,c.pivot);c.Yj=d.top;break;case a.cd:f=la.F(c.n),c.Xj=ma.dist(f,c.Tb),c.Yj=d.top}}}function B(a){a={type:a,name:"",ZL:1,width:0,height:0,Ve:null,Sq:null,qc:null,Re:null,zb:0,Vd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,kd:Ea.create(),n:new Float32Array(9),Ob:new Float32Array(16),vx:new Float32Array(16),wb:new Float32Array(16),
md:new Float32Array(16),ux:new Float32Array(16),nC:new Float32Array(16),qg:new Float32Array(16),direction:new Float32Array(3),mf:la.Al(),wx:la.Al(),Xr:la.Al(),uw:la.Al(),ms:la.Al(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,yH:!1,Cd:!1,dof_on:!1,Iv:new Float32Array(3),Lh:x(),Hk:0,hf:0,mc:null,Hh:null,uq:null,hu:new Float32Array(4),ho:new Float32Array(4)};a.kd[0]=a.kd[2]=45;a.kd[1]=a.kd[3]=55;return a}function m(a,
b){var c=B(a.type);c.name=a.name;c.ZL=a.ZL;c.width=a.width;c.height=a.height;b||(c.Ve=a.Ve,c.Sq=a.Sq,c.qc=a.qc,c.Re=a.Re);c.zb=a.zb;c.Vd=a.Vd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;Ea.copy(a.kd,c.kd);la.copy(a.n,c.n);Y.copy(a.Ob,c.Ob);Y.copy(a.wb,c.wb);Y.copy(a.md,c.md);Y.copy(a.ux,c.ux);Y.copy(a.nC,c.nC);Y.copy(a.qg,c.qg);la.copy(a.mf,c.mf);la.copy(a.wx,c.wx);la.copy(a.Xr,c.Xr);la.copy(a.uw,c.uw);la.copy(a.ms,c.ms);c.dof_distance=a.dof_distance;c.dof_front_start=
a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.yH=a.yH;c.Cd=a.Cd;c.dof_on=a.dof_on;ma.copy(a.Iv,c.Iv);var e=a.Lh,d=c.Lh;Ea.copy(e.left,d.left);Ea.copy(e.right,d.right);Ea.copy(e.top,d.top);Ea.copy(e.bottom,d.bottom);Ea.copy(e.near,d.near);Ea.copy(e.far,d.far);c.Hk=a.Hk;c.hf=a.hf;a.mc&&(c.mc=Ea.clone(a.mc));if(a.Hh){e=a.Hh.length;c.Hh=Array(e);
for(d=0;d<e;d++)c.Hh[d]=ma.clone(a.Hh[d]);c.uq=new Float32Array(a.uq)}Ea.copy(a.hu,c.hu);Ea.copy(a.ho,c.ho);return c}function x(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function g(b){switch(b){case "STATIC":return a.xg;case "TARGET":return a.Jb;case "EYE":return a.od;case "HOVER":return a.cd;default:z.q("Unknown move style")}}function l(b){var c=
B(b);if(b==a.qd)return c;switch(b){case a.Od:C(c,40,.1,1E3);break;case a.se:C(c,2.5,.1,1E3);break;case a.yh:break;case a.xh:break;case a.ui:break;case a.Mc:case a.ed:case a.Le:case a.Me:z.q("Stereo camera may only be created from perspective one");break;default:z.q("Unknown camera type")}return c}function h(b,c,e){b.type!=a.Mc&&b.type!=a.ed&&b.type!=a.Le&&b.type!=a.Me&&z.q("set_stereo_params(): wrong camera type");if(b.type==a.Mc||b.type==a.ed)b.Hk=c;b.hf=e;fa(b,b.zb);if(ta.Ca()&&(c=ta.B(),b=c.s.wd))for(c=
sa.ja(ta.Ul(c),c).ba,e=0;e<c.length;e++)u(c[e],b)}function w(a,b){return f(la.R(a.k.n),b)}function f(a,b){var c=z.lc(a,z.ad,Ha),e=z.lc(a,z.Zk,Da),d=-Math.asin(c[2]/ma.length(c)),c=Math.abs(d)>Math.PI/4?ma.scale(e,-z.sign(d),Ra):ma.scale(c,-z.sign(e[2]),Ra),f=Math.atan(Math.abs(c[0]/c[1]));0<e[2]&&(d=z.sign(d)*Math.PI-d);e=f;0<c[1]&&(e=Math.PI-e);0>c[0]&&(e=2*Math.PI-e);b[0]=e;b[1]=d;return b}function C(b,c,e,d,f){switch(b.type){case a.Od:case a.Mc:case a.ed:b.Vd=c;b.zb=1;break;case a.se:b.top=c;b.zb=
1;break;case a.yh:b.Vd=c;b.zb=f/c;break;case a.xh:b.top=c;b.zb=f/c;break;case a.Le:case a.Me:break;default:za.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=e;b.far=d}function K(b,c){var e=la.fc(c.k.n,Ha),d=la.Xd(c.k.n,ra),f=Y.fromRotationTranslation(d,e,Ka);Y.invert(f,b.Ob);if(ta.Ca())var f=ta.B(),k=ta.Ma(f,oa.ti);if(b.type==a.Mc||k&&k.enable_hmd_stereo&&b.type==a.Le)b.Ob[12]+=b.hf/2;else if(b.type==a.ed||k&&k.enable_hmd_stereo&&b.type==a.Me)b.Ob[12]-=b.hf/2;if(b.mc){la.Mi(b.Ob,
b.Xr);la.invert(b.Xr,b.uw);var f=b.mc[0],k=b.mc[1],h=b.mc[2],l=b.mc[3],g=b.vx;g[0]=1-2*f*f;g[1]=-2*f*k;g[2]=-2*f*h;g[3]=0;g[4]=-2*f*k;g[5]=1-2*k*k;g[6]=-2*k*h;g[7]=0;g[8]=-2*f*h;g[9]=-2*k*h;g[10]=1-2*h*h;g[11]=0;g[12]=-2*f*l;g[13]=-2*k*l;g[14]=-2*h*l;g[15]=1;Y.multiply(b.Ob,b.vx,b.Ob);fa(b,b.zb,!0);f=va;k=Ka;Y.invert(b.Ob,k);Y.transpose(k,k);Ea.transformMat4(b.mc,k,f);k=xa;k[0]=(z.sign(f[0])+b.wb[8])/b.wb[0];k[1]=(z.sign(f[1])+b.wb[9])/b.wb[5];k[2]=-1;k[3]=(1+b.wb[10])/b.wb[14];Ea.scale(f,2/(f[0]*
k[0]+f[1]*k[1]+f[2]*k[2]+f[3]*k[3]),f);b.wb[2]=f[0];b.wb[6]=f[1];b.wb[10]=f[2]+1;b.wb[14]=f[3];ma.transformMat4(e,b.vx,e)}la.Mi(b.Ob,b.mf);la.invert(b.mf,b.wx);H(b);M(b);la.ci(e,1,d,b.n)}function G(b,c,e,d){Y.lookAt(c,e,d,b.Ob);e=ta.B();e=ta.Ma(e,oa.ti);ta.Ca()&&(e=ta.B(),e=ta.Ma(e,oa.ti));if(b.type==a.Mc||e&&e.enable_hmd_stereo&&b.type==a.Le)b.Ob[12]+=b.hf/2;else if(b.type==a.ed||e&&e.enable_hmd_stereo&&b.type==a.Me)b.Ob[12]-=b.hf/2;la.Mi(b.Ob,b.mf);H(b);M(b);la.ff(c,b.n)}function L(a,b,c){c=ma.subtract(c,
b,Ha);ma.length(c)&&(ma.normalize(c,c),c=z.JC(z.$c,c,ra),P.bi(a,c));P.Vc(a,b)}function D(a,b,c){var e=a.k,d=0>z.lc(la.R(a.k.n),z.pi,Ha)[2];L(a,b,c);d?(b=ma.copy(e.lf,Ha),ma.negate(b,b),pa.Kj(a,b,!0)):pa.Kj(a,e.lf,!0)}function N(a,b){for(var c=a.k,e=b.ba,d=la.Xd(c.n,ra),d=z.lc(d,z.$c,Ha),f=la.fc(c.n,Da),k=b.WL,h=0;h<k.length;h++){var l=k[h];ma.copy(d,l.direction);la.fc(c.n,l.Iv)}for(h=0;h<e.length;h++)l=e[h],K(l,a),ma.copy(d,l.direction),z.xn(l.md,l.Lh),l.dof_object&&l.dof_on&&(c=P.Bf(l.dof_object,
Ra),c=ma.dist(f,c),l.dof_distance=c)}function I(b){var c=b.k;c.tb==a.Jb&&(c.Kk=0>z.lc(la.R(b.k.n),z.pi,Ha)[2])}function O(b,c){var e=b.k;if(c){e.lb=e.lb||{};e.lb.left=c.left;e.lb.right=c.right;e.lb.Vn=c.left;e.lb.po=c.right;e.lb.camera_space=Boolean(c.camera_space);var d=b.k;!(e=d.lb)||d.tb!=a.od&&d.tb!=a.Jb||(d=w(b,ya),e.camera_space?(e.left+=d[0],e.right+=d[0]):(e.Vn-=d[0],e.po-=d[0]),e.left=z.vi(e.left),e.right=z.vi(e.right),e.Vn=z.vi(e.Vn),e.po=z.vi(e.po))}else e.lb=null}function E(a,b){var c=
a.k;b?(c.ka=c.ka||{},c.ka.down=b.down,c.ka.up=b.up,c.ka.un=b.down,c.ka.Uo=b.up,c.ka.camera_space=Boolean(b.camera_space),k(a)):c.ka=null}function c(a,b){var c=a.k;if(!b){var e=w(a,ya);b={down:e[1],up:e[1]}}c.ka=c.ka||{};c.ka.down=b.down;c.ka.up=b.up;k(a);c.sb&&c.ka&&v(a)}function k(b){var c=b.k,e=c.ka;if(e)switch(c.tb){case a.od:case a.Jb:b=w(b,ya);e.camera_space?(e.up+=b[1],e.down+=b[1]):(e.Uo-=b[1],e.un-=b[1]);e.up=z.Bg(e.up,-Math.PI,Math.PI);e.down=z.Bg(e.down,-Math.PI,Math.PI);e.Uo=z.Bg(e.Uo,
-Math.PI,Math.PI);e.un=z.Bg(e.un,-Math.PI,Math.PI);break;case a.cd:e.up=z.Bg(e.up,-Math.PI,Math.PI),e.down=z.Bg(e.down,-Math.PI,Math.PI),e.up=z.V(e.up,-Math.PI/2,0),e.down=z.V(e.down,-Math.PI/2,0)}}function y(a,b){var c=a.k;if(!b){var e=P.co(a,c.Tb);b={min:e,max:e}}c.sb=c.sb||{};c.sb.min=b.min;c.sb.max=b.max;c.sb&&c.ka&&v(a)}function A(a,b){var c=a.k;b?(c.sb=c.sb||{},c.sb.min=b.min,c.sb.max=b.max):c.sb=null}function e(a,b){var c=a.k;b?(c.ae=c.ae||{},c.ae.min_z=b.min_z,c.ae.max_z=b.max_z):c.ae=null}
function R(a,b){var c=a.k;b?(c.yc=c.yc||{},c.yc.min=b.min,c.yc.max=b.max):c.yc=null}function q(a,b){var c=a.k;b?(c.zc=c.zc||{},c.zc.min=b.min,c.zc.max=b.max):c.zc=null}function ba(b){var c=b.k;if(sa.wa(b))for(var e=b.I,d=0;d<e.length;d++){var f=e[d].ba;if(f[0].type===a.se){switch(c.tb){case a.Jb:var k=la.F(c.n),k=ma.dist(k,c.pivot),k=k/c.Xj*c.Yj;break;case a.cd:k=la.F(c.n);k=ma.distance(k,c.Tb);k=k/c.Xj*c.Yj;break;default:k=f[0].top}for(var h=0;h<f.length;h++){var l=f[h];l.top=k;fa(l,l.zb)}N(b,e[d])}}}
function J(b){var c=b.k,e=c.tb;if(e===a.Jb||e===a.od){if(c.lb){var d=c.lb.left,f=c.lb.right,k=w(b,ya);(k=e==a.Jb?z.ul(k[0],d,f):z.ul(k[0],f,d))&&(e==a.Jb?V(b,k,0):F(b,k,0))}c.ka&&(d=c.ka.down,f=c.ka.up,k=w(b,ya),(k=e==a.Jb?z.ul(k[1],f,d):z.ul(k[1],d,f))&&(e==a.Jb?V(b,0,k):F(b,0,k)));if(e===a.Jb&&c.sb){var k=b.k,d=la.F(k.n),f=ma.subtract(d,k.pivot,Ha),h=ma.length(f);h>k.sb.max?(ma.scale(f,k.sb.max/h,f),ma.add(k.pivot,f,d)):h<k.sb.min&&(h=z.lc(la.R(k.n),z.$c,Da),ma.scale(h,100*k.sb.min,h),ma.add(f,
h,f),ma.scale(f,-k.sb.min/ma.length(f),f),ma.add(k.pivot,f,d))}}e===a.Jb&&c.ae&&(c=b.k,k=c.pivot[2],d=z.V(c.pivot[2],c.ae.min_z,c.ae.max_z),d!=k&&(k=ma.set(0,0,d-k,Ha),ma.add(c.pivot,k,c.pivot),c=la.F(c.n),ma.add(c,k,c)));e===a.cd&&(e=b.k,e.yc&&(k=z.V(e.Tb[0],e.yc.min,e.yc.max)-e.Tb[0],e.Tb[0]+=k,c=la.F(e.n),c[0]+=k),e.zc&&(k=z.V(e.Tb[1],e.zc.min,e.zc.max)-e.Tb[1],e.Tb[1]+=k,c=la.F(e.n),c[1]+=k),e=b.k,c=w(b,ya)[1],(e=z.ul(c,e.ka.up,e.ka.down))&&U(b,0,e))}function F(a,b,c,e,d){var f=a.k,k=b,h=c;if(e||
d)a=w(a,na),e&&(k=b-a[0]),d&&(h=c-a[1]);if(k||h)b=X.identity(ra),k&&(k=X.setAxisAngle(f.lf,k,wa),X.multiply(b,k,b)),f=la.R(f.n),h&&(k=z.lc(f,z.oi,Ha),h=X.setAxisAngle(k,h,wa),X.normalize(h,h),X.multiply(b,h,b)),X.multiply(b,f,f)}function V(a,b,c,e,d){var f=a.k,k=b,h=c;if(e||d){var l=w(a,na);e&&(k=b-l[0]);d&&(h=c-l[1])}aa(a,a.k.pivot,k,h);a=w(a,na);a=z.Bg(a[1],-Math.PI,Math.PI);f.Kk=Math.abs(a)>Math.PI/2}function U(a,b,c,e,d){var f=a.k,k=b,h=c;if(e||d){var l=w(a,na);e&&(k=b-l[0]);d&&(h=c-l[1])}f.Jh||
(k=0);aa(a,f.Tb,k,h);h&&v(a)}function aa(a,b,c,e){var d=a.k;if(c||e){var f=X.identity(ra);c&&(c=X.setAxisAngle(z.ad,c,wa),X.multiply(f,c,f));ha(a);a=la.R(d.n);e&&(c=z.lc(a,z.oi,Ha),e=X.setAxisAngle(c,e,wa),X.normalize(e,e),X.multiply(f,e,f));d=la.F(d.n);z.FX(d,b,f,d);X.multiply(f,a,a)}}function v(a){var b=a.k,c=w(a,ya)[1],e=a.k;a=e.ka;e=e.sb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(e.max-e.min)+e.min;a=la.F(b.n);e=z.lc(la.R(b.n),z.$c,Ha);ma.normalize(e,e);ma.scale(e,c,e);
ma.subtract(b.Tb,e,a)}function fa(b,c,e){switch(b.type){case a.Od:c||z.q("No aspect ratio"),b.zb=c;case a.yh:Y.perspective(z.Lb(b.Vd),b.zb,b.near,b.far,b.wb);break;case a.se:c||z.q("No aspect ratio"),b.zb=c;case a.xh:c=b.top*b.zb;Y.ortho(-c,c,-b.top,b.top,b.near,b.far,b.wb);break;case a.ui:Y.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb);break;case a.Mc:case a.ed:c||z.q("No aspect ratio");b.zb=c;var d=Math.tan(b.Vd*Math.PI/360);c=b.near*d;var f=b.zb*b.Hk*d;b.type==a.Mc?(d=f-b.hf/2,f+=b.hf/
2):(d=f+b.hf/2,f-=b.hf/2);d=-(b.near/b.Hk*d);f*=b.near/b.Hk;Y.frustum(d,f,-c,c,b.near,b.far,b.wb);b.left=d;b.right=f;break;case a.Le:case a.Me:if(ta.Ca())if(d=ta.B(),(d=ta.Ma(d,oa.ti))&&d.enable_hmd_stereo){c=Math.tan(z.Lb(b.kd[0]));var d=Math.tan(z.Lb(b.kd[1])),f=Math.tan(z.Lb(b.kd[2])),k=Math.tan(z.Lb(b.kd[3]));b.top=b.near*c;b.right=b.near*d;b.bottom=-b.near*f;b.left=-b.near*k;Y.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb)}else c||(c=b.zb),Y.perspective(z.Lb(b.Vd),c,b.near,b.far,b.wb);
break;case a.qd:return;default:z.q("Wrong camera type: "+b.type)}e||(H(b),M(b))}function M(a){Y.copy(a.Ob,a.qg);a.qg[12]=0;a.qg[13]=0;a.qg[14]=0;a.qg[15]=1;Y.multiply(a.wb,a.qg,a.qg);Y.invert(a.qg,a.qg)}function H(a){Y.copy(a.Ob,a.md);Y.multiply(a.wb,a.md,a.md);Y.invert(a.md,a.ux)}function Z(b,c,e,d,f){d||(d=new Float32Array(24));c||(c=b.near);e||(e=b.far);var k,h,l,g,q,u,v,m;switch(b.type){case a.qd:z.q("Extraction from NONE camera is not possible");break;case a.Od:case a.yh:k=c*Math.tan(b.Vd*Math.PI/
360);g=-k;h=k*b.zb;l=-h;q=e/c*k;m=-q;u=q*b.zb;v=-u;break;case a.se:case a.xh:l=b.top*b.zb;k=q=b.top;h=u=l;g=m=-b.top;l=v=-l;break;case a.ui:k=q=b.top;h=u=b.right;g=m=b.bottom;l=v=b.left;break;case a.Mc:case a.ed:q=c/b.near;k=c*Math.tan(b.Vd*Math.PI/360);g=-k;h=b.right*q;l=b.left*q;v=e/c;q=k*v;m=-q;u=h*v;v*=l;break;case a.Le:case a.Me:q=c/b.near;k=b.top*q;g=b.bottom*q;h=b.right*q;l=b.left*q;v=e/c;q=k*v;m=g*v;u=h*v;v*=l;break;default:z.q("Wrong camera type: "+b.type)}d[0]=l;d[1]=g;d[2]=-c;d[3]=h;d[4]=
g;d[5]=-c;d[6]=h;d[7]=k;d[8]=-c;d[9]=l;d[10]=k;d[11]=-c;d[12]=v;d[13]=m;d[14]=-e;d[15]=v;d[16]=q;d[17]=-e;d[18]=u;d[19]=q;d[20]=-e;d[21]=u;d[22]=m;d[23]=-e;f&&(c=Ka,Y.invert(b.Ob,c),z.jo(d,c,d,0));return d}function ha(b){return sa.wa(b)&&b.k&&b.k.tb==a.cd}function u(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Hh){var e=b.csm_num;a.Hh=Array(e);for(var d=0;d<e;d++)a.Hh[d]=new Float32Array(3);a.uq=new Float32Array(e)}for(e=0;e<c;e++){var d=0==e?a.near:Q(b,a,e-1),f=Q(b,a,e),d=Z(a,d,f,Na),d=ua.SU(d);a.Hh[e].set(d.G);
a.uq[e]=d.Xa;a.hu[e]=ma.length(d.G);a.ho[e]=ca(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,e)}}else a.ho[0]=b.first_cascade_blur_radius}function Q(a,b,c){var e=a.csm_num,d=z.V(a.csm_first_cascade_border,b.near,b.far);a=z.V(a.csm_last_cascade_border,b.near,b.far);return z.V(ca(d,a,e,c),b.near,b.far)}function ca(a,b,c,e){switch(e){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,e/(c-1))}return a}function ja(a,b){b||(b=new Float32Array(3));ma.copy(la.F(a.k.n),b);return b}
var ua=r("__boundings");r("__config");var pa=r("__constraints"),S=r("__container"),Y=r("__mat4"),qa=r("__math"),sa=r("__obj_util"),za=r("__print"),X=r("__quat"),ta=r("__scenes"),oa=r("__subscene"),P=r("__transform"),la=r("__tsr"),z=r("__util"),ma=r("__vec3"),Ea=r("__vec4");a.qd=10;a.Od=20;a.se=30;a.yh=40;a.xh=50;a.ui=60;a.Mc=70;a.ed=80;a.Le=90;a.Me=100;a.xg=0;a.Jb=2;a.od=3;a.cd=4;var ea=z.Lb(.5),ya=new Float32Array(2),na=new Float32Array(2),Ha=new Float32Array(3),Da=new Float32Array(3),Ra=new Float32Array(3),
ra=new Float32Array(4),wa=new Float32Array(4),va=new Float32Array(4),xa=new Float32Array(4),Ka=new Float32Array(16),Na=new Float32Array(24),da=new Float32Array(6);a.sR=function(c,e){var f=e.k,k=c.data;switch(k.type){case "PERSP":var h=l(a.Od);if(k.angle_y)var q=z.df(k.angle_y);C(h,q,k.clip_start,k.clip_end);break;case "ORTHO":h=l(a.se),C(h,k.ortho_scale/2,k.clip_start,k.clip_end)}h.name=e.name;q=e.I;q[0].ba.push(h);for(var u=1;u<q.length;u++){var v=m(h,!1);q[u].ba.push(v)}f.tb=g(k.b4w_move_style);
f.dof_distance=k.dof_distance;h=k.dof_object;f.dof_object=h?h.nb:null;f.dof_front_start=k.b4w_dof_front_start;f.dof_front_end=k.b4w_dof_front_end;f.dof_rear_start=k.b4w_dof_rear_start;f.dof_rear_end=k.b4w_dof_rear_end;f.dof_power=k.b4w_dof_power;f.dof_bokeh=k.b4w_dof_bokeh;f.dof_bokeh_intensity=k.b4w_dof_bokeh_intensity;f.Cd=k.b4w_dof_foreground_blur;f.Tk=k.b4w_trans_velocity;f.Sk=k.b4w_rot_velocity;f.Uk=k.b4w_zoom_velocity;h=e.k.tb;q=c.data;u=null;h!=a.Jb&&h!=a.od||!q.b4w_use_horizontal_clamping||
(u={left:q.b4w_rotation_left_limit,right:q.b4w_rotation_right_limit,camera_space:"LOCAL"==q.b4w_horizontal_clamping_type},h==a.od&&(u.left*=-1,u.right*=-1));h=u;q=e.k.tb;u=c.data;v=null;q!=a.Jb&&q!=a.od||!u.b4w_use_vertical_clamping?q==a.cd&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=u.b4w_hover_angle_max?(v={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},v.down*=-1,v.up*=-1):za.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(v={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,
camera_space:"LOCAL"==u.b4w_vertical_clamping_type},q==a.Jb&&(v.down*=-1,v.up*=-1));var q=v,u=e.k.tb,v=c.data,y=null;u==a.Jb&&v.b4w_use_target_distance_limits&&v.b4w_distance_min<=v.b4w_distance_max?y={min:v.b4w_distance_min,max:v.b4w_distance_max}:u===a.cd&&v.b4w_use_zooming&&(v.b4w_distance_min<=v.b4w_distance_max?y={min:v.b4w_distance_min,max:v.b4w_distance_max}:za.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=y;v=c.data;y=null;e.k.tb==a.cd&&v.b4w_use_horizontal_clamping&&
v.b4w_horizontal_translation_min<=v.b4w_horizontal_translation_max&&(y={min:v.b4w_horizontal_translation_min,max:v.b4w_horizontal_translation_max});var v=y,y=c.data,H=null;e.k.tb==a.cd&&y.b4w_use_vertical_clamping&&y.b4w_vertical_translation_min<=y.b4w_vertical_translation_max&&(H={min:y.b4w_vertical_translation_min,max:y.b4w_vertical_translation_max});var y=H,H=c.data,w=null;e.k.tb==a.Jb&&H.b4w_use_pivot_limits&&(w={min_z:H.b4w_pivot_z_min,max_z:H.b4w_pivot_z_max});H=w;switch(f.tb){case a.od:f=la.F(e.k.n);
n(e,f,null,h,q);break;case a.Jb:f=la.F(e.k.n);d(e,f,k.b4w_target,h,q,u,H,k.b4w_use_panning);break;case a.cd:f=la.F(e.k.n),h=t(e,c.data.b4w_hover_zero_level,Da),b(e,f,h,u,q,v,y,k.b4w_enable_hover_hor_rotation)}J(e);p(e)};a.QL=n;a.SL=d;a.RL=b;a.Nn=p;a.Fc=m;a.nS=x;a.e6=g;a.hd=l;a.Z1=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.qc);case "DEPTH":return Boolean(a.Re);case "SCREEN":return!Boolean(a.qc)&&!Boolean(a.Re);default:z.q("Wrong attachment type: "+b)}};a.Cw=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.qc=
c;break;case "DEPTH":a.Re=c;break;case "SCREEN":a.qc=null;a.Re=null;break;default:z.q("Wrong attachment type: "+b)}};a.E3=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.qc;case "DEPTH":return a.Re;case "SCREEN":return null;default:z.q("Wrong attachment type: "+b)}};a.Lv=function(b,c){(b.type!=a.Od||c!=a.Mc&&c!=a.ed&&c!=a.Le&&c!=a.Me)&&z.q("make_stereo(): wrong camera type");b.type=c;h(b,6,.065)};a.jY=h;a.En=w;a.NA=f;a.Ju=function(a,b){w(a,b);b[0]=z.vi(b[0]+Math.PI);b[1]*=-1;return b};
a.Fw=C;a.ZX=function(b,c,e,d,f,k,h){switch(b.type){case a.ui:b.left=c;b.right=e;b.bottom=d;b.top=f;b.near=k;b.far=h;break;default:za.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.Wl=function(a){return a.k.tb};a.rY=K;a.M7=G;a.bD=function(a,b,c){var e=Ha;e[0]=0;e[1]=0;e[2]=-1;ma.transformQuat(e,c,e);e[0]+=b[0];e[1]+=b[1];e[2]+=b[2];var d=Da;d[0]=0;d[1]=1;d[2]=0;ma.transformQuat(d,c,d);G(a,b,e,d)};a.Iw=L;a.eY=D;a.HZ=N;a.GZ=function(b){var c=b.k;J(b);ba(b);switch(c.tb){case a.Jb:var e=
la.F(c.n);pa.GX(e,la.R(c.n),c.pivot);for(var d=0;d<b.I.length;d++)for(var f=b.I[d].ba,k=0;k<f.length;k++){var l=f[k];l.type!=a.Mc&&l.type!=a.ed||h(l,ma.dist(e,c.pivot),l.hf)}pa.Kj(b,c.lf);break;case a.od:b.ic||pa.Kj(b,c.lf)}I(b)};a.QD=I;a.zL=O;a.ML=E;a.mv=c;a.lv=y;a.UX=A;a.gY=e;a.$X=R;a.qY=q;a.QZ=ba;a.bs=F;a.ww=V;a.cs=U;a.I5=function(b){switch(b.type){case a.Od:case a.se:case a.Mc:case a.ed:return!0;default:return!1}};a.ZH=function(b){switch(b.type){case a.Od:case a.yh:case a.Mc:case a.ed:return z.Lb(b.Vd);
default:return za.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Bk=fa;a.PX=function(b,c,e,d,f){var k=1/Math.max(f,d);switch(b.type){case a.Od:case a.yh:f/=2;d/=2;e=-(e-f)/f*Math.tan(z.Lb(b.Vd)/2);c=(c-d)/d*Math.tan(z.Lb(b.Vd)/2)*b.zb;d=b.near*(e+k);f=b.near*(c+k);e=b.near*(e-k);c=b.near*(c-k);Y.frustum(c,f,e,d,b.near,b.far,b.wb);break;case a.se:case a.xh:b.right=b.top*b.zb;e=-e/f;c/=d;d=b.top+(e+k)*(b.top+b.top);f=-b.right+(c+k)*(b.right+b.right);e=b.top+(e-k)*(b.top+b.top);
c=-b.right+(c-k)*(b.right+b.right);Y.ortho(c,f,e,d,b.near,b.far,b.wb);break;case a.ui:e=-e/f,c/=d,d=b.top+(e+k)*(b.top-b.bottom),f=b.left+(c+k)*(b.right-b.left),e=b.top+(e-k)*(b.top-b.bottom),c=b.left+(c-k)*(b.right-b.left),Y.ortho(c,f,e,d,b.near,b.far,b.wb)}Y.copy(b.Ob,b.md);Y.multiply(b.wb,b.md,b.md);z.xn(b.md,b.Lh)};a.xz=M;a.hG=H;a.QT=Z;a.HQ=function(a){a=a.k;var b=ua.Qd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.O=b;var c=ua.uz(1,z.yf([0,0,0]));a.xa=c;a.Lp=ua.RF(1,b);a.Np=
ua.TF(1,b);a.Mp=ua.SF(1,b)};a.Rn=function(b){return sa.wa(b)&&b.k&&b.k.tb==a.xg};a.Fa=function(b){return sa.wa(b)&&b.k&&b.k.tb==a.Jb};a.tc=function(b){return sa.wa(b)&&b.k&&b.k.tb==a.od};a.$a=ha;a.zv=function(b){return sa.wa(b)&&b.k&&b.I[0].ba[0].type==a.se};a.PD=u;a.hT=Q;a.oC=function(b,c,e){b=b.I[0].ba[0];switch(b.type){case a.Od:case a.yh:case a.se:case a.xh:case a.Mc:case a.ed:case a.Le:case a.Me:var d=va;d.set(c);d[3]=1;Ea.transformMat4(d,b.md,d);c=-d[1]/d[3];e[0]=(d[0]/d[3]+1)/2*b.width;e[1]=
(c+1)/2*b.height;S.r_(e[0],e[1],e,b);2<e.length&&(e[2]=(d[2]/Math.abs(d[3])+1)/2);return e;default:return za.error("Non-compatible camera"),e}};a.LU=function(a){return a.I[0].ba[0]};a.Gn=function(b,c){switch(b.type){case a.Od:case a.yh:case a.Mc:case a.ed:var e=Math.tan(z.Lb(b.Vd)/2);switch(c){case "LEFT":return-e*b.zb;case "RIGHT":return e*b.zb;case "TOP":return e;case "BOTTOM":return-e}break;case a.se:case a.xh:switch(c){case "LEFT":return-b.top*b.zb;case "RIGHT":return b.top*b.zb;case "TOP":return b.top;
case "BOTTOM":return-b.top}break;case a.ui:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Le:case a.Me:switch(c){case "LEFT":return-Math.tan(z.Lb(Math.min(b.kd[1],b.kd[3])));case "RIGHT":return Math.tan(z.Lb(Math.min(b.kd[1],b.kd[3])));case "TOP":return Math.tan(z.Lb(Math.min(b.kd[0],b.kd[2])));case "BOTTOM":return-Math.tan(z.Lb(Math.min(b.kd[0],b.kd[2])))}break;default:z.q("Unknown camera type")}};a.JV=function(b){switch(b.type){case a.se:case a.xh:case a.ui:return!0;
default:return!1}};a.QU=function(b,c){switch(b.type){case a.Od:case a.yh:case a.Mc:case a.ed:var e=z.Lb(b.Vd);return c?e*b.zb:e;default:return 0}};a.ls=function(a,b,c){a=a.k;la.ff(b,a.n);ma.copy(c,a.pivot)};a.Hw=function(a,b){var c=a.k,e=ma.subtract(b,c.Tb,Ha),e=ma.add(e,la.F(c.n),e);P.Vc(a,e);ma.copy(b,c.Tb)};a.kY=function(a,b){var c=a.k,e=ma.subtract(b,c.pivot,Ha),e=ma.add(e,la.F(c.n),e);P.Vc(a,e);ma.copy(b,c.pivot)};a.oI=ja;a.UC=function(c,e){c.k.tb=e;c.k.lb=null;c.k.ka=null;c.k.sb=null;c.k.yc=
null;c.k.zc=null;p(c);switch(e){case a.cd:var d=la.F(c.k.n),f=t(c,0,Da);b(c,d,f,null,null,null,null,c.k.Jh);break;case a.Jb:d=ja(c,Ha),f=z.lc(la.R(c.k.n),z.$c,Da),f=ma.scaleAndAdd(d,f,10,f),ma.copy(f,c.k.pivot)}};a.Ns=function(a){a=a.k;a.tb=0;ma.set(0,0,0,a.pivot);ma.set(0,0,0,a.Tb);a.Kk=!1;a.use_panning=!1;a.lb=null;a.ka=null;a.sb=null;a.yc=null;a.zc=null;a.ae=null;a.Jh=!0};a.PC=function(a,b){for(var c=0;c<a.length;c++){var e=a[c];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||h(e,e.Hk,b)}};a.TC=
function(a,b,c){var e=ta.B();a=sa.ja(a,e).ba;for(e=0;e<a.length;e++){var d=a[e];if(90==d.type||100==d.type)90==d.type&&Ea.copy(b,d.kd),100==d.type&&Ea.copy(c,d.kd),d.mc||fa(d),H(d),M(d)}}};b4w.module.__constraints=function(a,r){function n(a){var b={};b.type=a;return b}function d(a,c){a.ic&&a.ic.Ga&&b(a.ic.Ga,a);if(c.Ga){var d=c.Ga;-1==d.Pe.indexOf(a)?d.Pe.push(a):C.q("Descendant object override is forbidden")}a.ic=c}function b(a,b){var c=a.Pe.indexOf(b);-1!=c?a.Pe.splice(c,1):C.q("No descendant object")}function t(a,b,d){switch(b.type){case 1:var h=f.R(a.k.n),n=b.Ga.k.n;d=f.R(b.Ga.k.n);b.le?(w.copy(b.le,h),w.multiply(d,h,h)):w.copy(d,h);var p=f.Wc(b.offset,n,D);f.ff(p,a.k.n);f.Hf(b.ds*
f.Yd(b.Ga.k.n),a.k.n);break;case 9:p=f.F(a.k.n);h=f.R(a.k.n);n=b.Ga.k.n;d=f.R(b.Ga.k.n);w.multiply(w.invert(b.tm,b.tm),h,h);w.multiply(d,h,h);f.Wc(b.offset,n,p);w.copy(d,b.tm);break;case 10:p=f.F(a.k.n);h=f.R(a.k.n);n=b.Ga.k.n;d=f.R(b.Ga.k.n);w.multiply(w.invert(b.tm,b.tm),h,h);w.multiply(d,h,h);f.Wc(b.offset,n,p);w.copy(d,b.tm);p=f.R(a.k.n);h=w.multiply(f.R(b.Ga.k.n),b.le,E);h=g.NA(h,G);p=g.NA(p,L);g.bs(a,C.ul(p[0],h[0]+b.PR,h[0]+b.OR),C.ul(p[1],h[1]+b.NR,h[1]+b.QR));break;case 13:var p=f.F(a.k.n),
h=f.R(a.k.n),n=b.Ga.k.n,t=f.F(n),O=b.FY,r=D,v=E;f.Wc(b.offset,n,r);C.Xw(r,p,d,O,p);n=D;K.sub(t,p,n);K.normalize(n,n);var fa=h,p=c,t=p.subarray(0,3),r=p.subarray(3,6),M=p.subarray(6,9);K.copy(n,M);K.negate(M,M);K.normalize(M,M);Boolean(.999999<Math.abs(K.dot(n,C.ad)))?(n=l.fromQuat(w.normalize(fa,v),k),K.copy(n.subarray(0,3),t)):K.cross(C.ad,M,t);K.normalize(t,t);K.cross(M,t,r);K.normalize(r,r);w.fromMat3(p,v);w.normalize(v,v);C.gM(v,h,d,.16*O,h);break;case 2:h=f.R(a.k.n);d=y;x.Iu(b.Ga,b.sl,!0,d);
f.multiply(b.Ga.k.n,d,d);h[0]=d[4];h[1]=d[5];h[2]=d[6];h[3]=d[7];b.le&&(w.copy(b.le,h),w.multiply(h,b.le,h));f.Hf(b.ds*d[3],a.k.n);p=f.F(a.k.n);f.Wc(b.offset,d,p);break;case 3:p=f.F(a.k.n);h=f.R(a.k.n);d=f.F(b.Ga.k.n);B(p,h,d);break;case 4:p=f.F(a.k.n);h=f.R(a.k.n);d=b.target;B(p,h,d);break;case 5:p=f.F(a.k.n);h=f.R(a.k.n);d=f.F(b.Ga.k.n);B(p,h,d);h=K.dist(p,d);if(h=h>b.Mg?h-b.Mg:h<b.Bq?h-b.Bq:0)K.sub(d,p,D),K.normalize(D,D),K.scale(D,h,D),K.add(p,D,p);break;case 6:p=f.F(a.k.n);h=f.R(a.k.n);d=b.target;
B(p,h,d);h=K.dist(p,d);if(h=h>b.Mg?h-b.Mg:h<b.Bq?h-b.Bq:0)K.sub(d,p,D),K.normalize(D,D),K.scale(D,h,D),K.add(p,D,p);break;case 7:n=b.Ga.k.n;p=f.F(a.k.n);f.Wc(b.offset,n,p);break;case 8:t=f.F(b.Ga.k.n);p=f.F(a.k.n);K.add(t,b.offset,p);break;case 14:h=f.R(a.k.n);n=b.Ga.k.n;d=f.R(b.Ga.k.n);b.le?(w.copy(b.le,h),w.multiply(d,h,h)):w.copy(d,h);p=f.F(a.k.n);f.Wc(b.offset,n,p);break;case 11:f.multiply(b.Ga.k.n,b.kx,a.k.n);break;case 12:p=b.kx;d=y;x.Iu(b.Ga,b.sl,!0,d);f.multiply(b.Ga.k.n,d,d);f.multiply(d,
p,a.k.n);break;case 15:h=b.Ga,d=g.LU(h),p=f.F(a.k.n),n=g.Gn(d,"LEFT"),t=g.Gn(d,"RIGHT"),O=g.Gn(d,"TOP"),v=g.Gn(d,"BOTTOM"),r="heights"==b.hor_units?O-v:t-n,b.NJ?(n=g.Gn(d,"LEFT"),p[0]=n+r*b.vB):(t=g.Gn(d,"RIGHT"),p[0]=t-r*b.vB),n="heights"==b.vert_units?O-v:t-n,p[1]=b.NM?O-n*b.CD:v+n*b.CD,g.JV(d)?p[2]=-b.distance:(p[2]=-1,K.normalize(p,p),K.scale(p,b.distance/Math.abs(p[2]),p)),f.xd(p,h.k.n,p),K.add(f.F(h.k.n),p,p),p=f.R(a.k.n),h=f.R(h.k.n),b.le?(w.copy(b.le,p),w.multiply(h,p,p)):w.copy(h,p)}"CAMERA"==
a.k.type&&(p=a.k.lf,10==b.type&&(d=f.R(b.Ga.k.n),p=K.transformQuat(p,d,A)),g.QD(a),m(a,p))}function p(a,b){switch(b.type){case 1:var c=b.target.k.n,d=y;f.invert(a.k.n,d);f.multiply(d,c,d);x.OX(a,b.sl,d)}a.VB=!0}function B(a,b,c){var d=D;C.lc(b,C.$c,d);K.normalize(d,d);var f=N;K.subtract(c,a,f);K.normalize(f,f);a=C.JC(d,f,O);w.multiply(a,b,b);w.normalize(b,b)}function m(a,b,c){var d=a.k,k=f.R(d.n),h=C.lc(k,C.ad,D);K.normalize(h,h);if(.999999<Math.abs(K.dot(b,h)))h=w.identity(E);else{var l=K.cross(b,
h,N);K.normalize(l,l);d.tb==g.Jb?d.Kk&&K.negate(l,l):(d=C.lc(k,C.Zk,I),0<K.dot(d,b)&&K.negate(l,l));d=C.lc(k,C.oi,I);K.normalize(d,d);var m=C.V(K.dot(d,l),-1,1),h=-.999999>=m?w.setAxisAngle(h,Math.acos(m),E):w.rotationTo(d,l,E);w.normalize(h,h)}w.multiply(h,k,k);c&&(c=C.lc(k,C.pi,D),0>K.dot(b,c)&&w.rotateZ(k,Math.PI,k));g.QD(a)}var x=r("__armature"),g=r("__camera"),l=r("__mat3"),h=r("__print"),w=r("__quat"),f=r("__tsr"),C=r("__util"),K=r("__vec3");a.P_=1;a.O_=2;a.T_=3;a.U_=4;a.J_=5;a.K_=6;a.Q_=7;
a.I_=8;a.N_=9;a.M_=10;a.G_=11;a.H_=12;a.L_=13;a.R_=14;a.S_=15;a.D_=1;var G=new Float32Array(2),L=new Float32Array(2),D=new Float32Array(3),N=new Float32Array(3),I=new Float32Array(3),O=new Float32Array(4),E=new Float32Array(4),c=new Float32Array(9),k=new Float32Array(9),y=f.create(),A=new Float32Array(3);a.zF=function(a,b,c,f,k){var h=n(1);h.Ga=b;h.offset=new Float32Array(c);h.le=f?new Float32Array(f):null;h.ds=k;d(a,h);t(a,h,0)};a.qQ=function(a,b,c,f,k,h){var l=n(2);l.Ga=b;l.sl=c;l.offset=new Float32Array(f);
l.le=k?new Float32Array(k):null;l.ds=h;d(a,l);t(a,l,0)};a.oQ=function(a,b,c,k){var h=n(9),l=f.R(a.k.n),g=f.R(b.k.n);h.Ga=b;h.offset=new Float32Array(c);h.tm=new Float32Array(g);k&&(w.copy(k,l),w.multiply(g,l,l));d(a,h);t(a,h,0)};a.nQ=function(a,b,c,k,h,l,g,m){var y=n(10),v=f.R(a.k.n),p=f.R(b.k.n);y.Ga=b;y.offset=new Float32Array(c);y.tm=new Float32Array(p);y.OR=C.vi(h);y.PR=C.vi(l);y.QR=C.Bg(g,-Math.PI,Math.PI);y.NR=C.Bg(m,-Math.PI,Math.PI);k?(y.le=new Float32Array(k),w.copy(k,v),w.multiply(p,v,v)):
y.le=w.create();d(a,y);t(a,y,0)};a.mQ=function(a,b,c,f){var k=n(13);k.Ga=b;k.offset=new Float32Array(c);k.FY=f;d(a,k);t(a,k,0)};a.uQ=function(a,b,c,f){var k=n(14);k.Ga=b;k.offset=new Float32Array(c);k.ds=1;k.le=f?new Float32Array(f):null;d(a,k);t(a,k,0)};a.I6=b;a.wQ=function(a,b){var c=n(3);c.Ga=b;d(a,c);t(a,c,0)};a.xQ=function(a,b){var c=n(4);c.target=new Float32Array(b);d(a,c);t(a,c,0)};a.iQ=function(a,b,c,f){var k=n(5);k.Ga=b;k.Bq=c;k.Mg=f;d(a,k);t(a,k,0)};a.jQ=function(a,b,c,f){var k=n(6);k.target=
new Float32Array(b);k.Bq=c;k.Mg=f;d(a,k);t(a,k,0)};a.tQ=function(a,b){var c=n(7);c.Ga=b;c.offset=new Float32Array([0,0,.5]);d(a,c);t(a,c,0)};a.gQ=function(a,b,c){var f=n(8);f.Ga=b;f.offset=new Float32Array(c);d(a,f);t(a,f,0)};a.eQ=function(a,b,c){var f=n(11);f.Ga=b;f.kx=new Float32Array(c);d(a,f);t(a,f,0)};a.fQ=function(a,b,c,f){var k=n(12);k.Ga=b;k.sl=c;k.kx=new Float32Array(f);d(a,k);t(a,k,0)};a.gz=function(a,b,c){var f=n(15);f.Ga=b;if(C.Rh(c.left))f.NJ=!0,f.vB=c.left;else if(C.Rh(c.right))f.NJ=
!1,f.vB=c.right;else{h.error("append_stiff_viewport: Wrong positioning params");return}if(C.Rh(c.top))f.NM=!0,f.CD=c.top;else if(C.Rh(c.bottom))f.NM=!1,f.CD=c.bottom;else{h.error("append_stiff_viewport: Wrong positioning params");return}C.Rh(c.distance)?(f.distance=c.distance,f.le=C.Rh(c.rotation)?new Float32Array(c.rotation):null,f.hor_units=C.Rh(c.hor_units)?c.hor_units:"widths",f.vert_units=C.Rh(c.vert_units)?c.vert_units:"heights",d(a,f),t(a,f,0)):h.error("append_stiff_viewport: Wrong positioning params")};
a.IZ=function(a,b){a.ic&&t(a,a.ic,b)};a.rQ=function(a,b,c,d,f){var k=n(1);k.sl=c;k.target=b;k.offset=new Float32Array(d);k.le=f?new Float32Array(f):null;k.ds=1;b=k.target;c=k.sl;d=a.k.Dg[c];f=b.Oz;for(var h=0;h<f;h++){var l=f[h];if(l[0]==a&&l[1]==c){f.splice(h,1);break}}b.Oz.push([a,c]);d.ic=k;p(a,k)};a.BZ=function(a,b){var c=a.k.Dg[b];c.ic&&p(a,c.ic)};a.GX=B;a.Kj=m;a.DR=function(a){return a.ic?!0:!1};a.remove=function(a){a.ic.Ga&&b(a.ic.Ga,a);a.ic=null};a.O4=function(a){return a.ic?a.ic.type:null};
a.bg=function(a){a=a.ic;return!a||11!=a.type&&12!=a.type?!1:!0};a.Ku=function(a){if((a=a.ic)&&11==a.type)return a.Ga.k.n;if(a&&12==a.type){var b=y;x.Iu(a.Ga,a.sl,!0,b);f.multiply(a.Ga.k.n,b,b);return b}return null};a.$f=function(a){a=a.ic;return!a||11!=a.type&&12!=a.type?null:a.kx}};b4w.module.__container=function(a,r){var n,d,b,t,p;function B(a,b){n=a;d=b}function m(){var a=c.getBoundingClientRect();B(a.left,a.top)}function x(){return I.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function g(b,d,h){if(!b||!d){b=a.Sx;d=a.Rx;var g=y;g.style.width=a.Sx+"px";g.style.height=a.Rx+"px"}var g=c,m=k;!1!==h&&(g.style.width=b+"px",g.style.height=d+"px",m&&(m.style.width=b+"px",m.style.height=d+"px"));m&&(m.width=b,m.height=d,f.xs());h=Math.floor(b*I.canvas_resolution_factor);d=Math.floor(d*
I.canvas_resolution_factor);x()&&(h*=window.devicePixelRatio,d*=window.devicePixelRatio);if(m=G.Mh())m=m.s,h=Math.floor(h*m.no),d=Math.floor(d*m.no);g.width=h;g.height=d;var m=Math.min(E.drawingBufferWidth,O.FB,O.KB[0]),n=Math.min(E.drawingBufferHeight,O.FB,O.KB[1]);if(h>m||d>n)K.warn("Canvas size exceeds platform limits, downscaling"),m=Math.min(m/h,n/d),h*=m,d*=m,g.width=h,g.height=d;G.PL(h,d,h/b);G.Ca()&&D.D(G.B().wj);w.MZ(g.width,g.height);w.Wg()&&(l.update(),G.update(L.ar(),0),l.fN())}var l=
r("__anchors"),h=r("__config"),w=r("__data"),f=r("__hud"),C=r("__input"),K=r("__print"),G=r("__scenes"),L=r("__time"),D=r("__transform"),N=r("__util"),I=h.A,O=h.Ci,E=null,c=null,k=null,y=null,A=!1;t=b=0;p=1;n=d=0;a.Sx=320;a.Rx=240;a.If=function(a){E=a};a.Fn=function(){return c};a.hI=function(){return k};a.We=function(){return y};a.Ug=function(a,b){a&&a.parentNode?(c=a,k=b,y=a.parentNode):N.q("canvas container is not available")};a.sv=function(a,b){b=b||"LAST";switch(b){case "FIRST":y.insertBefore(a,
y.firstElementChild);break;case "JUST_BEFORE_CANVAS":y.insertBefore(a,c);break;case "JUST_AFTER_CANVAS":c.nextElementSibling?y.insertBefore(a,c.nextElementSibling):y.appendChild(a,c);break;case "LAST":y.appendChild(a,c);break;default:K.error(b+" invalid stack order")}};a.WI=function(){return b};a.VI=function(){return t};a.jL=B;a.WM=m;a.vY=function(a,c,d){b=a;t=c;p=d;m()};a.EA=function(){A=!0};a.Vt=function(a,b,c){c||(c=new Float32Array(2));var f=c;A&&(m(),A=!1);f[0]=a-n;a=c;A&&(m(),A=!1);a[1]=b-d;
return c};a.Qt=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*p;d[1]=c*p;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.r_=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/p;d[1]=c/p;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.uJ=function(b){return b&&b.parentNode?b.parentNode==y?!0:a.uJ(b.parentNode):!1};a.GV=x;a.bU=function(a){var b=document.getElementsByTagName("script");a=N.aj(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=g;a.wk=function(a){var b=y,d=c,f=b.clientWidth,
b=b.clientHeight;if(a||f!=d.clientWidth||b!=d.clientHeight)(a="HMD"===I.stereo&&C.ZI())&&a.isPresenting||g(f,b,!0)};a.reset=function(){y=k=c=E=null}};b4w.module.__anchors=function(a,r){function n(){q=!0;C.We().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!g&&!q}if(!ba&&!e){var b=R;if(b)if("visible"==b.lastElementChild.style.visibility)d(),R=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,f=c.firstElementChild,k=f.innerHTML;c.style.visibility="visible";var h=Math.min(parseInt(c.style.width)||200,B(k)-24),l=m(k,h),g=!0,q=!0;b.style.display="none";ba=!0;O.en(0,h,200,function(b){b==
h&&(g=!1,q||(ba=!1),a&&(f.style.visibility="visible"));c.style.width=b+"px"});O.en(0,l,200,function(b){b==l&&(q=!1,g||(ba=!1),a&&(f.style.visibility="visible"));c.style.height=b+"px"})}}})}function d(){var a=R.lastElementChild;R.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function t(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function p(a,c,f){var k=document.createElement("div"),h=document.createElement("span");f&&(k.style.width=f+"px");t(k);b(h);h.innerHTML=a;k.style.visibility="hidden";h.style.visibility="hidden";k.appendChild(h);c.appendChild(k);c.addEventListener("mousedown",function(){ba||c==R||1!=c.style.opacity||e||(R&&"visible"==R.lastElementChild.style.visibility&&d(),R=c)})}function B(a){var c=document.createElement("div"),e=document.createElement("span");e.innerHTML=a;b(e);t(c);c.appendChild(e);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function m(a,c){var e=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);t(e);e.style.width=c+"px";e.style.display="inline-block";e.appendChild(d);document.body.appendChild(e);d=e.offsetHeight-16;document.body.removeChild(e);return d}function x(){for(var a=0,b=0;b<A.length;b++)A[b].sn&&a++;J=new Float32Array(3*a)}function g(a,b){return b.depth-a.depth}function l(a,b,c){a=a.element;y.oJ&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var h=r("__batch"),w=r("__camera"),f=r("__config"),C=r("__container"),K=r("__objects"),G=r("__obj_util"),L=r("__print"),D=r("__renderer"),N=r("__scenes"),I=r("__subscene"),O=r("__time"),E=r("__transform"),c=r("__tsr"),k=r("__vec3"),y=f.A,A=[],e=!1,R=null,q=!1,ba=!1,J=new Float32Array(0),F=new Uint8Array(16),
V=new Float32Array(2),U=new Float32Array(3),aa=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<A.length;c++)if(A[c].da==a){c=!0;break a}c=!1}if(!c){c=a.anchor.sn&&Boolean(N.Ma(N.Mh(),I.Um));c={type:a.anchor.type,da:a,x:0,y:0,depth:0,ml:"out",sn:c,element:null,Zn:null,cQ:a.anchor.yW,Nj:a.anchor.Nj};switch(c.type){case "ANNOTATION":var e=c.da;a=C.We();var d=K.Vl(e),e=e.name,f=document.createElement("div"),k=f.cloneNode(),h=document.createElement("span"),l="";f.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
k.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";f.style.visibility="hidden";d&&(l=d.description||l,e=d.title||e);h.innerHTML=e;h.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(h);h.style.whiteSpace="nowrap";k.appendChild(h);f.appendChild(k);l&&p(l,f,c.cQ);a.appendChild(f);c.element=f;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.Nj),c.element)for(d=0;d<A.length;d++)"ELEMENT"==A[d].type&&A[d].Nj==a.anchor.Nj&&(L.warn("Anchor with the id '"+a.anchor.Nj+"' already exists, making the new anchor generic."),c.type="GENERIC");else L.warn("Anchor HTML element with the id '"+a.anchor.Nj+"' was not found, making it generic."),c.type="GENERIC"}A.push(c);x();
q||n()}};a.remove=function(a){for(var b=0;b<A.length;b++){var c=A[b];if(c.da==a){"ANNOTATION"==c.type&&(a=c,C.We().removeChild(a.element));A.splice(b,1);x();break}}};a.update=function(a){for(var b=0,e=A.length;e--;){var d=A[e];d.sn&&J.set(c.F(d.da.k.n),3*b++);var f,k=d,u=U;f=N.Ul(N.Mh());f=u=w.oC(f,c.F(k.da.k.n),u);k=f[0];u=f[1];f=f[2];if(a||k!=d.x||u!=d.y||f!=d.depth){switch(d.type){case "ANNOTATION":var m=k,q=u;l(d,m,q);break;case "ELEMENT":q=d.element.getBoundingClientRect(),m=k-q.width/2,q=u-
q.height/2,l(d,m,q)}d.x=k;d.y=u;d.depth=f;d.Zn&&d.Zn(k,u,d.ml,d.da,d.element)}}A.sort(g);for(e=0;e<A.length;e++)d=A[e],"GENERIC"!=d.type&&(d.element.style.zIndex=R==d.element?A.length:e);0<b&&(a=N.Ma(N.Mh(),I.Um),b=a.Ra[0].ra[0],h.vZ(b.za,J),I.Oc(a,b))};a.fN=function(){for(var a=C.We(),b=A.length;b--;){var c=A[b],e=c.da,f=e.k,h=c.x,l=c.y,g=c.depth,m=N.Ul(N.Mh()),q=E.Bf(e,U),m=E.Bf(m,aa),q=k.dist(q,m);(g=0>h||0>l||0>g||1<g||N.pB(e)||h>=a.clientWidth||l>=a.clientHeight)||(g=f.af,g=!(q<f.Yg?0:g==G.np||
q<g));f=g?"out":"visible";c.sn&&"out"!=f&&(f=c,g=N.Ma(N.Mh(),I.Um).p,q=C.Qt(f.x,f.y,V,g),D.vC(g.Ve,q[0],g.height-q[1],2,2,F),f=1020==F[5]+F[6]+F[9]+F[10]?"visible":"out"==f.ml||0==F[5]+F[6]+F[9]+F[10]?"covered":f.ml);if(f!=c.ml){switch(c.type){case "ANNOTATION":case "ELEMENT":var y=c.element;if(!y)break;"out"==f?(y.style.visibility="hidden",y.children.length&&(y.children[0].style.visibility="hidden")):"visible"==f?(y.style.visibility="visible",y.children.length&&(y.children[0].style.visibility="visible"),
y.style.opacity=1):(y.style.visibility="visible",y.style.opacity=.1,y.children.length&&(y.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<y.children.length&&"visible"==y.lastElementChild.style.visibility&&(d(),y==R&&(R=null)))}c.ml=f;c.Zn&&c.Zn(h,l,c.ml,e,y)}}};a.JF=function(a,b){for(var c=0;c<A.length;c++)A[c].da==a&&(A[c].Zn=b)};a.wH=function(a){for(var b=0;b<A.length;b++)A[b].da==a&&(A[b].Zn=null)};a.sa=function(){for(var a=0;a<A.length;a++){var b=A[a];"ANNOTATION"==b.type&&C.We().removeChild(b.element)}A.length=
0};a.uv=function(a){for(var b=0;b<A.length;b++)if(A[b].da==a)return!0;return!1};a.mI=function(a){for(var b=0;b<A.length;b++)if(A[b].da==a)return A[b].Nj;return!1};a.pause=function(){e=!0};a.dj=function(){e=!1};a.TW=function(a,b){for(var c=-1,e=0;e<A.length;e++){var d;if(d="visible"==A[e].ml){var f=A[e];if(f.element){d=Math.round(f.element.offsetWidth)||0;var k=Math.round(f.element.offsetHeight)||0}else k=d=0;var h=f.x,f=f.y;d=a>=h&&a<=h+d&&b<f&&b>=f-k?!0:!1}if(d)if(0>c)var l=A[e].depth,c=e;else A[e].depth<
l&&(c=e,l=A[e].depth)}return 0>c?null:A[c].da}};b4w.module.__objects=function(a,r){function n(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var e=b[c].xb;e.s.outline&&a.gh&&R.AX(e)}}function d(a){a.k.gh=0;a=ja.indexOf(a);-1!=a&&ja.splice(a,1)}function b(a){if(a.yn)for(var b=a.I,c=0;c<b.length;c++)R.YM(b[c].xb,a)}function t(a,b){for(var c=a.I,e=b.I,d=0;d<c.length;d++){for(var f=!1,k=0;k<e.length;k++)if(c[d].xb==e[k].xb){f=!0;break}f||p(b,c[d].xb)&&E.Fp(b,c[d].xb)}}function p(a,b){return!b.nF&&"SPEAKER"==a.type||!b.WP&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function B(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.$y||a.parent&&a.parent.$y)return!0;switch(a.type){case "MESH":var e=a.b4w_do_not_batch,d=a.b4w_collision,f=a.b4w_vehicle,k=a.b4w_floating,h=a.b4w_character,l=c.mV(a),g=I.dG(a),u=0<a.data.b4w_shape_keys.length,z=a.b4w_dynamic_geometry;if(!(e=w.eG(a,b)||e||d||f||u||k||l||h||g||z))a:{e=a.data;for(d=0;d<e.materials.length;d++)if(f=e.materials[d],f.b4w_water||f.b4w_lens_flares||m(f.node_tree)){e=!0;break a}e=!1}return e;case "EMPTY":return e=
I.dG(a),d=a.b4w_do_not_batch,f=Boolean(a.b4w_anchor),w.eG(a,b)||e||d||f;default:return!0}}function m(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var e=c.convert_from,d=c.convert_to,f=c.outputs[0];if(!(!f.is_linked||"WORLD"==e&&"CAMERA"==d||"CAMERA"==e&&"WORLD"==d||"OBJECT"==e&&"OBJECT"==d))return!0}if("NORMAL_MAP"==c.type&&(e=c.space,f=c.outputs[0],f.is_linked&&("OBJECT"==e||"BLENDER_OBJECT"==e))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(f=c.outputs[1],e=c.outputs[3],c.outputs[0].is_linked||f.is_linked||e.is_linked))return!0}return!1}function x(a,b){var c=a.animation_data,e=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==w.Ry||c.s.type==w.Qy&&"ARMATURE"==b.type||c.s.type==w.PO&&"LAMP"==b.type||c.s.type==w.OO&&"WORLD"==b.type)&&b.Jg.push(w.pJ(null,c)));e&&e.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Jg.push(w.pJ(null,e.action));"MESH"==b.type&&b.Jg.push.apply(b.Jg,w.DU(a))}function g(a,b,c){b=Z[b]||
[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if(f.k.Qe==c||-1==c)for(var k=f.I,h=0;h<k.length;h++)k[h].xb==a&&e.push(f)}return e}function l(a,b,c,e,d){for(var f=null,k=0;k<b.length;k++){var h=b[k];if(!((c?h.pm:h.name)!=a||h.k.Qe!=e&&-1!=e||d&&!h.Ej||(f=h,E.Sg(f))))break}return f}function h(a){Z.ALL.push(a);Z[a.type]||(Z[a.type]=[]);Z[a.type].push(a);var b=a.k.Ed;if(null!=b)for(var c=0;c<ca.length;c++){var e=ca[c];e.k.Ed==b&&e.Zr.push(a)}}var w=r("__animation"),f=r("__batch"),C=r("__boundings"),
K=r("__camera"),G=r("__config"),L=r("__constraints"),D=r("__geometry"),N=r("__lights"),I=r("__nla"),O=r("__nodemat"),E=r("__obj_util"),c=r("__particles"),k=r("__physics"),y=r("__print"),A=r("__primitives"),e=r("__quat"),R=r("__scenes"),q=r("__sfx"),ba=r("__transform"),J=r("__textures"),F=r("__tsr"),V=r("__util"),U=r("__vec3"),aa=r("__armature"),v=r("__anchors"),fa=r("__renderer"),M=G.A,H=G.Uc,Z={ALL:[]},ha=new Float32Array(24),u=0,Q=0,ca=[],ja=[],ua=new Float32Array(3),pa=new Float32Array(4);a.ay=
0;a.$x=1;a.Kc=2;a.Dc=-1;a.update=function(a){for(var b=0;b<ja.length;b++){var c=ja[b],e=c,f=a,k=0,h=e.qK;0==h.ex&&(h.ex=f);f-=h.ex;if(h.xC&&f/h.Gf>=h.xC)d(e);else{f%=h.Gf;if(f<h.cC)switch(h=f/(h.cC/5),f=Math.floor(h),f){case 0:k=(h-f)/2;break;case 1:k=(h-f)/2+.5;break;case 2:k=1;break;case 3:k=1-(h-f)/2;break;case 4:k=.5-(h-f)/2}e.k.gh=k}c.k.gh&&n(c)}if(a=Z.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.VB&&(ba.D(c),c.VB=!1)};a.CL=function(a,b){a.k.gh=b;n(a)};a.gn=function(a,b,c,e){var d=a.qK;d.ex=0;d.cC=
b;d.Gf=c;d.xC=e;-1==ja.indexOf(a)&&ja.push(a)};a.Tt=d;a.Pk=function(a,b){b.qj=a.uuid;b.Ej=!0;x(a,b);a.$y=b.Ea=B(a,b);a.XP=!0;b.Xe=a.b4w_vehicle;b.dg=a.b4w_character;b.cm=a.b4w_floating;b.Lm=a.b4w_collision;b.$b=a.b4w_collision_id;b.$t=a.b4w_correct_bounding_offset;var c=a.game;b.hh={Nr:c.physics_type,Es:c.use_ghost,nN:c.use_sleep,Uh:c.mass,tN:c.velocity_min,sN:c.velocity_max,nH:c.damping,aL:c.rotation_damping,hW:c.lock_location_x,iW:c.lock_location_y,jW:c.lock_location_z,kW:c.lock_rotation_x,lW:c.lock_rotation_y,
mW:c.lock_rotation_z,jq:c.collision_margin,hq:c.collision_group,kq:c.collision_mask,TD:c.use_collision_bounds,Wt:c.collision_bounds_type,As:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.kf={name:c.name,cf:c.part,aZ:c.suspension_rest_length,rD:c.suspension_compression,tD:c.suspension_stiffness,sD:c.suspension_damping,dE:c.wheel_friction,HC:c.roll_influence,HB:c.max_suspension_travel_cm,Qq:c.force_max,Vp:c.brake_max,Io:c.steering_max,Xn:c.max_speed_angle,zq:c.delta_tach_angle,ss:c.speed_ratio,
ts:c.steering_ratio,kr:c.inverse_control,Ml:c.floating_factor,Qm:c.water_lin_damp,Rm:c.water_rot_damp,yM:c.synchronize_position};if(c=a.b4w_floating_settings)b.zn={name:c.name,cf:c.part,Ml:c.floating_factor,Qm:c.water_lin_damp,Rm:c.water_rot_damp,yM:c.synchronize_position};if(c=a.b4w_character_settings)b.qG={w_:c.walk_speed,HX:c.run_speed,UY:c.step_height,PV:c.jump_strength,y_:c.waterline};for(c=0;c<a.constraints.length;c++){var e=a.constraints[c];"RIGID_BODY_JOINT"==e.type&&b.jC.push({target:e.target.nb,
VW:e.pivot_type,WW:e.pivot_x,XW:e.pivot_y,YW:e.pivot_z,Ha:e.axis_x,Ia:e.axis_y,Ja:e.axis_z,i_:e.use_limit_x,j_:e.use_limit_y,k_:e.use_limit_z,e_:e.use_angular_limit_x,f_:e.use_angular_limit_y,g_:e.use_angular_limit_z,ZV:e.limit_max_x,$V:e.limit_max_y,aW:e.limit_max_z,bW:e.limit_min_x,cW:e.limit_min_y,dW:e.limit_min_z,TV:e.limit_angle_max_x,UV:e.limit_angle_max_y,VV:e.limit_angle_max_z,WV:e.limit_angle_min_x,XV:e.limit_angle_min_y,YV:e.limit_angle_min_z})}c=b.k=E.tq("MESH"===b.type?b.Ea?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.nb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Kr=a.parent_bone),a.pinverse_tsr&&(b.lw=F.create(),F.copy(a.pinverse_tsr,b.lw))):a.dg_parent&&(b.parent=a.dg_parent.nb,b.rk=!0);var e=a.location,d=a.scale[0];V.qC(a.rotation_quaternion,pa);ba.Vc(b,e);ba.bi(b,pa);ba.Hf(b,d);b.Cs=a.b4w_use_default_animation;b.kl=w.ez(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Qv={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.xx={$P:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":aa.Pk(a,b);e=c.Dg;d=w.lR(e);a.b4w_animation_mixing?(c.ke=new Float32Array(d.Db),c.Be=new Float32Array(d.Db),c.oe=new Float32Array(d.trans),c.Ee=new Float32Array(d.trans)):(c.ke=d.Db,c.Be=d.Db,c.oe=d.trans,c.Ee=d.trans);for(var k in e){var l=e[k];1==l.Rt.length&&aa.CZ(l,!0,d.trans,d.Db)}c.Sr=d;c.Ue=0;c.wi=a.b4w_animation_mixing;break;case "MESH":c.tn=a.b4w_do_not_render;
c.ol=f.RQ(a.data.b4w_boundings.bb);c.yk=H.outlining_overview_mode||a.b4w_selectable;c.dw=a.b4w_selectable;c.Uc=H.outlining_overview_mode||a.b4w_outlining;c.cw=a.b4w_outlining;c.ew=H.outlining_overview_mode||a.b4w_outline_on_select;c.Cg=a.b4w_billboard;c.Pp=a.b4w_pres_glob_orientation;c.Rp="BASIC";c.Qp="SPHERICAL"==a.b4w_billboard_geometry;k=c.Wh;k.mk=a.b4w_outline_settings.outline_duration;k.nk=a.b4w_outline_settings.outline_period;k.ok=a.b4w_outline_settings.outline_relapses;c.yk&&(c.Hj=V.RH(u),
u++);for(k=0;k<a.data.b4w_vertex_anim.length;k++)e=a.data.b4w_vertex_anim[k],b.Yc.push({name:e.name,va:e.frame_start,Za:e.frame_end,O1:e.averaging,P1:e.averaging_interval,aQ:e.allow_nla});b.k.Yc=b.Yc.length?!0:!1;"MESH"!=a.type&&V.q("Wrong object type: "+a.name);k=b.k;if(a.data.b4w_shape_keys.length)for(k.Ge=!0,e=0;e<a.data.b4w_shape_keys.length;e++)d={},d.value=a.data.b4w_shape_keys[e].value,d.name=a.data.b4w_shape_keys[e].name,k.di.push(d);else k.Ge=!1;c.Ce=a.b4w_shadow_cast;c.ce=a.b4w_shadow_receive;
c.me=a.b4w_shadow_cast_only&&c.Ce;c.be=a.b4w_reflexible;c.Hd=a.b4w_reflexible_only&&c.be;c.Gd=a.b4w_reflective;c.jh=a.b4w_reflection_type;if(!c.Gd)for(k=a.data.materials,e=0;e<k.length;e++)d=k[e],d.use_nodes&&-1!=d.node_tree.Zy.indexOf("BSDF_GLOSSY")&&(c.Gd=!0,c.jh="CUBE");c.Gg=a.b4w_caustics;if(c.nf=a.b4w_wind_bending)c.Tm=a.b4w_wind_bending_angle,k=f.z_(a.b4w_wind_bending_angle,c.ol,a.scale[0]),c.rh=k,c.sh=a.b4w_wind_bending_freq,c.Lg=a.b4w_detail_bending_freq,c.Kg=a.b4w_detail_bending_amp,c.Fg=
a.b4w_branch_bending_amp,c.Ui=a.b4w_main_bend_stiffness_col,k=a.b4w_detail_bend_colors,c.we.uB=k.leaves_stiffness_col,c.we.tB=k.leaves_phase_col,c.we.dC=k.overall_stiffness_col;c.Ph=a.b4w_hidden_on_load;c.Vf=a.b4w_dynamic_geometry;"MESH"!==a.type&&V.q("Wrong object");k=a.data.materials[0];c.Pl=k.physics.friction;c.Jl=k.physics.elasticity;c.Yg=0;c.af=E.np;c.Zg=a.b4w_lod_transition;c.kw=a.pass_index;break;case "LINE":c.O=C.Qd();c.aa=C.Hg();c.Ta=C.Qd();c.pb=C.Hg();break;case "CAMERA":K.sR(a,b);K.HQ(b);
break;case "LAMP":N.QV(a,b);break;case "SPEAKER":b.W=q.AS();c=!1;for(k=0;k<b.I.length;k++)if(b.I[k].xb.Nc){c=!0;break}c&&q.Pk(a,b);break;case "EMPTY":k=C.Qd(),c.O=k,k=C.Gh(),c.xa=k,a.field&&(b.yn={type:a.field.type,rM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,sn:a.b4w_anchor.detect_visibility,Nj:a.b4w_anchor.element_id,yW:a.b4w_anchor.max_width})}h(b)};a.a_=function(a,b){b.qj=a.uuid;b.Ej=!0;x(a,b);a.$y=b.Ea=B(a,b);a.XP=!0;b.k=E.tq(b.type);b.Cs=a.b4w_use_default_animation;
b.kl=w.ez(a.b4w_anim_behavior);h(b)};a.OZ=function(a,b){var c=b.k;if(b.parent){!b.rk&&b.hh.As&&b.parent.hh.As&&(b.Lm=!1);for(var d=!1,f=0;f<b.I.length;f++)if(b.I[f].xb.wc){d=!0;break}if(f=d)f=b.hh,f=b.Xe||b.cm||k.dg(b)||b.Lm&&!f.Es&&0<f.Uh&&("DYNAMIC"==f.Nr||"RIGID_BODY"==f.Nr);if(f)f=b.rk?F.copy(c.n,F.create()):c.n,F.multiply(b.parent.k.n,f,c.n),ba.Vc(b,F.F(c.n)),ba.Hf(b,F.Yd(c.n)),ba.bi(b,F.R(c.n));else if(b.rk||!b.Kr)if(f=F.copy(c.n,F.create()),b.xx&&"CAMERA"==b.parent.type){f={distance:b.xx.distance,
rotation:F.R(f)};switch(b.xx.$P){case "TOP_LEFT":f.top=0;f.left=0;break;case "TOP":f.top=0;f.left=.5;break;case "TOP_RIGHT":f.top=0;f.right=0;break;case "LEFT":f.top=.5;f.left=0;break;case "CENTER":f.top=.5;f.left=.5;break;case "RIGHT":f.top=.5;f.right=0;break;case "BOTTOM_LEFT":f.bottom=0;f.left=0;break;case "BOTTOM":f.bottom=0;f.left=.5;break;case "BOTTOM_RIGHT":f.bottom=0,f.right=0}L.gz(b,b.parent,f)}else L.eQ(b,b.parent,f);else f=F.copy(c.n,F.create()),L.fQ(b,b.parent,b.Kr,f)}if("ARMATURE"==b.type)for(d=
a.pose.bones,f=0;f<d.length;f++){var l=d[f],g=l.constraints;if(g)for(var u=0;u<g.length;u++){var m=g[u];"COPY_TRANSFORMS"!=m.type||m.subtarget||m.mute||L.rQ(b,m.target.nb,l.name,V.aF,V.$m)}}if("MESH"==b.type)var v=w.fI(a);if(v){g=v.nb;f=g.k.Sr;d=b.k;l=a.data;b.Ft=g;l=l.vertex_groups;if(l.length){var g=g.k.Dg,u=0,m={},z;for(z in g){var q=V.Dd("name",z,l);q&&(m[z]={wN:q.index,Dj:g[z].Dj,mA:u++})}d.zi=m;z=u;l=w.vI();d.$g=z;z>2*l?(d.ck=!1,y.error('too many bones for "'+a.name+'" / '+d.$g+" bones (max "+
l+" with blending, "+2*l+" without blending). Skinning will be disabled.")):d.ck=!0}z=w.ST(f.trans,f.Db,c.zi);v.b4w_animation_mixing?(c.ke=new Float32Array(z.Db),c.Be=new Float32Array(z.Db),c.oe=new Float32Array(z.trans),c.Ee=new Float32Array(z.trans)):(c.ke=z.Db,c.Be=z.Db,c.oe=z.trans,c.Ee=z.trans);c.Hp=new Float32Array(4);c.Gp=e.create();c.Sr=z;c.Ue=0}if(c.Gd)if(c=b.k,"CUBE"==c.jh)c.Rd=Q++;else if("PLANE"==c.jh){a:{v=a.constraints;for(z=0;z<v.length;z++)if(f=v[z],"LOCKED_TRACK"==f.type&&"REFLECTION PLANE"==
f.name){if(f.target.nb){v=f.target.nb;break a}y.warn('Reflection plane target "'+f.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}v=null}v||(v=V.ws("%reflection%"),v=E.sq(v,"EMPTY"),z=E.tq("EMPTY"),v.k=z,t(b,v),L.zF(v,b,[0,0,0],null,1),h(v));z=null;for(f=0;f<ca.length;f++)if(ca[f]==v){z=f;break}null==z&&(z=ca.length,ca.push(v));v.k.Ed=z;c.Ed=z;v.Zr.push(b)}};a.JZ=b;a.C2=t;a.CR=p;a.PZ=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=
c.k.type&&"CAMERA"!=c.k.type||ba.D(c);c.Cs&&w.oK(c)&&(w.Dt(c),c.ha.length&&w.play(c,null,w.bl))}};a.Vl=function(a){return V.P(a.Qv)};a.sa=function(){Q=u=0;ca.length=0;ja.length=0;Z={ALL:[]}};a.copy=function(a,b,c){var e=b,d=E.Sg(a);b=d?E.SH(d.name,b):b;if(l(b,Z.ALL,!1,-1)){for(var d=1,k;;){k="."+(3>String(d).length?("000"+String(d)).slice(-3):String(d));if(!l(b+k,Z.ALL,!1,-1))break;d++}y.error('Object "'+b+'" already exists. Name was replaced by "'+b+k+'".');e+=k;b+=k}e=E.sq(b,a.type,e);e.Ej=a.Ej;
e.Ea=a.Ea;e.nr=a.nr;e.Cs=a.Cs;e.Jg=a.Jg;e.k=E.Jz(a.k);e.Qv=E.Zt(a.Qv);t(a,e);e.yt=E.Qz(a.yt);e.parent=E.Qz(a.parent);e.rk=a.rk;e.Kr=a.Kr;e.Yc=E.Qz(a.Yc);e.kl=a.kl;!a.C||a.Xe||a.dg||a.cm||(e.Lm=a.Lm,e.C=null);e.$b=a.$b;e.$t=a.$t;e.hh=E.Zt(a.hh);b=[];for(d=0;d<a.I.length;d++){k=e.I[d];var g=a.I[d].U;if(c){for(var m=k.U,v=0;v<g.length;v++)if(!g[v].Zf){var q=E.Zt(g[v]);q.Ba=D.XR(g[v].Ba);m.push(q);b.push(g[v].Ba)}for(v=0;v<g.length;v++)if(g[v].Zf){q=E.Zt(g[v]);m.push(q);for(var z=0;z<b.length;z++)b[z]==
g[v].Ba&&(q.Ba=m[z].Ba)}for(v=0;v<m.length;v++)m[v].Ba&&D.ZM(m[v].Ba),M.cz&&fa.LQ(m[v]),m[v].kk=e.qj,f.xZ(m[v]);J.yY(m)}else k.U=g;for(v=0;v<k.U.length;v++)for(g=k.U[v].ya,m=0;m<g.length;m++)J.pv(g[m])}c||(e.k.Vo=!1);E.KC(e,!1);h(e);e.k.vv=!0;e.k.wv=c;e.k.Hj=V.RH(u);u++;return e};a.OD=function(a){for(var b=a.k,c=a.I[0].U,e,d,k,h,l,g,u,z,m,v,q,y,n=[],w=0;w<c.length;w++){var H=c[w];if("MAIN"==H.type){var p=D.dr("a_position"),p=D.Vu(H.Ba.nc,p),Q=H.Ba.ld.a_position.offset;e=h=p[Q];d=l=p[Q+1];k=g=p[Q+
2]}}for(w=0;w<c.length;w++)if(H=c[w],H.Ba&&H.pb&&H.Ta){var p=D.dr("a_position"),p=D.Vu(H.Ba.nc,p),Q=H.Ba.ld.a_position.offset,x=H.Ba.ld.a_position.length+Q;u=v=p[Q];z=q=p[Q+1];m=y=p[Q+2];for(var E=Q;E<x;E+=3){var Q=p[E],t=p[E+1],O=p[E+2];u=Math.max(Q,u);z=Math.max(t,z);m=Math.max(O,m);v=Math.min(Q,v);q=Math.min(t,q);y=Math.min(O,y)}H.O.max_x=u.toFixed(3);H.O.max_y=z.toFixed(3);H.O.max_z=m.toFixed(3);H.O.min_x=v.toFixed(3);H.O.min_y=q.toFixed(3);H.O.min_z=y.toFixed(3);C.tl(H.O,b.n,H.Ta);C.EH(H.Ta,
ha);for(p=n.length=0;p<ha.length;p++)n.push(ha[p]);H.pb=C.au(n,!0);H.aa=C.gR(H.pb,b.n);H.xa=C.qq(H.aa);H.kb=C.qq(H.pb);H.Nf=C.oB(H.aa,H.xa);"MAIN"==H.type&&(e=Math.max(u,e),d=Math.max(z,d),k=Math.max(m,k),h=Math.min(v,h),l=Math.min(q,l),g=Math.min(y,g))}n={max_x:parseFloat(e.toFixed(3)),max_y:parseFloat(d.toFixed(3)),max_z:parseFloat(k.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(l.toFixed(3)),min_z:parseFloat(g.toFixed(3))};v=e-h;z=d-l;u=k-g;h=.5*(e+h);m=.5*(d+l);q=.5*(k+g);var F=
h,R=q;l=Math.max(v,Math.max(z,u))/2;g=Math.max(v,u)/2;var fa=[h/(v?v:1),m/(z?z:1),q/(u?u:1)];y=.5;if(b.Cg)Q=Math.max(Math.abs(n.max_x),Math.abs(n.min_x)),t=Math.max(Math.abs(n.max_y),Math.abs(n.min_y)),O=Math.max(Math.abs(n.max_z),Math.abs(n.min_z)),k=Math.sqrt(Q*Q+t*t+O*O),w=Math.sqrt(Q*Q+t*t),n.max_x=n.max_y=n.max_z=k,n.min_x=n.min_y=n.min_z=-k,g=w,l=k,Q=new Float32Array([0,0,0]),e=new Float32Array([l,l,l]),k=new Float32Array([0,0,0]);else{for(w=0;w<c.length;w++)if(H=c[w],"MAIN"==H.type)for(p=D.dr("a_position"),
p=D.Vu(H.Ba.nc,p),x=c[w].Ba.ld,Q=x.a_position.offset,x=x.a_position.length+Q,E=Q;E<x;E+=3){var Q=p[E],t=p[E+1],O=p[E+2],Z=Math.sqrt((h-Q)*(h-Q)+(m-t)*(m-t)+(q-O)*(q-O));if(Z>l){var H=h-l*(Q-h)/Z,r=m-l*(t-m)/Z,Z=q-l*(O-q)/Z;h=(H+Q)/2;m=(r+t)/2;q=(Z+O)/2;l=Math.sqrt((h-Q)*(h-Q)+(m-t)*(m-t)+(q-O)*(q-O))}r=Math.sqrt((F-Q)*(F-Q)+(R-O)*(R-O));r>g&&(H=F-g*(Q-F)/r,Z=R-g*(O-R)/r,F=(H+Q)/2,R=(Z+O)/2,g=Math.sqrt((F-Q)*(F-Q)+(R-O)*(R-O)));Q/=v?v:1;t/=z?z:1;O/=u?u:1;Z=Math.sqrt((fa[0]-Q)*(fa[0]-Q)+(fa[1]-t)*(fa[1]-
t)+(fa[2]-O)*(fa[2]-O));Z>y&&(H=fa[0]-y*(Q-fa[0])/Z,r=fa[1]-y*(t-fa[1])/Z,Z=fa[2]-y*(O-fa[2])/Z,fa[0]=(H+Q)/2,fa[1]=(r+t)/2,fa[2]=(Z+O)/2,y=Math.sqrt((fa[0]-Q)*(fa[0]-Q)+(fa[1]-t)*(fa[1]-t)+(fa[2]-O)*(fa[2]-O)))}w=v?v*fa[0]:e;d=z?z*fa[1]:d;k=u?u*fa[2]:k;e=y*v;p=y*z;x=y*u;Q=new Float32Array([h,m,q]);e=new Float32Array([e,p,x]);k=new Float32Array([w,d,k]);g=parseFloat(g.toFixed(3))}b.O=n;f.dY(b,g,g,n);n=C.uz(l,Q);b.xa=n;n=C.Op([e[0],0,0],[0,e[1],0],[0,0,e[2]],k);b.aa=n;ba.D(a);if(M.debug_view)for(w=
0;w<c.length;w++)if("DEBUG_VIEW"===c[w].type&&c[w].Gi){a=A.Gu(1,n.G);D.eL(a,[n.Ha[0],n.Ia[1],n.Ja[2]],n.G);D.dx(a,1,!0);a.pa.a_polyindex=D.yu(a);f.wZ(c[w],a);break}};a.jc=g;a.KI=function(a,b,c){b=Z[b]||[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if((f.k.Qe==c||-1==c)&&f.Ej)for(var k=f.I,h=0;h<k.length;h++)k[h].xb==a&&e.push(f)}return e};a.Tj=function(a){var b=Z.ALL;if(-1==a)return b;for(var c=[],e=0;e<b.length;e++){var d=b[e];d.k.Qe==a&&c.push(d)}return c};a.Lu=function(a){var b=Z.MESH;if(b)for(var c=
0;c<b.length;c++){var e=b[c];if(k.dg(e))for(var d=e.I,f=0;f<d.length;f++)if(d[f].xb==a)return e}return null};a.IY=function(a){var b=g(a,"LAMP",-1);if(b.length==a.s.j6){for(var c=[],e=0;e<b.length;e++){var d=b[e],d=E.ja(d,a);c[d.im]=e}for(e=0;e<c.length-1;e++)for(d=e+1;d<c.length;d++){var f=b[c[e]].Sc,k=b[c[d]].Sc;if(k.Km&&k.Mm&&(!f.Km||!f.Mm)||!f.Km&&(k.Km||!f.Mm&&k.Mm))f=c[e],c[e]=c[d],c[d]=f}for(e=0;e<c.length;e++)d=b[c[e]],E.ja(d,a).im=e,R.$M(b[c[e]],a)}};a.aw=function(a,b,c,e){for(var d=0;d<a.I.length;d++)for(var f=
a.I[d].U,k=0;k<f.length;k++){var h=f[k];h.Ba.Tf=b;h.Tf=b;h.yb.Tf=c;""!==h.ik&&(h=O.yI(h.ik))&&(h.AG=e)}};a.Ru=function(){var a=[],b=Z.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.yk&&e.Ej&&a.push(e)}return a};a.CI=function(){var a=[],b=Z.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.Uc&&e.Ej&&a.push(e)}return a};a.rc=function(b,c,e,d){var f=null,k=Z.ALL;switch(b){case a.ay:f=l(c,k,!0,e,d);break;case a.$x:a:{for(b=0;b<k.length;b++)if(f=k[b],f.pm==e&&(f.k.Qe==d||-1==d)){var h=E.Sg(f);
if(h&&h.pm==c)break a}f=null}break;case a.Kc:a:{for(d=0;d<k.length;d++){b=k[d];for(var f=c.length-1,h=b,g=!0;0<=f&&g;)g=h&&h.pm==c[f]&&(h.k.Qe==e||-1==e),h&&(h=E.Sg(h)),f--;if(g&&!h){f=b;break a}}f=null}}return f};a.Wu=function(a,b){return l("%meta_world%"+a,Z.WORLD,!0,b)};a.Or=function(b,c){var e=R.Mh();if(!e)return y.error("No active scene"),null;var d=v.TW(b,c);if(d)return d;d=R.UW(e,b,c);if(!d)return null;for(var e=g(e,"MESH",-1),f=0;f<e.length;f++){var k=e[f].k,h=k.Hj;if(h&&3>Math.abs(255*h[0]-
d[0])&&3>Math.abs(255*h[1]-d[1])&&3>Math.abs(255*h[2]-d[2]))return k.Uc&&k.ew&&(H.outlining_overview_mode?a.gn(e[f],H.mk,H.nk,H.ok):(d=k.Wh,a.gn(e[f],d.mk,d.nk,d.ok))),e[f]}return null};a.OL=function(a,c){for(var e=g(a,"EMPTY",-1),d=0;d<e.length;d++){var f=e[d];if(f.yn&&"WIND"===f.yn.type){var k=f;break}}if(!k)return y.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(e=V.Lb(c.wind_dir),U.set(Math.sin(e),-Math.cos(e),0,ua),V.pA(ua,V.ad,pa),ba.bi(k,pa));"number"==typeof c.wind_strength&&
(k.yn.rM=c.wind_strength);b(k)};a.$r=function(a){L.DR(a)&&L.remove(a);var b=Z.ALL,c=Z[a.type],e=b.indexOf(a);a=c.indexOf(a);-1!=e&&b.splice(e,1);-1!=a&&c.splice(a,1)};a.LW=h;a.MW=function(a){return Z[a.type]&&-1<Z[a.type].indexOf(a)}};b4w.module.__geometry=function(a,r){function n(){return{length:0,frames:1,Gc:0,Gm:0,offset:0,Eq:0}}function d(a,b){for(var c=b.a_tbn_quat,e=b.a_position,d=c.length,f=e.length,k=1;k<a.ib.length;k++)for(var h=a.ib[k].Af,l=a.ib[k].ir,h=h.a_position,g=0;g<f;g++)e[g]+=l*h[g];e=ja;for(k=0;k<d;k+=4){f=c.subarray(k,k+4);e.set(Z.$m);for(g=1;g<a.ib.length;g++)h=a.ib[g].Af,l=a.ib[g].ir,l=M.slerp(Z.$m,h.a_tbn_quat,l,ua),M.normalize(l,l),M.multiply(l,e,e);M.multiply(e,f,f)}}function b(a){return 65536<a.Ka?v.lI()?
!1:!0:!1}function t(a){return 0<a.ma.length?!0:!1}function p(a,b,c){if(!t(a))return a;c||fa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ka*(b||1)+", will use drawArrays","color: #aa0");b=a.ma;c=a.Ka;var e=a.pa,d=a.Z,f;for(f in e){var k=e[f],h=N(k,c);e[f]=B(b,k,h)}for(e=0;e<d.length;e++){var l=d[e];for(f in l)k=l[f],h=N(k,c),l[f]=B(b,k,h)}for(e=0;e<a.ib.length;e++){f=a.ib[e].Af;for(var g in f)k=f[g],h=N(k,c),f[g]=B(b,k,h)}a.Ka=b.length;a.ma=new Uint16Array(0);return a}
function B(a,b,c){if(0==b.length)return new Float32Array(0);for(var e=new Float32Array(a.length*c),d=0;d<a.length;d++)for(var f=a[d],k=0;k<c;k++)e[c*d+k]=b[c*f+k];return e}function m(){return{ie:null,nc:e(),Xl:0,count:0,ld:{},Jm:0,pn:0,rn:0,Md:[],cg:null,ib:null,am:1,Tf:!0}}function x(a,b){var c=a.ld[b];if(c){var e=V(b);return J(a.nc,e).subarray(c.offset,c.offset+c.length)}Z.q("extract_array() failed; invalid name: "+b)}function g(b,c){var e;switch(c){case a.Wm:case a.hp:e=S.STATIC_DRAW;break;case a.Us:e=
S.DYNAMIC_DRAW;break;default:Z.q("Wrong draw_mode")}b.Jm=e}function l(a,b,c){function e(a,b){d[a]||(d[a]=0);d[a]+=b}var d={},f;for(f in a[0]){var k=a[0][f],h=V(f);e(h,k.length*a.length)}for(f in b)k=b[f],h=V(f),e(h,k.length);if(c){a=c.So.length;h=V("a_part_ts");e(h,4*a);h=V("a_part_r");e(h,4*a);b=c.um;for(f in b)h=V(f),e(h,b[f].Gc*a);c=c.us;for(f in c)h=V(f),e(h,a)}return d}function h(a){a.ie?(a.cg||(a.cg=S.createBuffer()),S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.cg),S.bufferData(S.ELEMENT_ARRAY_BUFFER,
a.ie,a.Jm),a.pn=a.ie.byteLength):a.pn=0;for(var b=a.rn=0;b<a.nc.length;b++){var c=a.nc[b].type,e=q(a.Md,c);-1==e&&(a.Md.push({Rk:null,type:c,nT:Z.uZ()}),e=a.Md.length-1);c=a.Md[e];c.Rk||(c.Rk=S.createBuffer());S.bindBuffer(S.ARRAY_BUFFER,c.Rk);S.bufferData(S.ARRAY_BUFFER,a.nc[b].ki,a.Jm);a.rn+=a.nc[b].ki.byteLength}}function w(a,b){a.O=aa.tl(a.O,b);a.aa=aa.Sp(a.aa,b);a.xa=aa.Tp(a.xa,b);a.zd=aa.rz(a.zd,b)}function f(a){for(var b=a[0],c=a[0],e=A("JOIN_"+a.length+"_SUBMESHES"),d=0,f=0;f<a.length;f++)d+=
a[f].ma.length;e.ma=new Uint32Array(d);var k=d=0;if(0<a[0].ib.length)for(var h=0;h<a[0].ib.length;h++){for(f=0;f<a.length;f++)d+=a[f].ib[h].Af.a_position.length,k+=a[f].ib[h].Af.a_tbn_quat.length;f={a_position:new Float32Array(d),a_tbn_quat:new Float32Array(k)};e.ib.push({ir:a[0].ib[h].ir,Af:f})}for(f=d=0;f<a.length;f++)d+=a[f].Ka;e.Ka=d;for(var l in c.pa){for(f=d=0;f<a.length;f++)d+=a[f].pa[l].length;e.pa[l]=new Float32Array(d)}for(l in c.Z[0]){for(f=d=0;f<a.length;f++)d+=a[f].Z[0][l].length;for(f=
0;f<c.Z.length;f++)e.Z[f]=e.Z[f]||{},e.Z[f][l]=new Float32Array(d)}f=e.Kf;f.O=aa.vl(b.Kf.O);k=d=0;h=[];for(c=0;c<a.length;c++){var g=a[c],u=g.ma,m=g.Ka,v=g.pa;l=g.Kf.xa;aa.wA(f.O,g.Kf.O);aa.MT(f.xa,l);aa.AA(g.Kf.zd,h);for(l=0;l<u.length;l++)e.ma[d+l]=u[l]+k;var d=d+u.length,q;for(q in v){var u=v[q],y=k*N(u,m);e.pa[q].set(u,y)}for(l=0;l<g.Z.length;l++){var v=g.Z[l],n=e.Z[l];for(q in v)u=v[q],y=k*N(u,m),n[q].set(u,y)}k+=m}f.aa=aa.au(Z.yf(h),!0);if(0<e.ib.length)for(c=0;c<e.ib.length;c++)for(q=e.ib[c].Af,
l=d=f=0;l<a.length;l++)k=a[l].ib[c].Af,q.a_position.set(k.a_position,f),q.a_tbn_quat.set(k.a_tbn_quat,d),f+=k.a_position.length,d+=k.a_tbn_quat.length;a[0].Ef&&(e.Ef={So:b.Ef.So,ax:b.Ef.ax,mM:!0,us:b.Ef.us,um:b.Ef.um,tu:b.Ef.tu});return e}function C(a,b,c){b=b.Kf;for(var e=aa.Qd(),d=aa.du(),f=[],k=0;k<c.length;k++)aa.tl(a.Kf.O,c[k],e),aa.wA(b.O,e),aa.rz(a.Kf.zd,c[k],d),aa.AA(d,f);b.aa=aa.au(Z.yf(f),!0);b.zd=aa.fS(b.aa);b.xa=aa.qq(b.aa)}function K(a,b,e,d,f,k){var h=a.submeshes[b],l=h.base_length,
g=A("SUBMESH_"+a.name+"_"+a.materials[b].name);g.Ka=l;var z=!1;if(L(e,"a_texcoord")){var u=null,m=a.materials[b];b=a.submeshes[b];if(m.texture_slots.length)switch(m=m.texture_slots[0],m.texture_coords){case "UV":m=a.uv_textures.indexOf(m.uv_layer);0==m?u=new Float32Array(b.texcoord):1==m&&(u=new Float32Array(b.texcoord2));break;case "ORCO":for(var v=a.b4w_boundings.bb_src,u=new Float32Array(2*b.base_length),m=(v.max_x+v.min_x)/2,q=(v.max_y+v.min_y)/2,y=v.max_x-v.min_x,v=v.max_y-v.min_y,n=0,w=0;w<
b.position.length;w+=3)u[n++]=(b.position[w]-m)/y+.5,u[n++]=(b.position[w+1]-q)/v+.5}null===u&&(u=new Float32Array(2*b.base_length));b=u}else b=new Float32Array(0);if(L(e,"a_orco_tex_coord")){u=a.b4w_boundings.bb_src;m=new Float32Array(3*h.base_length);q=u.max_x-u.min_x;y=u.max_y-u.min_y;v=u.max_z-u.min_z;for(w=n=0;w<h.position.length;w+=3)0==q?m[n++]=.5:m[n++]=Z.V(parseFloat(((h.position[w]-u.min_x)/q).toFixed(5)),0,1),0==y?m[n++]=.5:m[n++]=Z.V(parseFloat(((h.position[w+1]-u.min_y)/y).toFixed(5)),
0,1),0==v?m[n++]=.5:m[n++]=Z.V(parseFloat(((h.position[w+2]-u.min_z)/v).toFixed(5)),0,1);u=m}else u=new Float32Array(0);m=h.group;if(L(e,"a_influence")&&d){q=new Float32Array(4*l);y=m.length/l;v=new Float32Array(y);for(n=0;n<y;n++){v[n]=-1;for(var H in d)if(w=d[H],w.wN===n){v[n]=w.mA;break}}var M=3<y?y:4;d=new Float32Array(M);H=new Uint32Array(M);for(var n=new Float32Array(4),w=new Float32Array(M),M=new Uint32Array(M),C=new Float32Array(4),Q=0;Q<l;Q++)d.set(w),H.set(M),n.set(C),q.set(D(m,y,Q,l,v,
d,H,n),4*Q)}else q=new Float32Array(0);d=q;f=f?Z.P(f):{};f.a_color={Tl:!0};f.a_color.src=L(e,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,eg:7}]:[];g.pa.a_texcoord=b;g.pa.a_influence=d;g.pa.a_orco_tex_coord=u;d=g.pa;H=h.vertex_colors;b=h.color;u=a.name;m=[];for(q=0;q<H.length;q++)m.push(H[q].name);for(var x in f)if(q=f[x].src,q.length){for(v=y=0;v<q.length;v++)y+=Z.ym(q[v].eg);d[x]=new Float32Array(y*l);for(v=n=0;v<q.length;v++){var E=q[v].name,w=q[v].eg,M=Z.$K(w),t=m.indexOf(E);-1==t&&
Z.q('vertex color "'+E+'" for mesh "'+u+'" not found.');C=H[t].mask;Q=Z.ym(C);(w&C)!==w&&fa.error("Wrong color extraction from "+E+" to "+x+".");for(var O=E=0;O<t;O++)E+=Z.ym(H[O].mask);t=E*l;for(E=0;E<l;E++)for(O=0;3>O;O++)M[O]&&(d[x][E*y+(n+Z.oo(w,O))]=b[t+E*Q+Z.oo(C,O)]);n+=Q}}else d[x]=new Float32Array(0);x=a.uv_textures;f=h.texcoord;d=h.texcoord2;H=g.pa;if(k)for(var F in k){b=x.indexOf(F);if(0==b)var R=new Float32Array(f);else 1==b&&(R=new Float32Array(d));H[k[F]]=R}g.ma=new Uint32Array(h.indices);
F=h.position.length/l/3;R=L(e,"a_tbn_quat")&&h.tbn_quat.length?!0:!1;x=L(e,"a_shade_tangs")&&h.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(z=!0);for(f=0;f<F;f++){k=G(h,l,R,x,f);if(z)if(d={},d.name=a.b4w_shape_keys[f].name,g.ib.push(d),0!=f){d.Af=k;d.ir=a.b4w_shape_keys[f].value;continue}else d.Af=G(h,l,R,x,f),d.ir=1;g.Z.push(k)}if(1<F&&!z){a=g.Z[0];k={};for(var r in a)k[r]=new Float32Array(a[r]);g.Z.push(k)}L(e,"a_polyindex")&&(p(g,1,!0),g.pa.a_polyindex=c(g));h=h.boundings;e=g.Kf;e.O=aa.Qd();
e.O.max_x=h.bb.max_x;e.O.max_y=h.bb.max_y;e.O.max_z=h.bb.max_z;e.O.min_x=h.bb.min_x;e.O.min_y=h.bb.min_y;e.O.min_z=h.bb.min_z;r=h.rbb;a=h.caxis_x;l=h.caxis_y;z=h.caxis_z;k=h.be_ax;e.aa=aa.Op(a,l,z,h.be_cen);ha.scale(e.aa.Ha,k[0],e.aa.Ha);ha.scale(e.aa.Ia,k[1],e.aa.Ia);ha.scale(e.aa.Ja,k[2],e.aa.Ja);e.xa=aa.qq(e.aa);ha.copy(r.rbb_c,e.zd.G);ha.copy(a,e.zd.Ha);ha.copy(l,e.zd.Ia);ha.copy(z,e.zd.Ja);h=r.rbb_s;ha.scale(e.zd.Ha,h[0],e.zd.Ha);ha.scale(e.zd.Ia,h[1],e.zd.Ia);ha.scale(e.zd.Ja,h[2],e.zd.Ja);
return g}function G(a,b,c,e,d){var f={},k=new Float32Array(3*b),h=new Float32Array(c?4*b:0),l=d*b*3;k.set(a.position.subarray(l,l+3*b),0);c&&(l=d*b*4,h.set(a.tbn_quat.subarray(l,l+4*b),0));e&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=c);f.a_position=k;f.a_tbn_quat=h;return f}function L(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,c,e,d,f,k,h,l){for(var g=!0,z=0;z<c;z++){var u=b[z*d+e];if(-1!==u){var m=f[z];-1!==m&&(k[z]=u,h[z]=m,g=!1)}}if(g)return l;I(k,h,a.Uy,
!1);for(z=b=0;4>z;z++)b+=k[z];if(.01>b)return l;for(z=0;4>z;z++)k[z]/=b;if(.01>Math.abs(k[0]-1))l[0]=h[0]+1;else for(z=0;4>z;z++)l[z]=h[z]+k[z];return l}function N(a,b){if(0==b)return 0;var c=a.length,e=c/b;e!=Math.floor(e)&&Z.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return e}function I(b,c,e,d){for(var f=b.length,k=f,h=!1,l=d?-1:1;1<k||h;){1<k&&(k=Math.floor(k/1.247330950103979));for(var h=!1,g=0;k+g<f;g++)if(e==a.Uy?0>l*(b[g]-b[g+k]):b[g]<b[g+k]&&
d)h=b[g],b[g]=b[g+k],b[g+k]=h,h=c[g],c[g]=c[g+k],c[g+k]=h,h=!0}}function O(a,b,c){var e=[],d=[];ha.subtract(b,a,e);ha.subtract(c,a,d);ha.normalize(e,e);ha.normalize(d,d);a=Z.V(ha.dot(e,d),-1,1);return Math.acos(a)}function E(a,b,c){if(t(b)){b=b.ma;for(var e=b.length/3,d=0;d<e;d++){var f=new Float32Array(9),k=b[3*d];f[0]=a[3*k];f[1]=a[3*k+1];f[2]=a[3*k+2];k=b[3*d+1];f[3]=a[3*k];f[4]=a[3*k+1];f[5]=a[3*k+2];k=b[3*d+2];f[6]=a[3*k];f[7]=a[3*k+1];f[8]=a[3*k+2];c[d]=f}}else for(d=0;d<a.length;d++)f=new Float32Array(9),
f[0]=a[9*d],f[1]=a[9*d+1],f[2]=a[9*d+2],f[3]=a[9*d+3],f[4]=a[9*d+4],f[5]=a[9*d+5],f[6]=a[9*d+6],f[7]=a[9*d+7],f[8]=a[9*d+8],c[d]=f;return c}function c(a){for(var b=new Float32Array(a.Ka),c=0;c<a.Ka;c++)b[c]=c%3/2;return b}function k(a,b,c){var e=ha.dist(a,b);a=ha.dist(a,c);b=ha.dist(b,c);c=(e+a+b)/2;return c*(c-e)*(c-a)*(c-b)}function y(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),e=0;e<a;e++)c.set(b,8*e);return c}function A(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ka:0,ma:null,Z:[],pa:b,ib:[],Kf:{O:aa.Qd(),aa:aa.Hg(),xa:aa.Gh(),zd:aa.du()},Ef:null}}function e(a){var b=[],c;for(c in a)b.push(R(c,a[c]));return b}function R(a,b){return{ki:new (F(a))(b),type:a}}function q(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function ba(a,b){var c=q(a,b);return-1==c?null:a[c].Rk}function J(a,b){var c=q(a,b);return-1==c?null:a[c].ki}function F(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function V(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function U(a,
b,c,e){var d=V(b);b=q(a,d);switch(d){case "float":a[b].ki.set(c,e);break;case "short":for(d=0;d<c.length;d++)a[b].ki[e+d]=Z.Mq(c[d]);break;case "unsigned_byte":for(d=0;d<c.length;d++)a[b].ki[e+d]=Z.sZ(c[d])}}var aa=r("__boundings"),v=r("__extensions"),fa=r("__print"),M=r("__quat"),H=r("__tsr"),Z=r("__util"),ha=r("__vec3");new Float32Array(2);var u=new Float32Array(3),Q=new Float32Array(3),ca=new Float32Array(3),ja=new Float32Array(4),ua=new Float32Array(4),pa=new Float32Array(8);a.hp=10;a.Us=20;a.Uy=
0;a.e1=1;a.Wm=a.hp;var S=null;a.MP="float";a.h1="short";a.i1="unsigned_byte";a.If=function(a){S=a};a.uM=function(a,c,f){b(a)&&p(a);var k=a.ma,u=a.Ka,v=a.Z,q={},y;for(y in a.pa)y in f&&!f[y].Tl||(q[y]=a.pa[y]);f=m();0<a.ib.length&&d(a,v[0]);y=a.Ef;if(k.length){var w=k.length;if(65536>=u)var k=new Uint16Array(k),z=S.UNSIGNED_SHORT;else k=new Uint32Array(k),z=S.UNSIGNED_INT}else w=u,k=null;for(var A=l(v,q,y),A=e(A),M={},C=0;C<A.length;C++)M[A[C].type]=0;var Q={},x;for(x in q){var E=q[x],t=E.length;if(t){var O=
V(x),C=Q[x]=n();C.length=t;C.Gc=N(E,u);C.offset=M[O];U(A,x,E,M[O]);M[O]+=t}}q=v.length;for(x in v[0])if(E=v[0][x],O=V(x),t=E.length,E=N(E,u),t)for(C=Q[x]=n(),C.length=t,C.frames=q,C.Gc=E,C.offset=M[O],1<q&&(C=Q[x+"_next"]=n(),C.length=t,C.frames=q,C.Gc=E,C.offset=M[O]+t),C=0;C<q;C++)E=v[C][x],O=V(x),U(A,x,E,M[O]),M[O]+=t;if(y){v=y.So;x=y.ax;q=y.um;t=y.us;v=y.So;x=y.ax;var q=y.um,t=y.us,O=y.mM,u={a_part_ts:{data:[],Gc:4},a_part_r:{data:[],Gc:4}},F;for(F in q)u[F]={data:[],Gc:q[F].Gc};for(F in t)u[F]=
{data:[],Gc:1};for(E=0;E<v.length;E++){C=v[E];O&&x&&!y.tu&&(C=H.multiply(x,v[E],pa));!O&&y.tu&&ha.subtract(v[E],x,v[E]);u.a_part_ts.data.push(C[0],C[1],C[2],C[3]);u.a_part_r.data.push(C[4],C[5],C[6],C[7]);for(F in q)for(var C=q[F].Gc,R=0;R<C;R++)u[F].data.push(q[F].data[E*C+R]);for(F in t)u[F].data.push(t[F][0])}for(F in u)v=V(F),U(A,F,u[F].data,M[v]),x=n(),x.Gc=u[F].Gc,x.offset=M[v],x.Eq=1,x.length=u[F].data.length,Q[F]=x,M[v]+=x.length;f.am=y.So.length}f.count=w;f.ie=k;f.nc=A;f.Xl=z;f.ld=Q;g(f,
c);h(f);f.ib=a.ib;return f};a.YY=d;a.IV=b;a.HV=t;a.dx=p;a.FZ=function(a,b,c){g(a,b);a.count=c.length;a.ie=c;a.Xl=c instanceof Uint16Array?S.UNSIGNED_SHORT:S.UNSIGNED_INT};a.EZ=function(a,b){var c=a.ld,e=c.a_p_data,d=V("a_p_data");if(e)3!=e.Gc&&Z.q('invalid num_comp for "a_p_data"'),U(a.nc,"a_p_data",b,e.offset);else{e=q(a.nc,d);-1==e&&(a.nc.push(R(d,0)),e=a.nc.length-1);var d=a.nc[e].ki,f=new d.constructor(d.length+b.length);f.set(d);a.nc[e].ki=f;U(a.nc,"a_p_data",b,d.length);c=c.a_p_data=n();c.Gc=
3;c.offset=d.length;c.length=b.length}h(a)};a.i3=x;a.b6=function(a){a.Jm=S.STATIC_DRAW};a.rW=function(a){a.Jm=S.DYNAMIC_DRAW};a.ZM=h;a.RR=function(a){a.cg&&S.deleteBuffer(a.cg);for(var b=0;b<a.Md.length;b++)a.Md[b].Rk&&S.deleteBuffer(a.Md[b].Rk);a.Md.length=0};a.gJ=function(a,b){return a.submeshes[b].base_length?!1:!0};a.cx=function(a,b){for(var c=0;c<a.Z.length;c++){var e=a.Z[c].a_position;H.Ro(e,b,e,0);e=a.Z[c].a_tbn_quat;0<e.length&&H.RM(e,b,e,0);(e=a.Z[c].a_shade_tangs)&&0<e.length&&H.nZ(e,b,
e)}(c=a.pa.au_center_pos)&&c.length&&H.Ro(c,b,c,0);w(a.Kf,b)};a.XY=function(a,b){var c=a.pa.au_center_pos;if(c&&c.length){var e=new Float32Array(c);H.Ro(e,b,e,0);for(var d=0;d<a.Z.length;d++)for(var f=0;f<e.length;f++)a.Z[d].a_position[f]+=e[f]-c[f];c.set(e)}else Z.q('Attribute "au_center_pos" is missing in particle submesh');w(a.Kf,b)};a.$Q=w;a.WY=function(a,b){var c=a.Ka,e;for(e in b){var d=b[e].length;a.pa[e]=new Float32Array(d*c);for(var f=0;f<c;f++)for(var k=0;k<d;k++)a.pa[e][f*d+k]=b[e][k]}};
a.tM=f;a.qW=function(a,b,c){if(!a.Ka)return A("EMPTY");var e=c.length;65536<a.Ka*e&&!v.lI()&&p(a,e);var d=a.ma,f=a.Ka,k=a.pa,h=a.Z,l;for(l in b){var g=b[l].length,u=g*f;k[l]=new Float32Array(u);for(var m=0;m<f;m++)for(u=0;u<g;u++)k[l][m*g+u]=b[l][u]}b=A("CLONE_"+e+"_SUBMESHES");b.Ka=f*e;b.ma=new Uint32Array(d.length*e);for(m=0;m<e;m++)for(g=d.length*m,l=f*m,u=0;u<d.length;u++)b.ma[g+u]=d[u]+l;for(var q in k)for(d=k[q],u=d.length*e,g=N(d,f),b.pa[q]=new Float32Array(u),m=0;m<e;m++)l=f*g*m,b.pa[q].set(d,
l);for(q in h[0])for(m=0;m<h.length;m++)for(d=h[m][q],u=d.length*e,g=N(d,f),b.Z[m]=b.Z[m]||{},b.Z[m][q]=new Float32Array(u),u=0;u<e;u++)switch(k=c[u],l=f*g*u,q){case "a_position":H.Ro(d,k,b.Z[m][q],l);break;case "a_tbn_quat":H.RM(d,k,b.Z[m][q],l);break;case "a_shade_tangs":H.qZ(d,k,b.Z[m][q],l);break;default:Z.q("Wrong attribute name: "+q)}C(a,b,c);return b};a.fG=C;a.BA=K;a.RT=function(a){var b=a.Ka,c=a.Z[0].a_position,e=new Float32Array(12*b);a=new Uint32Array(4*a.ma.length);for(var d=new Float32Array(4*
b),f=0;f<b;f++){e[12*f]=c[3*f];e[12*f+1]=c[3*f+1];e[12*f+2]=c[3*f+2];e[12*f+3]=c[3*f];e[12*f+4]=c[3*f+1];e[12*f+5]=c[3*f+2];e[12*f+6]=c[3*f];e[12*f+7]=c[3*f+1];e[12*f+8]=c[3*f+2];e[12*f+9]=c[3*f];e[12*f+10]=c[3*f+1];e[12*f+11]=c[3*f+2];a[6*f]=4*f+2;a[6*f+1]=4*f+1;a[6*f+2]=4*f;a[6*f+3]=4*f+2;a[6*f+4]=4*f;a[6*f+5]=4*f+3;var k=Math.random();d[4*f]=k;d[4*f+1]=k;d[4*f+2]=k;d[4*f+3]=k}c=A("HALO");c.Z[0]={};c.Ka=4*b;c.Z[0].a_position=e;c.pa.a_halo_bb_vertex=y(b);c.pa.a_random_vals=d;c.ma=a;return c};a.kV=
L;a.FH=function(a,b,c){for(var e=[],d=0;d<a.submeshes.length;d++){var k=K(a,d,b,null,c,null);k.Ka&&e.push(k)}return 0==e.length?A("EMPTY"):1==e.length?e[0]:f(e)};a.DZ=function(a,b,c,e){var d=a.ie,f=x(a,"a_position"),k=b.AW,h=b.BW;b=b.wT;for(var l=d,g=l.length/3,u=0;u<g;u++){var m=l[3*u],v=l[3*u+1],q=l[3*u+2],y=f[3*m+1],n=f[3*m+2],w=f[3*v+1],p=f[3*v+2],A=f[3*q+1],M=f[3*q+2];k[3*u]=(f[3*m]+f[3*v]+f[3*q])/3;k[3*u+1]=(y+w+A)/3;k[3*u+2]=(n+p+M)/3}H.Ro(k,c,h);c=h.length/3;for(f=0;f<c;f++)k=h[3*f]-e[0],
l=h[3*f+1]-e[1],g=h[3*f+2]-e[2],b[f]=k*k+l*l+g*g;e=d;d=b.length;if(!(2>d))for(h=d,f=!1;1<h||f;)for(1<h&&(h=Math.floor(h/1.247330950103979)),f=!1,c=0;h+c<d;c++)0>b[c]-b[c+h]&&(f=b[c],b[c]=b[c+h],b[c+h]=f,f=e,k=c,l=c+h,g=f[3*k],u=f[3*k+1],m=f[3*k+2],f[3*k]=f[3*l],f[3*k+1]=f[3*l+1],f[3*k+2]=f[3*l+2],f[3*l]=g,f[3*l+1]=u,f[3*l+2]=m,f=!0);d=e;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.cg);S.bufferData(S.ELEMENT_ARRAY_BUFFER,d,S.DYNAMIC_DRAW)};a.JY=I;a.kR=function(a,b,c){for(var e=b.length/3,d=a.length/3,f=[],
k=Array(3),h=Array(3),l=Array(3),g=0;g<d;g++){for(var u=a[3*g],m=a[3*g+1],v=a[3*g+2],q=0;3>q;q++)k[q]=b[3*u+q],h[q]=b[3*m+q],l[q]=b[3*v+q];if(c)var q=O(k,h,l),y=O(h,l,k),n=Math.PI-q-y;else n=y=q=1;var w=f,H;H=k;var p=l,A=[],M=[],C=[];ha.subtract(h,H,A);ha.subtract(p,H,M);ha.cross(A,M,C);ha.normalize(C,C);H=C;for(p=0;3>p;p++)A=3*m+p,M=3*v+p,w[3*u+p]=q*H[p],w[A]=y*H[p],w[M]=n*H[p]}if(c)for(var Q in c)for(g=c[Q],a=0;3>a;a++){b=3*g[0]+a;for(d=1;d<g.length;d++)k=3*g[d]+a,f[b]+=f[k];for(d=1;d<g.length;d++)k=
3*g[d]+a,f[k]=f[b]}for(g=0;g<e;g++){c=g;Q=f;a=new Float32Array(3);for(b=0;3>b;b++)d=3*c+b,a[b]=Q[d];ha.normalize(a,a);for(b=0;3>b;b++)d=3*c+b,Q[d]=a[b]}return f};a.nR=function(a,b,c){for(var e={},d=b.length/3,f=0;f<d;f++){var k=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);e[k]=[]}d=a.length;for(f=0;f<d;f++)b=a[f],k=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),k in e&&e[k].push(b);return e};a.HA=function(a,b,c,e){var d;d=null;d=[];d=E(a.Z[0].a_position,a,d);if(c){var f;f=null;f=[];for(var h=
a.Z[0].a_tbn_quat,l=h.length/4,g=new Float32Array(3*l),m=0;m<l;m++){var v=ja;v[0]=h[4*m];v[1]=h[4*m+1];v[2]=h[4*m+2];v[3]=h[4*m+3];v=ha.transformQuat(Z.pi,v,u);g[3*m]=v[0];g[3*m+1]=v[1];g[3*m+2]=v[2]}f=E(g,a,f)}l=d.length;g=new Float32Array(l);for(a=0;a<l;a++)m=d[a],u.set(m.subarray(0,3)),Q.set(m.subarray(3,6)),ca.set(m.subarray(6)),g[a]=Math.sqrt(k(u,Q,ca));h=new Float32Array(l);h[0]=g[0];for(a=1;a<l;a++)h[a]=h[a-1]+g[a];l=h[g.length-1];g=[];for(a=0;a<b;a++){var m=l*Z.og(e),m=Z.Kt(h,m,0,h.length-
1),q=m=c?f[m]:d[m],y=e;(m=u)||(m=new Float32Array(3));var v=q[0],n=q[1],w=q[2],H=q[3],p=q[4],A=q[5],C=q[6],x=q[7],t=q[8],q=Z.og(y),y=Z.og(y);1<q+y&&(q=1-q,y=1-y);var O=1-q-y,n=O*n+q*p+y*x,w=O*w+q*A+y*t;m[0]=O*v+q*H+y*C;m[1]=n;m[2]=w;c?(g[a]=new Float32Array(4),ha.normalize(m,m),m=M.rotationTo(Z.pi,m,ja),g[a][0]=m[0],g[a][1]=m[1],g[a][2]=m[2],g[a][3]=m[3]):(g[a]=new Float32Array(3),g[a][0]=m[0],g[a][1]=m[1],g[a][2]=m[2])}return g};a.yu=c;a.z8=k;a.QH=y;a.eL=function(a,b,c){a=a.Z[0].a_position;for(var e=
0;e<a.length;e+=3)a[e]=(a[e]-c[0])*b[0]+c[0],a[e+1]=(a[e+1]-c[1])*b[1]+c[1],a[e+2]=(a[e+2]-c[2])*b[2]+c[2]};a.CQ=function(a,b,c){var e=a.I[0].U;a=a.k.di;for(var d=1;d<a.length;d++)a[d].name==b&&(a[d].value=c);for(d=0;d<e.length;d++)if(!e[d].Zf&&e[d].Ge&&!e[d].Gi){b=e[d].Ba;var f=V("a_position");c=ba(b.Md,f);f=J(b.nc,f);S.bindBuffer(S.ARRAY_BUFFER,c);var k=b.ld.a_position;c=e[d];var h=a;if(k){for(var l=k.offset,k=k.length+l,g=c.Ba.ib[0].Af.a_position,u=l;u<k;u++)f[u]=g[u-l];for(u=1;u<c.Ba.ib.length;u++){var g=
c.Ba.ib[u].Af.a_position,m=h[u].value;if(m)for(var v=l;v<k;v++)f[v]+=m*g[v-l]}S.bufferSubData(S.ARRAY_BUFFER,Z.uj*l,f.subarray(l))}f=V("a_tbn_quat");c=ba(b.Md,f);f=J(b.nc,f);S.bindBuffer(S.ARRAY_BUFFER,c);l=b.ld.a_tbn_quat;b=e[d];c=f;f=a;if(l){h=l.offset;l=l.length+h;k=b.Ba.ib[0].Af.a_tbn_quat;u=ja;for(g=h;g<l;g+=4){u[0]=0;u[1]=0;u[2]=0;for(m=u[3]=1;m<b.Ba.ib.length;m++){var v=b.Ba.ib[m].Af.a_tbn_quat,q=f[m].value;if(q){var y=ua;y[0]=v[g-h];y[1]=v[g+1-h];y[2]=v[g+2-h];y[3]=v[g+3-h];v=M.slerp(Z.$m,
y,q,ua);M.multiply(v,u,u)}}m=ua;m[0]=k[g-h];m[1]=k[g-h+1];m[2]=k[g-h+2];m[3]=k[g-h+3];v=0<m[3];M.multiply(u,m,m);(0<m[3]&&!v||0>m[3]&&v)&&M.scale(m,-1,m);c[g]=Z.Mq(m[0]);c[g+1]=Z.Mq(m[1]);c[g+2]=Z.Mq(m[2]);c[g+3]=Z.Mq(m[3])}S.bufferSubData(S.ARRAY_BUFFER,Z.uj*h,c.subarray(h))}}};a.Ez=function(a){return a.k.Ge};a.I4=function(a){var b=[];if(a.k)for(var c=1;c<a.k.di.length;c++)b.push(a.k.di[c].name);return b};a.H4=function(a,b){if(a.k)for(var c=1;c<a.k.di.length;c++)if(b==a.k.di[c].name)return a.k.di[c].value;
return 0};a.nV=function(a,b){var c=a.k.di;if(c)for(var e=1;e<c.length;e++)if(c[e].name==b)return!0;return!1};a.eJ=function(a){return a&&a.k&&a.k.Vf?!0:!1};a.T2=function(b,c,d){var f=b.Ba;if(f){for(var k=d?c.length/3/2:c.length/3-1,l=new Float32Array(12*k),g=new Float32Array(12*k),u=new Uint16Array(6*k),m=0;m<k;m++){if(d)var v=6*m,q=6*m+3;else v=3*m,q=3*(m+1);var y=c[v],n=c[v+1],v=c[v+2],w=c[q],H=c[q+1],q=c[q+2],p=w-y,A=H-n,M=q-v;l[12*m]=y;l[12*m+1]=n;l[12*m+2]=v;g[12*m]=p;g[12*m+1]=A;g[12*m+2]=M;
l[12*m+3]=w;l[12*m+4]=H;l[12*m+5]=q;g[12*m+3]=-p;g[12*m+4]=-A;g[12*m+5]=-M;l[12*m+6]=y;l[12*m+7]=n;l[12*m+8]=v;g[12*m+6]=-p;g[12*m+7]=-A;g[12*m+8]=-M;l[12*m+9]=w;l[12*m+10]=H;l[12*m+11]=q;g[12*m+9]=p;g[12*m+10]=A;g[12*m+11]=M;u[6*m]=4*m;u[6*m+1]=4*m+1;u[6*m+2]=4*m+2;u[6*m+3]=4*m;u[6*m+4]=4*m+3;u[6*m+5]=4*m+1}d=0;for(var C in f.ld)c=f.ld[C],d+=l.length/3*c.Gc;c={};c["float"]=d;d=f.nc=e(c);a.FZ(f,b.Ih,u);b=0;for(C in f.ld)switch(c=f.ld[C],C){case "a_position":U(d,C,l,b);c.offset=b;c.length=l.length;
b+=c.length;break;case "a_direction":U(d,C,g,b);c.offset=b;c.length=g.length;b+=c.length;break;default:c.offset=b,c.length=l.length/3*c.Gc,u=new Float32Array(c.length),U(d,C,u,b),b+=c.length}h(f)}};a.XR=function(a){var b=m();if(a.ie)switch(a.Xl){case S.UNSIGNED_SHORT:b.ie=new Uint16Array(a.ie);break;case S.UNSIGNED_INT:b.ie=new Uint32Array(a.ie)}else b.ie=null;for(var c=a.nc,e=[],d=0;d<c.length;d++){var f=c[d].ki,k=c[d].type;e.push({ki:new f.constructor(f),type:k})}b.nc=e;b.Xl=a.Xl;b.count=a.count;
b.ld=Z.P(a.ld);b.Jm=a.Jm;b.pn=a.pn;b.rn=a.rn;b.cg=null;b.qv=Z.P(a.qv);b.ib=Z.P(a.ib);b.am=a.am;b.Tf=a.Tf;return b};a.Df=A;a.reset=function(){S=null};a.D5=e;a.KX=q;a.S4=ba;a.Vu=J;a.O3=F;a.dr=V;a.TI=function(a){switch(V(a)){case "float":return Z.uj;case "short":return Z.tp;case "unsigned_byte":return Z.Lx;default:return Z.uj}};a.VU=function(a){switch(V(a)){case "float":return S.FLOAT;case "short":return S.SHORT;case "unsigned_byte":return S.UNSIGNED_BYTE;default:return S.FLOAT}};a.qN=U};b4w.module.__nla=function(a,r){function n(){return{type:"CLIP",va:0,Za:0,ej:!1,paused:!1,Rf:"",Dp:"",xc:0,ao:null,xj:0,hl:0,DH:0,CH:0,lN:!1,scale:1,repeat:1,rF:0}}function d(a,b,c){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var h=0;h<f.length;h++)f[h].ao=c,b.push(f[h])}a=a.nodes;for(h=0;h<a.length;h++)if(f=a[h],f.node_group){var l=f.node_group.node_tree;if(l){var e=c.slice();e.push(f.name);d(l,b,e)}}}function b(a,b){var c=Math.round(a)-b.va;b.pj&&(c%=b.Rj,0>c&&(c+=b.Rj));return b.Sb+
c}function t(a,b){var c=(b-I)*L.sd()+a.Sb;c>a.va?(c-=a.va,a.ve&&(c%=a.Za-a.va+1),c+=a.va):c=a.va;return c}function p(a,b){a=D.V(a,b.va,b.Za);var c=a==b.Za?b.rF:b.xj+(a-b.va)/b.scale%(b.hl-b.xj);b.lN&&(c=b.hl-c+b.xj);return c}function B(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],h=f.strips;if(h)for(var e=0;e<h.length;e++){var l=h[e],g=n();g.type=l.type;g.va=l.frame_start;g.Za=l.frame_end;g.xc=b;g.xj=l.action_frame_start;g.hl=l.action_frame_end;g.lN=l.use_reverse;g.scale=l.scale;g.repeat=l.repeat;
l.action&&(g.Rf=l.action.name,g.Dp=l.action.uuid,g.ao=f.ao);c.push(g)}}return c}function m(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function x(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function g(a,b){var c=C.B();if(c.qa){var d=t(c.qa,b);c.qa.Sb-=d-a;c.qa.Bn=!0}}var l=r("__animation");r("__config");var h=r("__objects"),w=r("__obj_util"),f=r("__print"),C=r("__scenes"),K=r("__sfx"),G=r("__textures"),L=r("__time"),D=r("__util"),N=[],I=-1;a.Pk=function(a,b){var c,f=null;for(c=b.I.length-1;0<=c;c--){var h=b.I[c];if(h.xb.b4w_use_nla&&(f=h,h.xb.nF))break}if(c=f){c.nK=!0;var g=0;if((f=a.animation_data)&&f.nla_tracks.length){var e=f.nla_tracks;if(w.Ri(b)||w.wa(b)||w.Rc(b)||w.$j(b)||w.On(b)||
w.fm(b)||w.rr(b))e=B(e,g),e.length&&(b.ig=b.ig.concat(e),g++)}m(a)&&(e=a.data.animation_data.nla_tracks,e=B(e,g),e.length&&(b.ig=b.ig.concat(e),g++));if(w.Rc(b))for(h=a.data.materials,f=0;f<h.length;f++){var p=h[f];if(p.use_nodes&&p.node_tree&&(e=[],d(p.node_tree,e,[p.name]),e=B(e,g),e.length)){for(var p=g,q=e,C=l.AU(),x=[],t=0,r=0;r<q.length;r++){var G=q[r];""!=G.Dp?G=D.Dd("uuid",G.Dp,C):(G=G.Rf,G=D.Dd("name",G,C)||D.Dd("name",G+"_B4W_BAKED",C));if(G){var G=G.fcurves,K=[],v;for(v in G)K.push(v);
x.push(K)}}for(r=0;r<x.length;r++){C=!1;for(G=0;G<r;G++)if(D.FQ(x[r],x[G])){q[r].xc=q[G].xc;C=!0;break}C||(q[r].xc=g+t++)}g=p+t;b.ig=b.ig.concat(e)}}if(!w.rr(b)){for(f=0;f<a.particle_systems.length;f++)h=a.particle_systems[f],v=h.settings,"EMITTER"==v.type&&v.b4w_allow_nla&&(v=n(),v.type="CLIP",v.va=c.xb.frame_start,v.Za=c.xb.frame_end+1,v.Rf=h.name,v.xc=g,v.xj=v.va,v.hl=v.Za,b.ig.push(v),g++);c=g+1;for(f=0;f<b.Yc.length;f++)h=b.Yc[f],h.aQ&&(g=c,v=n(),v.type="CLIP",v.va=h.va,v.Za=h.Za,v.Rf=h.name,
v.xc=g,v.xj=v.va,v.hl=v.Za,b.ig.push(v))}}};a.UZ=function(a,b,c){a.qa||(a.qa={va:a.frame_start,Za:a.frame_end,Sb:0,wr:-1,Ur:a.frame_end,Vr:a.frame_start,Wo:null,ve:b,eb:[],ya:[],fL:a.name,dk:!1,Bn:!1,GC:!0},N.push(a.qa));b=a.qa;for(var d=h.KI(a,"ALL",c),l=0;l<d.length;l++){var g=d[l];if(g.ig.length){b.eb[c]||(b.eb[c]=[]);for(var e=0;e<g.I.length;e++){var m=g.I[e];m.xb==a&&m.nK&&b.eb[c].push(g)}for(var e=g.ig,m=b,q=g.name,w=0;w<e.length;w++){var p=e[w];m.va>p.Za||m.Za<p.va?(f.warn("NLA: Strip is out of scene range: "+
(q+" ["+p.va+":"+p.Za+"]")),e.splice(w,1),w--):p.Rf||"CLIP"!=p.type||(f.warn('NLA: no action in strip for object "'+q+'".'),e.splice(w,1),w--)}g=g.ig;e=b;for(m=0;m<g.length;m++){for(var q=g[m],w=e.va,p=e.Za+1,C=0;C<g.length;C++){var x=g[C];q.xc==x.xc&&(x.Za<=q.va&&(w=q.va),x.va>=q.Za&&(p=Math.min(p,x.va)))}q.DH=w;q.CH=p;q.rF=0===q.repeat%1?q.hl:q.xj+q.repeat%1*(q.hl-q.xj)}}}a=a.s.$o;for(l=0;l<a.length;l++)d=a[l].s,d.Qk&&(d.Sa||d.ud)&&d.Ls==c&&(g=n(),g.type="VIDEO",d.pj?(g.va=0,g.Za=b.Za):(g.va=D.V(d.va,
0,b.Za),g.Za=D.V(d.va+d.Rj,0,b.Za)),g.Rf=a[l].name,b.ya.push(d))};a.start=function(){I=0};a.dV=function(){return I};a.e4=function(a){return a.qa?a.qa.Sb:null};a.i7=function(a,b){return a.qa?(a.qa.Sb=b,!0):!1};a.update=function(a,d){if(!(0>I)){0==I&&(I=a);for(var c=0;c<N.length;c++){var f=N[c];f.dk&&(f.Sb-=L.sd()*d);var h=t(f,a);if((!f.dk||f.Bn)&&h>=f.Ur)if(f.ve){var h=f,m=a;h.Wo&&h.Wo();g(h.Vr,m);h.GC=!0;h=t(h,m)}else{var m=f,e=h;m.dk=!0;m.Sb-=e-m.Ur;m.Wo&&m.Wo()}if(!f.dk||f.Bn){for(var m=f,e=h,n=
0;n<m.eb.length;n++){var q=m.eb[n];if(q)for(var w=0;w<q.length;w++){for(var C=q[w],x=C.ig,r=0;r<x.length;r++){var B=x[r];"SOUND"==B.type&&e<m.wr-1E-6&&(B.ej=!1)}for(r=0;r<x.length;r++)switch(B=x[r],B.type){case "CLIP":if(B.DH<=e&&e<B.CH&&!B.ej){var n=C,aa=B,v=aa.ao;""!=aa.Dp?l.zQ(n,v,aa.Dp,aa.xc):l.apply(n,v,aa.Rf,aa.xc);l.ks(n,l.Fx,aa.xc);v=p(aa.va,aa);l.ro(n,v,aa.xc);for(n=0;n<x.length;n++)x[n]!=B&&x[n].xc==B.xc&&(x[n].ej=!1);B.ej=!0}B.ej&&(aa=C,v=p(e,B),1E-6<Math.abs(v-l.jI(aa,B.xc))&&l.ro(aa,
v,B.xc));break;case "SOUND":if((e<m.wr-1E-6||m.wr<B.va)&&B.va<=e&&e<B.Za&&!B.ej){var aa=C,fa=B,v=(fa.va-e)/L.sd(),fa=(fa.Za-fa.va)/L.sd();K.play(aa,v,fa);B.ej=!0}m.wr<B.Za&&B.Za<=e&&B.ej&&(B.ej=!1)}}}m=a;e=f;q=h;for(w=0;w<e.ya.length;w++)if(C=e.ya[w],C.Sa||C.ud){x=G.xN(C);r=C;B=D.V(b(q,r),r.Sb,r.Sb+G.yN(r)-1);r.ud&&(B=G.p_(r,B),B==r.fs&&B--);r=B;B=G.zN(C);aa=n=!1;if(e.Bn||e.GC)aa=!0;e.dk||(v=b(q,C),v=C.Sb<=v&&v<=C.Sb+G.yN(C),fa=G.AN(C),C.pj&&r==B&&(aa=!0),fa||x==r||(aa=!0),v&&!fa?G.BK(C):v&&fa?n=
!0:!v&&fa&&(C.Sa&&x<r?n=!0:G.gC(C)));aa?(G.XX(C,r),C.ud&&(C.Ak=G.Aw(C,m))):n&&G.BN(C)&&(C.Sa?G.eN(C):(x=G.Aw(C,m),x!=C.Ak&&(C.fj=r,G.dN(C)),C.Ak=x))}f.wr=h}f.Bn=!1;f.GC=!1}}};a.sa=function(a){if(0==a)N.length=0,I=-1;else for(var b=0;b<N.length;b++)N[b].eb[a]=null};a.dG=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||m(a)||x(a)?!0:!1};a.ro=g;a.Zq=function(a){var b=C.B();return b.qa?t(b.qa,a):-1};a.pM=function(){var a=C.B();if(a.qa){a.qa.dk=!0;for(var a=a.qa.ya,b=0;b<a.length;b++)G.gC(a[b])}};
a.aX=function(){var a=C.B();a.qa&&(a.qa.dk=!1,a.qa.Wo=null)};a.f4=function(){var a=C.B();return a.qa?a.qa.va:-1};a.rI=function(){var a=C.B();return a.qa?a.qa.Za:-1};a.ak=function(){var a=C.B();return a.qa?!a.qa.dk:!1};a.g2=function(){var a=C.B();return a.qa?a.b4w_use_nla:!1};a.f2=function(){var a=C.B();return a.qa?0<a.b4w_logic_nodes.length:!1};a.A7=function(a,b){var c=C.B();if(c.qa)c.qa.Vr=a,c.qa.Ur=b;else return!1};a.YC=function(a){var b=C.B();b.qa&&(b.qa.Ur=a)};a.hY=function(a){var b=C.B();b.qa&&
(b.qa.Vr=a)};a.N6=function(){var a=C.B();if(a.qa)a=a.qa,a.Vr=a.va,a.Ur=a.Za;else return!1};a.c7=function(a){var b=C.B();if(b.qa)b.qa.ve=a;else return!1};a.n2=function(){var a=C.B();a.qa&&(a.qa.Wo=null)};a.AL=function(a){var b=C.B().qa;b&&(b.Sb=-(a-I)*L.sd()+b.Vr,b.Bn=!0)};a.rI=function(){var a=C.B().qa;return a?a.Za:null}};b4w.module.__scenes=function(a,r){function n(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Qf||!c.Qf.length)return c}return null}function d(){bb||Ba.q("No active scene available");return bb}function b(a,b,c){if(!Aa.pu||!t(a,b,c))return null;c=a.b4w_shadow_settings;var e={};c.csm_resolution>Xa.Bc?(e.csm_resolution=Xa.Bc,Pa.error("Shadow map texture has unsupported size. Changed to "+Xa.Bc+".")):e.csm_resolution=c.csm_resolution;Aa.ZQ=c.blur_samples;e.EY=c.soft_shadows;a=da.Su(b,Aa.ssao&&a.b4w_enable_ssao);
e.self_shadow_polygon_offset=c.self_shadow_polygon_offset;e.self_shadow_normal_offset=c.self_shadow_normal_offset;e.enable_csm=c.b4w_enable_csm&&1==a.length;e.Xg=[];e.kM=[];e.dq=[];e.cq=[];for(b=0;b<a.length;b++)e.Xg.push(a[b].Sc.type),e.kM.push(a[b].Sc.Do),e.dq.push(a[b].Sc.dq),e.cq.push(a[b].Sc.cq),"SPOT"!=e.Xg[b]&&"POINT"!=e.Xg[b]||!e.enable_csm||(Pa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),e.enable_csm=!1);e.enable_csm?(e.csm_num=c.csm_num,e.csm_first_cascade_border=
c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,e.fade_last_cascade=c.fade_last_cascade,e.blend_between_cascades=c.blend_between_cascades):(e.csm_num=1,e.csm_first_cascade_border=c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,
e.fade_last_cascade=!1,e.blend_between_cascades=!1);return e}function t(a,b,c){if(0!=b.length&&Aa.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var e=!1,d=!1;a=Aa.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(e=!0);f.b4w_shadow_receive&&(d=!0);if((a||e)&&d)return!0}return!1}function p(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Sc.type)return!0;return!1}function B(a){if(!Aa.Dk)return!1;a=ua(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function m(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,e=0;e<c.length;e++)if(da.uG(a[b],c[e].settings))return!0;return!1}function x(a){for(var b=ua(a),c=[],e=0;e<b.length;e++){var d=b[e];if(d.b4w_water){for(var f={},k=0;k<a.length;k++)for(var h=a[k],l=h.data.materials,g=0;g<l.length;g++)l[g]==d&&(f.Xk=h.location[2]);f.xe=d.b4w_water_fog_color.slice(0);f.xe.push(d.b4w_water_fog_density);
d.b4w_water_dynamic?(f.Gq=!0,f.waves_height=d.b4w_waves_height,f.waves_length=d.b4w_waves_length,f.dst_noise_scale0=d.b4w_water_dst_noise_scale0,f.dst_noise_scale1=d.b4w_water_dst_noise_scale1,f.dst_noise_freq0=d.b4w_water_dst_noise_freq0,f.dst_noise_freq1=d.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=d.b4w_water_dir_min_shore_fac,f.dir_freq=d.b4w_water_dir_freq,f.dir_noise_scale=d.b4w_water_dir_noise_scale,f.dir_noise_freq=d.b4w_water_dir_noise_freq,f.dir_min_noise_fac=d.b4w_water_dir_min_noise_fac,
f.dst_min_fac=d.b4w_water_dst_min_fac,f.waves_hor_fac=d.b4w_water_waves_hor_fac):(f.Gq=!1,f.waves_height=0,f.waves_length=0);f.Gg=d.b4w_water_enable_caust;f.uR=d.b4w_water_caust_scale;f.tR=d.b4w_water_caust_brightness;f.vR=new Float32Array([.3,.7]);f.Ek=null;d=d.texture_slots;for(k=0;k<d.length;k++)h=d[k].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.Ek=h.image,f.gD=h.image.size[0],f.GB=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.xo=[(h[0]+h[1])/2,(h[2]+h[3])/2],f.yo=[h[0]-h[1],
h[2]-h[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Gq)for(e=0;e<c.length;e++)c[e].Gq&&(f=c[e]);return f}return null}function g(a){function b(a){if(a){a=a.nodes;for(var e=0;e<a.length;e++){var d=a[e];"GROUP"==d.type&&d.node_group&&b(d.node_group.node_tree);"GROUP"==d.type&&"B4W_REFRACTION"==d.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=ua(a);for(var e=0;e<a.length;e++){var d=a[e];d.b4w_refractive&&(c.refractions=!0);d.node_tree&&b(d.node_tree)}return c}function l(a,b,c){if(Aa.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var e=0,d=!1,f=0;f<b.length;f++){var k=b[f];k.k.Gd&&"CUBE"==k.k.jh&&e++;if(k.Zr.length){for(var h=null,l=0;l<a.length;l++)if(a[l]==k){h=l;break}null==h&&a.push(k)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(k=0;k<b.length;k++)if(h=b[k].game_settings.alpha_blend,"OPAQUE"!=h&&"CLIP"!=h){b=!0;break a}b=!1}else b=void 0;b&&(d=!0)}return{SK:a,kK:e,Ei:[],gA:[],Xh:[],mw:[],dJ:d}}function h(a,b){var c=a.b4w_sky_settings,e={};e.VK=c.render_sky||c.procedural_skydome;
e.procedural_skydome=c.procedural_skydome;e.use_as_environment_lighting=c.use_as_environment_lighting;e.Ao=c.color;e.rayleigh_brightness=c.rayleigh_brightness;e.mie_brightness=c.mie_brightness;e.spot_brightness=c.spot_brightness;e.scatter_strength=c.scatter_strength;e.rayleigh_strength=c.rayleigh_strength;e.mie_strength=c.mie_strength;e.rayleigh_collection_power=c.rayleigh_collection_power;e.mie_collection_power=c.mie_collection_power;e.mie_distribution=c.mie_distribution;e.be=c.reflexible;e.Hd=c.reflexible_only;
!b&&c.procedural_skydome&&Pa.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return e}function w(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.oV=a.hemisphere;b.YQ=a.blur_depth;b.bG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.IX=a.samples;return b}function f(a){if(!(Aa.bloom&&a.b4w_enable_bloom&&a.s.lj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function C(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function K(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function G(a){var b={};a=a.b4w_god_rays_settings;b.jB=a.intensity;b.Wn=a.max_ray_length;b.Ko=a.steps_per_pass;return b}function L(a){var b={};b.bj=a.b4w_outline_color;b.Ir=a.b4w_outline_factor;return b}
function D(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function N(a,b){var c=a.light_settings,e={};e.Og=c.environment_energy;e.Ds=c.use_environment_light;e.vA=c.environment_color;e.he=a.horizon_color.slice(0);e.pe=a.zenith_color.slice(0);e.Gs=a.use_sky_paper;e.Fs=a.use_sky_blend;e.Hs=a.use_sky_real;e.Ww=null;
e.Bo=null;e.xu=null;c=!0;if(e.Ds&&"SKY_TEXTURE"==e.vA&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){d=a.texture_slots[f];break}d?e.xu=d:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;d=a.texture_slots[f];e.Ww=d;f=Math.min(Xa.Vi,Qa.mR(d.texture.image.size[0]/3));e.Bo={gZ:f,ZF:d.blend_factor,
jJ:d.horizon_factor,HN:d.zenith_up_factor,GN:d.zenith_down_factor,color:d.color,Da:d.default_value,invert:d.invert,mN:d.use_rgb_to_intensity,$F:d.blend_type,hN:d.use_map_blend,iN:d.use_map_horizon,kN:d.use_map_zenith_up,jN:d.use_map_zenith_down};break}e.Ds=e.Ds?c:!1;return e}function I(a){var b=a.fog_settings,c={};c.h_=b.use_fog;c.jB=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.WT=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.xe=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.Yf=new Float32Array([c.jB,c.depth,c.start,c.height]);return c}function O(a,b){if(!Aa.jd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,e=!1,d=0;d<b.length;d++){for(var f=b[d],k=f.data.materials,h=0;h<k.length;h++)k[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)k=f[h].settings,"HAIR"==k.type&&k.b4w_dynamic_grass&&(e=!0);if(c&&e)return!0}return!1}function E(a,b){if(vb.outlining_overview_mode)return!0;if(Aa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.yk)return!0;return!1}else return!1}function c(a,b){if(vb.outlining_overview_mode)return!0;if(Aa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Uc)return!0;return!1}else return!1}function k(a,b){if(Aa.Pi)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var e=b[c].data.materials,
d=0;d<e.length;d++)if(Ka.tG(e[d]))return!0;return!1}else return!1}function y(a,b){if(Aa.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function A(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,e=0;e<c.length;e++){var d=c[e],f=d.game_settings.alpha_blend;if(d.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function e(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var e=b[c].nb;if(e.anchor&&e.anchor.sn)return!0}return!1}}function R(a,b,c){var e=ra.bh(a,b);ra.ii(a,e,function(a,b,e){if(e.Ec){switch(e.from){case "COLOR":case "CUBEMAP":var d=b.p.qc;break;case "DEPTH":d=b.p.Re;break;case "SCREEN":d=null;break;case W.nd:return;default:Ba.q("Wrong slink")}switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:d||Ba.q("Connection of SCREEN is forbidden"),d.Ie&&Ba.q("Batch texture can't use renderbuffer"),ka.xG(c.yb,e.to)&&ea.Aj(c,d,e.to)}}});for(a=0;a<b.Ya.length;a++){var e=b.Ya[a],d=b.hi[a];switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:d.Ie&&Ba.q("Batch texture can't use renderbuffer"),ka.xG(c.yb,e.to)&&ea.Aj(c,d,e.to)}}}function q(a){if(a&&a.s&&a.s.Wa){var b=ia.ec(a.s.Wa,W.zg);b&&ja(a,b)}}function ba(a,
b,c,e,d,f){for(var k=b.k,h=da.ja(b,d).U,l=0;l<h.length;l++){var g=h[l];if(!(g.me||g.Hd||"MAIN"!=g.type&&"NODES_GLOW"!=g.type&&"PARTICLES"!=g.type&&"LINE"!=g.type)&&("OPAQUE"==g.Eb&&"OPAQUE"==e||"BLEND"==g.Eb&&"BLEND"==e||"XRAY"==g.Eb&&"XRAY"==e||"NODES_GLOW"==g.type&&"GLOW"==e)){if(!f&&(J(g,a,b,c,e,d),!ea.Xc(g)))if("DEBUG"===cb.type())ea.Et(g,"error.glslv","error.glslf"),ea.Xc(g);else continue;var m=W.Qh(g,k);W.Oc(a,m);R(c,a,g);F(g)}}}function J(a,b,c,e,d,f){var k=c.k,h=f.s,l=da.ja(c,f),g="NO_SHADOWS";
c=S(f,[W.dd]);if(c.length&&a.ce){switch(d){case "OPAQUE":g="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":g="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":g="NO_SHADOWS";break;case "SHADOW":g="SHADOW_MASK_GENERATION";break;default:Ba.q("Wrong subscene type")}for(var m=0;m<c.length;m++)ea.HF(a,f.s.wd)}m="NO_SOFT_SHADOWS";if(h.wd&&h.wd.EY)switch(Aa.ZQ){case "16x":m="POISSON_X_16";break;case "8x":m="POISSON_X_8";break;case "4x":m="POISSON_X_4"}c=a.hb;ka.ga(c,"SHADOW_USAGE",
g);ka.ga(c,"POISSON_DISK_NUM",m);a.jd&&(m=ia.ec(e,W.ri))&&V(a,m,k);m=b.p;m.type==na.se||m.type==na.xh||m.type==na.ui?ka.ga(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ka.ga(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=d||a.Vj){d=b.$v;ka.ga(c,"NUM_LIGHTS",d);ka.ga(c,"NUM_LFACTORS",0==d%2?d/2:Math.floor(d/2)+1);ka.ga(c,"REFLECTION_PASS","REFL_PASS_NONE");ka.ga(c,"SSAO_ONLY",0);if(d=h.Jc)ka.ga(c,"WATER_EFFECTS",1),ka.ga(c,"WAVES_HEIGHT",ka.M(d.waves_height)),ka.ga(c,"WAVES_LENGTH",ka.M(d.waves_length)),
ka.ga(c,"WATER_LEVEL",ka.M(d.Xk));if(b.Gg&&a.Gg){ka.ga(c,"CAUSTICS",1);if(m=h.wd){k=m.Xg;for(m=g=0;m<k.length;m++)"SUN"==k[m]&&(g=m);ka.ga(c,"SUN_NUM",g)}ka.ga(c,"CAUST_SCALE",ka.M(b.jG));ka.ga(c,"CAUST_SPEED",ka.M(b.kG,2));ka.ga(c,"CAUST_BRIGHT",ka.M(b.iG))}b=l.Ei;l=l.Xh;if(-1!==a.Ld.indexOf("u_mirrormap"))ka.ga(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Gd&&b)b=b.p.qc,ea.Aj(a,b,"u_cube_reflection"),ka.ga(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Gd&&l)for(m=0;m<l.length;m++)b=l[m].p.qc,ea.Aj(a,
b,"u_plane_reflection"),ka.ga(c,"REFLECTION_TYPE","REFL_PLANE");else ka.ga(c,"REFLECTION_TYPE","REFL_NONE");(l=ia.ec(e,W.zg))?a.ru?(b=l.p.qc,ea.Aj(a,b,"u_sky")):l.procedural_skydome&&(a.ue=l.ue,ka.ga(c,"PROCEDURAL_FOG",1)):ka.ga(c,"PROCEDURAL_FOG",0);b=h.cp;b.Ds&&(ka.ga(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.vA?(b.xu?(l=b.xu.texture,b=Qa.fe(b.xu),ea.Aj(a,b,"u_sky_texture",l.name)):l&&(b=l.p.qc,ea.Aj(a,b,"u_sky_texture")),ka.ga(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.vA&&ka.ga(c,"SKY_COLOR",1));
b=h.FN;b.h_&&(ka.ga(c,"USE_FOG",1),ka.ga(c,"FOG_TYPE",b.WT));a.uk&&a.Kb?(Aa.pu&&ka.ga(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.Vj||"NODES_GLOW"==a.type?(ka.ga(c,"REFRACTIVE",1),h.refractions?ka.ga(c,"USE_REFRACTION",1):ka.ga(c,"USE_REFRACTION",0)):h.refractions?ka.ga(c,"REFRACTIVE",1):ka.ga(c,"REFRACTIVE",0),(h.VJ.refractions||h.refractions)&&ka.ga(c,"HAS_REFRACT_TEXTURE",1)):(ka.ga(c,"REFRACTIVE",0),ka.ga(c,"USE_REFRACTION",0),ka.ga(c,"USE_REFRACTION_CORRECTION",0));a.sj&&(Aa.Dk&&a.Ms&&
ia.ec(e,W.nE)?ka.ga(c,"SHORE_SMOOTHING",1):ka.ga(c,"SHORE_SMOOTHING",0),a.water_dynamic&&d&&d.waves_height?ka.ga(c,"DYNAMIC",1):ka.ga(c,"DYNAMIC",0));"PARTICLES"==a.type&&(ka.ga(c,"SIZE_RAMP_LENGTH",a.gb.T7),ka.ga(c,"COLOR_RAMP_LENGTH",a.gb.HG));if(!a.Zf)for(a=a.ya,e=0;e<a.length;e++)if(b=a[e],"SCENE"==b.source)for(h=0;h<Ua.length;h++)for(c=Ua[h],l=Ua[h].Qf,d=0;d<l.length;d++)l[d]==b&&ra.r(yb,c,f,null)}}function F(a){8<a.ya.length&&Pa.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.td.join(", ")+'"')}function V(a,b,c){a.ge=b.ge;var e=b.ge[0],d=b.ge[1],f=b.ge[2];c=c.O;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.ge[2]=f;b=b.p;na.Fw(b,f/2,-d,-e,f/2);na.Bk(b);e=a.er||0;e=0==e?c:Math.max(e,c);a.er=e}function U(a,b,c,e,d,f){for(var h=b.k,k=da.ja(b,d).U,l=0;l<k.length;l++){var g=k[l];if(("MAIN"==g.type||"PARTICLES"==g.type||"LINE"==g.type)&&"REFLECT"==g.Eb&&g.Kb==e){if(a.type==W.Nd||a.type==W.sf){var m;a:{var u=d.s.$h.Xh;for(m=0;m<u.length;m++)for(var v=
0;v<u[m].length;v++)if(u[m][v]==a)break a;u=d.s.$h.mw;for(m=0;m<u.length;m++)for(v=0;v<u[m].length;v++)if(u[m][v]==a)break a;m=null}if(m==h.Ed)continue}else if(m=Ea(d,a),m==h.Rd)continue;if(!f&&(J(g,a,b,c,"REFLECT",d),m=g.hb,ka.ga(m,"WATER_EFFECTS",0),a.type==W.Nd||a.type==W.sf?ka.ga(m,"REFLECTION_PASS","REFL_PASS_PLANE"):ka.ga(m,"REFLECTION_PASS","REFL_PASS_CUBE"),ka.ga(m,"TEXTURE_NORM",0),!ea.Xc(g)))if("DEBUG"===cb.type())ea.Et(g,"error.glslv","error.glslf"),ea.Xc(g);else continue;g=W.Qh(g,h);W.Oc(a,
g)}}}function aa(a){ca(a);var b=Y(a,W.Pb),c=!0,e=a.s.wd;ra.oa(a.s.Wa,function(d,f){f.type===W.dd&&(fa(f,a,b.p,e,c),c=!1)})}function v(a){ra.oa(a.s.Wa,function(a,b){b.type===W.Ym&&(b.uA=1)})}function fa(a,b,c,e,d){if(0!=a.Ra.length){var f=a.p,h=Ca.fc(c.n,Nb);Ca.ff(h,f.n);Ca.copy(c.mf,f.ms);if("SUN"===e.Xg[a.nh]||"HEMI"===e.Xg[a.nh]){h=uc;ya.B_(h);for(var k=0;k<a.Ra.length;k++)for(var l=a.Ra[k].ra,g=0;g<l.length;g++){var m=l[g].bf;0==k&&0==g?ya.ln(m.Ta,h):ya.wA(h,m.Ta)}h=ya.EH(h,Nc);Ba.jo(h,f.Ob,h);
if(e.enable_csm){b=Oa.copy(c.Hh[a.fA],Nb);e=xa.invert(c.Ob,lc);Ba.jo(b,e,b);Ba.jo(b,f.Ob,b);a=c.uq[a.fA];if(d)for(Gb=0,fc=-Infinity,d=2;d<h.length;d+=3)Gb=Math.min(Gb,h[d]),fc=Math.max(fc,h[d]);d=uc;d.max_x=b[0]+a;d.max_y=b[1]+a;d.max_z=fc;d.min_x=b[0]-a;d.min_y=b[1]-a;d.min_z=Gb}else{c=d=uc;e=Wc;e.set(h);h=Cc/9;k=xa.identity(lc);xa.rotate(k,h,Ba.$c,k);g=l=-1;for(m=0;10>m;m++){var u=ya.PF(e,Rc),v=(u.max_x-u.min_x)*(u.max_y-u.min_y);if(-1==l||v<l)l=v,g=m,ya.ln(u,c);Ba.jo(e,k,e)}c=g*h;0<c&&(h=xa.identity(lc),
xa.rotate(h,c,Ba.$c,h),xa.multiply(h,f.Ob,f.Ob),Ca.Mi(f.Ob,f.mf));c=d.max_x-d.min_x;h=d.max_y-d.min_y;c&&h&&(e=Math.abs(c-h)/2,2<c/h?(d.max_y+=e,d.min_y-=e):2<h/c&&(d.max_x+=e,d.min_x-=e));d.max_x+=.005;d.max_y+=.005;d.max_z+=.005;d.min_x-=.005;d.min_y-=.005;d.min_z-=.005;M(a,b.s.Wa)}na.ZX(f,d.min_x,d.max_x,d.min_y,d.max_y,-d.max_z,-d.min_z);na.Bk(f);Ba.xn(f.md,f.Lh)}else"SPOT"!==e.Xg[a.nh]&&"POINT"!==e.Xg[a.nh]||na.Bk(f,f.zb)}}function M(a,b){for(var c=a.p,e=ia.$U(b,a),d=0;d<e.length;d++){var f=
e[d];if(f.type==W.Pb||f.type==W.tf||f.type==W.Lc||f.type==W.Pf)if(Aa.Kv)f.VD.set(c.mf,9*a.nh);else{var h=Ca.F(c.mf),k=Ca.R(c.mf);zb.set(h[0],h[1],h[2],Ca.Yd(c.mf),fb);f.px.set(fb,4*a.nh);f.ox.set(k,4*a.nh)}}}function H(a,b,c,e,d){for(var f=b.k,h=da.ja(b,e).U,k=0;k<h.length;k++){var l=h[k];if("COLOR_ID"==l.type&&(a.type==W.pf&&"COLOR_ID"==l.Eb||a.type==W.qi&&"COLOR_ID_XRAY"==l.Eb)){if(!d&&(J(l,a,b,c,"COLOR_ID",e),ea.ef(l,"USE_OUTLINE",0),!ea.Xc(l)))continue;l=W.Qh(l,f);W.Oc(a,l)}}}function Z(a,b,c,
e,d){if(!e&&(d.jd&&(e=ia.ec(c,W.ri))&&V(d,e,b),!ea.Xc(d)))if("DEBUG"===cb.type())ea.Et(d,"error.glslv","error.glslf"),ea.Xc(d);else return;b=W.Qh(d,b);W.Oc(a,b);R(c,a,d);F(d)}function ha(a,b){u(a,b);for(var c=0;c<a.Pe.length;c++)a.Pe[c].parent==a&&ha(a.Pe[c],b)}function u(a,b){a.k.Ph=b;if(da.On(a))for(var c=0;c<a.I.length;c++)for(var e=a.I[c],d=S(e.xb,mb),f=0;f<d.length;f++){var h=d[f],k=a.k,l=a.Sc,g=e.im,m=l.Km&&!k.Ph?1:0;h.yr[4*g+3]=m;m=l.Mm&&!k.Ph?1:0;h.xr[4*g+3]=m;h.Aa=!0}}function Q(a,b){for(var c=
S(b,mb),e=a.Sc,d=a.k,f=da.ja(a,b),h=Ca.F(d.n),d=Ca.R(d.n),k=0;k<c.length;k++){var l=c[k],g=l,m=a.k,u=a.Sc,v=f.im,q=Ca.F(a.k.n),z=u.lq;g.xB.set(u.direction,3*v);fb[0]=q[0];fb[1]=q[1];fb[2]=q[2];fb[3]=u.Km&&!m.Ph?1:0;g.yr.set(fb,4*v);fb[0]=z[0];fb[1]=z[1];fb[2]=z[2];fb[3]=u.Mm&&!m.Ph?1:0;g.xr.set(fb,4*v);g.Aa=!0;switch(e.type){case "SUN":l.xM.set(d);l.wM=e.lq;l.type===W.zg?(l.Vv=e.gK,Oa.copy(e.direction,l.qD),ja(b,l)):Oa.copy(e.direction,l.qD);break;case "HEMI":case "POINT":case "SPOT":break;default:Pa.error("Unknown light type: "+
e.type+'".')}l=l.Ra;for(g=0;g<l.length;g++)for(m=l[g].ra,u=0;u<m.length;u++)v=m[u].za,v.hm&&ea.aY(v,a)}c=Y(b,W.Pb).p;f=f.eD;e=b.s.wd;for(k=0;k<f.length;k++)l=f[k],na.bD(l.p,h,d),fa(l,b,c,e,!0),M(l,b.s.Wa)}function ca(a){var b=Na.jc(a,"LAMP",Na.Dc),b=da.Su(b,Aa.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var e=b[c],d=e.k,f=Ca.fc(d.n,Nb),d=Ca.Xd(d.n,Ab),h=0;h<e.I.length;h++){var k=e.I[h],l=k.eD;if(k.xb==a)for(k=0;k<l.length;k++)na.bD(l[k].p,f,d)}}function ja(a,b){ga.ow(b);Sa.vn(b);
if(b.Vv)for(var c=S(a,jb),e=0;e<c.length;e++)for(var d=c[e].Ra,f=0;f<d.length;f++)for(var h=d[f].ra,k=0;k<h.length;k++){var l=h[k];l.ac&&(l=l.za,ea.yR(l)&&Sa.AZ(l))}}function ua(a){for(var b=[],c=0;c<a.length;c++)for(var e=a[c].data,d=0;d<e.materials.length;d++){var f=e.materials[d];-1==b.indexOf(f)&&b.push(f)}return b}function pa(a,b,c){for(var e=a.s,d=da.ja(a.wj,a).ba,f=0;f<d.length;f++){var h=d[f];na.Bk(h,b/c);e.wd&&na.PD(h,e.wd)}e.wd&&(e.Wv=!0,Y(a,W.tf).Aa=!0,Y(a,W.Lc).Aa=!0);var k=e.Wa;ia.rZ(k,
function(e,d,f){if(e.xs){var h=e.Bm*b,l=e.Cm*c;if(d)for(d=0;d<f.Ya.length;d++)f.Ya[d]==e&&Qa.resize(e.jb,h,l);else switch(Qa.Sn(e.jb)&&Qa.resize(e.jb,h,l),e=f.p,e.width=h,e.height=l,f.type){case W.ip:qa(a,{dof_power:f.p.dof_power});break;case W.kp:za(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case W.dp:sa(a,{bloom_blur:f.jn});break;case W.Ym:f=ia.Cb(k,f,W.dc);h=ia.Cb(k,f,W.dc);l=ia.Cb(k,h,W.dc);e=ia.Cb(k,l,W.dc);ia.Jd(f,1/b,1/c);ia.Jd(h,
1/b,1/c);ia.Jd(l,1/b,1/c);ia.Jd(e,1/b,1/c);break;default:ia.Jd(f,1/b,1/c)}}})}function S(a,b){for(var c=[],e=0;e<b.length;e++){var d=b[e];ra.oa(a.s.Wa,function(a,b){b.type==d&&c.push(b)})}return c}function Y(a,b){return ia.ec(a.s.Wa,b)}function qa(a,b){var c=Y(a,W.ip);if(!c)return Pa.error("DOF is not enabled on the scene. Check camera settings"),0;var e=c.p.dof_bokeh,d=e?S(a,[W.Mx]):[],f=a.s.Wa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,e))for(var h=0;h<d.length;h++)d[h].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,e))for(h=0;h<d.length;h++)d[h].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,e))for(h=0;h<d.length;h++)d[h].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,e))for(h=0;h<d.length;h++)d[h].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,e))for(h=0;h<d.length;h++)d[h].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,e))for(h=0;h<d.length;h++)d[h].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,e&&(d=ia.SA(f,c,W.dc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[0]=ia.Cb(f,d[0],W.dc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(e){e=b.dof_power;c.p.dof_power=e;var e=
e/2,h=c.p.width,k=c.p.height,l=[1/h,0],g=[1/h*.5,1/k*.866],m=[-1/h*.5,1/k*.866],d=ia.SA(f,c,W.dc);ia.Ic(d[0],e);ia.Jd(d[0],m[0],m[1]);ia.Ic(d[1],e);ia.Jd(d[1],g[0],g[1]);d[0]=ia.Cb(f,d[0],W.dc);ia.Ic(d[0],e);ia.Jd(d[0],l[0],l[1]);c.p.Cd&&(d[0]=ia.Cb(f,d[0],W.Mx),d[0]=ia.Cb(f,d[0],W.dc),ia.Jd(d[0],1/h,1/k),d[0]=ia.Cb(f,d[0],W.dc),ia.Jd(d[0],1/h,1/k))}else c.p.dof_power=b.dof_power,d=ia.Cb(f,c,W.dc),f=ia.Cb(f,d,W.dc),ia.Ic(d,c.p.dof_power),ia.Jd(d,1/c.p.width,1/c.p.height),ia.Ic(f,c.p.dof_power),ia.Jd(f,
1/c.p.width,1/c.p.height)}function sa(a,b){var c=Y(a,W.jt),e=Y(a,W.dp);if(!c||!e)return Pa.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.Mt=b.key,c.Aa=!0);"number"==typeof b.edge_lum&&(c.Lt=b.edge_lum,c.Aa=!0);if("number"==typeof b.blur){var d=a.s.Wa,c=ia.Cb(d,e,W.ep),d=ia.Cb(d,c,W.ep);e.jn=b.blur;ia.Ic(c,b.blur);ia.Jd(c,1/e.p.width,1/e.p.height);ia.Ic(d,b.blur);ia.Jd(d,1/e.p.width,1/e.p.height)}}function za(a,b){var c=Y(a,W.kp);if(!c)return Pa.error("Glow is not enabled on the scene"),
null;for(var e=a.s.Wa,d=ia.XU(e,c),f=0;f<d.length;++f){var h=d[f];if(h.type==W.dc&&"GLOW_MASK_LARGE"==h.Eb)var k=h;if(h.type==W.dc&&"GLOW_MASK_SMALL"==h.Eb)var l=h}d=ia.Cb(e,k,W.dc);e=ia.Cb(e,l,W.dc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Aa=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Aa=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ia.Ic(l,b.small_glow_mask_width),
ia.Jd(l,1/c.p.width,1/c.p.height),l.Aa=!0,ia.Ic(e,b.small_glow_mask_width),ia.Jd(e,1/c.p.width,1/c.p.height),e.Aa=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ia.Ic(k,b.large_glow_mask_width),ia.Jd(k,1/c.p.width,1/c.p.height),k.Aa=!0,ia.Ic(d,b.large_glow_mask_width),ia.Jd(d,1/c.p.width,1/c.p.height),d.Aa=!0)}function X(a,b,c){var e=a.s,d=e.Jc;if(!d.Gq)return d.Xk;var f=d.waves_height,h=d.waves_length,k=d.Xk,l=Oa.length(e.tj)||1;a=Y(a,W.Pb).time;a*=
l;var g=Rb;g[0]=20/h*(b-.25*a);g[1]=20/h*(c-.25*a);l=Ba.lG(g);g[0]=17/h*(c+.1*a);g[1]=17/h*(b+.1*a);var g=Ba.lG(g),l=l+g-1,m=d.dst_noise_scale0,g=d.dst_noise_scale1,u=d.dst_noise_freq0,v=d.dst_noise_freq1,q=Rb;q[0]=m*(b+u*a);q[1]=m*(c+u*a);m=Ba.jD(q);q[0]=g*(c-v*a);q[1]=g*(b-v*a);g=Ba.jD(q);g*=f*m;if(d.Ek)if(v=(b-d.xo[0])/d.yo[0],q=(d.xo[1]+c)/d.yo[1],v+=.5,q+=.5,1<v||0>v||1<q||0>q)d=g;else{var e=Ba.cI(e.fD,d.gD,v,q),q=d.dir_freq,z=d.dir_noise_scale,n=d.dir_noise_freq,m=d.dir_min_noise_fac,v=d.dst_min_fac,
u=h/d.GB/Math.PI;c=[z/h*(b+n*a),z/h*(c+n*a)];b=Math.sqrt(e);d=f*Math.max(e,d.dir_min_shore_fac)*Math.sin(b/u+q*a)*Math.max(Ba.jD(c),m);f=Math.max(b,v);d=d*(1-f)+g*f;l*=e}else d=g;return k+(d+.05*l)}function ta(a,b){a.mr&&a.type==W.dc&&b.ac!=a.ac&&(a.ac=b.ac);b.ac||a.type!=W.Ym||(a.uA=0)}function oa(a,b,c,e){var d=ra.Va(a,b);na.Cw(d.p,c,e);d.jz=!0;ra.Lk(a,b,function(b,d,f){f.Ec&&f.from==c&&ia.LR(f)&&P(a,b,f.to,e)});ra.ii(a,b,function(b,d,f){f.Ec&&f.from==c&&f.from==f.to&&oa(a,b,c,e)})}function P(a,
b,c,e){a=ra.Va(a,b).Ra;for(b=0;b<a.length;b++)for(var d=a[b].ra,f=0;f<d.length;f++)ea.yX(d[f].za,e,c)}function la(a){var b=Y(a,W.ri);if(b){var c=b.p,e=a.wj.k;a=Ca.fc(e.n,Nb);var d=Ob;d[0]=0;d[1]=0;d[2]=-b.ge[2]/2;b=Ca.Xd(e.n,Ab);Oa.transformQuat(d,b,d);d[0]+=a[0];d[1]+=a[1];d[2]=0;eb.identity(b);na.bD(c,d,b)}}function z(a,b){ra.oa(a,function(c,e){if(e.type==W.vh){e.Ya[0]&&e.hi[0]||Ba.q("Wrong MOTION_BLUR subscene");var d=e.Ya[0],f=e.hi[0];e.hi[0]=e.p.qc;ra.Lk(a,c,function(b,c,e){e.Ec&&P(a,b,e.to,
f)});oa(a,c,d.from,f);P(a,c,d.to,e.hi[0]);e.$J=Math.exp(-b/e.mb_factor)}})}function ma(a){return a.s.tj}function Ea(a,b){if(!a.s.$h)return null;for(var c=a.s.$h.Ei,e=0;e<c.length;e++)if(c[e]==b)return e;c=a.s.$h.gA;for(e=0;e<c.length;e++)if(c[e]==b)return e;return null}var ea=r("__batch"),ya=r("__boundings"),na=r("__camera"),Ha=r("__config"),Da=r("__container"),Ra=r("__debug"),ra=r("__graph"),wa=r("__hud"),va=r("__input"),xa=r("__mat4"),Ka=r("__nodemat"),Na=r("__objects"),da=r("__obj_util"),T=r("__physics"),
ga=r("__prerender"),Mb=r("__primitives"),Pa=r("__print"),eb=r("__quat"),Sa=r("__renderer"),ia=r("__scenegraph"),Ta=r("__sfx"),ka=r("__shaders"),W=r("__subscene"),Qa=r("__textures"),Ca=r("__tsr"),Ba=r("__util"),Oa=r("__vec3"),zb=r("__vec4"),cb=r("__version"),Aa=Ha.A,Xa=Ha.Ci,vb=Ha.Uc,Fa=Ha.qo,Za=[W.ri,W.dd,W.Pb,W.Lc,W.Pf,W.ee,W.Nd,W.nd,W.sf,W.Ke,W.pf,W.qi,W.tf,W.yg,W.rf];a.d1=Za;var mb=[W.Pb,W.Lc,W.Pf,W.ee,W.Nd,W.nd,W.vj,W.et,W.zg,W.sf,W.Ke,W.jt,W.tf,W.dd,W.pf,W.qi,W.yg],jb=[W.Pb,W.rt,W.Lc,W.Pf,W.ee,
W.Nd,W.nd,W.sf,W.Ke],ib=[W.dd,W.Pb,W.Lc,W.Pf,W.ee,W.Nd,W.nd,W.sf,W.Ke,W.pf,W.qi,W.tf,W.vj,W.yg,W.rf],kc=[W.Pb,W.Lc,W.Pf,W.ee,W.Nd,W.nd,W.sf,W.Ke],ab=null,bb=null,Ua=[],yb=null,Cc=Math.PI/2,Rb=new Float32Array(2),Nb=new Float32Array(3),Ob=new Float32Array(3),Ab=new Float32Array(4),fb=new Float32Array(4),lc=new Float32Array(16),Nc=new Float32Array(24),Wc=new Float32Array(24),uc=ya.Qd(),Rc=ya.Qd(),Gb=0,fc=-Infinity;a.H2=function(){return{}};a.Bw=function(a){bb=a;Ta.NX(a)};a.hX=function(a,b){var c=a.s,
e=ia.zS(c.Wa);if(a==b){pa(a,Da.WI(),Da.VI());for(var d=0;d<e.length;d++)a.s.xm.push(e[d])}else for(d=a.Qf[0],pa(a,d.hj,d.hj),d=0;d<e.length;d++)b.s.xm.push(e[d]);e=S(a,ib);for(d=0;d<e.length;d++)e[d].tj.set(c.tj);for(d=0;d<c.xm.length;d++)c.xm[d].type==W.dd&&Sa.vn(c.xm[d])};a.Mh=function(){ab||(ab=n(Ua));return ab};a.Au=n;a.B=d;a.Ca=function(){return bb?!0:!1};a.Ul=function(a){return a.wj};a.Xq=function(){return Ua};a.UA=function(){if(1==Ua.length)return Ua;for(var a=0;a<Ua.length;a++){var b=Ua[a].s.Wa;
ra.oa(b,function(b,c){for(var e=c.Ra,d=0;d<e.length;d++)for(var f=e[d].ra,h=0;h<f.length;h++){for(var k=f[h],l=k.za.ya,g=null,m=0;m<l.length;m++)if("SCENE"==l[m].source&&l[m].ps==Ua[a].name&&c.type!=W.Ox){Pa.error('Texture-scene loop detected. A scene is rendered to texture "'+l[m].name+'" yet this texture belongs to the same scene.');ra.bh(yb,Ua[a]);g=k.za;break}g&&(g.ya=[],g.Ld=[],ea.zZ(g,null),ea.Xc(g),W.Oc(c,k))}})}for(var c=[],a=0;a<Ua.length;a++)if(b=Ua[a],!b.Qf.length){b=ra.bh(yb,b);ra.JT(yb,
b);b=ra.bx(yb,b,ra.Ss);b=ra.DD(b);ra.oa(b,function(a,b){c.push(b)});break}return c};a.kQ=function(a,d,u,v,q){a.Qf=a.Qf||[];a.qa=null;var z=a.s,n=da.ja(a.wj,a),H=a.wj.k;z.$o=[];var M=a.world;z.RV=u.length;z.lj=p(u);z.Sw=h(M,z.lj);z.cp=N(M,z.Sw);z.FN=I(M);if(M=!a.Qf.length)a:{if("HMD"==Aa.stereo){if(n.ba[0].type!=na.Od){Pa.warn("Head-mounted display stereo is disabled for the non-perspective camera");Aa.stereo="NONE";M=!1;break a}if(!va.Bz(va.Je)){Pa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Aa.stereo="NONE";M=!1;break a}}M="HMD"==Aa.stereo}z.kv=M;if(M=!a.Qf.length)n.ba[0].type!=na.Od&&"ANAGLYPH"==Aa.stereo?(Pa.warn("Anaglyph stereo is disabled for the non-perspective camera"),Aa.stereo="NONE",M=!1):M="ANAGLYPH"==Aa.stereo;z.anaglyph_use=M;z.bQ=!z.kv&&!z.anaglyph_use&&e(a,q);z.$h=l(a,d,v);z.XQ=f(a);z.zW=C(a);z.wR=K(a);z.hV=G(a);z.OW=L(a);z.Uj=D(a);z.dof=Aa.dof&&(0<H.dof_distance||H.dof_object);z.motion_blur=Aa.motion_blur&&a.b4w_enable_motion_blur;z.compositing=Aa.compositing&&a.b4w_enable_color_correction;
z.antialiasing=Aa.antialiasing&&1==Aa.Cc&&"NONE"!=a.b4w_antialiasing_quality;z.ssao=Aa.ssao&&a.b4w_enable_ssao;z.god_rays=Aa.god_rays&&a.b4w_enable_god_rays&&z.lj;z.rT=Aa.pu;z.Yu=a.b4w_glow_settings.render_glow_over_blend;z.TY=w(a);q=g(v);z.VJ=q;z.refractions=y(a,q);z.wd=b(a,u,v);z.Jc=x(v);z.th=A(v);z.DY=m(v);z.Dk=B(v);z.jd=O(a,v);z.ZR=E(a,v);z.outline=c(a,v);z.Pi=k(a,v);switch(a.b4w_reflection_quality){case "LOW":z.Fi=Fa.jH;z.ih=Fa.yK;break;case "MEDIUM":z.Fi=Fa.kT;z.ih=Fa.$W;break;case "HIGH":z.Fi=
Fa.jT;z.ih=Fa.ZW;break;default:z.Fi=Fa.jH,z.ih=Fa.yK}Da.GV()?(Pa.log("%cENABLE HIDPI MODE","color: #00a"),z.oF="AA_QUALITY_LOW",z.no=1,Aa.Cc=1):1<Aa.Cc?(Pa.log("%cENABLE MSAA RENDERING: "+Aa.Cc+"x","color: #00a"),z.no=1):(z.oF="AA_QUALITY_"+a.b4w_antialiasing_quality,z.no="MEDIUM"===a.b4w_antialiasing_quality&&Aa.quality===Ha.Zm||"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Ha.al?1.33:"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Ha.Zm||"NONE"===a.b4w_antialiasing_quality&&Aa.quality===Ha.Zm?
2:1);u=a.Qf.sort(function(a,b){return b.hj-a.hj});z.Wa=ia.yS(z,n,H,u);z.xm=[];z.Wv=!1;z.TB=!1;z.UB=!1;z.tj=new Float32Array(3);Ua.push(a);yb||(yb=ra.create());ra.J(yb,a);for(z=0;z<d.length;z++)da.KC(d[z],!0,a);a=Da.We();Da.resize(a.clientWidth,a.clientHeight,!0)};a.lQ=function(a,b,c){for(var e=0;e<b.length;e++){var d=b[e].s;d&&d.em&&(d.Ls=c,a.s.$o.push(b[e]))}};a.RA=function(a){return a.s.Wa};a.TH=function(a,b){ra.oa(b,function(c,e){var d=null;switch(e.type){case W.dc:d=ea.$z(e.nw);break;case W.rt:d=
ea.FS(e);break;case W.Vy:d=ea.GS(e);break;case W.nE:d=ea.lS();break;case W.vj:ia.Cb(b,e,W.an)||ia.Cb(b,e,W.rf)||ia.Cb(b,e,W.Lc)||ia.Cb(b,e,W.vj);d=ea.pS(e.sK,e.sj,e.Ko);break;case W.et:ia.Cb(b,e,W.an)||ia.Cb(b,e,W.rf)||ia.Cb(b,e,W.Lc);ia.Cb(b,e,W.vj);d=ea.qS();break;case W.vh:d=ea.uS();break;case W.Mx:d=ea.iS(e.EG);break;case W.ip:var d=ea.mS(e),f=e.p.dof_power;if(e.p.dof_bokeh){var f=f/2,h=ia.SA(b,e,W.dc);ia.Ic(h[0],f);ia.Ic(h[1],f);h[0]=ia.Cb(b,h[0],W.dc);ia.Ic(h[0],f)}else{var h=ia.Cb(b,e,W.dc),
k=ia.Cb(b,h,W.dc);ia.Ic(h,f);ia.Ic(k,f)}break;case W.Ym:var d=ea.vS(),f=ia.Cb(b,e,W.dc),h=ia.Cb(b,f,W.dc),k=ia.Cb(b,h,W.dc),l=ia.Cb(b,k,W.dc);ia.Ic(h,e.oz);ia.Ic(f,e.oz);ia.Ic(l,e.zA*e.Ir);ia.Ic(k,e.zA*e.Ir);break;case W.kp:d=ea.oS();break;case W.Nx:d=ea.jS();break;case W.gE:d=ea.dS(e);break;case W.Ty:case W.pt:case W.vp:case W.qt:d=ea.DS(e.type);break;case W.ti:d=ea.HS(e.Eb);break;case W.zg:d=ea.kS(a,e);break;case W.LUMINANCE:d=ea.rS();break;case W.JN:d=ea.eS();break;case W.jt:d=ea.sS();break;case W.ep:d=
ea.gS();break;case W.dp:d=ia.Cb(b,e,W.ep);f=ia.Cb(b,d,W.ep);ia.Ic(d,e.jn);ia.Ic(f,e.jn);d=ea.hS();break;case W.NP:d=ea.eT();break;case W.Um:d=ea.cS();break;case W.qp:d=ea.wS()}d&&(f=W.Qh(d,da.tq("NONE")),W.Oc(e,f),R(b,e,d),F(d))})};a.fn=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.s.Wa,d=b.k;!ia.ec(e,W.dd)&&d.ce&&(d.ce=!1);d=S(a,Za);c&&b.Lm&&T.fn(b,a);for(var f=0;f<d.length;f++){var h=d[f],k=b,l=e,g=a,m=c;switch(h.type){case W.Pb:ba(h,k,l,"OPAQUE",g,m);break;case W.Lc:ba(h,
k,l,"BLEND",g,m);break;case W.Pf:ba(h,k,l,"XRAY",g,m);break;case W.ee:ba(h,k,l,"GLOW",g,m);break;case W.Nd:case W.nd:U(h,k,l,!1,g,m);break;case W.sf:case W.Ke:U(h,k,l,!0,g,m);break;case W.tf:for(var u=da.ja(k,g).U,v=0;v<u.length;v++){var z=u[v];if("SHADOW"==z.type&&"RECEIVE"==z.Eb&&z.ce){if(!m&&(J(z,h,k,l,"SHADOW",g),!ea.Xc(z)))continue;var q=W.Qh(z,k.k);W.Oc(h,q);R(l,h,z);F(z)}}break;case W.dd:u=!1;v=k.k;k=da.ja(k,g).U;z=ia.ec(l,W.ri);for(q=0;q<k.length;q++){var n=k[q];if("SHADOW"==n.type&&"CAST"==
n.Eb){u=!0;if(!m){var y=h.$v;ea.ef(n,"NUM_LIGHTS",y);ea.ef(n,"NUM_LFACTORS",0==y%2?y/2:Math.floor(y/2)+1);ka.ga(n.hb,"SHADOW_USAGE","SHADOW_CASTING");n.jd&&z&&V(n,z,v);ea.ef(n,"SHADOW_TEX_RES",ka.M(g.s.wd.csm_resolution));if(!ea.Xc(n))continue}n=W.Qh(n,v);W.Oc(h,n)}}u&&(k=g.s.wd,m=ia.ec(l,W.Pb),fa(h,g,m.p,k,!0));break;case W.pf:H(h,k,l,g,m);break;case W.qi:H(h,k,l,g,m);break;case W.yg:u=k.k;v=da.ja(k,g).U;for(z=0;z<v.length;z++)if(q=v[z],"COLOR_ID"==q.type&&"OUTLINE"==q.Eb){if(!m&&(J(q,h,k,l,"COLOR_ID",
g),ea.ef(q,"USE_OUTLINE",1),!ea.Xc(q)))continue;q=W.Qh(q,u);W.Oc(h,q)}break;case W.ri:l=k.k;k=da.ja(k,g).U;for(g=0;g<k.length;g++)if(u=k[g],"GRASS_MAP"==u.type){if(!m&&!ea.Xc(u))if("DEBUG"===cb.type())ea.Et(u,"error.glslv","error.glslf"),ea.Xc(u);else continue;u=W.Qh(u,l);W.Oc(h,u);u=h.p;n=l.Ta;v=h.ge[0];z=h.ge[1];q=h.ge[2];0==v&&0==z?(v=n.min_z,z=n.max_z):(v=Math.min(v,n.min_z),z=Math.max(z,n.max_z));n=1E-4*(z-v);v-=n;z+=n;h.ge[0]=v;h.ge[1]=z;na.Fw(u,q/2,-z,-v,q/2);na.Bk(u)}break;case W.rf:for(u=
k.k,k=da.ja(k,g).U,g=0;g<k.length;g++)v=k[g],"DEBUG_VIEW"==v.type&&Z(h,u,l,m,v)}}break;case "LAMP":Q(b,a),Na.IY(a)}da.KC(b,!0,a)};a.RD=q;a.LC=function(a){a.s.Wv=!0};a.WZ=function(a,b){ra.oa(b,function(b,c){if(c.type===W.dd){var e=Ca.fc(a.n,Nb);Ca.ff(e,c.p.n);Ca.copy(a.mf,c.p.ms)}})};a.M8=M;a.GU=function(a,b){for(var c=a.s.wd,e=new Float32Array(c.csm_num),d=0;d<c.csm_num;d++)e[d]=na.hT(c,b,d);return e};a.r1=Z;a.nG=ha;a.$p=u;a.pB=function(a){return a.k.Ph};a.rX=function(a){for(var b=0;b<a.I.length;b++)for(var c=
S(a.I[b].xb,Za),b=0;b<c.length;b++)for(var e=c[b].Ra,d=0;d<e.length;d++)for(var f=e[d].ra,h=f.length-1;0<=h;h--){var k=f[h];k.bf==a.k&&(k.za&&ea.BG(k.za),f.splice(h,1))}};a.KZ=function(a,b){for(var c=a.Sc,e=da.ja(a,b).im,d=S(b,mb),f=0;f<d.length;f++){var h=d[f];h.xr.set(c.lq,4*e);h.Aa=!0}};a.$M=Q;a.YZ=function(a){a=a.I;for(var b=0;b<a.length;b++)q(a[b].xb)};a.sa=function(){for(var a=0;a<Ua.length;a++){var b=Ua[a];ra.oa(b.s.Wa,function(a,b){if(b.type!=W.bn){var c=b.p;Sa.sX(c.Ve,c.qc,c.Re,c.width,c.height);
for(var c=b.Ra,e=0;e<c.length;e++)for(var d=c[e].ra,f=0;f<d.length;f++){var h=d[f].za;h&&ea.BG(h)}}});b.s.Wa=[];b.s.xm=[]}bb=ab=null;Ua.length=0;yb=null};a.TJ=function(a,b,c){a=na.QT(a,a.near,a.far,null,!0);var e=Mb.tU(a);a=da.tq("DYNAMIC");a.Ta=a.O={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.kb=a.xa=ya.TQ();var d=a.kb.Xa;a.pb=a.aa=ya.Op([d,0,0],[0,d,0],[0,0,d],a.kb.G);a.Vo=!1;c=ea.BS(e,c);c=W.Qh(c,a);W.Oc(b,c)};a.E4=function(a){return[a.frame_start,a.frame_end]};a.PL=
function(a,b,c){Da.vY(a,b,c);bb&&pa(bb,a,b)};a.N7=pa;a.oD=S;a.Ma=Y;a.nI=function(a){a=Y(a,W.Pb);var b=a.he,c=a.pe,e=[],d=[];e[0]=b[0];e[1]=b[1];e[2]=b[2];d[0]=c[0];d[1]=c[1];d[2]=c[2];return[a.Og,e,d]};a.OC=function(a,b,c,e){a=S(a,mb);for(var d=0;d<a.length;d++){var f=a[d];f.he.set(c);f.pe.set(e);f.Og=b;f.Aa=!0}};a.MI=function(a){if(a=Y(a,W.zg)){var b={};b.color=Array(3);Oa.copy(a.Ao,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=
a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.GL=function(a,b){var c=Y(a,W.zg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&
(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.Ao.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==
typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Aa=!0,c.Vv=!0,ja(a,c))};a.OU=function(a){return S(a,jb)[0].Yf[0]};a.MU=function(a){return S(a,jb)[0].Yf[1]};a.PU=function(a){return S(a,jb)[0].Yf[2]};a.NU=function(a){return S(a,
jb)[0].Yf[3]};a.tL=function(a,b){for(var c=S(a,jb),e=0;e<c.length;e++){var d=c[e];d.Yf[0]=b;d.Aa=!0}};a.rL=function(a,b){for(var c=S(a,jb),e=0;e<c.length;e++){var d=c[e];d.Yf[1]=b;d.Aa=!0}};a.uL=function(a,b){for(var c=S(a,jb),e=0;e<c.length;e++){var d=c[e];d.Yf[2]=b;d.Aa=!0}};a.sL=function(a,b){for(var c=S(a,jb),e=0;e<c.length;e++){var d=c[e];d.Yf[3]=b;d.Aa=!0}};a.qI=function(a,b){var c=b||[],e=S(a,jb)[0].xe;c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];return c};a.SC=function(a,b){for(var c=S(a,jb),e=
0;e<c.length;e++){var d=c[e];d.xe.set(b);d.Aa=!0}};a.OI=function(a){var b=Y(a,W.rt);a=Y(a,W.Vy);if(!b)return null;var c=b.Ra[0].ra[0].za,e={};e.ssao_quality=ea.MA(c,"SSAO_QUALITY")[1];e.ssao_hemisphere=b.ssao_hemisphere;e.ssao_blur_depth=a.ssao_blur_depth;e.bG=a.ssao_blur_discard_value;e.radius_increase=b.Go;e.influence=b.Fo;e.dist_factor=b.Eo;e.ssao_only=b.ssao_only;e.ssao_white=ea.MA(c,"SSAO_WHITE")[1];return e};a.IL=function(a,b){var c=Y(a,W.rt),e=Y(a,W.Vy);if(!c)return Pa.error("SSAO is not enabled on the scene"),
0;var d=c.Ra[0].ra[0],f=d.za;"string"==typeof b.ssao_quality&&(ea.ef(f,"SSAO_QUALITY",b.ssao_quality),ea.Xc(f),W.Oc(c,d));"number"==typeof b.ssao_hemisphere&&(ea.ef(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),ea.Xc(f),W.Oc(c,d));"number"==typeof b.ssao_blur_depth&&(ea.ef(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ea.Xc(f),W.Oc(c,d));"number"==typeof b.ssao_white&&(ea.ef(f,"SSAO_WHITE",b.ssao_white),ea.Xc(f),W.Oc(c,d));"number"==typeof b.ssao_blur_discard_value&&(e.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.Go&&(c.Go=b.Go);"number"==typeof b.Fo&&(c.Fo=b.Fo);"number"==typeof b.Eo&&(c.Eo=b.Eo);if("number"==typeof b.ssao_only){c=Y(a,W.Pb);c.ssao_only=b.ssao_only;for(var d=c.Ra,h=0;h<d.length;h++)for(var k=d[h].ra,l=0;l<k.length;l++)f=k[l].za,ea.ef(f,"SSAO_ONLY",b.ssao_only),ea.Xc(f),W.Oc(c,k[l])}c.Aa=!0;e.Aa=!0};a.kI=function(a){a=Y(a,W.ip);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.qL=qa;a.tI=function(a){var b=S(a,[W.vj]);a=Y(a,W.et);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Wn;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ea.MA(b[0].Ra[0].ra[0].za,"STEPS_PER_PASS")[1];return c};a.wL=function(a,b){var c=S(a,[W.vj]),e=Y(a,W.et);if(!c||!e)return Pa.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(e.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var d=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].Wn=d,c[f].tw=d/c[f].Ko/(f+1),c[f].Aa=!0;if("number"==typeof b.god_rays_steps)for(var h=ka.M(b.god_rays_steps,1),d=c[0].Wn,f=0;f<c.length;f++){c[f].Ko=h;c[f].tw=d/h/(f+1);c[f].Aa=!0;var k=c[f].Ra[0].ra[0],l=k.za;ea.ef(l,"STEPS_PER_PASS",h);ea.Xc(l);W.Oc(c[f],k)}e.Aa=!0};a.eI=function(a){var b=Y(a,W.jt);a=Y(a,W.dp);
if(!b||!a)return null;var c={};c.key=b.Mt;c.edge_lum=b.Lt;c.blur=a.jn;return c};a.iL=sa;a.sI=function(a){a=Y(a,W.kp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.vL=za;a.aJ=function(a){var b=ma(a);a=Oa.length(b);if(0==a)return null;var b=Ba.df(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.JX=
function(a){a.s.TB=!0};a.YI=X;a.XI=function(a,b){var c=a.s.Jc,e=Y(a,W.Pb);e&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,e.mi&&(b.water_fog_density=e.mi[3],c=b.water_fog_color=[],c[0]=e.mi[0],c[1]=e.mi[1],c[2]=e.mi[2]))};a.NL=function(a,b){var c=a.s.Jc;if(!c)return Pa.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Gq=b.water_dynamic);for(var e=S(a,kc),d=0;d<e.length;d++){var f=e[d];"number"==typeof b.water_fog_density&&c.xe&&(f.mi[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.xe&&f.mi.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.$D=b.waves_height);"number"==typeof b.waves_length&&(f.aE=b.waves_length);f.Aa=!0}};a.LI=
function(a,b,c){var e=a.s.Jc;if(!e.Ek)return 100;var d=e.GB;a=e.Xk;var f=(b[0]-e.xo[0])/e.yo[0],h=(e.xo[1]+b[1])/e.yo[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)b=1;else return e=d*Ba.cI(bb.s.fD,e.gD,f,h),b=(a-b[2])*c,b=Math.sqrt(e*e+b*b)};a.update=function(a,b){for(var c=d().wj.k,e=0;e<Ua.length;e++){var f=Ua[e],h=f.s.Wa,k=f.s;if(k.Jc)var l=Ca.F(c.n),g=l[2]-X(f,l[0],l[1]);for(l=0;l<k.$o.length;l++){var m=k.$o[l].s,u=m.Sa,q=m.ud;if(!(f.b4w_use_nla&&m.Qk||!u&&!q)&&Qa.AN(m)){var n=Qa.xN(m),y=Qa.zN(m);u&&
Aa.is_mobile_device&&(y-=5);var w=Qa.q_(m);n>=w&&m.pj||n<y?(Qa.ZK(m),q&&(m.Ak=Qa.Aw(m,a))):n>=w&&!m.pj?Qa.gC(m):Qa.BN(m)&&(u?Qa.eN(m):(u=Qa.Aw(m,a),u!=m.Ak&&(Qa.dN(m),m.fj++),m.Ak=u))}}ra.oa(h,function(b,c){-1<ib.indexOf(c.type)&&(c.time=a);k.Jc&&(c.Az=g)})}for(e=0;e<Ua.length;e++)if(f=Ua[e],k=f.s,h=k.Wa,c=k.xm,c.length)for(k.Wv&&(aa(f),k.Wv=!1),k.TB&&(la(f),k.TB=!1),k.UB&&(v(f),k.UB=!1),k.motion_blur&&z(h,b),f=ia.ec(h,W.yg),l=0;l<c.length;l++)h=c[l],ga.ow(h),f&&ta(h,f),Sa.vn(h);Aa.show_hud_debug_info&&
wa.zY(Ua,b)};a.AX=function(a){a.s.UB=!0};a.JA=function(a){var b=[];ra.oa(a.s.Wa,function(a,c){b.push(c)});return b};a.gI=function(){var a=Y(bb,W.Lc),b=bb;return a||b.s.Jc?a.Az:null};a.cN=function(a){ra.oa(a.s.Wa,function(a,b){b.Aa=!0})};a.RX=function(a,b){a.debug_view_mode=b;a.ac=b!=Ra.Ws;a.Kb=b==Ra.Xs;a.Aa=!0;for(var c=d(),e=0;e<kc.length;e++){var f=Y(c,kc[e]);f&&(f.sA=b==Ra.jp)}};a.QX=function(a,b){a.debug_colors_seed=b;a.Aa=!0};a.iY=function(a,b){a.pH=b;a.Aa=!0};a.tY=function(a,b){for(var c=a.Ra,
e=0;e<c.length;e++)for(var d=c[e].ra,f=0;f<d.length;f++){var h=d[f].za;Oa.copy(b,h.wireframe_edge_color);h.Aa=!0}};a.YM=function(a,b){var c=b.yn,e=a.s.tj;if(c&&"WIND"==c.type&&e){Oa.transformQuat(Ba.ad,Ca.R(b.k.n),e);Oa.normalize(e,e);Oa.scale(e,c.rM,e);for(var c=S(a,ib),d=0;d<c.length;d++)c[d].tj.set(e);return!0}return!1};a.UW=function(a,b,c){var e=Y(a,W.pf);if(e){var d=Da.Fn();na.PX(e.p,b,c,d.clientWidth,d.clientHeight);ga.ow(e);e.ac&&Sa.vn(e);if(a=Y(a,W.qi))xa.copy(e.p.wb,a.p.wb),xa.copy(e.p.md,
a.p.md),Ba.xn(a.p.md,a.p.Lh),ga.ow(a),a.ac&&Sa.vn(a);if(e.ac||a&&a.ac)return Sa.vC(a?a.p.Ve:e.p.Ve,0,0)}else Pa.error("Object Selection is not available on the scene");return null};a.BL=function(a){var b=d();if(b=Y(b,W.Ym))b.bj.set(a),b.Aa=!0};a.f5=ma;a.Vl=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.XM=function(a,b){var c=Nb;Oa.negate(b,c);for(var e=0;6>e;e++){var d=a.Dl[e],f=a.vq[e],h=a.p;xa.translate(Ba.VN[e],
c,d);xa.multiply(h.wb,d,h.md);Ba.xn(h.md,f)}};a.aN=function(a,b,c){Ba.lZ(b,c,Ba.ad,a.p.mc)};a.JQ=function(a,b,c){var e=a.s.wd,d=a.s.$h;c=da.Su(c,Aa.ssao&&a.b4w_enable_ssao);if(d)for(var f=0;f<b.length;f++){var h=b[f],k=da.ja(h,a);if(-1!=h.k.Ed){var l=d.Xh,g=d.mw,h=h.k.Ed;g.length?k.Xh=g[h]:l.length&&(k.Xh=l[h])}else-1!=h.k.Rd&&(l=d.Ei,g=d.gA,h=h.k.Rd,g.length?k.Ei=g[h]:l.length&&(k.Ei=l[h]))}for(f=0;f<c.length;f++)if(k=da.ja(c[f],a),e)for(b=S(a,[W.dd]),d=0;d<b.length;d++)f==b[d].nh&&k.eD.push(b[d])};
a.UJ=function(a,b){return a.timeline_markers[b]};a.Gw=function(a){var b=d();if(b=Y(b,W.ti))a.distortion_coefs&&(b.Hl[0]=a.distortion_coefs[0],b.Hl[1]=a.distortion_coefs[1],b.Aa=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Aa=!0),a.base_line_factor&&(b.Hl[2]=
a.base_line_factor,b.Aa=!0),a.inter_lens_factor&&(b.Hl[3]=a.inter_lens_factor,b.Aa=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Aa=!0)};a.bK=function(b,c){for(var e=Ua,d=0;d<e.length;d++)ia.GW(a.RA(e[d]),b,c)};a.I8=function(a){for(var b=Na.jc(a,"LAMP",Na.Dc),c=S(a,Za),e=0;e<c.length;e++)for(var d=c[e],f=d.Ra,h=0;h<f.length;h++)for(var k=f[h].ra,l=0;l<k.length;l++){var g=k[l],m=g.za;"MAIN"==m.type&&(ea.yZ(m,b,a),ea.Xc(m),W.Oc(d,g))}};a.A6=function(a){for(var b=0;b<Ua.length;b++)ra.oa(Ua[b].s.Wa,
function(b,c){for(var e=c.Ra,d=0;d<e.length;d++)for(var f=e[d].ra,h=0;h<f.length;h++){var k=f[h];k.za==a&&W.Oc(c,k)}})}};b4w.module.__hud=function(a,r){function n(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var d=0,h=0,l=0;m.oa(a.s.Wa,function(a,g){if(g.type!=x.bn){for(var m=Math.round(g.p.width)+"x"+Math.round(g.p.height),n=0,w=0;w<g.Ra.length;w++)n+=g.Ra[w].ra.length;w=g.xq;if(g.type==x.nd||g.type==x.Ke)n*=6;var p=g.ac,t=p?g.xf:0;g.Ud||(g.xf=0);var c=
p?" (\u2713)":" (\u2715)",k=x.pD(g);b(c,k,g.$v,m,w,"of",n,"  ",t.toFixed(3));g.xq=0;p&&(d+=n,h+=w,l+=t)}});return[d,h,l]}b("No INFO")}function b(){for(var a=80+20*h[0],b=arguments[0],d=1;d<arguments.length;d++){for(var m="",n=0;n<g[d]-String(arguments[d]).length;n++)m+=" ";b+=m+arguments[d]}h[0]++;l.fillText(b,30,a)}function t(a,b,d){b*=a.oc;d.x=a.x+b;d.y=a.y;d.oc=a.oc-2*b;d.Hb=a.Hb}function p(a){return a.x+a.oc/2}function B(a){var b=l,d={x:0,y:0,oc:0,Hb:0},h=b.canvas.width,b=b.canvas.height;d.x=
0;d.y=0;d.oc=h;d.Hb=b;t(d,.01,d);h=.02*d.Hb;d.x=d.x;d.y+=h;d.oc=d.oc;d.Hb-=2*h;h=d.oc/8;d.x+=h*a;d.y=d.y;d.oc=h;d.Hb=d.Hb;t(d,.02,d);return d}var m=r("__graph");r("__print");var x=r("__subscene"),g=[5,30,4,10,5,3,5],l=null,h=[0,0];a.Ug=function(a){a=a.getContext("2d");n(a);return l=a};a.xs=function(){l&&n(l)};a.reset=function(){var a=l;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),h[0]=0,h[1]=0)};a.zY=function(a,f){var g=
l;if(g){g.textAlign="left";g.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/f).toFixed(2));h[0]++;for(var m=g=0,n=0,p=0;p<a.length;p++){var x=d(a[p]),g=g+x[0],m=m+x[1],n=n+x[2];h[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",m,"of",g,"  ",n.toFixed(3))}};a.print=function(){var a=l;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.z6=function(a,b,d,h,g,m,n){var x=l;if(x){b=B(b);var t=b.Hb/5;b.x=b.x;b.y+=4*t;b.oc=
b.oc;b.Hb=t;x.textAlign="center";x.fillStyle="#00FF00";l.fillText(a,p(b),b.y-10);x.strokeStyle="#00FF00";x.lineWidth=.5;x.beginPath();x.moveTo(b.x,b.y);x.lineTo(b.x+b.oc,b.y);x.lineTo(b.x+b.oc,b.y+b.Hb);x.lineTo(b.x,b.y+b.Hb);x.closePath();x.stroke();if(!m&&!n)for(m=1E6,n=-1E6,a=0;a<d.length;a++)m=Math.min(m,d[a]),n=Math.max(n,d[a]);x.textAlign="right";l.fillText(String(m),b.x-10,b.y+b.Hb);l.fillText(String(n),b.x-10,b.y);x.textAlign="center";l.fillText(String(h),b.x,b.y+b.Hb+15);l.fillText(String(g),
b.x+b.oc,b.y+b.Hb+15);x.strokeStyle="#FF0000";x.lineWidth=1.5;x.beginPath();h=b.oc/(d.length-1);n=b.Hb/(n-m);for(a=0;a<d.length;a++)g=b.x+h*a,t=b.y+b.Hb-(d[a]-m)*n,0==a?x.moveTo(g,t):x.lineTo(g,t);x.stroke()}};a.U2=function(a,b,d,h,g,m,n){var x=l;if(x)for(x.textAlign="center",x.fillStyle="#00FF00",x.font="bold 12px Courier",d=B(d),l.fillText(b?"["+a+"]":a,p(d),d.y),0<=m&&l.fillText(m?"[M]":"[ ]",p(d)-15,d.y+30),0<=n&&l.fillText(n?"[S]":"[ ]",p(d)+15,d.y+30),a={x:0,y:0,oc:0,Hb:0},b=0;b<h.length;b++){m=
h[b];var t="VOLUME"==m[0];if(t){n=d.y+350;var r=d.oc,E=a;E.x=d.x;E.y=n;E.oc=r;E.Hb=250}else{n=d.y+50+50*b;var r=d.oc,E=d.Hb,c=a;c.x=d.x;c.y=n;c.oc=r;c.Hb=E}n=x;var r=a,c=b==g,k=m[0],E=m[1],y=m[2],A=m[3],e=(A-y)/m[4],e=1>e?Math.floor(1/e-1E-5).toFixed(0).length:0;m=m[5]?Math.log(E/y)/Math.log(A/y):(E-y)/(A-y);n.textAlign="center";c?n.fillText("["+k+"]",p(r),r.y):n.fillText(k,p(r),r.y);n.strokeStyle="#00FF00";n.lineWidth=t?3:1;t?(n.textAlign="right",n.fillText(A.toFixed(e),p(r)-10,r.y+15),n.textAlign=
"right",n.fillText(y.toFixed(e),p(r)-10,r.y+r.Hb-15)):(n.textAlign="right",n.fillText(y.toFixed(e),r.x+28,r.y+15),n.textAlign="left",n.fillText(A.toFixed(e),r.x+r.oc-28,r.y+15));n.beginPath();if(t){var R=r.y+15+(r.Hb-30)*(1-m);n.moveTo(p(r),r.y+15);n.lineTo(p(r),r.y+r.Hb-15);n.moveTo(p(r)-5,r.y+15);n.lineTo(p(r)+5,r.y+15);n.moveTo(p(r)-5,r.y+r.Hb-15);n.lineTo(p(r)+5,r.y+r.Hb-15);n.moveTo(p(r)-5,R);n.lineTo(p(r)+5,R)}else{var q=r.x+30+(r.oc-60)*m;n.moveTo(r.x+30,r.y+15);n.lineTo(r.x+r.oc-30,r.y+15);
n.moveTo(r.x+30,r.y+15-5);n.lineTo(r.x+30,r.y+15+5);n.moveTo(r.x+r.oc-30,r.y+15-5);n.lineTo(r.x+r.oc-30,r.y+15+5);n.moveTo(q,r.y+15-5);n.lineTo(q,r.y+15+5)}n.stroke();"EQ_Q"==k?(m=Math.log(1+1/(2*E*E)+Math.sqrt((2+1/(E*E))*(2+1/(E*E))/4-1))/Math.log(2),t?(n.textAlign="left",n.fillText(E.toFixed(e),p(r)+10,R),n.textAlign="left",n.fillText("("+m.toFixed(e+1)+")",p(r)+10,R+10)):(n.textAlign="right",n.fillText(E.toFixed(e),q,r.y+30),n.textAlign="left",n.fillText("("+m.toFixed(e+1)+")",q,r.y+30))):t?(n.textAlign=
"left",n.fillText(E.toFixed(e),p(r)+10,R)):(n.textAlign="center",n.fillText(E.toFixed(e),q,r.y+30))}}};b4w.module.__subscene=function(a,r){function n(a,b){a.$v=b;a.xB=new Float32Array(3*b);a.yr=new Float32Array(4*b);a.xr=new Float32Array(4*b)}function d(a){a={type:a,Eb:"",Kb:!1,sK:!1,jz:!1,Vv:!1,xq:0,xf:0,El:[],debug_view_mode:0,debug_colors_seed:0,pH:1,sA:!1,time:0,p:null,Dl:null,vq:[],Ra:[],Ya:[],hi:[],tj:new Float32Array(3),ge:new Float32Array(3),xe:new Float32Array(4),Yf:new Float32Array(4),ue:new Float32Array(16),Uw:0,Og:0,$v:0,xB:null,yr:null,xr:null,T5:null,he:new Float32Array(3),pe:new Float32Array(3),
Vw:new Float32Array(4),wM:new Float32Array(3),qD:new Float32Array([0,0,1]),xM:new Float32Array(4),Tw:new Float32Array(3),Ir:0,uA:0,mr:!1,bj:new Float32Array(3),sj:!1,Az:0,mi:null,$D:0,aE:0,Xk:0,Jc:null,Gg:!1,jG:0,kG:new Float32Array(2),iG:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Ao:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,Go:0,Fo:0,Eo:0,lM:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Wn:0,tw:0,Ko:0,fA:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,px:null,ox:null,VD:null,sm:null,uc:!1,OH:"",Mt:0,jn:0,Lt:0,oz:0,zA:0,mb_decay_threshold:0,mb_factor:0,$J:0,nw:"",EG:"",MV:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,AD:new Float32Array(2),Fb:new Float32Array(2),
Hl:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,nh:0,SB:!0,aM:!1,fM:!1,bM:!1,cM:!1,eM:!1,dM:!1,$L:"",Fs:!1,Gs:!1,Hs:!1,ac:!0,Ud:!0,vb:!0,Ab:!0,Sd:!0,Aa:!0,rg:1};a.Fb[0]=1;a.Fb[1]=1;a.Hl[2]=.5;a.Hl[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function t(a,d){return-b(a.Ag,d.Ag)||b(a.kg,d.kg)||b(a.yb.dD,d.yb.dD)}var p=r("__camera"),B=r("__config"),m=r("__util"),x=r("__boundings"),g=B.Uc;a.Pb=0;a.Lc=1;a.Pf=2;a.Nd=3;a.nd=4;a.sf=5;a.Ke=6;a.ee=7;a.dd=
8;a.tf=9;a.ri=10;a.dc=11;a.ep=12;a.kp=13;a.an=14;a.pf=15;a.qi=16;a.rf=17;a.Um=18;a.nE=19;a.rt=20;a.Vy=21;a.gE=22;a.vp=23;a.pt=24;a.Ty=25;a.qt=26;a.Nx=27;a.vh=28;a.Mx=29;a.ip=30;a.yg=31;a.Ym=32;a.vj=33;a.et=34;a.zg=35;a.Ox=36;a.ti=37;a.LUMINANCE=38;a.JN=39;a.jt=40;a.dp=41;a.NP=42;a.bn=43;a.qp=44;a.YS=function(a,b,g,f){var C=d(8);C.fA=a;C.self_shadow_polygon_offset=g.self_shadow_polygon_offset;C.nh=b;switch(g.Xg[b]){case "SPOT":case "POINT":C.p=p.hd(p.Od);a=m.df(g.kM[b]);p.Fw(C.p,a,g.dq[b],g.cq[b]);
break;default:C.p=p.hd(p.ui)}n(C,f);return C};a.YR=function(a){var b=a.p;a.p=null;var d=m.P(a);a.p=b;d.p=p.Fc(b,!0);return d};a.RS=function(){var a=d(10);a.p=p.hd(p.xh);return a};a.Ad=function(a){var b=d(11);b.vb=!1;b.Ab=!1;b.Sd=!1;b.uc=!0;b.p=p.hd(p.qd);b.nw=a;switch(a){case "NONE":b.Fb[0]=1;b.Fb[1]=1;break;case "GRAYSCALE":b.Fb[0]=1;b.Fb[1]=1;break;case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=0;b.Fb[1]=1;break;case "X_GLOW_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_GLOW_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;case "X_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "Y_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "X_ALPHA_BLUR":b.Fb[0]=1;b.Fb[1]=0;b.rg=3;break;case "Y_ALPHA_BLUR":b.Fb[0]=0;b.Fb[1]=1;b.rg=3;break;case "X_EXTEND":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_EXTEND":b.Fb[0]=0;b.Fb[1]=1;break;default:m.q("Wrong postprocessing effect: "+a)}return b};a.$G=function(a){var b=d(12);b.vb=!1;b.Ab=!1;b.Sd=!1;b.p=p.hd(p.qd);b.nw=a;b.uc=!0;switch(a){case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;default:m.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.PS=function(a,b){var g=d(13);g.vb=!1;g.Ab=!1;g.Sd=!1;g.small_glow_mask_coeff=b.Uj.small_glow_mask_coeff;g.large_glow_mask_coeff=b.Uj.large_glow_mask_coeff;g.small_glow_mask_width=b.Uj.small_glow_mask_width;g.large_glow_mask_width=b.Uj.large_glow_mask_width;g.p=a;g.uc=!0;return g};a.Bl=function(a,b,g,f,p,x,t,r,B){var N=d(a);0==a?(N.vb=!0,N.Ab=g,N.Kb=!1):1==a?(N.vb=!1,N.Ab=!1,N.Kb=!0):2==a?(N.vb=!1,N.Ab=!0,N.Kb=
!0):3==a||4==a?(N.vb=!0,N.Ab=!0,N.Kb=!1):5==a||6==a?(N.vb=!1,N.Ab=!1,N.Kb=!0):7==a?(N.vb=!0,N.Ab=!1,N.Kb=!0):m.q("wrong main subscene type");N.Kb&&r&&(N.self_shadow_normal_offset=r.self_shadow_normal_offset);N.p=b;if(a=t.Bo)N.Vw.set([a.ZF,a.jJ,a.HN,a.GN]),N.Tw.set(a.color),N.Uw=a.Da;N.he.set(t.he);N.pe.set(t.pe);N.Og=t.Og;N.xe=x.xe;N.Yf=x.Yf;f&&(N.Jc=f,f.xe&&(N.mi=new Float32Array(f.xe)),N.$D=f.waves_height,N.aE=f.waves_length,N.Xk=f.Xk,f.Gg&&B&&(N.Gg=!0,N.jG=f.uR,N.iG=f.tR,N.kG.set(f.vR)));n(N,p);
return N};a.fu=function(){var a=d(14);a.uc=!0;a.p=p.hd(p.qd);return a};a.aH=function(a,b,g){var f=d(15);b&&(f.type=16,f.vb=!1,f.Ab=!0);f.Ud=!1;f.p=a;n(f,g);return f};a.NS=function(a){var b=d(17);b.ac=!1;b.vb=!1;b.Ab=!1;b.p=a;return b};a.JS=function(a){var b=d(18);b.vb=!0;b.Ab=!1;b.p=a;return b};a.ZS=function(a,b){var g=d(9);g.p=a;n(g,b);return g};a.OS=function(a){var b=d(19);b.vb=!1;b.Ab=!1;b.p=a;b.uc=!0;return b};a.aT=function(a,b,g){var f=d(20);f.vb=!1;f.Ab=!1;f.Sd=!1;f.p=a;f.xe=b.xe;f.mi=new Float32Array(b.xe);
f.Go=g.radius_increase;f.ssao_hemisphere=g.oV;f.Fo=g.influence;f.Eo=g.dist_factor;f.lM=g.IX;f.uc=!0;return f};a.bT=function(a,b){var g=d(21);g.vb=!1;g.Ab=!1;g.Sd=!1;g.p=a;g.ssao_blur_depth=b.YQ;g.ssao_blur_discard_value=b.bG;g.uc=!0;return g};a.IS=function(a){var b=d(22);b.vb=!1;b.Ab=!1;b.Sd=!1;b.rg=1/a.no;b.OH=a.oF;b.p=p.hd(p.qd);b.uc=!0;return b};a.dA=function(a,b){var g=d(a);g.vb=23==a||24==a?!0:!1;g.Ab=!1;g.Sd=!1;g.rg=1/b.no;g.p=p.hd(p.qd);23==a&&(g.NV=new Float32Array(4));g.uc=!0;return g};a.MS=
function(a,b,g,f){var m=d(27);m.vb=!1;m.Ab=!1;m.Sd=!1;m.p=p.hd(p.qd);m.brightness=a;m.contrast=b;m.exposure=g;m.saturation=f;m.uc=!0;return m};a.US=function(a,b){var g=d(28);g.vb=!1;g.Ab=!1;g.Sd=!1;g.p=p.hd(p.qd);g.jz=!0;g.mb_decay_threshold=a;g.mb_factor=b;g.uc=!0;return g};a.aA=function(a,b){var g=d(29);g.vb=!1;g.Ab=!1;g.Sd=!1;g.p=a;g.rg=g.p.dof_power;g.EG=b;g.uc=!0;return g};a.bH=function(a){var b=d(30);b.vb=!1;b.Ab=!1;b.Sd=!1;b.p=a;b.rg=b.p.dof_power;b.uc=!0;return b};a.WS=function(a,b){var g=
d(31);g.Sd=!1;g.p=a;n(g,b);return g};a.VS=function(a){var b=d(32);g.outlining_overview_mode?b.bj.set(g.bj):b.bj.set(a.bj);b.Ir=a.Ir;b.zA=5;b.oz=3;b.Sd=!1;b.p=p.hd(p.qd);b.uc=!0;return b};a.cA=function(a,b,g,f,m,p,x){var t=d(33);t.vb=!1;t.Ab=!1;t.Sd=!1;t.he=new Float32Array([1,1,1]);t.pe=new Float32Array([1,1,1]);t.Og=1;t.sK=f;t.sj=b;t.tw=m;t.Wn=g;t.Ko=x;t.p=a;n(t,p);return t};a.QS=function(a,b){var g=d(34);g.vb=!1;g.Ab=!1;g.Sd=!1;g.p=p.hd(p.qd);g.god_rays_intensity=a;n(g,b);g.uc=!0;return g};a.$S=
function(a,b,g,f){var x=d(35);x.Ud=!1;x.vb=!1;x.Ab=!1;x.Sd=!1;var t=p.hd(p.qd);t.width=f;t.height=f;x.p=t;x.Dl=m.rU();n(x,b);x.he=new Float32Array([1,1,1]);x.pe=new Float32Array([1,1,1]);x.Og=1;x.Ao.set(g.Ao);x.procedural_skydome=g.procedural_skydome;x.use_as_environment_lighting=g.use_as_environment_lighting;x.rayleigh_brightness=g.rayleigh_brightness;x.mie_brightness=g.mie_brightness;x.spot_brightness=g.spot_brightness;x.scatter_strength=g.scatter_strength;x.rayleigh_strength=g.rayleigh_strength;
x.mie_strength=g.mie_strength;x.rayleigh_collection_power=g.rayleigh_collection_power;x.mie_collection_power=g.mie_collection_power;x.mie_distribution=g.mie_distribution;if(a){x.he.set(a.he);x.pe.set(a.pe);x.Og=a.Og;if(b=a.Bo)x.Vw.set([b.ZF,b.jJ,b.HN,b.GN]),x.Tw.set(b.color),x.Uw=b.Da,x.aM=b.invert,x.fM=b.mN,x.bM=b.hN,x.cM=b.iN,x.eM=b.kN,x.dM=b.jN,x.$L=b.$F;x.Fs=a.Fs;x.Gs=a.Gs;x.Hs=a.Hs}return x};a.bA=function(){var a=d(36);a.vb=!1;a.Ab=!1;a.p=p.hd(p.qd);a.uc=!0;return a};a.cT=function(a){var b=d(37);
b.vb=!1;b.Ab=!1;b.Eb=a?"HMD":"ANAGLYPH";b.p=p.hd(p.qd);b.uc=!0;return b};a.SS=function(){var a=d(38);a.vb=!1;a.Ab=!1;a.p=p.hd(p.qd);a.uc=!0;return a};a.KS=function(){var a=d(39);a.vb=!1;a.Ab=!1;a.p=p.hd(p.qd);a.uc=!0;return a};a.TS=function(a,b,g,f){var m=d(40);m.vb=!1;m.Ab=!1;m.Mt=a;m.Lt=b;m.p=f;n(m,g);m.uc=!0;return m};a.LS=function(a){var b=d(41);b.vb=!1;b.Ab=!1;b.p=p.hd(p.qd);b.jn=a;b.uc=!0;return b};a.I2=function(a){var b=d(42);b.vb=!1;b.Ab=!1;b.p=a;b.uc=!0;return b};a.cH=function(){var a=d(43);
a.Ud=!1;return a};a.XS=function(){var a=d(44);a.uc=!0;return a};a.pD=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.nw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Oc=function(a,b){for(var d=b.za,f=d.yb,g=0;g<a.Ra.length;g++){var m=a.Ra[g].ra,n=m.indexOf(b);
-1!=n&&(m.splice(n,1),m.length||a.Ra.splice(g,1))}g=a.Kb?d.kg:0;a:{m=a.Ra;for(n=0;n<m.length;n++){var p=m[n];if(p.yb==f&&g==p.kg){m=p;break a}}m=null}m?m.ra.push(b):(a.Ra.push({yb:f,ra:[b],Ag:d.Ag,kg:g,ac:!0}),a.SB=!0)};a.Qh=function(a,b){var d={ac:!0,tA:[!0,!0,!0,!0,!0,!0],bf:b,za:a,qv:null};if(a.of&&a.Ba.ie){var f=a.Ba.ie;d.qv={AW:new Float32Array(f.length),BW:new Float32Array(f.length),wT:new Float32Array(f.length/3),IN:new Float32Array(3),SQ:x.jR(a.O)}}return d};a.HY=function(a){a.Ra.sort(t);
a.SB=!1}};b4w.module.__input=function(a,r){function n(a){var b=V.qu();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function d(a,b){if(!n(a))return null;var c={type:a,kh:!1,lg:[],fh:[],Wi:[],$d:[],Xi:[],Yi:[],sr:[],GJ:[],Si:[],oj:[],nj:[],mj:[],element:b,Yh:!0,Vb:[],Uv:new Float32Array(2),FW:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),bp:null,ni:null,Of:null,orientation:fa.create(),position:H.create(),
Ji:new Float32Array(4),Ki:new Float32Array(4),Qi:0,Bj:0,xk:0,Sm:0,Wj:0,Cj:0,Ql:[],Sj:[0,0,0,0,0,0,0,0,0,0,0,0],PH:[0,0,0,0,0,0,0,0,0,0,0,0],Fu:[]};c.Ji[0]=c.Ji[1]=c.Ji[2]=c.Ji[3]=45;c.Ki[0]=c.Ki[1]=c.Ki[2]=c.Ki[3]=45;30==a||40==a||50==a?(c.kh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Yh=!1)):10==a?c.kh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ha.is_mobile_device?p(c,u.webvr):(t(c),c.kh=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:U.We());for(var e=0;e<za.length;e++)if(za[e].type==b&&za[e].element==c)return za[e];e=d(b,c);60!=b&&70!=b&&80!=b&&90!=b||e.Fu.push(a.jy,a.ky,a.vy,a.Cy,a.Dy,a.Ey,a.bt,a.dt,a.Fy,a.Gy,a.ly,a.my,a.ny,a.oy,a.py,a.qy,a.ry,a.sy,a.ty,a.uy,a.wy,a.xy,a.yy,a.zy,a.Ay,a.By,a.Ys,a.Zs,a.$s,a.at,a.dy,a.ey,a.fy,a.gy,a.hy,a.iy,a.by,a.cy);e&&za.push(e);return e}function t(a){var b=u.nonwebvr;a.Sm=b.Sm;a.Wj=b.Wj;a.Cj=b.Cj;p(a,b);a.Qi=b.Qi;a.Bj=b.Bj;a.xk=b.xk;m(a)}function p(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function B(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function m(a){var b=a.Bj-a.Cj,c=a.Wj-b,e=a.Qi/2,d=(a.Sm-a.Qi)/2,b=M.df(Math.atan(b/a.xk)),c=M.df(Math.atan(c/a.xk)),e=M.df(Math.atan(e/
a.xk)),d=M.df(Math.atan(d/a.xk));c&&(a.Ji[0]=a.Ki[0]=Math.min(c,60));e&&(a.Ji[1]=a.Ki[3]=Math.min(e,60));b&&(a.Ji[2]=a.Ki[2]=Math.min(b,60));d&&(a.Ji[3]=a.Ki[1]=Math.min(d,60))}function x(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),e=null;c.length&&(e=c[0]);c=null;e&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==e.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.bp=e;a.ni=c}function g(a,b,c){switch(a.type){case 20:var e=
a.Of||a.bp;e?(b=e.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,e=B(a,Math.tan(M.Lb(b.downDegrees))),M.df(Math.atan(e)),e=B(a,Math.tan(M.Lb(b.upDegrees))),M.df(Math.atan(e)),e=B(a,Math.tan(M.Lb(b.leftDegrees))),M.df(Math.atan(e)),a=B(a,Math.tan(M.Lb(b.rightDegrees))),M.df(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Ji:a.Ki,Z.copy(b,c));break;default:v.error("fov is undefined for device: ",a.type)}return c}
function l(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ha.is_mobile_device?1:0:2;case 23:var c=a.Of||a.bp;if(c){var e=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.Of?c.offset[0]-e.offset[0]:c.eyeTranslation.x-e.eyeTranslation.x}return a.Qi}}function h(a,b){if(a.Of){var c=a.Of,e=c.capabilities,c=c.getPose();e.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);e.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-ua&&(ua=b,navigator.getVRDisplays?a.Of||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Of=b[0],a.kh=!0)},function(){v.N("WebVR displays are not found.");a.kh=!1}):navigator.getVRDevices?a.bp||pa||navigator.getVRDevices().then(function(b){x(a,b);b.length&&(a.kh=!0);pa=!0},function(){v.N("WebVR devices are not found.");a.kh=!1;pa=!0}):ha.is_mobile_device||
v.N("HMD isn't supported."))}function w(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Ql[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.Sj[c]=a.axes[c]}}function f(a){for(var b=0;b<a.Ql;b++)a.Ql[b]=0;for(b=0;b<a.Sj.length;b++)a.PH[b]=a.Sj[b],a.Sj[b]=0}function C(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function K(a){return null===a}function G(a,b,d,f){switch(b){case 120:d&&C(a.lg,d);if(f||a.fh.every(K)&&a.lg.every(K))a.lg.length=0,a.fh.length=0,b=a.Vb.indexOf(131),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("deviceorientation",D,!1));break;case 130:d&&C(a.fh,d);if(f||a.fh.every(K)&&a.lg.every(K))a.lg.length=0,a.fh.length=0,b=a.Vb.indexOf(131),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:d&&C(a.Wi,d);if(f||a.Wi.every(K))a.Wi.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mousedown",E,!1));break;case 30:d&&C(a.$d,d);if(f||a.$d.every(K))a.$d.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("mousemove",I,!1));break;case 31:d&&C(a.$d,d);if(f||a.$d.every(K))a.$d.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mousemove",O,!1));break;case 50:d&&C(a.Xi,d);if(f||a.Xi.every(K)){a.Xi.length=0;b=a.Vb.indexOf(b);0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mouseout",c,!1),a.element.removeEventListener("mouseup",k,!1));break}break;case 60:d&&C(a.Yi,d);if(f||a.Yi.every(K))a.Yi.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("wheel",y,!1));break;case 80:d&&C(a.sr,d);if(f||a.sr.every(K))a.sr.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("keydown",A,!1));break;case 70:d&&C(a.Si,d);if(f||a.Si.every(K))a.Si.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("keyup",e,!1));break;case 90:d&&C(a.oj,d);if(f||a.oj.every(K))a.oj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchstart",R,!1));break;
case 100:d&&C(a.nj,d);if(f||a.nj.every(K))a.nj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchmove",q,!1));break;case 110:if(d&&C(a.mj,d),f||a.mj.every(K))a.mj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchend",ba,!1))}}function L(a,b){M.$B(a,M.Yy,b);var c="orientation"in window?M.Lb(window.orientation):"orientation"in window.screen?M.Lb(window.screen.orientation.angle):0,c=fa.setAxisAngle(M.$c,c,ca);fa.multiply(b,c,
b);return b}function D(a){var c=ja;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=M.Lb(a.alpha),c[1]=M.Lb(a.beta),c[2]=M.Lb(a.gamma));a=b(10,a.currentTarget);for(var e=0;e<a.fh.length;e++){var d=a.fh[e];d&&(H.copy(c,Y),d(Y))}if(a.lg.length)for(c=L(c,Q),e=0;e<a.lg.length;e++)if(d=a.lg[e])fa.copy(c,qa),d(qa);for(e=0;e<a.lg.length;e++)a.lg[e]||a.lg.splice(e,1);for(e=0;e<a.fh.length;e++)a.fh[e]||a.fh.splice(e,1)}function N(a,b){switch(a.type){case 30:a.Uv[0]=b.clientX,a.Uv[1]=b.clientY,
a.FW=b.which}}function I(a){if(!sa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);N(c,a);for(var e=0;e<c.$d.length;e++){var d=c.$d[e];d&&(S[0]=a.clientX,S[1]=a.clientY,d(S))}c.Yh&&a.preventDefault();for(e=0;e<c.$d.length;e++)c.$d[e]||c.$d.splice(e,1)}}function O(a){if(!sa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);N(c,a);for(var e=0;e<c.$d.length;e++){var d=c.$d[e];
if(d){if("number"==typeof a.movementX)var f=a.movementX,k=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,k=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,k=a.mozMovementY):k=f=0;S[0]=f;S[1]=k;d(S)}}c.Yh&&a.preventDefault();for(e=0;e<c.$d.length;e++)c.$d[e]||c.$d.splice(e,1)}}function E(a){if(!sa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);N(c,a);for(var e=0;e<c.Wi.length;e++){var d=
c.Wi[e];d&&d(a.which)}c.Yh&&a.preventDefault();for(e=0;e<c.Wi.length;e++)c.Wi[e]||c.Wi.splice(e,1)}}function c(a){!U.uJ(a.relatedTarget)&&a.which&&k(a)}function k(a){if(!sa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);N(c,a);for(var e=0;e<c.Xi.length;e++){var d=c.Xi[e];d&&d(a.which)}c.Yh&&a.preventDefault();for(e=0;e<c.Xi.length;e++)c.Xi[e]||c.Xi.splice(e,1)}}function y(a){for(var c=b(30,a.currentTarget),e=0;e<c.Yi.length;e++){var d=
c.Yi[e];d&&d(-a.deltaY)}c.Yh&&a.preventDefault();for(e=0;e<c.Yi.length;e++)c.Yi[e]||c.Yi.splice(e,1)}function A(a){for(var c=b(40,a.currentTarget),e=a.ctrlKey||a.altKey||a.metaKey?c.GJ:c.sr,d=0;d<e.length;d++){var f=e[d];f?f(a.keyCode):e.splice(d--,1)}c.Yh&&a.preventDefault()}function e(a){for(var c=b(40,a.currentTarget),e=0;e<c.Si.length;e++){var d=c.Si[e];d&&d(a.keyCode)}c.Yh&&a.preventDefault();for(e=0;e<c.Si.length;e++)c.Si[e]||c.Si.splice(e,1)}function R(a){for(var c=b(50,a.currentTarget),e=
0;e<c.oj.length;e++){var d=c.oj[e];d&&d(a.targetTouches)}for(e=0;e<c.oj.length;e++)c.oj[e]||c.oj.splice(e,1)}function q(a){for(var c=b(50,a.currentTarget),e=0;e<c.nj.length;e++){var d=c.nj[e];d&&d(a.targetTouches)}c.Yh&&a.preventDefault();for(e=0;e<c.nj.length;e++)c.nj[e]||c.nj.splice(e,1)}function ba(a){for(var c=b(50,a.currentTarget),e=0;e<c.mj.length;e++){var d=c.mj[e];d&&d(a.targetTouches)}for(e=0;e<c.mj.length;e++)c.mj[e]||c.mj.splice(e,1)}function J(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function F(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var e=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof e&&e.apply(c)}var V=r("__compat"),U=r("__container"),aa=r("__config"),v=r("__print"),fa=r("__quat"),M=r("__util"),H=r("__vec3"),Z=r("__vec4"),ha=aa.A,u=aa.qV;a.uh=10;a.Je=20;a.bd=30;a.gp=40;a.wg=50;a.Ts=60;a.Tx=70;a.Ux=80;a.Vx=90;a.pE=0;a.qE=1;a.oE=2;a.Oy=3;a.it=0;a.gt=10;a.ht=20;a.ON=21;a.PN=22;a.Ky=23;a.Jy=24;a.Hy=25;a.My=26;a.Ny=27;a.Ly=
28;a.Iy=29;a.si=30;a.CE=31;a.$k=40;a.op=50;a.pp=60;a.mp=70;a.lp=80;a.tE=81;a.el=90;a.wp=100;a.cl=110;a.ft=120;a.Xm=130;a.jy=300;a.ky=301;a.vy=302;a.Cy=303;a.Dy=304;a.Ey=305;a.bt=306;a.dt=307;a.Fy=308;a.Gy=309;a.ly=310;a.my=311;a.ny=312;a.oy=313;a.py=314;a.qy=315;a.ry=316;a.sy=317;a.ty=318;a.uy=319;a.wy=320;a.xy=321;a.yy=322;a.zy=323;a.Ay=324;a.By=325;a.Ys=326;a.Zs=327;a.$s=328;a.at=329;a.dy=330;a.ey=331;a.fy=332;a.gy=333;a.hy=334;a.iy=335;a.by=336;a.cy=337;var Q=fa.create(),ca=fa.create(),ja=H.create(),
ua=-Infinity,pa=!1,S=new Float32Array(2);H.create();var Y=H.create(),qa=fa.create(),sa="ontouchstart"in document.documentElement,za=[];a.Bz=n;a.ia=b;a.uD=function(a,b){a.Yh=b};a.CC=function(a){switch(a.type){case 20:if(a.kh)if(a.Of)a.Of.resetPose();else if(a.ni)for(var b=0;b<a.ni.length;b++)a.ni[b].resetSensor();break;default:v.error("reset_device() is undefined for device: ",a.type)}};a.Oi=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:H.copy(M.$m,c);if(a.Of)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.ni)for(b=0;b<a.ni.length;b++){var e=a.ni[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState();e.orientation&&(c[0]=e.orientation.x,c[1]=e.orientation.y,c[2]=e.orientation.z,c[3]=e.orientation.w)}fa.normalize(c,c);a=fa.setAxisAngle(M.oi,Math.PI/2,ca);fa.multiply(a,c,c);break a;default:v.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:H.copy(M.Xy,c);if(a.Of)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.ni)for(b=0;b<a.ni.length;b++)e=a.ni[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState(),e.position&&(c[0]=e.position.x,c[1]=-e.position.z,c[2]=e.position.y);break a;default:v.error("position is undefined for device: ",a.type)}return c;case 21:return g(a,"left",c);case 22:return g(a,"right",c);case 30:case 31:return c[0]=a.Uv[0],c[1]=a.Uv[1],c}};a.Uu=l;a.NC=function(a,b,c){switch(a.type){case 20:if(3===l(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Qi=c;m(a);break;case 25:a.Bj=c;m(a);break;case 26:a.xk=c;m(a);break;case 27:a.Sm=c;m(a);break;case 28:a.Wj=c;m(a);break;case 29:a.Cj=c,m(a)}break;case 60:case 70:case 80:case 90:a.Fu[b]=c}};a.UU=function(a,b){var c=b-300;return c<a.Ql.length?a.Ql[a.Fu[c]-300]:!1};a.TU=function(a,b){return b-326<a.Sj.length?a.Sj[a.Fu[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<za.length;c++){var e=za[c];switch(e.type){case 60:f(e);w(b[0],e);break;case 70:f(e);w(b[1],e);break;case 80:f(e);w(b[2],e);break;case 90:f(e);w(b[3],e);break;case 20:h(e,a)}}};a.yd=function(a,b,d){switch(b){case 120:a.lg.push(d);b=131;break;case 130:a.fh.push(d);b=131;break;case 40:a.Wi.push(d);break;case 30:case 31:a.$d.push(d);break;case 50:a.Xi.push(d);break;case 60:a.Yi.push(d);break;case 80:a.sr.push(d);break;case 81:a.GJ.push(d);b=80;break;case 70:a.Si.push(d);
break;case 90:a.oj.push(d);break;case 100:a.nj.push(d);break;case 110:a.mj.push(d)}if(-1==a.Vb.indexOf(b)&&(a.Vb.push(b),a.kh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",E,!1);break;case 30:a.element.addEventListener("mousemove",I,!1);break;case 31:a.element.addEventListener("mousemove",O,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",c,!1),a.element.addEventListener("mouseup",
k,!1));break;case 60:a.element.addEventListener("wheel",y,!1);break;case 80:a.element.addEventListener("keydown",A,!1);break;case 70:a.element.addEventListener("keyup",e,!1);break;case 90:a.element.addEventListener("touchstart",R,!1);break;case 100:a.element.addEventListener("touchmove",q,!1);break;case 110:a.element.addEventListener("touchend",ba,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.Bd=function(a,b,c){G(a,b,c,!1)};a.jV=L;a.sa=function(){for(var a=0;a<za.length;a++)for(var b=
za[a],c=0;c<b.Vb.length;c++)G(b,b.Vb[c],null,!0);za.length=0};a.DI=function(a){a=b(J(a));for(var c=0;c<a.Ql.length;c++)if(a.Ql[c])return c+300;return-1};a.wI=function(a){a=b(J(a));for(var c=0;c<a.Sj.length;c++)if(a.PH[c]-a.Sj[c])return c+326;return-1};a.pI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.ZI=function(){var a=b(20);return a&&a.Of};a.ZP=function(a){a.element.addEventListener("mousedown",
function(){a.value||F(a)},!1)}};b4w.module.__physics=function(a,r){function n(a,b){for(var c=a.Pe,e=0;e<c.length;e++)c[e].hh.As&&b.push(c[e]),n(c[e],b)}function d(a,b,c){for(var e=a.wc.ra,d=0;d<e.length;d++)for(var f=e[d].C,k=0;k<f.Oe.length;k++){var h=f.Oe[k];"ANY"!=h.$b&&c!=h.$b||N(h,a,b)}}function b(a,b,c){if(F.tv(a))switch(b){case F.dO:var e=t(a);e.wc.EN=!0;F.fa(a,F.oP,Date.now()-performance.now(),ca.max_fps,ca.wz?ja.KH:0);break;case F.eO:U.Zd("URANIUM:",c.slice(1));break;case F.$N:U.error(c);break;case F.aO:J.zu.apply(this,
c.slice(1));break;case F.jO:var d=p(c.ea);if(d){a=c.trans;e=c.quat;b=c.Sh;var f=c.Ah,d=d.C;d.ju=c.time;H.ci(a,1,e,d.iA);ha.copy(b,d.Sh);ha.copy(f,d.Ah)}break;case F.gO:(a=p(c.Cz))&&H.ci(c.trans,1,c.quat,a.v.Tr[c.pC]);break;case F.bO:if(e=p(c[1]))a=c[4],e=e.Xf.Nt[c[2]],M.Vc(e,c[3]),M.bi(e,a),M.D(e);break;case F.kO:if(d=p(c[1]))d.v.speed=c[2];break;case F.WN:e=t(a);B(e,c.ql,c.rl,c.result,null,null,0);break;case F.YN:e=t(a);B(e,c.ql,c.rl,c.result,c.yl,c.coll_norm,c.coll_dist);break;case F.XN:if(d=p(c[1]))a=
d.C,a.xl&&a.xl(c[2]);break;case F.sE:case F.hO:e=t(a);if(a=e.wc.tk[c.id])if(e=p(c.kn),b==F.sE)b=a.callback,b(a.id,c.hit_fract,e,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,d=c.hit_pos,k=a.callback;d?k(a.id,b,e,f,d,c.hit_norm):k(a.id,b,e,f)}break;case F.iO:E(id);break;case F.fO:a=S.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case F.cO:pa=c[1];break;case F.ZN:a=
S.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:U.error("Wrong message: "+b)}}function t(a){for(var b=0;b<S.length;b++)if(S[b]==a)return Y[b]}function p(a){return qa[a]||null}function B(a,b,c,e,d,f,k){a=a.wc.ra;for(var h=0;h<a.length;h++)for(var g=a[h].C,l=0;l<g.Oe.length;l++){for(var u=g.Oe[l],v=u.qk,q=!1,n=0;n<v.length;n++){var y=v[n];if(y[0]===b&&y[1]===c){u.Jr[n]=e;q=!0;break}}q&&(v=m(u),d&&u.pz!=b&&(q=d,n=f,y=k,q[0]+=n[0]*y,q[1]+=n[1]*y,q[2]+=n[2]*y,n[0]*=-1,n[1]*=
-1,n[2]*=-1),u.callback(v,v?u.pz==b?p(c):p(b):null,d,f,k))}}function m(a){a=a.Jr;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function x(){X.body++;return X.body}function g(a){var b=za.indexOf(a);return-1==b?(za.push(a),za.length-1):b}function l(a,b){return{ea:a,type:b,Uh:0,xv:!1,Fk:!0,Xe:!1,dg:!1,EV:!1,Yt:null,$b:"",iq:0,y2:{},Oe:[],xl:null,ju:0,iA:new Float32Array([0,0,0,1,0,0,0,1]),Sh:new Float32Array(3),Ah:new Float32Array(3),Pt:new Float32Array(3),Wp:new Float32Array(4),Dr:null}}function h(a,
b){switch(a){case "BOX":var c=b.O;break;case "CYLINDER":c=b.Np;break;case "CONE":c=b.Mp;break;case "SPHERE":c=b.xa;break;case "CAPSULE":c=b.Lp}return c}function w(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=a.G);
"number"===typeof a.Xa&&(b.radius=a.Xa);"number"===typeof a.height&&(b.height=a.height);return b}function f(a,b,c,e,d){var f=H.F(a.k.n),k=H.invert(b.k.n,P),h=new Float32Array(3);H.Wc(f,k,h);switch(b.v.type){case 10:b=b.kf;a=a.k.O;F.fa(d,F.SO,c,h,b.aZ,b.HC,(a.max_z-a.min_z)/2,e);break;case 20:F.fa(d,F.RO,c,h,a.i8)}}function C(a){return a.C&&a.C.Yt}function K(a,b,c,e,d,f,k,h,g,l){var m;X.ic++;m=X.ic.toString(16);var u=b.C.ea;F.fa(G(u),F.ZO,m,a,h,u,c,e,d.C.ea,f,k,g,l);b.C.Yt=m}function G(a){for(var b=
0;b<Y.length;b++)for(var c=Y[b].wc.ra,e=0;e<c.length;e++)if(c[e].C.ea==a)return S[b];return null}function L(a){var b=a.C;if(b=b?0===b.Uh?!0:!0===b.xv?!0:!1===b.Fk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=H.fc(a.k.n,ta),c=H.Xd(a.k.n,oa),b=b[0]!=a.C.Pt[0]||b[1]!=a.C.Pt[1]||b[2]!=a.C.Pt[2]||c[0]!=a.C.Wp[0]||c[1]!=a.C.Wp[1]||c[2]!=a.C.Wp[2]||c[3]!=a.C.Wp[3];if(b){var b=a.C,e=a.k,c=F.xI(F.kt);c.ea=b.ea;var d=H.fc(e.n,c.trans),e=H.Xd(e.n,c.quat);ha.copy(d,b.Pt);aa.copy(e,b.Wp);"DYNAMIC"==
b.type&&aa.identity(c.quat);F.fa(G(b.ea),F.kt)}a=a.Pe;for(b=0;b<a.length;b++)L(a[b])}function D(a,b,c,e,d){d=d||new Float32Array(3);a=H.R(a.k.n);d[0]=b;d[1]=c;d[2]=e;ha.transformQuat(d,a,d)}function N(a,b,c){var e=a.qk,d=a.Jr,f=a.pz,k=[],h=a.$b;k||Z.q("At least one destination required");for(var g=0;g<b.wc.ra.length;g++){var l=b.wc.ra[g];if("ANY"==h||l.C.$b==h&&"NAVMESH"!=l.C.type)l=l.C.ea,k&&-1==k.indexOf(l)&&k.push(l)}for(b=0;b<k.length;b++)h=k[b],f<h&&!I(e,f,h)?(e.push([f,h]),d.push(!1)):f>h&&
!I(e,h,f)&&(e.push([h,f]),d.push(!1));F.fa(c,F.QO,f);F.fa(c,F.YO,e,a.Dh)}function I(a,b,c){for(var e=0;e<a.length;e++)if(a[e][0]==b&&a[e][1]==c)return!0;return!1}function O(a){a.C&&a.C.xl&&(a=a.C,F.fa(G(a.ea),F.kP,a.ea),a.xl=null)}function E(a){var b=k(a),e=c(a).wc;e.tk[a]&&(delete e.tk[a],e.uC.splice(e.uC.indexOf,1),F.fa(b,F.tP,a))}function c(a){for(var b=0;b<Y.length;b++){var c=Y[b];if(c.wc.tk[a])return c}return null}function k(a){for(var b=0;b<Y.length;b++)if(Y[b].wc.tk[a])return S[b];return null}
function y(a,b,c){if(b.Jo){a=a.C.ea;var e=b.wn*b.Qq,d=b.Up*b.Vp,f=-b.Ho*b.Io*2*Math.PI/b.ts;b.kr&&(f*=-1);switch(b.type){case 10:F.fa(c,F.GP,a,e,d,f);break;case 20:F.fa(c,F.FP,a,e,d,f)}}}function A(a){return a.Xe&&"CHASSIS"==a.kf.cf}function e(a){return a.Xe&&"HULL"==a.kf.cf}function R(a){return"NAVMESH"==a.hh.Nr}function q(a){return a.cm&&"MAIN_BODY"==a.zn.cf}var ba=r("__config"),J=r("__debug"),F=r("__ipc"),V=r("__obj_util"),U=r("__print"),aa=r("__quat"),v=r("__scenes"),fa=r("__subscene"),M=r("__transform"),
H=r("__tsr"),Z=r("__util"),ha=r("__vec3"),u=r("__version"),Q=r("__navmesh"),ca=ba.C,ja=ba.A,ua=ba.Pd,pa=0,S=[],Y=[],qa={},sa=[],za=["ANY"],X={body:0,ic:0,QK:0},ta=new Float32Array(3);new Float32Array(4);var oa=new Float32Array(4);new Float32Array(16);var P=H.create(),la=H.create();a.yV=function(a){a.wc={EN:!1,ra:[],tk:{},uC:[]};var c=ca.zs;ua.prevent_caching&&(c+=u.timestamp());U.log("%cLOAD PHYSICS","color: #0a0",ca.Is?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ca.max_fps);
U.log("%cPHYSICS PATH","color: #0a0",c);var e=F.fT(c,!ca.Is);F.MQ(e,b);S.push(e);Y.push(a);ca.ping&&setInterval(function(){F.fa(e,F.qP,performance.now())},1E3)};a.MR=function(a){return a.wc?a.wc.EN:!0};a.sa=function(){for(var a=0;a<S.length;a++)F.terminate(S[a]);S.length=0;Y.length=0;qa={};sa.length=0;za.length=0;for(var b in X)X[b]=0};a.fn=function(a,b){a.k||Z.q("No object render: "+a.name);var c;a:{for(var k=0;k<Y.length;k++)if(Y[k]==b){c=S[k];break a}c=void 0}var m=[];a.hh.As&&n(a,m);var u=b.wc.ra;
if(A(a)||e(a)||a.dg||q(a)||a.Lm){var v=R(a),p;if(v){var M=a,t=x(),r=l(t,"NAVMESH"),E=V.ja(M,b).U;r.Dr=null;for(var fa=0;fa<E.length;fa++){var O=E[fa];if("PHYSICS"==O.type){r.Dr=Q.HW(O.Ba);break}}p=r}else{var B=a,G=c,D=B.k,ca=B.hh,ha=ca.Nr,J=x();if("CAMERA"==B.type)var I=ca.TD?ca.Wt:"BOX",N=h(I,D),ja=D.Pl,L=D.Jl,ja=.5,L=0;else if("EMPTY"==B.type)I="EMPTY",N=null,L=ja=0;else{var I=ca.TD?ca.Wt:"BOX",N=h(I,D),ba=H.Yd(D.n);if(1!=ba){var X=N;switch(I){case "BOX":X.min_x*=ba;X.max_x*=ba;X.min_y*=ba;X.max_y*=
ba;X.min_z*=ba;X.max_z*=ba;break;case "CYLINDER":case "CONE":case "CAPSULE":X.height*=ba;X.Xa*=ba;break;case "SPHERE":X.Xa*=ba}}ja=D.Pl;L=D.Jl}var ua=H.F(D.n),pa=H.R(D.n),za=ca.Es,ta=ca.nN,zb=ca.Uh,cb=ca.tN,Aa=ca.sN,Xa=ca.nH,vb=ca.aL,Fa=B.$b,Za=g(Fa),mb=ca.jq,jb=ca.hq,ib=ca.kq,kc=D.xa.Xa,ab=w(N),bb=B.$t,Ua;var yb=I;if(m.length){var Cc=[],Rb={};Rb.quat=new Float32Array([0,0,0,1]);Rb.trans=new Float32Array(3);Rb.worker_bounding=ab;Rb.bounding_type=yb;Cc.push(Rb);var Nb=H.invert(D.n,P),Ob=oa;aa.invert(H.R(D.n),
Ob);for(var Ab=0;Ab<m.length;Ab++){var fb={},lc=m[Ab],Nc=lc.hh.Wt,Wc=new Float32Array(4),uc=new Float32Array(3),Rc=H.R(lc.k.n);H.Wc(H.F(lc.k.n),Nb,uc);aa.multiply(Ob,Rc,Wc);fb.trans=uc;fb.quat=Wc;fb.bounding_type=Nc;fb.worker_bounding=w(h(Nc,lc.k));Cc.push(fb)}Ua=Cc}else Ua=[];F.fa(G,F.VO,J,ua,pa,ha,za,ta,zb,cb,Aa,Xa,vb,Za,mb,jb,ib,I,ab,kc,ja,L,Ua,bb);qa[J]=B;sa.push(B);var Gb=l(J,"BOUNDING");Gb.type=ha;Gb.Uh=zb;Gb.xv=za;Gb.$b=Fa;Gb.iq=Za;p=Gb}var fc=p;a.C=fc;var wb={za:null,C:fc};v||(u.push(wb),
d(b,c,fc.$b))}else for(var Va=V.ja(a,b).U,Ga=0;Ga<Va.length;Ga++){var xb=Va[Ga],Sc;if(Sc="PHYSICS"==xb.type){var Xb;a:{for(var yc=b.wc.ra,dd=0;dd<yc.length;dd++){var vc=yc[dd].za;if(vc&&vc.id==xb.id){Xb=!0;break a}}Xb=!1}Sc=!Xb}if(Sc)if(xb.Jf.Ka)if(xb.sj&&b.s.Jc){var $b=xb,Xc=b,ed=c,ac=Xc.s.Jc;F.fa(ed,F.dP,ac.Xk);if($b.x_){var Yb={};Yb.dst_noise_scale0=$b.dst_noise_scale0;Yb.dst_noise_scale1=$b.dst_noise_scale1;Yb.dst_noise_freq0=$b.dst_noise_freq0;Yb.dst_noise_freq1=$b.dst_noise_freq1;Yb.dir_min_shore_fac=
$b.dir_min_shore_fac;Yb.dir_freq=$b.dir_freq;Yb.dir_noise_scale=$b.dir_noise_scale;Yb.dir_noise_freq=$b.dir_noise_freq;Yb.dir_min_noise_fac=$b.dir_min_noise_fac;Yb.dst_min_fac=$b.dst_min_fac;Yb.waves_hor_fac=$b.waves_hor_fac;var rd=ac.waves_height,Dc=ac.waves_length;ac.Ek?F.fa(ed,F.PE,Yb,ac.yo[0],ac.yo[1],ac.xo[0],ac.xo[1],ac.GB,rd,Dc,ac.gD,Xc.s.fD):F.fa(ed,F.PE,Yb,0,0,0,0,0,rd,Dc,0,null)}}else{var kb;if(xb.Es){var Yc=a,zc=xb,mc=c,Sb=x(),Pb=zc.Jf,nc=Pb.Z[0].a_position,Ec=Pb.ma||null,Hb=zc.$b,oc=g(Hb);
F.fa(mc,F.aP,Sb,nc,Ec,H.F(Yc.k.n),oc,zc.jq,zc.hq,zc.kq);var pb=l(Sb,"STATIC_MESH");pb.xv=!0;pb.$b=Hb;pb.iq=oc;kb=pb}else{var db=a,bc=xb,Zc=c,Cb=x(),Tb=bc.Jf,gb=Tb.Z[0].a_position,ob=Tb.ma||null,Fc=H.F(db.k.n),pc=bc.Pl,Gc=bc.Jl,Ib=bc.$b,qc=g(Ib);F.fa(Zc,F.cP,Cb,gb,ob,Fc,pc,Gc,qc,bc.jq,bc.hq,bc.kq);var cc=l(Cb,"STATIC_MESH");cc.$b=Ib;cc.iq=qc;kb=cc}fc=kb;a.C=fc;wb={za:xb,C:fc};u.push(wb);d(b,c,fc.$b)}else U.error("Object "+a.name+" has collision material with no assigned vertices")}if(A(a)||e(a)){var Ya=
a,dc=c,Jb=Ya.C.ea;A(Ya)?(Ya.v.type=10,F.fa(dc,F.WO,Jb,Ya.v.rD,Ya.v.tD,Ya.v.sD,Ya.v.dE,Ya.v.HB)):e(Ya)&&(Ya.v.type=20,F.fa(dc,F.UO,Jb,Ya.v.Ml,Ya.v.Qm,Ya.v.Rm));if(Ya.v.wm){var rb=Ya.v.wm;switch(Ya.v.type){case 10:f(rb[0],Ya,Jb,!0,dc);f(rb[1],Ya,Jb,!0,dc);f(rb[2],Ya,Jb,!1,dc);f(rb[3],Ya,Jb,!1,dc);break;case 20:for(var rc=0;rc<rb.length;rc++)f(rb[rc],Ya,Jb,!1,dc)}}y(a,a.v,c)}else if(a.dg){var sb=c,Kb=a.k,Ub=a.C,wc=Kb.O.max_z-Kb.O.min_z,Hc=Ub.ea,Ja=a.qG,gc=Ja.w_,Db=Ja.HX,Eb=Ja.UY,Ac=Ja.PV,Vb=Ja.y_,lb=
Z.vT(a);F.fa(sb,F.XO,Hc,lb,wc,gc,Db,Eb,Ac,Vb);Ub.dg=!0}else if(q(a)){var hb=a,Ia=c,Zb=hb.C.ea;F.fa(Ia,F.$O,Zb,hb.Xf.Ml,hb.Xf.Qm,hb.Xf.Rm);if(hb.Xf.Nt)for(var Fb=hb.Xf.Nt,La=0;La<Fb.length;La++){var Ma=Fb[La],nb=H.F(Ma.k.n),Oc=H.invert(hb.k.n,P),Ic=new Float32Array(3);H.Wc(nb,Oc,Ic);F.fa(Ia,F.TO,Zb,Ic,Ma.cG)}hb.C.EV=!0}for(Ga=0;Ga<sa.length;Ga++)if(a=sa[Ga],a.C){var tb=a;if(!C(tb))for(var Bc=0;Bc<tb.jC.length;Bc++){var Wb=tb.jC[Bc],ec=Wb.target,fd=Wb.VW;if(ec.C){var $c=new Float32Array([Wb.WW,Wb.XW,
Wb.YW]),Tc,ad=new Float32Array([Wb.Ha,Wb.Ia,Wb.Ja]);Tc=Z.Pj(ad,new Float32Array(4));var ub=H.identity(P),ub=H.ff($c,ub),ub=H.Ck(Tc,ub),Pc=H.multiply(tb.k.n,ub,P),qb=H.invert(ec.k.n,la),gd=H.multiply(qb,Pc,qb),Wa=Wb,$a={};$a.use_limit_x=Wa.i_;$a.use_limit_y=Wa.j_;$a.use_limit_z=Wa.k_;$a.use_angular_limit_x=Wa.e_;$a.use_angular_limit_y=Wa.f_;$a.use_angular_limit_z=Wa.g_;$a.limit_max_x=Wa.ZV;$a.limit_min_x=Wa.bW;$a.limit_max_y=Wa.$V;$a.limit_min_y=Wa.cW;$a.limit_max_z=Wa.aW;$a.limit_min_z=Wa.dW;$a.limit_angle_max_x=
Wa.TV;$a.limit_angle_min_x=Wa.WV;$a.limit_angle_max_y=Wa.UV;$a.limit_angle_min_y=Wa.XV;$a.limit_angle_max_z=Wa.VV;$a.limit_angle_min_z=Wa.YV;K(fd,tb,$c,Tc,ec,H.F(gd),H.R(gd),$a,null,null)}}}};a.$T=p;a.update=function(a,b){for(var c=0;c<S.length;c++){var e=S[c],d=a;e&&F.yJ(e)&&F.fa(e,F.HP,d,b);for(var f=0;f<sa.length;f++){var k=sa[f],h=k.C;if(h.Fk&&h.ju){var g=F.yJ(e)?d-h.ju:performance.now()/1E3-h.ju,g=Math.min(g,10/ca.max_fps),g=g-1/ca.max_fps;ja.IW&&(g=0);var l=P;H.zV(h.iA,g,h.Sh,h.Ah,P);M.gj(k,
l);M.D(k);L(k);if(k.v)for(var h=k,g=h.v.wm,l=h.k.n,m=P,u=0;u<g.length;u++){var q=g[u];H.multiply(l,h.v.Tr[u],m);M.gj(q,m);M.D(q)}k.v&&k.v.Jo&&(m=k,g=m.v,h=g.Jo)&&(u=m.v.nM,H.multiply(m.k.n,m.v.oM,h.k.n),l=ta,H.xd(u,m.k.n,l),m=oa,aa.setAxisAngle(l,-g.Ho*g.Io*2*Math.PI,m),g=H.R(h.k.n),aa.multiply(m,g,g),M.D(h));k.v&&k.v.kD&&(m=k,g=m.v,h=g.kD)&&(u=m.v.iM,H.multiply(m.k.n,m.v.jM,h.k.n),l=ta,H.xd(u,m.k.n,l),m=oa,u=Math.abs(g.speed)*g.ss,u>g.Xn&&(u=g.Xn),aa.setAxisAngle(l,-u,m),g=H.R(h.k.n),aa.multiply(m,
g,g),aa.normalize(g,g),M.D(h));k.v&&k.v.vD&&(l=k,h=l.v,k=h.vD)&&(m=l.v.zM,H.multiply(l.k.n,l.v.AM,k.k.n),g=ta,H.xd(m,l.k.n,g),l=oa,aa.setAxisAngle(g,-Math.abs(h.wn)*h.zq,l),h=H.R(k.k.n),aa.multiply(l,h,h),aa.normalize(h,h),M.D(k))}}F.eX(e);e=Y[c];(d=e.s.Jc)&&0<d.waves_height&&(e=v.Ma(e,fa.Pb),d=ha.length(e.tj)||1,F.fa(S[c],F.EP,e.time*d))}};a.zU=function(){return Y[0]};a.pause=function(){for(var a=0;a<S.length;a++)F.fa(S[a],F.pP)};a.dj=function(){for(var a=0;a<S.length;a++)F.fa(S[a],F.uP)};a.AH=function(a){(a=
a.C)||Z.q("No object physics");if(!a.Fk){var b=a.ea,c=G(b);a.Fk=!0;F.fa(c,F.nP,b)}};a.rA=function(a){(a=a.C)||Z.q("No object physics");if(a.Fk){var b=a.ea,c=G(b);a.Fk=!1;F.fa(c,F.mP,b)}};a.xw=function(a){return Boolean(a.wc)};a.na=function(a){return Boolean(a.C)};a.fJ=function(a){return(a=a.C)&&a.Fk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Uh&&0==a.xv?!0:!1};a.cB=function(a){return(a=a.C)&&a.Fk?!0:!1};a.xL=function(a,b){var c=a.C.ea;F.fa(G(c),F.DP,c,b)};a.lV=C;a.AF=K;a.CG=function(a){a=a.C;
F.fa(G(body_a),F.sP,a.Yt);a.Yt=null};a.JK=function(b,c,e,d,f,k){c=H.ci(c,1,e,P);f=H.ci(f,1,k,la);H.invert(c,c);H.multiply(f,c,c);M.br(d,f);H.multiply(f,c,c);M.gj(b,c);M.D(b);a.Kw(b,H.F(b.k.n),H.R(b.k.n))};a.Kw=function(a,b,c){var e=a.C,d=F.xI(F.kt),f=H.fc(a.k.n,d.trans);a=H.Xd(a.k.n,d.quat);H.ci(f,1,a,e.iA);d.ea=e.ea;ha.copy(b,d.trans);aa.copy(c,d.quat);F.fa(G(e.ea),F.kt)};a.H=L;a.EF=function(a,b,c,e){var d=ta;D(a,b,c,e,d);a=a.C.ea;b=Math.abs(0);c=Math.abs(0);e=Math.abs(0);var f=Math.abs(d[0]),k=
Math.abs(d[1]),h=Math.abs(d[2]);d[0]=f?d[0]/f*Math.max(f,b):0;d[1]=k?d[1]/k*Math.max(k,c):0;d[2]=h?d[2]/h*Math.max(h,e):0;F.fa(G(a),F.RE,a,d[0],d[1],d[2])};a.FF=function(a,b,c,e){a=a.C.ea;F.fa(G(a),F.RE,a,b,c,e)};a.iz=function(a,b,c,e,d){var f=ta;d?(f[0]=b,f[1]=c,f[2]=e):D(a,b,c,e,f);a=a.C.ea;F.fa(G(a),F.eP,a,f[0],f[1],f[2])};a.DF=function(a,b,c,e){var d=ta;D(a,b,c,e,d);a=a.C.ea;F.fa(G(a),F.gP,a,d[0],d[1],d[2])};a.MC=function(a,b,c){a=a.C.ea;F.fa(G(a),F.xP,a,b,c)};a.Dw=function(a,b){var c=a.C.ea;
F.fa(G(c),F.yP,c,b)};a.oL=function(a,b){var c=a.C.ea;F.fa(G(c),F.CP,c,b)};a.nL=function(a,b){var c=a.C.ea;F.fa(G(c),F.AP,c,b)};a.kL=function(a,b){var c=a.C.ea;F.fa(G(c),F.vP,c,b)};a.oG=function(a){a=a.C.ea;F.fa(G(a),F.iP,a)};a.pG=function(a,b,c){a=a.C.ea;F.fa(G(a),F.jP,a,b,c)};a.Ew=function(a,b,c){a=a.C.ea;F.fa(G(a),F.zP,a,b,c)};a.lL=function(a,b){var c=a.C.ea;F.fa(G(c),F.wP,c,b)};a.mL=function(a,b){var c=a.C.ea;F.fa(G(c),F.BP,c,b)};a.fz=function(a,b,c,e){var d=a.C;if(!d.Dr){for(var f=d.ea,k=0;k<
d.Oe.length;k++)if(a=d.Oe[k],a.$b==b&&a.callback==c)return;a={pz:f,Dh:e||!1,$b:b,callback:c,qk:[],Jr:[]};d.Oe.push(a);b=G(f);N(a,t(b),b)}};a.yC=function(a,b,c){a=a.C;for(var e=G(a.ea),d=t(e),f=0;f<a.Oe.length;f++){var k=a.Oe[f];if(k.$b==b&&k.callback==c){if(m(k)){var h=ha.set(0,0,0,ta);k.callback(!1,null,h,h,0)}a.Oe.splice(f,1);f--;for(var h=e,k=k.qk,g=d.wc.ra,l=0;l<g.length;l++)for(var u=g[l].C,v=0;v<u.Oe.length;v++)for(var q=u.Oe[v],n=0;n<q.qk.length;n++)for(var y=q.qk[n],H=0;H<k.length;H++){var p=
k[H];y[0]==p[0]&&y[1]==p[1]&&(k.splice(H,1),H--)}k.length&&F.fa(h,F.QE,k)}}};a.hz=function(a,b){a.C&&a.C.xl&&O(a);var c=a.C;F.fa(G(c.ea),F.fP,c.ea);c.xl=b};a.Hz=O;a.Ct=function(a,b,c,e,d,f,k,h,l){var m;X.QK++;m=X.QK;a={id:m,ea:a?a.C.ea:0,from:new Float32Array(b),to:new Float32Array(c),$b:e,iq:g(e),MF:f,fR:k,Dh:h,nv:l,callback:d};b=G(a.ea)||S[0];c=t(b).wc;m=a.id;c.tk[m]=a;c.uC.push(a);F.fa(b,F.bP,a.id,a.ea,a.from,a.to,a.iq,a.MF,a.fR,a.Dh,a.nv);return m};a.zC=E;a.mG=function(a,b,e){var d=k(a),f=c(a).wc.tk[a];
f&&!f.MF&&(f.from.set(b),f.to.set(e),F.fa(d,F.hP,a,b,e))};a.AJ=function(a){return c(a).wc.tk[a]?!0:!1};a.Yo=function(a,b){var c=a.v;c.wn=b;y(a,c,G(a.C.ea))};a.Xo=function(a,b){var c=a.v;c.Ho=b;y(a,c,G(a.C.ea))};a.WD=function(a,b){var c=a.v;c.Up=b;y(a,c,G(a.C.ea))};a.Ye=A;a.Ze=e;a.O5=R;a.CV=function(a){if(!a.Xe)return!1;a=a.kf.cf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.BV=function(a){return a.Xe?"BOB"==a.kf.cf?!0:!1:!1};a.FV=function(a){return a.cm?
"BOB"==a.zn.cf?!0:!1:!1};a.CJ=function(a){return a.Xe&&"STEERING_WHEEL"==a.kf.cf?!0:!1};a.BJ=function(a){return a.Xe&&"SPEEDOMETER"==a.kf.cf?!0:!1};a.DJ=function(a){return a.Xe&&"TACHOMETER"==a.kf.cf?!0:!1};a.UI=function(a){return a.v.speed};a.A_=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.dg=function(a){return a.dg};a.J5=q;a.RU=function(){return pa};a.oT=function(){for(var a=0;a<S.length;a++)F.fa(S[a],
F.lP)};a.$r=function(a){if("BOUNDING"==a.C.type){var b=sa.indexOf(a);-1==b&&U.error("Object "+a.name+" doesn't have bounding physics");delete qa[c];sa.splice(b,1)}for(var c=a.C.ea,b=G(c),e=t(b),d=c,f=e.wc.ra,k=[],h=0;h<f.length;h++)for(var g=f[h].C,l=0;l<g.Oe.length;l++)for(var u=g.Oe[l],v=0;v<u.qk.length;v++){var q=u.qk[v],n=u.Jr[v];if(q[0]==d||q[1]==d)u.qk.splice(v,1),u.Jr.splice(v,1),v--,n&&!m(u)&&(n=ha.set(0,0,0,ta),u.callback(!1,null,n,n,0)),k.push(q)}k.length&&F.fa(b,F.QE,k);a.C&&a.C.xl&&O(a);
a=e.wc.ra;for(e=0;e<a.length;e++)a[e].C.ea==c&&(a.splice(e,1),e--);F.fa(b,F.rP,c)}};b4w.module.__ipc=function(a,r){function n(a,b,c){for(var d=0;d<w.length;d+=2)w[d+1]==a&&(h[d+Number(!b)]=c)}function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var h=c[f];switch(h.constructor){case Float32Array:d+=h.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.dO=0;var t=a.WN=1,p=a.YN=2;a.XN=3;a.$N=4;a.aO=5;a.bO=6;a.eO=7;var B=a.gO=8,m=a.sE=9,x=a.hO=10;a.iO=11;var g=a.jO=12;a.kO=13;a.fO=14;a.cO=15;a.ZN=16;a.oP=100;a.QO=101;a.RO=102;a.SO=103;a.TO=104;a.VO=105;a.UO=106;
a.WO=107;a.XO=108;a.YO=109;a.ZO=110;a.$O=111;a.aP=112;a.cP=113;a.dP=114;a.rP=115;a.eP=116;a.fP=117;a.gP=118;a.iP=119;a.jP=120;a.kP=121;a.mP=122;a.nP=123;a.pP=124;a.bP=125;a.tP=126;a.hP=127;a.QE=128;a.sP=129;a.uP=130;a.vP=131;a.wP=132;a.xP=133;a.yP=134;a.zP=135;a.AP=136;a.BP=137;a.CP=138;a.DP=139;a.RE=140;var l=a.kt=141;a.EP=142;a.PE=143;a.FP=144;a.GP=145;a.qP=146;a.lP=147;a.HP=148;var h=b4w.worker_listeners,w=b4w.worker_namespaces,f={Ff:g,ea:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Sh:new Float32Array(3),Ah:new Float32Array(3),len:0},C={Ff:B,Cz:0,pC:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},K={Ff:m,id:0,kn:0,hit_fract:0,hit_time:0,len:0},G={Ff:x,id:0,kn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},L={Ff:t,ql:0,rl:0,result:0,len:0},D={Ff:p,ql:0,rl:0,result:0,yl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},N={Ff:l,ea:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},I=[f,C,K,G,L,D,
N];a.fT=function(a,d){var c={yv:a?!0:!1,Yk:null,Ch:[],Wf:""};if(d)if(c.Yk={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");n(c.Wf,c.yv,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");n(c.Wf,c.yv,null)},postMessage:function(a){var b;a:{for(b=0;b<w.length;b+=2)if(w[b+1]==c.Wf){b=h[b+Number(!!c.yv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<w.length;a+=2)if(w[a+1]==c.Wf){h.splice(a,2);w.splice(a,2);break}}},c.yv){var f=
r("__util"),g=r("__container"),l=b4w.get_namespace(r),f=f.ws(l+"_worker");w.push(l);w.push(f);h.push(null);h.push(null);c.Wf=f;(g=g.bU(a))?b?g.addEventListener("load",function(){b4w.require("__bindings",c.Wf)},!1):(b4w.sa("__bindings",c.Wf),b4w.sa("__ipc",c.Wf),b4w.require("__bindings",c.Wf)):(g=document.createElement("script"),g.src=a,g.defer="defer",g.async="async",g.addEventListener("load",function(){b=!1;b4w.require("__bindings",c.Wf)},!1),document.head.appendChild(g))}else c.Wf=b4w.get_namespace(r);
else c.Yk=a?new Worker(a):self;return c};a.MQ=function(a,b){function c(d){if(d.constructor==ArrayBuffer)d=new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var h=0;h<d.length;h++)c(d[h]);return}h=d[0]|0;switch(h){case g:var n=f;n.ea=d[1]|0;n.time=d[2];n.trans[0]=d[3];n.trans[1]=d[4];n.trans[2]=d[5];n.quat[0]=d[6];n.quat[1]=d[7];n.quat[2]=d[8];n.quat[3]=d[9];n.Sh[0]=d[10];n.Sh[1]=d[11];n.Sh[2]=d[12];n.Ah[0]=d[13];n.Ah[1]=d[14];n.Ah[2]=d[15];break;case B:n=C;n.Cz=d[1]|0;n.pC=d[2]|0;n.trans[0]=
d[3];n.trans[1]=d[4];n.trans[2]=d[5];n.quat[0]=d[6];n.quat[1]=d[7];n.quat[2]=d[8];n.quat[3]=d[9];break;case m:n=K;n.id=d[1]|0;n.kn=d[2]|0;n.hit_fract=d[3];n.hit_time=d[4];break;case x:n=G;n.id=d[1]|0;n.kn=d[2]|0;n.hit_fract=d[3];n.hit_time=d[4];n.hit_pos[0]=d[5];n.hit_pos[1]=d[6];n.hit_pos[2]=d[7];n.hit_norm[0]=d[8];n.hit_norm[1]=d[9];n.hit_norm[2]=d[10];break;case t:n=L;n.ql=d[1]|0;n.rl=d[2]|0;n.result=!!d[3];break;case p:n=D;n.ql=d[1]|0;n.rl=d[2]|0;n.result=!!d[3];n.yl[0]=d[4];n.yl[1]=d[5];n.yl[2]=
d[6];n.coll_norm[0]=d[7];n.coll_norm[1]=d[8];n.coll_norm[2]=d[9];n.coll_dist=d[10];break;case l:n=N;n.ea=d[1]|0;n.trans[0]=d[2];n.trans[1]=d[3];n.trans[2]=d[4];n.quat[0]=d[5];n.quat[1]=d[6];n.quat[2]=d[7];n.quat[3]=d[8];break;default:n=d}b(a,h,n)}d(I);a.Yk.addEventListener("message",function(a){c(a.data)},!1)};a.sa=function(){};a.fa=function(a,b){if(a)switch(b){case g:var c=f,d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ea;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=
c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Sh[0];d[11]=c.Sh[1];d[12]=c.Sh[2];d[13]=c.Ah[0];d[14]=c.Ah[1];d[15]=c.Ah[2];a.Ch.push(d.buffer);break;case B:c=C;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.Cz;d[2]=c.pC;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.Ch.push(d.buffer);break;case m:c=K;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.id;d[2]=c.kn;d[3]=c.hit_fract;d[4]=c.hit_time;a.Ch.push(d.buffer);break;case x:c=G;d=new Float32Array(c.len);
d[0]=c.Ff;d[1]=c.id;d[2]=c.kn;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.Ch.push(d.buffer);break;case t:c=L;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ql;d[2]=c.rl;d[3]=c.result;a.Ch.push(d.buffer);break;case p:c=D;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ql;d[2]=c.rl;d[3]=c.result;d[4]=c.yl[0];d[5]=c.yl[1];d[6]=c.yl[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.Ch.push(d.buffer);break;case l:c=N;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ea;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.Ch.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Yk.postMessage(d)}};a.eX=function(a){a&&a.Ch.length&&(a.Yk.postMessage(a.Ch),a.Ch.length=0)};a.xI=function(a){switch(a){case g:return f;case B:return C;case m:return K;case x:return G;case t:return L;case p:return D;case l:return N;
default:return null}};a.terminate=function(a){a.Yk.terminate();a.Yk=null};a.tv=function(a){return!!a.Yk};a.yJ=function(a){return!!a.Wf}};b4w.module.__transform=function(a,r){function n(a,b){h.bg(a)?L.ff(b,h.$f(a)):L.ff(b,a.k.n)}function d(a,b){var d=a.k;if(h.bg(a)){L.Ck(b,d.n);var f=h.Ku(a),f=L.invert(f,c);L.multiply(f,d.n,h.$f(a))}else L.Ck(b,d.n)}function b(a,b){h.bg(a)?L.Ck(b,h.$f(a)):L.Ck(b,a.k.n)}function t(a,b){L.Xd(a.k.n,b);return b}function p(a,b){h.bg(a)?L.Xd(h.$f(a),b):L.Xd(a.k.n,b);return b}function B(a,b){h.bg(a)?L.copy(b,h.$f(a)):L.copy(b,a.k.n)}function m(a,b){h.bg(a)?L.copy(h.$f(a),b):L.copy(a.k.n,b);return b}function x(a){var b=
a.k,d=a.I,k=a.type;"CAMERA"==k&&l.QD(a);h.IZ(a,y);"CAMERA"==k&&l.GZ(a);var m=L.fc(b.n,I),n=L.Xd(b.n,E);g.tl(b.O,b.n,b.Ta);g.Tp(b.xa,b.n,b.kb);if(b.Vo)for(var p=0;p<d.length;p++)for(var t=d[p].U,r=0;r<t.length;r++){var v=t[r];g.tl(v.O,b.n,v.Ta);g.Tp(v.xa,b.n,v.kb);v.Nf&&g.Sp(v.aa,b.n,v.pb)}else b.Nf&&g.Sp(b.aa,b.n,b.pb);switch(k){case "MESH":a.fK&&L.invert(a.k.n,a.k.Ex);if(t=a.Ft)L.invert(t.k.n,c),L.multiply(c,b.n,c),L.fV(c,b.Hp),L.Xd(c,b.Gp);b.Rq=!0;break;case "CAMERA":for(p=0;p<d.length;p++)l.HZ(a,
d[p]);break;case "SPEAKER":G.LY(a,y,A);break;case "LAMP":w.LZ(a)}for(p=0;p<d.length;p++)if(r=d[p],r.tv){t=r.xb;v=t.s;switch(k){case "MESH":b.Ce&&K.LC(t);v=r.Ei;null!=b.Rd&&v&&K.XM(v,m);break;case "EMPTY":f.JZ(a);break;case "CAMERA":K.JX(t);if(v.wd){v.wd.enable_csm&&K.LC(t);var fa=C.ja(a,t).ba[0];K.WZ(fa,v.Wa)}K.B()==t&&K.Ul(t)==a&&G.fW(t,m,n,y,A);break;case "LAMP":K.$M(a,t)}v=r.Xh;fa=a.Zr;if(fa.length)for(r=0;r<v.length;r++){var M=v[r].p;K.aN(v[r],m,n);C.bN(fa,M.mc);l.rY(M,K.Ul(t));D.xn(M.md,M.Lh)}}b=
a.Pe;for(p=0;p<b.length;p++)x(b[p]);a=a.Oz;for(p=0;p<a.length;p++)b=a[p],t=b[0],h.BZ(t,b[1])}var g=r("__boundings"),l=r("__camera"),h=r("__constraints"),w=r("__lights"),f=r("__objects"),C=r("__obj_util"),K=r("__scenes"),G=r("__sfx"),L=r("__tsr"),D=r("__util"),N=r("__vec3"),I=new Float32Array(3),O=new Float32Array(3),E=new Float32Array(4);new Float32Array(9);var c=L.create(),k=L.create(),y=0,A=0;a.$E=0;a.cn=1;a.update=function(a){y=a;A++};a.Vc=function(a,b){var d=a.k;if(h.bg(a)){L.ff(b,d.n);var f=
h.Ku(a),f=L.invert(f,c);L.multiply(f,d.n,h.$f(a))}else L.ff(b,d.n)};a.Lw=n;a.Bf=function(a,b){L.fc(a.k.n,b);return b};a.SI=function(a,b){h.bg(a)?L.fc(h.$f(a),b):L.fc(a.k.n,b);return b};a.bi=d;a.Jw=b;a.In=t;a.HI=p;a.ZC=function(a,b){var c=D.Pj(b,E);d(a,c)};a.$C=function(a,c){var d=D.Pj(c,E);b(a,d)};a.FI=function(a,b){t(a,E);return b=D.sw(euler,b)};a.GI=function(a,b){p(a,E);return b=D.sw(euler,b)};a.Hf=function(a,b){var c=a.k;if(h.bg(a)){var c=h.$f(a),d=L.Yd(h.Ku(a));L.Hf(b/d,c)}else L.Hf(b,c.n)};a.aD=
function(a,b){var c=a.k;h.bg(a)?L.Hf(b,h.$f(a)):L.Hf(b,c.n)};a.Yd=function(a){return L.Yd(a.k.n)};a.JI=function(a){return h.bg(a)?L.Yd(h.$f(a)):L.Yd(a.k.n)};a.gj=function(a,b){L.copy(b,a.k.n);if(h.bg(a)){var d=h.Ku(a),d=L.invert(d,c);L.multiply(d,a.k.n,h.$f(a))}};a.Mw=B;a.br=function(a,b){return L.copy(a.k.n,b)};a.cr=m;a.Ou=function(a){var b=a.k;a=b.ol;var c=L.Yd(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.Nu=function(a,b,c){b?(a=a.k,N.copy(a.kb.G,
c)):(a=a.k,b=a.ol,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,L.Wc(c,a.n,c));return c};a.ah=function(a,b,d,f){var h=m(a,c),k=I;k[0]=b;k[1]=d;k[2]=f;L.Wc(k,h,k);n(a,k)};a.IC=function(a,b){var d=m(a,c),f=L.Ck(b,L.identity(k));L.multiply(d,f,f);B(a,f)};a.D=x;a.distance=function(a,b){var c=L.fc(a.k.n,I),d=L.fc(b.k.n,O);return N.dist(c,d)};a.co=function(a,b){var c=L.fc(a.k.n,I);return N.dist(c,b)};a.BI=function(a){return{max_x:a.k.Ta.max_x,min_x:a.k.Ta.min_x,max_y:a.k.Ta.max_y,
min_y:a.k.Ta.min_y,max_z:a.k.Ta.max_z,min_z:a.k.Ta.min_z}}};b4w.module.__sfx=function(a,r){function n(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return D.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function d(a,c,e){var d=a.W;if("NONE"!=d.behavior){var f=d.loop,h=d.pitch;if(d.src&&(f||0<=e)){d.kz=Math.floor(5E4*Math.random());var k=J.currentTime+c,k=
Math.max(0,k);d.gf=k;d.state=20;var g=F.Nc;"POSITIONAL"==d.behavior&&"none"==g.Dq&&(d.behavior="BACKGROUND_SOUND");b(a,F.Nc);if("POSITIONAL"==d.behavior||"BACKGROUND_SOUND"==d.behavior){c=J.createBufferSource();c.buffer=d.src;c.playbackRate.value=h;if(f){d.bc&&d.bc.disconnect();d.Kd&&d.Kd.disconnect();c.loop=!0;c.loopStart=d.SJ;if(c.loopEnd=d.Jv)e=J.createBufferSource(),e.buffer=d.src,e.playbackRate.value=h,d.Kd=e,e.connect(d.Fd);c.start(k);d.duration=0}else f=c.buffer?c.buffer.duration:0,e>f?(f=
k+e+d.zf,c.loop=!0,c.start(k),c.stop(f),d.duration=e):(c.loop=!1,c.start(k),d.duration=f);c.connect(d.Fd);d.bc=c;p(d);B(d);m(d)}else"BACKGROUND_MUSIC"==d.behavior&&(I.Ut(d.lz),I.Ut(d.mz),e=function(){var b=a.W,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.bc=b.bc||J.createMediaElementSource(c),b.bc.connect(b.Fd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?e():d.lz=I.LL(e,1E3*c),d.duration=f?0:G(a));x(d,k)}}}function b(a,b){var d=a.W;if(!d.Fd){var e=O.F(a.k.n),f=O.R(a.k.n);if(y.Rv){var h=
J.createBiquadFilter();h.type="peaking"}else h=null;var k=J.createGain();switch(d.behavior){case "POSITIONAL":var g=J.createPanner();"string"!=typeof g.panningModel?(g.panningModel=g.EQUALPOWER,g.distanceModel=g.INVERSE_DISTANCE):(g.panningModel="equalpower",g.distanceModel=b.Dq);g.setPosition(e[0],e[1],e[2]);c.copy(e,d.sB);e=A;E.lc(f,E.$c,e);g.setOrientation(e[0],e[1],e[2]);g.refDistance=d.Cq;g.maxDistance=d.Mg;g.rolloffFactor=d.Jp;g.coneInnerAngle=d.IG;g.coneOuterAngle=d.JG;g.coneOuterGain=d.KG;
var l=J.createGain();l.gain.value=K(d);h?(g.connect(h),h.connect(l)):g.connect(l);l.connect(k);d.Fd=g;if(d.Pm){var m=J.createGain();k.connect(m);m.connect(b.Fd)}else m=null,k.connect(b.Fd);break;case "BACKGROUND_SOUND":g=null;l=J.createGain();l.gain.value=K(d);h?(d.Fd=h,h.connect(l)):d.Fd=l;l.connect(k);d.Pm?(m=J.createGain(),k.connect(m),m.connect(b.Fd)):(m=null,k.connect(b.Fd));break;case "BACKGROUND_MUSIC":m=g=null,l=J.createGain(),l.gain.value=K(d),h?(d.Fd=h,h.connect(l)):d.Fd=l,l.connect(k),
k.connect(b.Fd)}d.eC=g;d.Qg=h;d.Dn=l;d.Qj=k;d.tC=m}}function t(a){var b=a.W,c=b.duration,b=b.sH+b.tH*Math.random();d(a,b,c)}function p(a){var b=a.Kd||a.bc;E.Rh(b.onended)&&(b.onended=function(){a.state=50})}function B(a){a.Pm&&a.tC.gain.cancelScheduledValues(a.gf);a.io&&(a.bc.playbackRate.cancelScheduledValues(a.gf),a.Kd&&a.Kd.playbackRate.cancelScheduledValues(a.gf));a.Ks=a.gf}function m(a){if(a.Pm||a.io){var b=a.tC,c=a.bc,d=c.buffer?c.buffer.duration:0;if(d){var e=a.gf;U[0]=a.kz;for(var f=0;5>f;){var h=
a.pitch+a.io*E.og(U);if(e>=a.Ks){if(a.Pm){var k=1-E.V(a.Pm,0,1)*Math.random();b.gain.setValueAtTime(k,e)}a.io&&(c.playbackRate.setValueAtTime(h,e),a.Kd&&a.Kd.playbackRate.setValueAtTime(h,e));f++}e+=d/h}a.Ks=e-.001}}}function x(a,b){if(a.Ll||a.zf){var c=a.Qj;c.gain.cancelScheduledValues(b);a.Ll?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Ll)):c.gain.setValueAtTime(1,b);a.zf&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.zf))}}
function g(a){"SPEAKER"!=a.type&&E.q("Wrong object type");var b=a.W;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Qj,d=J.currentTime;b.zf&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.zf));"BACKGROUND_MUSIC"==b.behavior?b.src&&(I.Ut(b.lz),I.Ut(b.mz),b.mz=I.LL(function(){var b=a.W.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.zf)):(c=b.bc,b.duration<c.buffer.duration?b.zf&&20==b.state?c.stop(d+b.zf):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.gf=0,b.fC=0,b.vz=0);b.state=30}}function l(a){a=a.W;if(20==a.state){var b=J.currentTime;a.fC=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.vz=b>a.gf?h(a,b):0,a.bc.onended=function(){},a.bc.stop(0),a.bc.disconnect(),B(a));a.state=40}}function h(a,b){U[0]=a.kz;for(var c=a.bc.buffer.duration,d=a.gf,e;d<b;)e=a.pitch+a.io*E.og(U),d+=c/e;return(c/e-(d-b))*e}function w(a){var b=a.W;if(40==b.state){var c=J.currentTime;b.gf+=c-b.fC;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.W;var d=J.createBufferSource();d.loop=a.bc.loop;d.loopStart=a.bc.loopStart;d.loopEnd=a.bc.loopEnd;d.buffer=a.bc.buffer;d.playbackRate.value=a.bc.playbackRate.value;d.connect(a.Fd);a.bc=d;a.Kd&&(d=J.createBufferSource(),d.loop=a.Kd.loop,d.buffer=a.Kd.buffer,d.playbackRate.value=a.Kd.playbackRate.value,d.connect(a.Fd),a.Kd=d);b.Ks=c;c=b.bc;p(b);c.start(b.gf,b.vz);m(b)}x(b,b.gf);b.state=20}}function f(a,b,d){var e=1,e=b.yT;if(0<e){var f=b.MY;if(0!=c.dot(a.sx,a.sx)||0!=c.dot(b.jm,b.jm)){var h=
c.subtract(a.sB,b.Th,A),k=c.length(h);b=c.dot(h,b.jm)/k;h=c.dot(h,a.sx)/k;h=-h;k=f/e;b=Math.min(-b,k);h=Math.min(h,k);e=(f-e*b)/(f-e*h);isFinite(e)||(e=0);e=Math.min(e,16);e=Math.max(e,.125);e=E.vc(e,a.LJ,d,.3);a.bc.playbackRate.value=e;a.LJ=e}}}function C(a){a=a.W;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function K(a){return a.muted?0:a.volume}function G(a){a=a.W;return(a=a.src)?a.duration:0}var L=r("__config"),D=r("__print"),N=r("__quat"),I=r("__time"),O=r("__tsr"),E=r("__util"),
c=r("__vec3"),k=L.A,y=L.W,A=new Float32Array(3),e=new Float32Array(3);new Float32Array(3);var R=N.create(),q=[],ba=[],J=null,F=null,V=[],U=[1],aa=null;a.kE=10;a.Gx=20;a.jE=30;a.AS=function(){return{qj:-1,Pg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,Jp:1,Cq:1,Mg:1E4,IG:360,JG:360,KG:1,autoplay:!1,ve:!1,loop:!1,SJ:0,Jv:0,sH:0,tH:0,Pm:0,io:0,Ll:0,zf:0,gf:0,fC:0,vz:0,duration:0,Ks:0,kz:1,src:null,state:10,sB:new Float32Array(3),sx:new Float32Array(3),wu:!1,LJ:1,lz:-1,mz:-1,Il:0,Fd:null,bc:null,Kd:null,
eC:null,Qg:null,Dn:null,Qj:null,tC:null,Ok:0}};a.Ug=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(q.push("ogg"),q.push("ogv"),q.push("oga")),""!=a.canPlayType("audio/mpeg")&&q.push("mp3"),""!=a.canPlayType("audio/mp4")&&(q.push("mp4"),q.push("m4v"),q.push("m4a")),""!=a.canPlayType("audio/webm")&&q.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(ba.push("ogv"),ba.push("ogg"),ba.push("oga")),""!=b.canPlayType("video/mp4")&&
(ba.push("m4v"),ba.push("mp4")),""!=b.canPlayType("video/webm")&&ba.push("webm"),""!=b.canPlayType("video/mpeg")&&ba.push("mp3"))};a.NQ=function(a){y.bE&&!J&&(J=n())&&D.log("%cINIT WEBAUDIO: "+J.sampleRate+"Hz","color: #00a");if(J){var b={Th:new Float32Array(3),jm:new Float32Array(3),Ok:0},c=J.createGain(),d=J.createGain();b.Dn=c;b.Qj=d;c.connect(d);d.connect(J.destination);if(a.b4w_enable_dynamic_compressor){var d=J.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;d.threshold.value=
e.threshold;d.knee.value=e.knee;d.ratio.value=e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.pq=d;b.Fd=d}else b.pq=null,b.Fd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Dq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Dq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Dq="exponential";break;case "NONE":b.Dq="none";break;default:E.q("Wrong audio distance model")}b.yT=a.audio_doppler_factor;b.MY=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=K(b);b.Il=0}else b=null;a.Nc=b};a.NX=function(a){F=a};a.sT=function(a){a||(a="ogg");return-1<q.indexOf(a)?a:-1<q.indexOf("m4a")?"m4a":-1<q.indexOf("oga")?"oga":""};a.uT=function(a){a||(a="webm");return-1<ba.indexOf(a)?a:-1<ba.indexOf("m4v")?"m4v":-1<ba.indexOf("webm")?"webm":""};a.Pk=function(a,b){var c=a.data,d=b.W;d.qj=a.data.sound.uuid;d.Pg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=J?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var e;J?(window.MediaElementAudioSourceNode?e=!0:(D.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!k.yG?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:E.q("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.wu=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.Jp=c.attenuation;d.Cq=c.distance_reference;d.Mg=c.distance_max||1E4;d.IG=c.cone_angle_inner;d.JG=c.cone_angle_outer;d.KG=c.cone_volume_outer;d.autoplay=
c.b4w_auto_play;d.ve=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.SJ=c.b4w_loop_start;d.Jv=c.b4w_loop_end;d.sH=c.b4w_delay;d.tH=c.b4w_delay_random;d.Pm=c.b4w_volume_random;d.io=c.b4w_pitch_random;d.Ll=c.b4w_fade_in;d.zf=c.b4w_fade_out;V.push(b)};a.hM=function(b){"SPEAKER"!=b.type&&E.q("Wrong object type");switch(b.W.behavior){case "POSITIONAL":return a.Gx;case "BACKGROUND_SOUND":return a.Gx;case "BACKGROUND_MUSIC":return a.jE;case "NONE":return a.kE;default:E.q("Wrong speaker behavior")}};a.ZZ=function(a,
b){var c=a.W;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:E.q("Wrong speaker behavior")}};a.AK=function(){var a=J.createBufferSource();a.buffer=J.createBuffer(1,22050,22050);a.connect(J.destination);a.start(0)};a.pT=function(a,b,c){J?J.decodeAudioData(a,b,c):c()};a.KY=function(a){g(a);a.W=null;V.splice(V.indexOf(a),1)};a.sa=function(){for(var a=0;a<V.length;a++){var b=V[a].W;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.bc&&b.bc.disconnect(),b.Kd&&b.Kd.disconnect())}F&&F.Nc&&(a=F.Nc,a.Th[0]=0,a.Th[1]=0,a.Th[2]=0,a.jm[0]=0,a.jm[1]=0,a.jm[2]=0);F=null;V.splice(0);aa=null};a.update=function(a){if(J&&0!=V.length){for(var b=0;b<V.length;b++){var c=V[b],d=c.W,e=d.bc,f=J.currentTime;!d.loop&&20==d.state&&d.duration&&d.gf+d.duration<f&&("BACKGROUND_MUSIC"==d.behavior||e&&!E.Rh(e.onended))&&(d.state=50);d.ve&&50==d.state&&t(c);20==d.state&&3>d.Ks-f&&m(d)}aa&&aa.ij.length&&(-1==aa.Ec||a>aa.uF+aa.zH[aa.Ec])&&(b=aa,-1<b.Ec&&
g(b.ij[b.Ec]),-1==b.Ec&&b.random?c=Math.round(Math.random()*(b.ij.length-1)):b.random?(c=1+Math.round(Math.random()*(b.ij.length-2)),c=(b.Ec+c)%b.ij.length):c=(b.Ec+1)%b.ij.length,t(b.ij[c]),b.Ec=c,b.uF=a)}};a.play=d;a.zK=t;a.stop=g;a.KV=function(a){return 20==a.W.state};a.V7=l;a.W7=w;a.a6=function(a,b){var c=a.W,d=c.Kd;if(C(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=J.currentTime+b;c.bc.stop(e);d.start(e,c.Jv)}};a.bX=function(a,b){var c=a.W;c.pitch=b;!C(a)||"POSITIONAL"!=
c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.bc.playbackRate.value=b,c.Kd&&(c.Kd.playbackRate.value=b),B(c),m(c))};a.A4=function(a){return a.W.pitch};a.ve=function(a,b){a.W.ve=Boolean(b)};a.AV=function(a){return a.W.autoplay};a.DV=function(a){return a.W.ve};a.fW=function(a,b,d,h,k){if(a=a.Nc){var g=A;g[0]=0;g[1]=0;g[2]=-1;c.transformQuat(g,d,g);e[0]=0;e[1]=1;e[2]=0;c.transformQuat(e,d,e);d=J.listener;d.setPosition(b[0],b[1],b[2]);d.setOrientation(g[0],g[1],g[2],e[0],e[1],e[2]);if(h&&a.Ok!=k){if(a.zB)a.zB=
!1,c.copy(b,a.Th);else for(d=a.jm,d[0]=(b[0]-a.Th[0])/h,d[1]=(b[1]-a.Th[1])/h,d[2]=(b[2]-a.Th[2])/h,c.copy(b,a.Th),b=0;b<V.length;b++)d=V[b],g=d.W,C(d)&&"POSITIONAL"==g.behavior&&g.wu&&f(g,a,h);a.Ok=k}else c.copy(b,a.Th)}};a.zB=function(){var a=F.Nc;a&&(a.zB=!0)};a.LY=function(a,b,d){var h=a.W;if(C(a)&&"POSITIONAL"==h.behavior){var k=O.fc(a.k.n,A);a=O.Xd(a.k.n,R);var g=h.eC;g.setPosition(k[0],k[1],k[2]);E.lc(a,E.$c,e);g.setOrientation(e[0],e[1],e[2]);h.wu&&(a=h.sB,b&&h.Ok!=d?(h.Gm?(c.copy(k,a),h.Gm=
!1):(g=h.sx,g[0]=(k[0]-a[0])/b,g[1]=(k[1]-a[1])/b,g[2]=(k[2]-a[2])/b,c.copy(k,a),f(h,F.Nc,b)),h.Ok=d):c.copy(k,a))}};a.X7=function(a){var b=a.W;C(a)&&"POSITIONAL"==b.behavior&&b.wu&&(b.Gm=!0)};a.WA=function(a){return a.W.behavior};a.Y1=function(){for(var a=0;a<V.length;a++)if(C(V[a]))return!0;return!1};a.o7=function(a){var b=F.Nc;b&&(b.volume=a,J&&(b.Dn.gain.value=K(b)))};a.k4=function(){var a=F.Nc;return a?a.volume:0};a.sY=function(a,b){var c=a.W;c.volume=b;C(a)&&(c.Dn.gain.value=K(c))};a.d5=function(a){return a.W.volume};
a.kc=function(a,b){a.W.muted=Boolean(b);C(a)&&(a.W.Dn.gain.value=K(a.W))};a.N5=function(a){return a.W.muted};a.f6=function(a){var b=F.Nc;b&&(b.muted=Boolean(a),J&&(b.Dn.gain.value=K(b)))};a.M5=function(){var a=F.Nc;return a?a.muted:!1};a.cV=function(){return V};a.pause=function(){for(var a=0;a<V.length;a++)l(V[a])};a.dj=function(){for(var a=0;a<V.length;a++)w(V[a])};a.a7=function(a,b){if(a.Nc&&a.Nc.pq){var c=a.Nc.pq;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.N3=function(a){if(!a.Nc||!a.Nc.pq)return null;a=a.Nc.pq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.V2=function(a,b,c){if(C(a)){a=a.W;var d=a.Qj,e=J.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Il=c}};a.B8=function(a){if(C(a)){a=a.W;var b=a.Qj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Il);
a.Il=0}};a.W2=function(a,b){if(J){var c=F.Nc,d=c.Qj,e=J.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Il=b}};a.C8=function(){if(J){var a=F.Nc,b=a.Qj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Il);a.Il=0}};a.H1=function(a,b,c){aa={Ec:-1,uF:0,random:c,ij:[],zH:[]};for(c=0;c<a.length;c++){var d=a[c],e=G(d);0==e?D.warn("Ignoring speaker with zero duration: "+d.name):(g(d),d.W.ve=!1,aa.ij.push(d),aa.zH.push(e+b))}};
a.T3=G;a.s2=function(){if(aa)for(var a=aa.ij,b=0;b<a.length;b++)g(a[b]);aa=null};a.D4=function(a){return(a=a.W)&&"POSITIONAL"==a.behavior?{dist_ref:a.Cq,dist_max:a.Mg,attenuation:a.Jp}:null};a.z7=function(a,b){var c=a.W;if(c&&"POSITIONAL"==c.behavior){c.Cq=b.dist_ref;c.Mg=b.dist_max;c.Jp=b.attenuation;var d=c.eC;d&&(d.refDistance=c.Cq,d.maxDistance=c.Mg,d.rolloffFactor=c.Jp)}};a.f7=function(a,b){var c=a.W;c&&c.Qg&&(c.Qg.frequency.value=b.freq,c.Qg.Q.value=b.Q,c.Qg.gain.value=b.gain)};a.Y3=function(a){return(a=
a.W)&&a.Qg?{freq:a.Qg.frequency.value,Q:a.Qg.Q.value,gain:a.Qg.gain.value}:null};a.X3=function(a,b,c,d){a=a.W;if(!a||!a.Qg)return null;a.Qg.getFrequencyResponse(b,c,d)};a.reset=function(){q.length=0;ba.length=0;J=null}};b4w.module.__time=function(a,r){function n(){return-1!==d.ll.Du?d.ll.Du:g}var d=r("__config");r("__print");var b=0,t=0,p=[],B=0,m=0,x=[],g=-1;a.KL=function(a){b=a;t=performance.now();for(a=0;a<p.length;a++){var d=p[a];b>d.xA&&(p.splice(a,1),a--,d.callback())}for(a=0;a<x.length;a++){var d=x[a],g=1-(d.xA-b)/d.duration,g=Math.min(g,1);d.callback(d.from+g*(d.to-d.from));1==g&&(x.splice(a,1),a--)}};a.ar=function(){return b};a.LL=function(a,d){var g;B++;g=B;p.push({id:g,callback:a,xA:b+(performance.now()-
t+d)/1E3});return g};a.Ut=function(a){for(var b=0;b<p.length;b++)if(p[b].id==a){p.splice(b,1);break}};a.St=function(a){for(var b=x.length;b--;)if(x[b].id==a){x.splice(b,1);break}};a.en=function(a,d,g,f){g/=1E3;var n;m++;n=m;x.push({id:n,callback:f,from:a,to:d,xA:b+g,duration:g});f(a);return n};a.reset=function(){t=b=0;p.length=0;m=B=x.length=0};a.sd=n;a.YX=function(a){g=a};a.Zq=function(a){return a*n()}};"object"==typeof module&&module.yA&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function r(){var a=n,d=a.getDate(),d=10>d?"0"+String(d):String(d),p=a.getMonth()+1,p=10>p?"0"+String(p):String(p),r=String(a.getFullYear()),m=a.getHours(),m=10>m?"0"+String(m):String(m),x=a.getMinutes(),x=10>x?"0"+String(x):String(x),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+p+"."+r+" "+m+":"+x+":"+a}var n=new Date(2017,3,13,22,39,45),d=[16,12,1];a.version=function(){return d};a.XD=function(){for(var a="",n=0;n<d.length;n++)a=1==n?a+(10>d[n]?"0"+
d[n]:d[n]):a+d[n],n!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.oH=function(){return n};a.kA=r;a.timestamp=function(){var a=r(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.yA&&b4w.module.__version(exports);b4w.module.__navmesh=function(a,r){function n(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.Wk,f=c.Wk,h=[],k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);if(2>h.length)return[];0<=b(h,e[0])&&0<=b(h,e[e.length-1])&&d(e);0<=b(h,f[0])&&0<=b(h,f[f.length-1])&&d(f);h=[];for(k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);return h}function d(a){function b(a){for(var c=a.hg,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.cX;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function t(a){function b(a,c){for(var d=0;d<a.length;d++)if(c===a[d])return d}for(var c={},e=a.Zo,f=0;f<e.length;f++)e[f][0]=parseFloat(e[f][0].toFixed(2)),e[f][1]=parseFloat(e[f][1].toFixed(2)),e[f][2]=parseFloat(e[f][2].toFixed(2));c.Zo=a.Zo;a=d(a);c.rB=[];for(f=0;f<a.length;f++){for(var e=
[],h=a[f],k=0;k<h.length;k++){for(var g=[],l=h[k],m=0;m<l.hg.length;m++)g.push(b(h,l.hg[m]));for(var q=[],m=0;m<l.hg.length;m++)q.push(n(l,l.hg[m]));l.gd[0]=parseFloat(l.gd[0].toFixed(2));l.gd[1]=parseFloat(l.gd[1].toFixed(2));l.gd[2]=parseFloat(l.gd[2].toFixed(2));e.push({id:b(h,l),hg:g,Wk:l.Wk,gd:l.gd,Tc:l.Tc,dX:q,CA:0,Tq:0,Hb:0,bS:1,ZD:!1,closed:!1,parent:null})}c.rB.push(e)}return c}function p(a,b,c,d,e){function f(a,b){D.subtract(a,b,I);return D.dot(I,I)}function h(a,b){for(var c=[],d=0;d<b.hg.length;d++)c.push(a[b.hg[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.CA=0;c.Tq=0;c.Hb=0;c.bS=1;c.ZD=!1;c.closed=!1;c.parent=null}})(a);var k=K.UQ(function(a){return a.CA});for(K.WF(k,b);0<k.content.length;){var g=K.VQ(k);if(g===c){a=g;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}g.closed=!0;for(var l=h(a,g),m=0,q=l.length;m<q;m++){var n=l[m];if(!n.closed){var y=g.Tq+D.dist(n.gd,g.gd),p=n.ZD;if(!p||y<n.Tq)n.ZD=!0,n.parent=g,n.Hb=n.Hb||f(n.gd,e)+f(n.gd,d),n.Tq=y,n.CA=n.Tq+n.Hb,p?K.WQ(k,
n):K.WF(k,n)}}}return[]}function B(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function m(a,b,c,d){b=D.subtract(b,a,I);a=D.subtract(c,a,O);a=D.cross(b,a,I);return L.sign(D.dot(d,a))}function x(a,b){D.subtract(a,b,I);return 1E-5>D.dot(I,I)}function g(a,b,c){var d=D.subtract(b.right,b.left,I),f=c.Tc,h=b.Tc;c=Math.acos(D.dot(f,h));f=L.sign(D.dot(d,D.cross(f,h,O)));c*=-f;f=G.identity(e);G.translate(f,b.left,f);G.rotate(f,c,d,f);G.translate(f,D.scale(b.left,-1,O),f);G.multiply(a,f,a)}function l(a,b,d,
e,f,h,l,m,q){for(var u=G.identity(y),n=f;n<d;n++)if(a[n].wJ&&(n>f||!n)){var p,w=b,x=e;p=a[n].left;var A=a[n].right,C=h,t=u,r=D.create(),F=D.transformMat4(p,t,E);F[3]=1;t=D.transformMat4(A,t,I);t=D.subtract(t,F,c);w=D.subtract(x,w,I);C=D.cross(C,w,k);.01>Math.abs(D.dot(C,t))?x=.5:(D.normalize(C,C),C[3]=-D.dot(C,x),x=-N.dot(C,F)/N.dot(C,t));A=D.subtract(A,p,I);p=D.scaleAndAdd(p,A,x,r);B(l,p);m&&B(q,a[n].Tc);n&&g(u,a[n],a[n-1])}}function h(a,b){function c(b,d){C=w=p=d;k=h=f=b;D.copy(b,n);D.copy(b,u);
D.copy(a[p].Tc,y)}var d=[],e=[],f,h,k,n,u,y,p=0,w=0,C=0;f=a[0].right;h=a[0].left;k=a[0].right;n=D.copy(h,R);u=D.copy(k,q);y=D.copy(a[0].Tc,F);B(d,f);b&&B(e,a[0].Tc);for(var t=G.identity(A),r=1;r<a.length;r++){var E=a[r].left,O=a[r].right,K=D.transformMat4(E,t,ba),I=D.transformMat4(O,t,J);a[r].wJ&&g(t,a[r],a[r-1]);if(0>=m(f,u,I,y)){var N=x(f,k);if(N||0<m(f,n,I,y))k=O,D.copy(I,u),C=r;else{(E=x(n,f))||l(a,n,w,f,p,y,d,b,e);t=G.identity(t);c(h,w);r=p;E||(B(d,f),b&&B(e,a[r].Tc));continue}}0<=m(f,n,K,y)&&
((N=x(f,h))||0>m(f,u,K,y)?(h=E,D.copy(K,n),w=r):((E=x(u,f))||l(a,u,C,f,p,y,d,b,e),t=G.identity(t),c(k,C),r=p,E||(B(d,f),b&&B(e,a[r].Tc))))}t=a.length-1;r=a[t].left;(E=x(f,r))||l(a,n,t,f,p,y,d,b,e);E&&p||B(d,r);return b?(B(e,a[t].Tc),{positions:new Float32Array(d),normals:new Float32Array(e)}):{positions:new Float32Array(d),normals:null}}function w(a,b,c,d,e){for(var f=null,h=Number.MAX_VALUE,k=0;k<a.length;k++){var g=a[k],l=e(c,g.gd,g.Wk,b,h);l<h&&(f=g,h=l)}return 0<d&&h>d?null:f}function f(a,b,c,
d,e){a.push({left:b,right:c,wJ:d,Tc:e})}var C=r("__geometry"),K=r("__math"),G=r("__mat4"),L=r("__util"),D=r("__vec3"),N=r("__vec4"),I=D.create(),O=D.create(),E=N.create(),c=N.create(),k=N.create(),y=G.create(),A=G.create(),e=G.create(),R=D.create(),q=D.create(),ba=D.create(),J=D.create(),F=D.create();a.HW=function(a){var b=C.Vu(a.nc,C.MP),c=a.ie;a=[];for(var d=0;d<c.length;d+=3)a.push({ma:new Uint32Array([c[d],c[d+1],c[d+2]]),gd:new Float32Array(3),Tc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],D.add(c[d.ma[0]],c[d.ma[1]],I),D.add(I,c[d.ma[2]],I),D.scale(I,1/3,d.gd);for(b=0;b<a.length;b++){var d=a[b],e=D.subtract(c[d.ma[1]],c[d.ma[0]],I),f=D.subtract(c[d.ma[2]],c[d.ma[0]],O),e=D.cross(e,f,I);D.normalize(e,e);D.copy(e,d.Tc)}for(var h={},b=[],d=[],k,g,l=Math.pow(10,4),e=0,f=c.length;e<f;e++)k=c[e],g=Math.round(k[0]*l)+"_"+Math.round(k[1]*l)+"_"+Math.round(k[2]*l),void 0===h[g]?(h[g]=e,b.push(k),
d[e]=b.length-1):d[e]=d[h[g]];h=[];e=0;for(f=a.length;e<f;e++)for(k=a[e],k.ma[0]=d[k.ma[0]],k.ma[1]=d[k.ma[1]],k.ma[2]=d[k.ma[2]],k=[k.ma[0],k.ma[1],k.ma[2]],g=0;3>g;g++)if(k[g]==k[(g+1)%3]){h.push(e);break}for(e=h.length-1;0<=e;e--)a.splice(h[e],1);c.length=0;for(e in b)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)f=a[b],d.push({id:e++,Wk:f.ma,gd:f.gd,Tc:f.Tc,hg:[]});a={cX:d,Zo:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)f=d[b].Wk[e],h=d[b].Wk[(e+1)%3],f=f>h?h+"-"+f:f+"-"+h,f in c||(c[f]=[]),c[f].push(d[b]);
d=Object.keys(c);b=0;for(h=d.length;b<h;b++)for(f=d[b],e=0;e<c[f].length;e++)for(k=e+1;k<c[f].length;k++)c[f][e].hg.push(c[f][k]),c[f][k].hg.push(c[f][e]);return t(a)};a.dK=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.rB,h=0;h<f.length;h++)for(var k=0;k<f[h].length;k++){var g=f[h][k];D.subtract(g.gd,b,I);g=c(b,g.gd,g.Wk,a.Zo,e);g<e&&(d=h,e=g)}return d};a.LV=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-1;++c<e;f=c)(d[c][1]<=a[1]&&a[1]<d[f][1]||
d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.cK=function(a,b,c,d){var e;e=a.rB[d.island];var k=a.Zo,g=w(e,k,b,d.allowed_distance,d.distance_to_closest);e=g?(k=w(e,k,c,d.allowed_distance,d.distance_to_farthest))?p(e,g,k,b,c):null:null;if(e&&e.length)if(d.do_not_pull_string)if(c=e,d.return_normals){b=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].gd,3*e);c={positions:b,normals:null}}else{b=new Float32Array(3*
c.length);a=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].gd,3*e),a.set(c[e].Tc,3*e);c={positions:b,normals:a}}else{a=a.Zo;d=d.return_normals;g=[];f(g,b,b,!1,e[0]&&e[0].Tc||L.ad);for(b=0;b<e.length;b++){var l=e[b];if(k=e[b+1]){var m=.999>Math.abs(D.dot(l.Tc,k.Tc));a:{for(var u=0;u<l.hg.length;u++)if(l.hg[u]===k.id){l=l.dX[u];break a}l=void 0}f(g,a[l[0]],a[l[1]],m,k.Tc)}}f(g,c,c,!1,g[g.length-1].Tc);c=h(g,d)}else c=null;return c}};b4w.module.__prerender=function(a,r){function n(a,d){var h=a.bf;h.Tn=!1;if(h.Ph)return!1;var n=d.p,t=d.type==m.dd?n.Iv:x.fc(n.n,w);if("STATIC"==h.type&&h.Pn)var r=h.zr,B=h.Ar;else r=h.kb.G,B=h.kb.Xa;var I=h.Yg,O=h.af,t=l.dist(r,t);if(!(t<I?0:O==p.np||t<O+h.Zg*B))return!1;h.Tn=!0;O=a.za;if(d.type==m.rf)return d.debug_view_mode==b.Vs?O.Gi:!O.Gi;if(d.type==m.yg&&0==h.gh)return!1;h.Vo?(B=O.kb,I=O.pb,h=O.Nf):(B=h.kb,I=h.pb,h=h.Nf);if(O=!O.Mj)n=n.Lh,O=B.G,g.NY(O,n,B.Xa)?O=!0:h?(O=I.G,O=g.FT(O,n,I.Ha,I.Ia,
I.Ja)):O=!1;return O?!1:!0}function d(a){var b=a.gb;if(b&&b.eK){a=a.Ba;t.rW(a);var d=a.ld,h=d.a_position.offset;t.qN(a.nc,"a_position",b.mC,h);h=d.a_tbn_quat.offset;t.qN(a.nc,"a_tbn_quat",b.yD,h);t.ZM(a)}}r("__config");var b=r("__debug"),t=r("__geometry"),p=r("__obj_util"),B=r("__renderer"),m=r("__subscene"),x=r("__tsr"),g=r("__util"),l=r("__vec3"),h=[m.Pb,m.Lc,m.Nd,m.nd,m.sf,m.Ke,m.ee,m.Pf,m.dd,m.tf,m.yg,m.rf,m.pf,m.qi],w=new Float32Array(3);a.ow=function(a){if(-1<h.indexOf(a.type)){for(var b=!1,
g=a.type==m.nd||a.type==m.Ke,l=a.Ra,p=0;p<l.length;p++){for(var w=l[p],x=w.ra,t=!1,r=0;r<x.length;r++){var E=x[r],c=E.za;if(g)for(var k=0;6>k;k++)a.p.Lh=a.vq[k],E.tA[k]=n(E,a),E.tA[k]&&(t=b=!0,d(c));else E.ac=n(E,a),E.ac&&(t=b=!0,d(c));a.Aa&&(c.yb.Er=!0)}w.ac=t}a.Aa=!1;switch(a.type){case m.rf:break;default:a.type==m.Pb||a.type==m.tf||a.type==m.ee||a.type==m.Nd||a.type==m.nd||b?a.ac=!0:(a.ac&&B.clear(a),a.ac=!1)}}else if(a.Aa){l=a.Ra;for(p=0;p<l.length;p++)for(x=l[p].ra,r=0;r<x.length;r++)E=x[r],
c=E.za,c.yb.Er=!0;a.Aa=!1}a.SB&&m.HY(a)}};b4w.module.__primitives=function(a,r){function n(a,b,d,n){for(var f=[],p=[],x=[],t=[],r=2*d/(a-1),D=2*n/(b-1),N=0;N<a;N++)for(var I=-d+N*r,O=0;O<b;O++)if(p.push(I,-n+O*D,0),t.push(0,0,0,1),x.push(N/(a-1),O/(b-1)),N&&O){var E=N*b+O,c=E-1,k=(N-1)*b+O,y=k-1;f.push(E,c,k);f.push(c,y,k)}a=m.Ig();a.a_position=new Float32Array(p);a.a_tbn_quat=new Float32Array(t);t=B.Df("GRID_PLANE");t.Z[0]=a;t.pa.a_texcoord=new Float32Array(x);t.ma=new Uint32Array(f);t.Ka=p.length/3;return t}function d(a){var b=a.length;
b%4&&m.q("Wrong array");for(var d=[],n=[],f=0;f<b;f+=4){var p=a[f+1],x=a[f+2],r=a[f+3];t(a[f],n);t(p,n);t(x,n);t(r,n);d.push(f,f+1,f+2);d.push(f,f+2,f+3)}a=m.Ig();a.a_position=new Float32Array(n);b=B.Df("FROM_QUADS");b.Z[0]=a;b.ma=new Uint32Array(d);b.Ka=n.length/3;return b}function b(a,b){var d=3*b;return[a[d],a[d+1],a[d+2]]}function t(a,b){b.push(a[0],a[1],a[2])}var p=r("__config"),B=r("__geometry");r("__print");var m=r("__util"),x=p.A;a.wU=function(){var a=B.Df("LINE"),b=m.Ig();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.Z[0]=b;a.ma=new Uint32Array(1);a.Ka=1;return a};a.C3=function(a,b){var d=n(2,2,a,b);d.name="PLANE";return d};a.B3=n;a.pU=function(a,b,d){function n(a,b){return 1==a%2&&(0==b||b==r-1)||1==b%2&&(0==a||a==t-1)?!0:!1}var f=d/=Math.pow(2,a-1),p=d,t=b+1,r=b+1;b=[];d=[];for(var L=[],D=0,N=0,I=-1,O=[],E=0;E<a;E++){for(var c=2*f/(t-1),k=2*p/(r-1),y=[],A=[],e=0,R=0;R<t;R++){for(var q=-f+R*c,ba=[],J=0;J<r;J++){var F=-p+J*k;if(q>-D&&q<D&&F>-N&&F<N)ba.push(-1),e++;else{for(var V=
null,U=0;U<O.length;U+=3)if(q==O[U]&&F==O[U+1]){V=O[U+2];break}U=null!==V?V:I+1;n(R,J)?(ba.push(-2),e++):(null==V&&(0==J||J==r-1||0==R||R==t-1?(V=E==a-1?c:2*c,y.push(q,F,U)):V=c,d.push(q,F,V),L.push(.707,0,0,.707),I++),ba.push(U));if(R&&J)if(1==R)if(n(R-1,J)){if(1<J){var F=U-1,V=A[R-1][J+1],aa=V-1;b.push(aa,F,U)}else V=A[R-1][J+1],aa=V-1;b.push(V,aa,U)}else n(R,J)||(F=U-1,V=A[R-1][J],b.push(V,F,U));else if(R==t-1){if(!n(R,J))if(J==r-1)F=U-1,V=A[R-1][J-1],aa=A[R-2][J],b.push(V,F,U),b.push(aa,V,U);
else{var F=U-1,V=A[R-1][J],aa=V-1,v=V+1;b.push(aa,F,U);b.push(V,aa,U);b.push(v,V,U);2==J&&(v=A[R-2][J-2],b.push(aa,v,F))}}else 1==J?n(R,J-1)?(F=A[R-1][J],V=A[R-1][J-1],b.push(F,V,U)):(F=ba[J-1],V=A[R-1][J],aa=A[R-2][J-1],b.push(V,F,U),b.push(V,aa,F)):J==r-1?n(R,J)||(F=ba[J-1],V=A[R-1][J-1],aa=A[R-2][J],b.push(V,F,U),b.push(aa,V,U)):-1!=A[R-1][J]&&-1!=A[R-1][J-1]&&-1!=ba[J-1]?(F=ba[J-1],V=A[R-1][J],aa=A[R-1][J-1],b.push(V,F,U),b.push(V,aa,F),J==r-2&&n(R,J+1)&&(v=A[R-1][J+1],b.push(v,V,U))):J==r-2&&
n(R,J+1)&&(V=A[R-1][J],v=A[R-1][J+1],b.push(v,V,U))}}A.push(ba)}O=y;D=f;N=p;f*=2;p*=2}if(2E4>D)for(a=-(2*D)/(t-1),d.push(-2E4,-2E4,a),d.push(-2E4,2E4,a),d.push(-D,-N,a),d.push(-D,N,a),d.push(2E4,-2E4,a),d.push(2E4,2E4,a),d.push(D,-N,a),d.push(D,N,a),U=I+1,b.push(U+1,U+2,U+3,U+1,U+0,U+2,U+2,U+4,U+6,U+2,U+0,U+4,U+1,U+7,U+5,U+1,U+3,U+7,U+7,U+4,U+5,U+6,U+4,U+7),R=0;8>R;R++)L.push(.707,0,0,.707);a=m.Ig();a.a_position=new Float32Array(d);a.a_tbn_quat=new Float32Array(L);f=B.Df("MULTIGRID_PLANE");f.Z[0]=
a;f.ma=new Uint32Array(b);f.Ka=d.length/3;x.CN&&(B.dx(f,1,!0),a.a_polyindex=B.yu(f));return f};a.A3=function(a){var b=a.length;b%3&&m.q("Wrong array");for(var d=[],n=[],f=0;f<b;f+=3){var p=a[f+1],x=a[f+2];t(a[f],n);t(p,n);t(x,n);d.push(f,f+1,f+2)}a=m.Ig();a.a_position=new Float32Array(n);b=B.Df("FROM_TRIANGLES");b.Z[0]=a;b.ma=new Uint32Array(d);b.Ka=n.length/3;return b};a.z3=d;a.tU=function(a){a=m.n_(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],
a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.Qc=function(){var a=B.Df("FULLSCREEN_TRI"),b=m.Ig();b.a_position=new Float32Array([0,0,1,0,0,1]);a.Z[0]=b;a.ma=new Uint32Array([0,1,2]);a.Ka=3;return a};a.uU=function(){var a=B.Df("FULLSCREEN_QUAD"),b=m.Ig();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.Z[0]=b;a.ma=new Uint32Array([0,2,1,1,2,3]);a.Ka=4;return a};a.oU=function(){var a=B.Df("BILLBOARD"),b=m.Ig();b.a_bb_vertex=B.QH(1);
a.Z[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ka=4;return a};a.qU=function(){var a=B.Df("CUBEMAP_BOARD"),b=m.Ig();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.Z[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ka=4;return a};a.Gu=function(a,d){var h=B.Df("UV_SPHERE"),n,f,p=[],x=[],r=[];for(f=0;8>=f;f++)for(n=0;16>=n;n++){var L=n/16,D=f/8;x.push(-a*Math.cos(2*L*Math.PI)*Math.sin(D*Math.PI)+d[0],a*Math.cos(D*Math.PI)+d[1],a*Math.sin(2*L*Math.PI)*Math.sin(D*Math.PI)+d[2])}for(f=L=0;8>f;f++)for(n=
0;16>n;n++){var D=b(x,17*f+n+1),N=b(x,17*f+n),I=b(x,17*(f+1)+n),O=b(x,17*(f+1)+n+1);Math.abs(D[1])==a+d[1]?(t(D,p),t(I,p),t(O,p),r.push(L,L+1,L+2),L+=3):Math.abs(I[1])==a+d[1]?(t(D,p),t(N,p),t(I,p),r.push(L,L+1,L+2),L+=3):(t(D,p),t(N,p),t(I,p),t(O,p),r.push(L,L+1,L+2),r.push(L,L+2,L+3),L+=4)}n={};n.a_position=p;x=B.nR(r,x,p);x=B.kR(r,p,x);n.a_tbn_quat=m.Wq(x);h.Z[0]=n;h.ma=r;h.Ka=p.length/3;return h};a.UH=function(a){var b=B.Df("INDEX"),d=m.Ig();d.a_index=new Float32Array(3*a);for(var n=new Uint16Array(3*
a),f=0;f<3*a;f++)d.a_index[f]=f,n[f]=f;b.Z[0]=d;b.ma=n;b.Ka=3*a;return b}};b4w.module.__scenegraph=function(a,r){function n(a,b){var c=[];q.sg(a,function(b,d,e){-1<c.indexOf(e)?q.xX(a,b,d,e,N(e)):c.push(e)});q.oa(a,function(a,d){for(var e=0;e<d.Ya.length;e++){var f=d.Ya[e];b||d.type!=J.Nd&&d.type!=J.nd&&d.type!=J.Pf||(f.jf=!0);-1<c.indexOf(f)?d.Ya[e]=N(f):c.push(f)}})}function d(a,c){q.oa(a,function(b,d){d.type==J.gE&&q.ii(a,b,function(a,b){if(b.type==J.vh)for(var c=0;c<b.Ya.length;c++){var d=b.Ya[c];d.Oa=F.K;d.Na=F.K}});c||q.ii(a,b,function(a,b,c){"DEPTH"==c.from&&(c.jf=
!0)})});q.oa(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],h=0;h<c.length;h++)if(c[h].Oa==F.K){f=c[h];break}for(var k=c[0],h=0;h<c.length;h++)if(c[h].Na==F.K){k=c[h];break}for(var g=c[0],h=0;h<c.length;h++)if(!c[h].jf){g=c[h];break}for(h=0;h<c.length;h++)c[h].Oa=f.Oa,c[h].Na=k.Na,c[h].jf=g.jf}})}function b(a,c,d){q.ii(a,c,function(c,e,f){f.Ec&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});q.Lk(a,c,function(a,b,c){c.Ec&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=q.Va(a,c);if(c.type==J.vh)for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];d[f.from].push(f)}}function t(a){var b=[J.vh,J.Ty,J.qt,J.Nd,J.nd,J.qp],c=q.DD(a),d=[];q.oa(c,function(a,e){for(var f=0;f<e.Ya.length;f++){var h=e.Ya[f];-1<b.indexOf(e.type)&&(h.lx=!0);var k=g(d,h,p(h));h.jb=k;e.hi[f]=k}for(f=0;f<e.hi.length;f++)k=e.hi[f],x(d,k);q.Lk(c,a,function(f,h,k){-1<b.indexOf(e.type)&&(k.lx=!0);k.jb||((f=B(c,a,k.from))&&k.Ec&&!k.jb?m(d,f):f=g(d,
k,p(k)),k.jb=f)});q.ii(c,a,function(a,b,c){x(d,c.jb)});q.Lk(c,a,function(a,b,c){c.jb&&"NONE"==c.to&&x(d,c.jb)})})}function p(a){a=V.Eh(a);delete a.to;delete a.Ec;delete a.jb;return JSON.stringify(a)}function B(a,b,c){var d=null;q.ii(a,b,function(a,b,e){if(e.Ec&&e.from==e.to&&e.from==c&&e.jb)return d=e.jb,!0});q.Lk(a,b,function(a,b,e){if(e.Ec&&e.from==c&&e.jb)return d=e.jb,!0});return d}function m(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.zD===b&&d.Yr++}}function x(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.zD===b&&d.Yr&&d.Yr--}}function g(a,b,c){if(b.fo)return m(a,b.fo.jb),b.fo.jb;if(b.lx)return l(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Yr){d=f;break}}if(d&&!aa.HH)return d.Yr++,d.zD;b=l(b);a.push({id:c,Yr:1,zD:b});return b}function l(a){var b=a.Bm*a.size,c=a.Cm*a.size;switch(a.from){case "COLOR":if(a.jf){var d=F.Cl(a.gk?F.vt:F.ut,a.Bs);F.resize(d,b,c)}else d=F.Cl(F.wh,a.Bs),F.resize(d,b,c),F.QC(d,a.Oa,a.Na);return d;case "DEPTH":return a.jf?(d=F.Cl(a.gk?F.tt:F.st,a.Bs),
F.resize(d,b,c)):(d=F.Cl(F.fl,a.Bs),F.resize(d,b,c),F.QC(d,a.Oa,a.Na)),d;case "CUBEMAP":return d=F.PG(b);case "SCREEN":case "NONE":return null;default:V.q("Wrong slink param: "+a.from)}}function h(a,b){var c=!1;q.sg(a,function(d,e,f){if(f&&(d=q.Va(a,d),e=q.Va(a,e),b(f,!1,d,e)))return c=!0});c||q.oa(a,function(a,c){for(var d=0;d<c.Ya.length;d++)if(b(c.Ya[d],!0,c,null))return!0})}function w(a){q.oa(a,function(b,c){if(c.type!=J.bn){var d=c.p;q.Lk(a,b,function(a,b,c){c.Ec&&c.jb&&(A.Cw(d,c.from,c.jb),
c.from==c.to&&b.p&&A.Cw(b.p,c.from,c.jb))});for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];f.Ec&&f.from==f.to&&A.Cw(d,f.from,c.hi[e])}!d.qc&&!d.Re||d.Ve||(d.Ve=ba.tX(d.qc,d.Re))}});q.oa(a,function(b,c){if(c.type==J.an||c.type==J.Ox){var d=E(a,c);c.p.Sq=d[0].p.Ve}})}function f(a){var b=null,c=0;q.oa(a,function(a,d){if(d.type==U.$Y){if(c==U.ZY)return b=d,!0;c++}});return b}function C(a,b){var c=q.bh(a,b),d=J.Ad("NONE"),e=q.J(a,d),f=q.$q(a)[0];q.sg(a,function(b,c){c==f&&q.nX(a,b,f,b,e)});var h=K(b,a);
q.sg(a,function(e,f,k){if(e==c){if(h){e=J.fu();q.J(a,e);f=D("COLOR","RESOLVE",1,1,1,!0);f.gk=!0;f.jf=!0;var g=D("DEPTH","RESOLVE",1,1,1,!0);g.gk=!0;g.jf=!0;q.r(a,b,e,f);q.r(a,b,e,g);b=e}q.r(a,b,d,D(U.BY,"u_color",k.size,k.Bm,k.Cm,k.xs));return!0}});q.fd(a,e,f,D("SCREEN","NONE",.5,.5,.5,!0))}function K(a,b){var c=!1,d=q.bh(b,a);q.mg(b,d)&&(c=q.Tg(b,d,0),d=q.Wd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=q.Va(b,c),c=K(d,b)):c="RESOLVE"==d.to);return c}function G(a,b,c,
d){var e=c.ba,f=b.kv,h=b.$h.Xh,k=b.$h.mw,g=q.bx(a,q.ZU(a,d),q.Ss),l=[],m=[],n=[],g=q.clone(g,function(b){var d;if(-1<fa.indexOf(b.type))m.push(b),d=b;else{d=J.YR(b);if(d.type==J.Nd)for(var g=0;g<h.length;g++)if(h[g][0]==b){h[g]=[b,d];d.p.mc=b.p.mc;c.ba.push(d.p);break}if(b.type==J.sf)for(g=0;g<h.length;g++){if(k[g][0]==b){k[g]=[b,d];d.p=h[g][1].p;break}}else-1<e.indexOf(b.p)&&(f?(A.Lv(b.p,A.Le),A.Lv(d.p,A.Me)):(A.Lv(b.p,A.Mc),A.Lv(d.p,A.ed)),e.push(d.p));var y=q.bh(a,b);q.ii(a,y,function(a,b,c){-1<
fa.indexOf(b.type)&&l.push([b,d,c])});if(b.type!==J.vh)for(g=0;g<b.Ya.length;g++)d.Ya[g].fo=b.Ya[g];b=!0;for(g=0;g<q.Mn(a,y);g++){var v=q.Ni(a,y,g),v=q.Va(a,v);-1==fa.indexOf(v.type)&&(b=!1)}b&&n.push(d)}return d},function(a){var b=N(a,!0);b.fo=a;return b});q.sg(g,function(a,b,c){q.Va(g,a).type===J.vh&&(c.fo=null)});for(var y=0;y<m.length;y++)q.pg(g,q.bh(g,m[y]));q.Gz(g);b=J.cT(f);var y=q.J(a,b),v=J.bA();q.J(a,v);var p=D("COLOR","COPY",1,1,1,!0);q.r(a,d,v,p);var x=D("COLOR","u_sampler_left",1,1,1,
!0);x.lx=!0;x.Oa=F.K;x.Na=F.K;q.r(a,v,b,x);d.uc||(d=J.bA(),q.J(g,d),x=D("COLOR","COPY",1,1,1,!0),x.fo=p,p=q.$q(g)[0],p=q.Va(g,p),q.r(g,p,d,x));d=D("COLOR","u_sampler_right",1,1,1,!0);d.Oa=F.K;d.Na=F.K;q.vQ(g,a,[q.$q(g)[0],y,d]);for(y=0;y<l.length;y++)q.r(a,l[y][0],l[y][1],l[y][2]);d=D("SCREEN","NONE",0,0,0,!1);for(y=0;y<n.length;y++)q.r(a,v,n[y],d);f&&L(a,.5,1);return b}function L(a,b,c){var d=[];q.oa(a,function(b,c){if(-1==fa.indexOf(c.type)&&c.Ya.length&&I(a,c,J.ti))for(var e=0;e<c.Ya.length;e++){var f=
c.Ya[e];-1==d.indexOf(f)&&d.push(f)}});q.sg(a,function(b,c,e){b=q.Va(a,b);c=q.Va(a,c);-1==fa.indexOf(b.type)&&I(a,c,J.ti)&&-1==d.indexOf(e)&&d.push(e)});for(var e=0;e<d.length;e++)d[e].Bm*=b,d[e].Cm*=c}function D(a,b,c,d,e,f){return{from:a,to:b,size:c,Bm:d,Cm:e,xs:f,Ec:!0,jb:null,gk:!1,jf:!1,Oa:F.re,Na:F.re,lx:!1,Bs:!1}}function N(a,b){if(b){var c=a.jb;a.jb=null}a.jb&&V.q("Failed to clone slink with attached texture");var d=V.Eh(a);b&&(a.jb=c,d.jb=c);return d}function I(a,b,d){if(b.type==d)return!0;
b=c(a,b);for(var e=0;e<b.length;e++)if(I(a,b[e],d))return!0;return!1}function O(a,b,c){if(b.type==c)return!0;b=E(a,b);for(var d=0;d<b.length;d++)if(O(a,b[d],c))return!0;return!1}function E(a,b){var c=q.bh(a,b);c==q.Py&&V.q("Subscene not in graph");for(var d=[],e=q.Mn(a,c),f=0;f<e;f++){var h=q.Ni(a,c,f);h!=c&&d.push(q.Va(a,h))}return d}function c(a,b){var c=q.bh(a,b);c==q.Py&&V.q("Subscene not in graph");for(var d=[],e=q.mg(a,c),f=0;f<e;f++){var h=q.Tg(a,c,f);h!=c&&d.push(q.Va(a,h))}return d}function k(a){var b=
[],c=[];h(a,function(a){a.jb&&-1==b.indexOf(a.jb)&&(b.push(a.jb),c.push(a.jb,b.length-1))});return c}function y(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.xs){var d=a.Bm,e=a.Cm;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.Bm,e=a.Cm,c+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){c+=" ";if(a.jf)c+="RR";else{var d=a.Oa,e=a.Na,f="";d==F.K?f+="L":d==F.re&&(f+="N");e==F.K?f+="L":e==F.re&&(f+="N");c+=f}for(d=
0;d<b.length;d+=2)b[d]==a.jb&&(c+=" "+b[d+1])}return c+")\\n"}var A=r("__camera"),e=r("__config"),R=r("__debug"),q=r("__graph"),ba=r("__renderer"),J=r("__subscene"),F=r("__textures"),V=r("__util"),U=e.yq,aa=e.A,v=e.qo,fa=[J.ri,J.dd,J.nd,J.Ke];a.LR=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.rZ=h;a.yS=function(a,b,e,h){function k(c){var d=A.Fc(Sa,!0);b.ba.push(d);d=J.Bl(c,d,!1,
I,K,Da,Ha,Ra,a.lj);q.J(g,d);c==J.Pf?(q.r(g,l[0],d,D("COLOR","COLOR",1,1,1,!0)),d.Ya.push(D("DEPTH","DEPTH",1,1,1,!0))):(c=ga&&l[0].type==J.an?Ab:l[0],q.r(g,c,d,Pa),q.r(g,c,d,Mb));Fa&&(q.r(g,Fa,d,Za),q.r(g,Fa,d,mb));for(c=0;c<y.length;c++)q.r(g,y[c],d,p[c]);Va&&q.r(g,Va,d,Ga);if(x.length){var e=x.length;for(c=0;c<e;c++)q.r(g,x[c],d,r[c])}if(B.length)for(c=0;c<B.length;c++)q.r(g,B[c],d,O[c]);Gb&&q.r(g,Gb,d,fc);return d}var g=q.create(),l=[],m=[],y=[],p=[],x=[],r=[],B=[],O=[],K=a.RV,I=a.Jc,L=a.Dk,fa=
a.DY,P=a.ssao,ba=a.god_rays,z=a.$h,ma=a.VJ,Ea=a.XQ,ea=a.motion_blur,ya=a.compositing,na=a.antialiasing,Ha=a.cp,Da=a.FN,Ra=a.wd,ra=a.zW,wa=a.wR,va=a.hV,xa=a.OW,Ka=a.dof,Na=a.rT,da=a.refractions,T=Boolean(h.length),ga=1<aa.Cc,Mb=D("COLOR","COLOR",1,1,1,!0),Pa=D("DEPTH","DEPTH",1,1,1,!0);if(ga){N(Pa);var eb=N(Pa);Mb.gk=!0;Mb.jf=!0;Pa.gk=!0;Pa.jf=!0}var Sa=b.ba[0];if(Ra){A.PD(Sa,Ra);for(var ia=0;ia<Ra.Xg.length;ia++)for(var Ta=Ra.csm_num,ka=0;ka<Ta;ka++){var W=J.YS(ka,ia,Ra,K);q.J(g,W);y.push(W);var Qa=
Ra.csm_resolution,Ca=W.p;b.WL.push(Ca);Ca.width=Qa;Ca.height=Qa;W.vb=!1;var Ba=D("DEPTH","u_shadow_map"+(0<ia?ia:ka),Qa,1,1,!1);aa.mq&&(Ba.Oa=F.K,Ba.Na=F.K,Ba.Bs=!0);p.push(Ba);(R.ER()||aa.XL)&&W.Ya.push(D("COLOR","COLOR",Qa,1,1,!1))}}if(z&&z.kK&&!T)for(ka=0;ka<z.kK;ka++){Ca=A.hd(A.Od);Ca.width=a.Fi;Ca.height=a.Fi;A.Fw(Ca,90,.1,100);A.Bk(Ca,Ca.zb);var Oa=J.Bl(J.nd,Ca,!1,I,K,Da,Ha,null,a.lj);Oa.Dl=V.vU();for(ia=0;6>ia;ia++)Oa.vq.push(A.nS());q.J(g,Oa);var zb=D("CUBEMAP","u_cube_reflection",a.Fi,1,
1,!1);zb.Oa=F.K;zb.Na=F.K;O.push(zb);if(z.dJ){var cb=J.Bl(J.Ke,Ca,!1,I,K,Da,Ha,null,a.lj);cb.Dl=Oa.Dl;cb.vq=Oa.vq;q.J(g,cb);var Aa=D("DEPTH","DEPTH",a.Fi,1,1,!1),Xa=D("COLOR","COLOR",a.Fi,1,1,!1);q.r(g,Oa,cb,Aa);q.r(g,Oa,cb,Xa);B.push(cb);z.gA.push(cb)}else{var vb=D("DEPTH","DEPTH",a.Fi,1,1,!1);Oa.Ya.push(vb);B.push(Oa)}z.Ei.push(Oa)}if(z&&0<z.SK.length&&!T)for(ia=0;ia<z.SK.length;ia++)Ca=A.Fc(Sa,!0),Ca.mc=new Float32Array(4),b.ba.push(Ca),Oa=J.Bl(J.Nd,Ca,!1,I,K,Da,Ha,null,a.lj),q.J(g,Oa),zb=D("COLOR",
"u_plane_reflection",1,a.ih,a.ih,!0),zb.Oa=F.K,zb.Na=F.K,r.push(zb),z.dJ?(cb=J.Bl(J.sf,Ca,!1,I,K,Da,Ha,null,a.lj),q.J(g,cb),Aa=D("DEPTH","DEPTH",1,a.ih,a.ih,!0),Xa=D("COLOR","COLOR",1,a.ih,a.ih,!0),Xa.Oa=F.re,Xa.Na=F.re,q.r(g,Oa,cb,Aa),q.r(g,Oa,cb,Xa),z.mw.push([cb]),x.push(cb)):(vb=D("DEPTH","DEPTH",1,a.ih,a.ih,!0),Oa.Ya.push(vb),x.push(Oa)),z.Xh.push([Oa]);if(a.jd){var Fa=J.RS();q.J(g,Fa);Qa=v.fr;Fa.p.width=Qa;Fa.p.height=Qa;var Za=D("DEPTH","u_grass_map_depth",Qa,1,1,!1);aa.cc||(Za.Oa=F.K,Za.Na=
F.K);var mb=D("COLOR","u_grass_map_color",Qa,1,1,!1);mb.Oa=F.K;mb.Na=F.K}else mb=Za=Fa=null;if(Na&&Ra){var jb=A.Fc(Sa,!0);b.ba.push(jb);var ib=J.ZS(jb,K);q.J(g,ib);ib.self_shadow_normal_offset=Ra.self_shadow_normal_offset;for(ka=0;ka<y.length;ka++)W=y[ka],q.r(g,W,ib,p[ka]);var kc=D("COLOR","u_color",1,1,1,!0),ab=D("DEPTH","u_depth",1,1,1,!0);if(P){var bb=A.Fc(Sa,!0);b.ba.push(bb);var Ua=a.TY,yb=J.aT(bb,Da,Ua);q.J(g,yb);var Cc=D("COLOR","u_ssao_mask",1,1,1,!0);q.r(g,ib,yb,kc);q.r(g,ib,yb,ab);var Rb=
A.Fc(Sa,!0);b.ba.push(Rb);var Nb=J.bT(Rb,Ua);q.J(g,Nb);var Ob=D("COLOR","u_shadow_mask",1,1,1,!0);q.r(g,yb,Nb,Cc);q.r(g,ib,Nb,ab)}ga?ib.Ya.push(D("DEPTH","DEPTH",1,1,1,!0)):ib.Ya.push(Pa);Fa&&(q.r(g,Fa,ib,Za),q.r(g,Fa,ib,mb))}else ib=null;var Ab=J.Bl(J.Pb,Sa,!0,I,K,Da,Ha,null,a.lj);q.J(g,Ab);if(ga){var fb=J.fu();q.J(g,fb);m.push(fb);var lc=D("COLOR","RESOLVE",1,1,1,!0);lc.gk=!0;lc.jf=!0;var Nc=D("DEPTH","RESOLVE",1,1,1,!0);Nc.gk=!0;Nc.jf=!0;q.r(g,Ab,fb,lc);q.r(g,Ab,fb,Nc)}else m.push(Ab);ib&&(Cc?
q.r(g,Nb,Ab,Ob):Ra?q.r(g,ib,Ab,D("COLOR","u_shadow_mask",1,1,1,!0)):V.q("Internal error"));Fa&&(q.r(g,Fa,Ab,Za),q.r(g,Fa,Ab,mb));if(x.length)for(var Wc=x.length,ia=0;ia<Wc;ia++)q.r(g,x[ia],Ab,r[ia]);if(B.length)for(ia=0;ia<B.length;ia++)q.r(g,B[ia],Ab,O[ia]);l=m;m=[];if(!T&&a.ZR){Ca=A.Fc(Sa,!0);Ca.width=1;Ca.height=1;b.ba.push(Ca);var uc=J.aH(Ca,!1,K);q.J(g,uc);if(a.th){Ca=A.Fc(Sa,!0);Ca.width=1;Ca.height=1;b.ba.push(Ca);var Rc=J.aH(Ca,!0,K);q.J(g,Rc);q.r(g,uc,Rc,D("COLOR","COLOR",1,1,1,!1));q.r(g,
uc,Rc,D("DEPTH","DEPTH",1,1,1,!1))}}else uc=null;if(!ma.refractions&&!da||T)Gb=null;else{if(ga)Gb=fb;else{var Gb=J.bA();q.J(g,Gb);q.r(g,l[0],Gb,D("COLOR","COPY",1,1,1,!0))}var fc=D("COLOR","u_refractmap",1,1,1,!0)}if(Na&&(da||L||fa)){var wb=A.Fc(Sa,!0);b.ba.push(wb);var Va=J.OS(wb);q.J(g,Va);q.r(g,ga?fb:Ab,Va,D("DEPTH","u_depth",1,1,1,!0));var Ga=D("COLOR","u_scene_depth",1,1,1,!0);Ga.Oa=F.re;Ga.Na=F.re}else Va=null;if(a.Yu){var xb=k(J.Lc);m.push(xb);l=m;m=[]}if(a.Pi){var Sc=A.Fc(Sa,!0);b.ba.push(Sc);
var Xb=J.Bl(J.ee,Sc,!1,I,K,Da,Ha);q.J(g,Xb);Va&&q.r(g,Va,Xb,Ga);Gb&&q.r(g,Gb,Xb,fc);Fa&&(q.r(g,Fa,Xb,Za),q.r(g,Fa,Xb,mb));if(x.length)for(Wc=x.length,ia=0;ia<Wc;ia++)q.r(g,x[ia],Xb,r[ia]);if(B.length)for(ia=0;ia<B.length;ia++)q.r(g,B[ia],Xb,O[ia]);q.r(g,ga?fb:Ab,Xb,ga?eb:Pa);var yc=J.Ad("X_GLOW_BLUR");yc.Eb="GLOW_MASK_SMALL";yc.rg=a.Uj.small_glow_mask_width;var dd=D("COLOR","u_color",1,1,1,!0);dd.Oa=F.K;dd.Na=F.K;q.J(g,yc);q.r(g,Xb,yc,dd);var vc=J.Ad("Y_GLOW_BLUR");vc.Eb="GLOW_MASK_SMALL";vc.rg=a.Uj.small_glow_mask_width;
var $b=D("COLOR","u_color",1,.5,.5,!0);$b.Oa=F.K;$b.Na=F.K;q.J(g,vc);q.r(g,yc,vc,$b);var Xc=J.Ad("X_GLOW_BLUR");Xc.Eb="GLOW_MASK_LARGE";Xc.rg=a.Uj.large_glow_mask_width;var ed=D("COLOR","u_color",1,.5,.5,!0);ed.Oa=F.K;ed.Na=F.K;q.J(g,Xc);q.r(g,vc,Xc,ed);var ac=J.Ad("Y_GLOW_BLUR");ac.Eb="GLOW_MASK_LARGE";ac.rg=a.Uj.large_glow_mask_width;var Yb=D("COLOR","u_color",1,.25,.25,!0);Yb.Oa=F.K;Yb.Na=F.K;q.J(g,ac);q.r(g,Xc,ac,Yb);var rd=A.Fc(Sa,!0);b.ba.push(rd);var Dc=J.PS(rd,a);q.J(g,Dc);var kb=D("COLOR",
"u_src_color",1,1,1,!0);if(a.Yu)if(ga){var Yc=J.fu();q.J(g,Yc);q.r(g,xb,Yc,lc);q.r(g,xb,Yc,Nc);q.r(g,Yc,Dc,kb)}else q.r(g,xb,Dc,kb);else q.r(g,ga?fb:Ab,Dc,kb);q.r(g,a.Yu?xb:Ab,Dc,Pa);var zc=D("COLOR","u_glow_mask_small",1,.5,.5,!0);zc.Oa=F.K;zc.Na=F.K;q.r(g,vc,Dc,zc);var mc=D("COLOR","u_glow_mask_large",1,.25,.25,!0);mc.Oa=F.K;mc.Na=F.K;q.r(g,ac,Dc,mc);l=[Dc];m=[]}a.Yu||(xb=k(J.Lc),m.push(xb),l=m,m=[]);if(aa.debug_view){Ca=A.Fc(Sa,!0);b.ba.push(Ca);var Sb=J.NS(Ca);m.push(Sb);q.J(g,Sb);q.r(g,l[0],
Sb,Mb);q.r(g,l[0],Sb,Pa);Fa&&(q.r(g,Fa,Sb,Za),q.r(g,Fa,Sb,mb));R.SX(Sb);l=m;m=[]}if(ga){var Pb=J.fu();q.J(g,Pb);m.push(Pb);q.r(g,l[0],Pb,lc);q.r(g,l[0],Pb,Nc);l=m;m=[]}var nc=l.slice(0);if(!T&&a.bQ){Ca=A.Fc(Sa,!0);b.ba.push(Ca);var Ec=J.JS(Ca);q.J(g,Ec);q.r(g,l[0],Ec,ga?eb:Pa)}if(ba&&Na&&!T){var Hb=va.Wn,oc=va.jB,pb=va.Ko,db=l[0],bc=I?!0:!1,Zc=D("DEPTH","u_input",1,1,1,!0),Cb=D("COLOR","u_input",1,.25,.25,!0);Cb.Oa=F.K;Cb.Na=F.K;var Tb=Hb/pb,gb=A.Fc(Sa,!0);b.ba.push(gb);var ob=J.cA(gb,bc,Hb,!0,Tb,
K,pb);q.J(g,ob);q.r(g,db,ob,Zc);var Tb=Hb/pb*.5,Fc=A.Fc(Sa,!0);b.ba.push(Fc);var pc=J.cA(Fc,bc,Hb,!1,Tb,K,pb);q.J(g,pc);q.r(g,ob,pc,Cb);var Tb=Hb/pb*.25,Gc=A.Fc(Sa,!0);b.ba.push(Gc);var Ib=J.cA(Gc,bc,Hb,!1,Tb,K,pb);q.J(g,Ib);q.r(g,pc,Ib,Cb);var qc=J.QS(oc,K);m.push(qc);q.J(g,qc);q.r(g,db,qc,D("COLOR","u_main",1,1,1,!0));q.r(g,Ib,qc,D("COLOR","u_god_rays",1,1,1,!0));l=m;m=[]}if(Ea&&!T){var db=l[0],cc=J.SS();q.J(g,cc);q.r(g,db,cc,D("COLOR","u_input",1,1,1,!0));var Ya=J.KS();q.J(g,Ya);Ya.p.width=aa.Hq?
2:1;Ya.p.height=aa.Hq?2:1;var dc=D("COLOR","u_input",1,.25,.25,!0);dc.Oa=F.K;dc.Na=F.K;var Jb=D("COLOR","u_luminance",1,.25,.25,!0);Jb.Oa=F.K;Jb.Na=F.K;q.r(g,cc,Ya,dc);var rb=Ea.key,rc=Ea.edge_lum,sb=A.Fc(Sa,!0);b.ba.push(sb);var Kb=J.TS(rb,rc,K,sb);q.J(g,Kb);q.r(g,db,Kb,D("COLOR","u_main",1,1,1,!0));q.r(g,cc,Kb,Jb);q.r(g,Ya,Kb,D("COLOR","u_average_lum",1,1,1,!1));var Ub=D("COLOR","u_color",1,.25,.25,!0);Ub.Oa=F.K;Ub.Na=F.K;yc=J.$G("X_BLUR");q.J(g,yc);q.r(g,Kb,yc,Ub);vc=J.$G("Y_BLUR");q.J(g,vc);q.r(g,
yc,vc,Ub);var wc=J.LS(Ea.blur);q.J(g,wc);var Hc=D("COLOR","u_bloom",1,.25,.25,!0);Hc.Oa=F.K;Hc.Na=F.K;q.r(g,vc,wc,Hc);q.r(g,db,wc,D("COLOR","u_main",1,1,1,!0));m.push(wc);l=m;m=[]}if(Ka&&Na&&!T){var db=l[0],Ja=A.Fc(Sa,!0);b.ba.push(Ja);if(e.dof_bokeh){var gc=D("COLOR","u_color",1,1,1,!0);gc.Oa=F.K;gc.Na=F.K;var Db=D("DEPTH","u_depth",1,1,1,!0),Eb=D("COLOR","u_color",1,.5,.5,!0);Eb.Oa=F.re;Eb.Na=F.re;Ub=D("COLOR","u_color",1,.5,.5,!0);Ub.Oa=F.re;Ub.Na=F.re;var Ac=D("COLOR","u_blurred1",1,.5,.5,!0);
Ac.Oa=F.K;Ac.Na=F.K;var Vb=D("COLOR","u_blurred2",1,.5,.5,!0);Vb.Oa=F.K;Vb.Na=F.K;var lb=nc[0];if(e.Cd){var hb=A.Fc(Sa,!0);b.ba.push(hb);var Ia=J.aA(hb,"COC_FOREGROUND");hb.dof_distance=e.dof_distance;hb.dof_object=e.dof_object;hb.dof_front_start=e.dof_front_start;hb.dof_front_end=e.dof_front_end;hb.dof_rear_start=e.dof_rear_start;hb.dof_rear_end=e.dof_rear_end;hb.dof_power=e.dof_power;hb.dof_bokeh=e.dof_bokeh;hb.dof_bokeh_intensity=e.dof_bokeh_intensity;hb.Cd=e.Cd;hb.dof_on=!0;q.J(g,Ia);q.r(g,db,
Ia,gc);q.r(g,lb,Ia,Db);var Zb=J.Ad("X_ALPHA_BLUR");q.J(g,Zb);q.r(g,Ia,Zb,Eb);var Fb=J.Ad("Y_ALPHA_BLUR");q.J(g,Fb);q.r(g,Zb,Fb,Ub);var La=A.Fc(Sa,!0),Ma=J.aA(La,"COC_COMBINE");b.ba.push(La);La.dof_distance=e.dof_distance;La.dof_object=e.dof_object;La.dof_front_start=e.dof_front_start;La.dof_front_end=e.dof_front_end;La.dof_rear_start=e.dof_rear_start;La.dof_rear_end=e.dof_rear_end;La.dof_power=e.dof_power;La.dof_bokeh=e.dof_bokeh;La.dof_bokeh_intensity=e.dof_bokeh_intensity;La.Cd=e.Cd;La.dof_on=!0;
q.J(g,Ma);q.r(g,db,Ma,gc);q.r(g,lb,Ma,Db);q.r(g,Fb,Ma,D("COLOR","u_coc_fg",1,.5,.5,!0))}else La=A.Fc(Sa,!0),b.ba.push(La),Ma=J.aA(La,"COC_ALL"),La.dof_distance=e.dof_distance,La.dof_object=e.dof_object,La.dof_front_start=e.dof_front_start,La.dof_front_end=e.dof_front_end,La.dof_rear_start=e.dof_rear_start,La.dof_rear_end=e.dof_rear_end,La.dof_power=e.dof_power,La.dof_bokeh=e.dof_bokeh,La.dof_bokeh_intensity=e.dof_bokeh_intensity,La.Cd=e.Cd,La.dof_on=!0,q.J(g,Ma),q.r(g,db,Ma,gc),q.r(g,lb,Ma,Db);var nb=
J.Ad("X_DOF_BLUR");nb.p.dof_bokeh_intensity=e.dof_bokeh_intensity;q.J(g,nb);q.r(g,Ma,nb,Eb);var Oc=J.Ad("Y_DOF_BLUR");Oc.p.dof_bokeh_intensity=e.dof_bokeh_intensity;q.J(g,Oc);q.r(g,nb,Oc,Ub);var Ic=J.Ad("Y_DOF_BLUR");Ic.p.dof_bokeh_intensity=e.dof_bokeh_intensity;q.J(g,Ic);q.r(g,nb,Ic,Ub);var tb=J.bH(Ja);Ja.dof_distance=e.dof_distance;Ja.dof_object=e.dof_object;Ja.dof_front_start=e.dof_front_start;Ja.dof_front_end=e.dof_front_end;Ja.dof_rear_start=e.dof_rear_start;Ja.dof_rear_end=e.dof_rear_end;Ja.dof_power=
e.dof_power;Ja.dof_bokeh=e.dof_bokeh;Ja.dof_bokeh_intensity=e.dof_bokeh_intensity;Ja.Cd=e.Cd;Ja.dof_on=!0;m.push(tb);q.J(g,tb);q.r(g,db,tb,D("COLOR","u_sharp",1,1,1,!0));q.r(g,Oc,tb,Ac);q.r(g,Ic,tb,Vb)}else{var Bc=D("COLOR","u_color",1,1,1,!0);Bc.Oa=F.K;Bc.Na=F.K;var Wb=D("COLOR","u_color",1,1,1,!0);Wb.Oa=F.K;Wb.Na=F.K;nb=J.Ad("X_BLUR");q.J(g,nb);q.r(g,db,nb,Bc);var ec=J.Ad("Y_BLUR");q.J(g,ec);q.r(g,nb,ec,Wb);var fd=nc[0],tb=J.bH(Ja);Ja.dof_distance=e.dof_distance;Ja.dof_object=e.dof_object;Ja.dof_front_start=
e.dof_front_start;Ja.dof_front_end=e.dof_front_end;Ja.dof_rear_start=e.dof_rear_start;Ja.dof_rear_end=e.dof_rear_end;Ja.dof_power=e.dof_power;Ja.dof_bokeh=e.dof_bokeh;Ja.dof_bokeh_intensity=e.dof_bokeh_intensity;Ja.Cd=e.Cd;Ja.dof_on=!0;m.push(tb);q.J(g,tb);q.r(g,db,tb,D("COLOR","u_sharp",1,1,1,!0));q.r(g,ec,tb,D("COLOR","u_blurred",1,1,1,!0));q.r(g,fd,tb,D("DEPTH","u_depth",1,1,1,!0))}l=m;m=[]}if(a.th){var $c=k(J.Pf);m.push($c);l=m;m=[]}if(ea&&!T){var Tc=l[0],ad=J.US(ra.mb_decay_threshold,ra.mb_factor);
m.push(ad);q.J(g,ad);q.r(g,Tc,ad,D("COLOR","u_mb_tex_curr",1,1,1,!0));ad.Ya.push(D("COLOR","u_mb_tex_accum",1,1,1,!0));l=m;m=[]}if(!T&&a.outline){var db=l[0],ub=A.Fc(Sa,!0);b.ba.push(ub);var Pc=J.WS(ub,K);q.J(g,Pc);var qb=J.Ad("X_EXTEND"),gd=D("COLOR","u_color",1,1,1,!0),Wa=D("COLOR","u_outline_mask",1,1,1,!0);qb.mr=!0;q.J(g,qb);q.r(g,Pc,qb,gd);var $a=D("COLOR","u_color",1,.5,.5,!0);$a.Oa=F.K;$a.Na=F.K;var Uc=J.Ad("Y_EXTEND");Uc.mr=!0;q.J(g,Uc);q.r(g,qb,Uc,$a);nb=J.Ad("X_BLUR");nb.mr=!0;q.J(g,nb);
q.r(g,Uc,nb,$a);var hc=D("COLOR","u_color",1,.25,.25,!0);hc.Oa=F.K;hc.Na=F.K;var Qb=D("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Qb.Oa=F.K;Qb.Na=F.K;ec=J.Ad("Y_BLUR");ec.mr=!0;q.J(g,ec);q.r(g,nb,ec,hc);var bd=J.VS(xa);q.J(g,bd);q.r(g,db,bd,D("COLOR","u_outline_src",1,1,1,!0));q.r(g,Pc,bd,Wa);q.r(g,ec,bd,Qb);m.push(bd);l=m;m=[]}n(g,Na);if((a.anaglyph_use||a.kv)&&!T){var zd=G(g,a,b,l[0]);m.push(zd);l=m;m=[]}if(ya&&!T){var db=l[0],Qc=J.MS(wa.brightness,wa.contrast,wa.exposure,wa.saturation);q.J(g,
Qc);q.r(g,db,Qc,D("COLOR","u_color",1,1,1,!0));m.push(Qc);l=m;m=[]}if(na){db=l[0];if(aa.smaa){var xc=D("COLOR","u_color",1,1,1,!0);xc.Oa=F.K;xc.Na=F.K;var Jc=J.dA(J.pt,a);q.J(g,Jc);q.r(g,db,Jc,xc);var ic=J.dA(J.vp,a);q.J(g,ic);q.r(g,Jc,ic,xc);var hd=D("COLOR","u_search_tex",1,1,1,!1),Lc=D("COLOR","u_area_tex",1,1,1,!1);hd.Oa=F.K;hd.Na=F.K;Lc.Oa=F.K;Lc.Na=F.K;ic.Ya.push(hd);ic.Ya.push(Lc);var sc=J.dA(J.qt,a);q.J(g,sc);q.r(g,db,sc,xc);var Bb=D("COLOR","u_blend",1,1,1,!0);Bb.Oa=F.K;Bb.Na=F.K;q.r(g,ic,
sc,Bb);m.push(sc)}else{var Kc=J.IS(a);q.J(g,Kc);var kd=D("COLOR","u_color",1,1,1,!0);kd.Oa=F.K;kd.Na=F.K;q.r(g,db,Kc,kd);m.push(Kc)}l=m;m=[]}var sd=q.bh(g,l[0]);if(l[0].type==J.vh||l[0].type==J.an)var jc=!0;else jc=!1,q.ii(g,sd,function(a,b,c){if(c.from==c.to)return jc=!0});if(jc){var nd=J.Ad("NONE");q.J(g,nd);q.r(g,l[0],nd,D("COLOR","u_color",1,1,1,!0));m.push(nd);l=m;m=[]}m.push(l[0]);uc&&(Rc?m.push(Rc):m.push(uc));Ec&&m.push(Ec);Qa=v.iu;if(a.Sw.VK){var td=a.Sw,cd=a.cp,ud=cd.Bo,Qa=ud?ud.gZ:Qa,od=
J.$S(cd,K,td,Qa);q.J(g,od);m.push(od)}var tc=J.cH();q.J(g,tc);for(ka=0;ka<m.length;ka++){var Mc=m[ka];switch(Mc.type){case J.pf:case J.qi:q.r(g,Mc,tc,D("COLOR","NONE",1,1,1,!1));q.r(g,Mc,tc,D("DEPTH","NONE",1,1,1,!1));break;case J.zg:q.r(g,Mc,tc,D("CUBEMAP","u_sky",Qa,1,1,!1));break;case J.Um:q.r(g,Mc,tc,D("COLOR","NONE",1,1,1,!0));break;default:if(T){var vd=h[0],Vc=D("COLOR","OFFSCREEN",1,1,1,!0);Vc.jb=vd;q.r(g,m[ka],tc,Vc);for(ia=1;ia<h.length;ia++){var wd=h[ia],ld=J.Ad("NONE");q.J(g,ld);q.r(g,
m[ka],ld,D("COLOR","SCALE",1,1,1,!0));var Lb=wd.hj/vd.hj,Vc=D("COLOR","OFFSCREEN",1,Lb,Lb,!0);Vc.jb=wd;q.r(g,ld,tc,Vc)}}else q.r(g,m[ka],tc,D("SCREEN","NONE",1,1,1,!0))}}fb&&!c(g,fb).length&&(q.pg(g,q.bh(g,fb)),q.Gz(g));n(g,Na);d(g,Na);if(U.enabled){var xd=f(g);xd&&C(g,xd)}t(g);w(g);Ra&&q.oa(g,function(a,b){if(b.type==J.tf||b.type==J.Lc||b.type==J.Pf){for(var c=0,d=E(g,b),e=0,f=0;f<d.length;f++){var h=d[f];h.type==J.dd&&(e++,b.sm=b.sm||[],b.sm[0<h.nh?h.nh:c]=h.p.wb,c++)}b.px&&b.ox||(aa.Kv?b.VD=new Float32Array(9*
e):(b.px=new Float32Array(4*e),b.ox=new Float32Array(4*e)))}});return g};a.GW=L;a.Jd=function(a,b,c){var d=a.rg;a.AD[0]=b*a.Fb[0]*d;a.AD[1]=c*a.Fb[1]*d};a.Ic=function(a,b){a.rg=b};a.xS=function(){var a=q.create(),b=J.XS(),c=A.hd(A.qd);c.width=512;c.height=512;b.p=c;q.J(a,b);b.Ya.push(D("COLOR","u_color",512,1,1,!1));c=J.cH();q.J(a,c);q.r(a,b,c,D("COLOR","NONE",512,1,1,!1));t(a);w(a);return a};a.aU=function(a){var b=null;q.oa(a,function(a,c){return c.p&&null===c.p.Ve?(b=c,!0):!1});return b};a.Cb=function(a,
b,c){a=E(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.SA=function(a,b,c){a=E(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.m5=I;a.p5=O;a.XU=E;a.$U=c;a.ec=function(a,b){var c=null;q.oa(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.lT=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=k(a);q.oa(a,function(a,d){var e=
b+="    ",f=J.pD(d);if(d.p){for(var f=f+"\\n",h=0;h<c.length;h+=2){var k=d.p.qc;c[h]==k&&(f=F.Qn(k)?f+("CR"+c[h+1]+" "):f+("C"+c[h+1]+" "))}for(h=0;h<c.length;h+=2)k=d.p.Re,c[h]==k&&(f=F.Qn(k)?f+("DR"+c[h+1]):f+("D"+c[h+1]))}d.Ya.length&&(f+="\\n-----\\n");for(h=0;h<d.Ya.length;h++)f+=y(d.Ya[h],c);h=d.type==J.bn?"dotted":d.Ud?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(h+",bold")+'"];\n')});q.sg(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+y(e,
c)+'" style="'+(e.Ec?"solid":"dotted")+'"];\n'});return b+="}"};a.zS=function(a){a=q.jZ(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.Ud&&b.push(d)}return b}};b4w.module.__textures=function(a,r){function n(){return{type:0,source:"",ps:"",width:0,height:0,oq:1,anisotropic_filtering:"",hj:1024,Kl:!1,Sf:null,mb:0,rb:null,Ie:null,em:!1,Ls:-1,Sa:null,tx:"",fk:0,Rg:0,va:0,Sb:0,Rj:0,gg:!1,lh:1,ud:null,fs:0,es:0,fj:-1,hs:!1,Ak:-1,Js:!1,SD:!1,pj:!1,Qk:!1,repeat:!0,hr:"",Kn:"",Ln:"",fB:"",eB:"",ov:!1,Yl:"",tz:"",jk:0}}function d(a,b,c){a.Ln=b.uuid;a.Kn=b.filepath;a.fB=b.source;a.eB=b.name;a.hr=ha.aj(c+b.filepath);if(a.ov=b.zh)a.Yl=b.zp;X.push(a)}function b(a,b,c){var d=
-1<b.indexOf(".dds"),e=-1<b.indexOf(".pvr");a.ov=d||e;a.Yl=d?"dds":e?"pvr":"";a.Kn=b;a.hr=c}function t(b,c){var d=n();d.type=b;d.source="NONE";if(b==a.ut||b==a.st||b==a.vt||b==a.tt)d.Ie=P.createRenderbuffer();else{var e=P.TEXTURE_2D,f=P.createTexture();P.bindTexture(e,f);P.texParameteri(e,P.TEXTURE_MAG_FILTER,P.LINEAR);P.texParameteri(e,P.TEXTURE_MIN_FILTER,P.LINEAR);P.texParameteri(e,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE);P.texParameteri(e,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE);var h=K(d),k=G(d),g=L(d),l=
b==a.fl?null:new Uint8Array([204,204,204,255]);P.texImage2D(e,0,k,1,1,0,h,g,l);pa.mq&&c&&P.texParameterf(e,P.TEXTURE_COMPARE_MODE,P.COMPARE_REF_TO_TEXTURE);P.bindTexture(e,null);d.mb=e;d.rb=f}return d}function p(a){"CANVAS"!=a.source&&ha.q("Wrong texture");var b=a.mb;P.bindTexture(b,a.rb);var c=K(a),d=G(a),e=L(a),f=a.Sf.canvas;P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!0);P.texImage2D(b,0,d,c,e,f);P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!1);a.Kl&&P.generateMipmap(b);P.bindTexture(b,null);a.width=f.width;a.height=
f.height}function B(a){var b=a.mb;P.bindTexture(b,a.rb);P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Sa.length?a.gg?g(a,a.Sa,a.width*a.lh,a.height*a.lh,!1):P.texImage2D(b,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,a.Sa):P.texImage2D(b,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,a.Sa);P.bindTexture(b,null)}function m(a){var b=a.mb;P.bindTexture(b,a.rb);P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!0);a.gg?g(a,a.ud[a.fj],a.width*a.lh,a.height*a.lh,!1):P.texImage2D(b,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,a.ud[a.fj]);P.bindTexture(b,
null)}function x(){qa||(qa=document.createElement("canvas"));return qa}function g(a,b,c,d,e){e||(h(P.TEXTURE_2D),P.texImage2D(P.TEXTURE_2D,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,b));P.bindTexture(P.TEXTURE_2D,null);u.AT(a,c,d,za,sa)}function l(a,b,c,d){for(var e=0;6>e;e++){var f=d[e],h=x();h.width=c;h.height=c;var k=h.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(k.translate(0,c),k.scale(1,-1)):(k.translate(c,0),k.scale(-1,1));k.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);P.texImage2D(P["TEXTURE_CUBE_MAP_"+
f[0]],0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,h)}}function h(a){za||(za=P.createFramebuffer());P.bindTexture(a,null);sa||(sa=P.createTexture());P.bindTexture(a,sa);P.texParameteri(a,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE);P.texParameteri(a,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE);P.texParameteri(a,P.TEXTURE_MAG_FILTER,P.LINEAR);P.texParameteri(a,P.TEXTURE_MIN_FILTER,P.LINEAR)}function w(a,b,c){var d=a.source,e=a.rb,k=a.mb,m=a.Yl,n=a.Kn,q=1,y=1;P.bindTexture(k,e);a.repeat?(P.texParameteri(k,P.TEXTURE_WRAP_S,P.REPEAT),
P.texParameteri(k,P.TEXTURE_WRAP_T,P.REPEAT)):(P.texParameteri(k,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(k,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE));if(4==b.length){var p=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==d)if(p)P.texImage2D(k,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(m){y=v.$I(b,m);p=ha.aq(y.width)||ha.aq(y.height);if(y.width>S.Bc||y.height>S.Bc){H.error('Image "'+n+'" has unsupported size: '+y.width+"x"+y.height+". Max available: "+
S.Bc+"x"+S.Bc+".");return}q=y.width;y=y.height;if(p||"pvr"==m)a.gg=!0,h(k),q=C(q*a.lh),y=C(y*a.lh);"dds"==m?v.b_(P,M.II(),b,!0):"pvr"==m&&v.c_(P,M.EI(),b);a.gg&&(g(a,null,q,y,!0),P.bindTexture(k,e),P.generateMipmap(k));a.width=q;a.height=y;a.oq=v.FU(b,m)}else{P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!0);a.em?pa.gs?(q=b[0].width,y=b[0].height):(q=b.videoWidth,y=b.videoHeight):(q=b.width,y=b.height);a.width=q;a.height=y;if(q>S.Bc||q>S.Bc)H.warn('Image "'+n+'" has unsupported size: '+q+"x"+y+". Max available: "+
S.Bc+"x"+S.Bc+". Reduced image size will be used."),a.lh=Math.min(S.Bc/q,S.Bc/y),a.gg=!0;a.em&&(c in oa||(oa[c]={}),oa[c][a.tx]=a,pa.gs?(a.ud=b,a.fs=b.length,a.Rg=a.es*a.fk/b.length,b=b[0]):(a.Sa=b,a.Sa.loop=a.pj,a.Rg=b.duration?a.fk/b.duration:Z.sd(),Y.xH||(b.playbackRate=Z.sd()/a.Rg,Y.zG&&2<b.playbackRate&&(b.playbackRate=2)),f(a)));q=C(a.width*a.lh);y=C(a.height*a.lh);a.gg?(n=x(),e=n.getContext("2d"),n.width=q,n.height=y,e.drawImage(b,0,0,a.width,a.height,0,0,q,y),P.texImage2D(k,0,P.RGBA,P.RGBA,
P.UNSIGNED_BYTE,n)):pa.cc||!ha.aq(a.width)&&!ha.aq(a.height)?P.texImage2D(k,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,b):(g(a,b,q,y,!1),a.gg=!0);e=a.rb;a.em||(P.bindTexture(k,e),P.generateMipmap(k),P.bindTexture(k,null));a.width=q;a.height=y}else if("ENVIRONMENT_MAP"==d)if(q=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],p){for(n=0;6>n;n++)P.texImage2D(P["TEXTURE_CUBE_MAP_"+q[n][0]],0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){H.error('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}y=b.width/3;y>S.Vi?(H.warn('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*S.Vi+"x"+2*S.Vi+". Reduced image size will be used."),n=C(S.Vi/y*y),a.gg=!0):(n=C(y),!pa.cc&&(3*n>S.Bc||2*n>S.Bc)&&(a.gg=!0));if(a.gg||pa.FC)l(b,y,n,q);else{m=
b;e=n;h(P.TEXTURE_2D);P.texImage2D(P.TEXTURE_2D,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,m);P.bindTexture(P.TEXTURE_2D,null);for(m=0;6>m;m++)P.texImage2D(P.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,P.RGBA,e,e,0,P.RGBA,P.UNSIGNED_BYTE,null);P.bindTexture(a.mb,null);P.bindFramebuffer(P.FRAMEBUFFER,za);for(m=0;6>m;m++)u.zT(a,P.TEXTURE_CUBE_MAP_POSITIVE_X+m,e,y,sa,m);P.bindFramebuffer(P.FRAMEBUFFER,null);P.bindTexture(a.mb,a.rb);P.texParameteri(a.mb,P.TEXTURE_MIN_FILTER,la[pa.Po]);P.texParameteri(a.mb,P.TEXTURE_MAG_FILTER,
P.LINEAR)}fa.HR()&&(H.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),l(b,y,U.JE,q));a.width=3*n;a.height=2*n;P.generateMipmap(k)}else"NODE_TEX"==d&&(P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,!1),P.texImage2D(k,0,P.RGBA,b.width,b.height,0,P.RGBA,P.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);P.bindTexture(k,null)}function f(a){a.Sa.r6=function(){B(a)}}function C(a){return ha.aq(a)?ha.V(Math.pow(2,parseInt(a).toString(2).length),2,S.Bc):a}function K(b){var c;
switch(b.type){case a.wh:c=P.RGBA;break;case a.wt:c=P.RGB;break;case a.xp:c=P.RGBA;break;case a.yp:c=P.RGB;break;case a.fl:c=P.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}function G(b){var c;switch(b.type){case a.wh:c=pa.cc?P.RGBA8:P.RGBA;break;case a.wt:c=pa.cc?P.RGB8:P.RGB;break;case a.xp:c=pa.cc?P.RGBA8:P.RGBA;break;case a.yp:c=pa.cc?P.RGB8:P.RGB;break;case a.fl:c=pa.cc?pa.dz?P.DEPTH_COMPONENT16:P.DEPTH_COMPONENT24:P.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}
function L(b){var c;switch(b.type){case a.wh:c=P.UNSIGNED_BYTE;break;case a.wt:c=P.UNSIGNED_BYTE;break;case a.xp:c=P.FLOAT;break;case a.yp:c=P.FLOAT;break;case a.fl:c=pa.dz?P.UNSIGNED_SHORT:P.UNSIGNED_INT;break;default:ha.q("Wrong texture type")}return c}function D(a){return a&&a.Ie?!0:!1}function N(a){a.Sa?a.Sa.play():a.ud&&(a.hs=!0);a.Js=!1}function I(a){a.Sa?a.Sa.pause():a.ud&&(a.hs=!1);a.Js=!0}function O(a){a.Sa?a.Sa.currentTime=a.Sb/a.Rg:a.ud&&(a.fj=c(a,a.Sb),m(a))}function E(a){return a.Sa?
!a.Sa.paused:a.ud?a.hs:!1}function c(a,b){return Math.round(b*a.fs/a.fk)}function k(a,b){if(Q.Ea(a))return y(a,b);for(var c=a.Pv,d=0;d<c.length;d++){var e=y(c[d],b);if(e)return e}return null}function y(a,b){var c=a.I;if(c.length)for(var c=c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.ya.length;f++)if(e.Eg[f]==b)return e.ya[f]}return null}function A(a,b,c){a=a.I;if(a.length){a=a[0].U;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++)e.Eg[f]==
b&&(J(e.ya[f]),e.ya[f]=c,F(c))}}}function e(a,b){var c=a.I;if(c.length)for(var c=c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++){var h=e.ya[f],k=e.Eg[f];-1==b.indexOf(k)&&"NODE_TEX"!=h.source&&b.push(k)}}}function R(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),h=q(d,f,!0),k=ba(d,f,!0);if(h&&k)if("CONSTANT"==a)c.push.apply(c,h.color);else{var g=c,l=h,m=k;l==m?g.push.apply(g,l.color):(g.push(ca.Gv(m.color[0],m.position,l.color[0],
l.position,f)),g.push(ca.Gv(m.color[1],m.position,l.color[1],l.position,f)),g.push(ca.Gv(m.color[2],m.position,l.color[2],l.position,f)),g.push(ca.Gv(m.color[3],m.position,l.color[3],l.position,f)))}k&&!h&&c.push.apply(c,k.color);h&&!k&&c.push.apply(c,h.color)}}function q(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function ba(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-
b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function J(a){0<a.jk&&--a.jk;0>=a.jk&&(a.rb&&P.deleteTexture(a.rb),a=X.indexOf(a),-1!=a&&X.splice(a,1))}function F(a){a.jk+=1}function V(a,b){for(var c=0;c<X.length;c++){var d=X[c];if(d.hr==a&&d.type==b.type&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.Qk==b.Qk)return d}return null}var U=r("__compat"),aa=r("__config"),v=r("__texcomp"),fa=r("__debug"),M=r("__extensions"),H=r("__print"),Z=r("__time"),ha=
r("__util"),u=r("__renderer"),Q=r("__obj_util"),ca=r("__curve"),ja=r("__vec3"),ua=r("__scenes"),pa=aa.A,S=aa.Ci,Y=aa.W,qa=null,sa=null,za=null;a.re=0;a.K=0;a.LP=0;a.JP=0;a.KP=0;a.IP=0;a.wh=10;a.wt=20;a.xp=30;a.yp=40;a.fl=50;a.ut=60;a.st=70;a.vt=80;a.tt=90;a.mE=128;a.LN=128;a.SE=128;var X=[],ta={},oa={},P=null,la;a.If=function(b){la=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.re=b.NEAREST;a.K=b.LINEAR;a.LP=b.NEAREST_MIPMAP_NEAREST;a.JP=b.LINEAR_MIPMAP_NEAREST;
a.KP=b.NEAREST_MIPMAP_LINEAR;a.IP=b.LINEAR_MIPMAP_LINEAR;P=b};a.J3=function(a,b){return b in ta&&a in ta[b]?ta[b][a].Sf:null};a.J8=function(a,b){return b in ta&&a in ta[b]?(p(ta[b][a]),!0):!1};a.yF=d;a.Cl=t;a.PG=function(b){var c=P.createTexture(),d=P.TEXTURE_CUBE_MAP;P.bindTexture(d,c);P.texParameteri(d,P.TEXTURE_MAG_FILTER,P.LINEAR);P.texParameteri(d,P.TEXTURE_MIN_FILTER,P.LINEAR);P.texParameteri(d,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE);P.texParameteri(d,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
f=0;6>f;f++)P.texImage2D(P[e[f]],0,P.RGBA,b,b,0,P.RGBA,P.UNSIGNED_BYTE,null);P.bindTexture(d,null);d=n();d.type=a.wh;d.source="NONE";d.width=3*b;d.height=2*b;d.oq=1;d.rb=c;d.mb=P.TEXTURE_CUBE_MAP;return d};a.QC=function(a,b,c){if(!D(a)){var d=a.mb;P.bindTexture(d,a.rb);b&&P.texParameteri(d,P.TEXTURE_MIN_FILTER,b);c&&P.texParameteri(d,P.TEXTURE_MAG_FILTER,c);P.bindTexture(d,null)}};a.Z3=function(b){if(D(b))return{min:a.re,oW:a.re};var c=b.mb;P.bindTexture(c,b.rb);b=P.getTexParameter(c,P.TEXTURE_MIN_FILTER);
var d=P.getTexParameter(c,P.TEXTURE_MAG_FILTER);P.bindTexture(c,null);return{min:b,oW:d}};a.resize=function(b,c,d){c=Math.max(c,pa.Hq?2:1);d=Math.max(d,pa.Hq?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.ut:P.bindRenderbuffer(P.RENDERBUFFER,b.Ie);P.renderbufferStorage(P.RENDERBUFFER,P.RGB565,c,d);P.bindRenderbuffer(P.RENDERBUFFER,null);break;case a.st:P.bindRenderbuffer(P.RENDERBUFFER,b.Ie);P.renderbufferStorage(P.RENDERBUFFER,P.DEPTH_COMPONENT16,c,d);P.bindRenderbuffer(P.RENDERBUFFER,null);
break;case a.vt:P.bindRenderbuffer(P.RENDERBUFFER,b.Ie);P.renderbufferStorageMultisample(P.RENDERBUFFER,pa.Cc,P.RGBA8,c,d);P.bindRenderbuffer(P.RENDERBUFFER,null);break;case a.tt:P.bindRenderbuffer(P.RENDERBUFFER,b.Ie);P.renderbufferStorageMultisample(P.RENDERBUFFER,pa.Cc,P.DEPTH_COMPONENT24,c,d);P.bindRenderbuffer(P.RENDERBUFFER,null);break;default:var e=b.mb;P.bindTexture(e,b.rb);var f=K(b),h=G(b),k=L(b);P.texImage2D(e,0,h,c,d,0,f,k,null);P.bindTexture(e,null)}c>S.Bc||d>S.Bc?ha.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+S.Bc+"x"+S.Bc+"."):(b.width=c,b.height=d)}};a.dT=function(b,c,e,f,h){var k=b.type,g=b.image,l=n();l.tz=b.uuid;l.type=a.wh;l.width=1;l.height=1;var m=b.b4w_anisotropic_filtering;"DEFAULT"===m&&(m=c);"OFF"!==m&&pa.anisotropic_filtering&&M.bI()&&(m=parseFloat(m.split("x")[0]),l.anisotropic_filtering=m);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)l.repeat=!1;if(g&&("IMAGE"==k&&"MOVIE"==g.source&&(l.em=!0,l.tx=b.name,l.va=b.frame_start,l.Sb=
b.frame_offset,l.Rj=b.frame_duration,l.SD=b.use_auto_refresh,l.pj=b.use_cyclic,l.fk=b.movie_length,l.Qk=b.b4w_nla_video,0!=l.Sb&&H.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),c=ha.aj(h+g.filepath),c=V(c,l))){b.s=c;return}c=new Uint8Array([204,204,204,255]);switch(k){case "IMAGE":var m=P.createTexture(),u=P.TEXTURE_2D;P.bindTexture(u,m);P.texImage2D(u,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,c);break;case "NONE":m=P.createTexture();
u=P.TEXTURE_2D;P.bindTexture(u,m);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=ha.Dd("name",b.b4w_source_id,e)))l.hj=b.b4w_source_size,e.Qf=e.Qf||[],e.Qf.push(l),F(l),P.texImage2D(u,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,c);else return;break;case "ENVIRONMENT_MAP":m=P.createTexture();u=P.TEXTURE_CUBE_MAP;P.bindTexture(u,m);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var q=0;6>q;q++)P.texImage2D(P["TEXTURE_CUBE_MAP_"+
e[q]],0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,c);break;case "BLEND":return;default:H.error('texture "'+b.name+'" has unsupported type "'+k+'"');return}l.rb=m;l.mb=u;l.anisotropic_filtering&&P.texParameterf(l.mb,M.bI().TEXTURE_MAX_ANISOTROPY_EXT,l.anisotropic_filtering);"NONE"==k&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==k&&"MOVIE"==g.source?P.texParameteri(u,P.TEXTURE_MIN_FILTER,P.LINEAR):P.texParameteri(u,P.TEXTURE_MIN_FILTER,la[pa.Po]);P.texParameteri(u,P.TEXTURE_MAG_FILTER,
P.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==k?(k=b.b4w_source_id,e=b.b4w_source_size,l.Kl=b.b4w_enable_canvas_mipmapping,l.ps=k,l.source="CANVAS",c=document.createElement("canvas"),c.width=e,c.height=e,l.Sf=c.getContext("2d"),f in ta||(ta[f]={}),ta[f][k]=l,p(l)):"SCENE"==b.b4w_source_type&&"NONE"==k?(l.ps=b.b4w_source_id,l.source="SCENE"):(l.source=k,P.generateMipmap(u),P.bindTexture(u,null));g&&d(l,g,h);b.s=l};a.eN=B;a.dN=m;a.ys=w;a.mR=C;a.Sn=function(a){return a&&(a.rb||a.Ie)?!0:!1};a.Qn=D;a.H5=
function(b){return b.type==a.xp||b.type==a.yp?!0:!1};a.eV=function(b){var c=0;switch(b.type){case a.wh:case a.wt:c=4;break;case a.xp:case a.yp:c=16;break;case a.fl:c=3;break;case a.ut:case a.st:c=2;break;case a.vt:c=4*pa.Cc;break;case a.tt:c=3*pa.Cc}return c};a.sa=function(){if(!pa.gs)for(var a in oa)for(var b in oa[a])oa[a][b].Sa.pause(),oa[a][b].Sa.src="",oa[a][b].Sa.load();X.length=0;ta={};oa={}};a.pause=function(){for(var a in oa)for(var b in oa[a]){var c=oa[a][b];E(c)&&I(c)}};a.reset=function(){for(var a in oa)for(var b in oa[a])O(oa[a][b])};
a.play=function(a){for(var b in oa)for(var c in oa[b]){var d=oa[b][c];a&&!d.Js||N(d)}};a.a5=function(a,b){return b in oa&&a in oa[b]?oa[b][a]:null};a.S8=function(a){return a.Qk};a.BK=N;a.gC=I;a.ZK=O;a.XX=function(a,b){if(void 0 in oa&&a in oa[void 0]){var c=oa[void 0][a];c.Sa?c.Sa.currentTime=b/c.Rg:c.ud&&(c.fj=b,m(c))}};a.AN=E;a.BN=function(a){return a.Sa||a.ud?a.Sa?2<=a.Sa.readyState:!0:0};a.xN=function(a){return a.Sa||a.ud?a.Sa?Math.round(a.Sa.currentTime*a.Rg):a.fj:0};a.zN=function(a){return a.Sa||
a.ud?a.Sa?a.Sb:c(a,a.Sb):0};a.q_=function(a){if(!a.Sa&&!a.ud)return 0;var b=Math.min(a.Rj,a.fk-a.Sb);return a.Sa?a.Sb+b:c(a,a.Sb+b)};a.Aw=function(a,b){return Math.round(b*a.es*(Z.sd()/a.Rg))};a.yN=function(a){return Math.min(a.Rj,a.fk-a.Sb)};a.p_=c;a.K3=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?c.Sf:null};a.K8=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?(p(c),!0):!1};a.M4=k;a.N4=function(a){var b=[];if(Q.Ea(a))e(a,b);else{a=a.Pv;for(var c=0;c<a.length;c++)e(a[c],b)}return b};
a.yY=function(a){for(var b={},c=0;c<a.length;c++){for(var d=a[c].ya,e=a[c].Ld,f=[],h=[],k=0;k<d.length;k++){var g=d[k],l=e[k];if("CANVAS"==g.source)if(l in b)g=b[l];else{var m=d[k],g=n();g.source="CANVAS";g.width=m.width;g.height=m.height;g.Kl=m.Kl;g.type=m.type;m=document.createElement("canvas");m.width=g.width;m.height=g.height;g.Sf=m.getContext("2d");g.mb=P.TEXTURE_2D;g.rb=P.createTexture();P.bindTexture(P.TEXTURE_2D,g.rb);g.Kl?P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,la[pa.Po]):P.texParameteri(P.TEXTURE_2D,
P.TEXTURE_MIN_FILTER,P.LINEAR);P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR);P.bindTexture(P.TEXTURE_2D,null);m=g;m.Sf.drawImage(d[k].Sf.canvas,0,0);p(m);b[l]=g}f.push(g);h.push(l)}a[c].ya=f}};a.PT=function(a,b){for(var c=[],d=0;d<a.length;d++)R(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ha.V(255*a,0,255)}))};a.hR=R;a.TT=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var h=a[f].data.value,k=[],g=h.curve_mapping.curves_data,
l=h.curve_mapping.curve_extend,m=h.curve_mapping.curves_handle_types,h=0;h<g.length;h++){for(var u=l[h],n=g[h],y=[],v=m[h],p=0;p<n.length;p++)y.push([new Float32Array(3),new Float32Array(n[p].concat(0)),new Float32Array(3)]);ca.yz(y[0],null,y[1],v[0],v[0]);for(p=1;p<y.length-1;p++)ca.yz(y[p],y[p-1],y[p+1],v[p],v[p]);ca.yz(y[y.length-1],y[y.length-2],null,v[y.length-1],v[y.length-1]);if(2<y.length){if("AUTO"==v[0]){ja.subtract(y[0][2],y[0][1],c);p=ja.length(c);ja.copy(y[1][0],d);d[0]<y[0][1][0]&&(d[0]=
y[0][1][0]);ja.subtract(d,y[0][1],d);var x=ja.length(d);1E-8<x&&(ja.scale(d,p/x,d),ja.add(y[0][1],d,y[0][2]),ja.subtract(y[0][1],d,y[0][0]))}n=y.length-1;"AUTO"==v[0]&&(ja.subtract(y[n][0],y[n][1],c),p=ja.length(c),ja.copy(y[n-1][2],d),d[0]>y[n][1][0]&&(d[0]=y[n][1][0]),ja.subtract(d,y[n][1],d),x=ja.length(d),1E-8<x&&(ja.scale(d,p/x,d),ja.add(y[n][1],d,y[n][0]),ja.subtract(y[n][1],d,y[n][2])))}for(n=0;n<y.length-1;n++)ca.aS(y[n][1],y[n][2],y[n+1][0],y[n+1][1]);n=[];3>=g.length?(p=Math.round(-b/2),
v=Math.round(b/2)):(p=0,v=b);for(;p<v;p++){var x=p/(v-1),w=q(y,x,!1),A=ba(y,x,!1);w&&A?n.push(ca.UF(x,w[1],w[2],A[0],A[1],.001)):A&&!w?"EXTRAPOLATED"==u?(x=A[1][0]==A[2][0]?A[1][1]:ca.PJ(x,A[1],A[2]),n.push(x)):n.push(A[1][1]):w&&!A&&("EXTRAPOLATED"==u?(x=w[0][0]==w[1][0]?w[1][1]:ca.PJ(x,w[0],w[1]),n.push(x)):n.push(w[1][1]))}k.push(n)}e.push(k)}c=[];for(p=0;p<e.length;p++)for(k=e[p],h=0;h<k[0].length;h++)3>=k.length?(d=ha.V(127.5*(k[0][h]+1),0,255),f=ha.V(127.5*(k[1][h]+1),0,255),g=ha.V(127.5*(k[2][h]+
1),0,255),n=255):(d=ha.V(255*k[0][h],0,255),f=ha.V(255*k[1][h],0,255),g=ha.V(255*k[2][h],0,255),n=ha.V(255*k[3][h],0,255)),c.push(d,f,g,n);return new Uint8Array(c)};a.OG=function(b,c){var d=t(a.wh,!1);d.source="NODE_TEX";d.repeat=!1;w(d,{width:c,height:b.length/(4*c),data:b});return d};a.X1=function(a,c,d,e,f){var h=ha.aj(f);if("WORLD"!=a.type){var k=V(h,c);if(!k){k=n();k.type=c.type;k.source=c.source;k.ps=c.ps;k.width=c.width;k.height=c.height;k.oq=c.oq;k.hj=c.hj;k.Kl=c.Kl;k.Sf=c.Sf;k.mb=c.mb;k.rb=
c.rb;k.Ie=c.Ie;k.em=c.em;k.Ls=c.Ls;k.Sa=c.Sa;k.tx=c.tx;k.fk=c.fk;k.Rg=c.Rg;k.va=c.va;k.Sb=c.Sb;k.Rj=c.Rj;k.gg=c.gg;k.lh=c.lh;k.ud=c.ud;k.fs=c.fs;k.es=c.es;k.fj=c.fj;k.hs=c.hs;k.Ak=c.Ak;k.Js=c.Js;k.SD=c.SD;k.pj=c.pj;k.Qk=c.Qk;k.repeat=c.repeat;k.Kn=c.Kn;k.hr=c.hr;k.Ln=c.Ln;k.fB=c.fB;k.eB=c.eB;k.ov=c.ov;k.Yl=c.Yl;var g=k;P.bindTexture(c.mb,c.rb);var l=P.getTexParameter(c.mb,P.TEXTURE_MAG_FILTER),m=P.getTexParameter(c.mb,P.TEXTURE_MIN_FILTER),u=P.getTexParameter(c.mb,P.TEXTURE_WRAP_S);c=P.getTexParameter(c.mb,
P.TEXTURE_WRAP_T);g.rb=P.createTexture();P.bindTexture(g.mb,g.rb);P.texParameteri(g.mb,P.TEXTURE_MAG_FILTER,l);P.texParameteri(g.mb,P.TEXTURE_MIN_FILTER,m);P.texParameteri(g.mb,P.TEXTURE_WRAP_S,u);P.texParameteri(g.mb,P.TEXTURE_WRAP_T,c);P.bindTexture(g.mb,null);b(k,f,h);X.push(k);w(k,e,0)}e=k;if(Q.Ea(a))A(a,d,e);else for(a=a.Pv,f=0;f<a.length;f++)A(a[f],d,e)}else k=c,b(k,f),w(k,e,0),ua.YZ(a)};a.wC=J;a.pv=F;a.fe=function(a){return a.texture.s};a.BX=function(){P=null};a.uI=function(){return X}};b4w.module.__texcomp=function(a,r){function n(a,b,d,f){var n=new Int32Array(d,0,31),r,B,L,D,N,I;if(542327876!=n[0])return p.error("Invalid magic number in DDS header"),0;if(!n[20]&4)return p.error("Unsupported format, must contain a FourCC code"),0;r=n[21];switch(r){case m:B=8;L=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case x:B=16;L=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case g:B=16;L=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return p.error("Unsupported FourCC code:",t(r)),null}I=
1;n[2]&131072&&!1!==f&&(I=Math.max(1,n[7]));D=n[4];N=n[3];n=n[1]+4;if(b)for(r=0;r<I;++r)f=Math.max(4,D)/4*Math.max(4,N)/4*B,b=new Uint8Array(d,n,f),a.compressedTexImage2D(a.TEXTURE_2D,r,L,D,N,0,b),n+=f,D=Math.max(.5*D,1),N=Math.max(.5*N,1);else if(r==m){Math.max(4,D);Math.max(4,N);d=b=new Uint16Array(d);B=n/2;L=D;var O=N,n=new Uint16Array(4);b=new Uint16Array(L*O);for(var E=0,c=0,k=c=E=r=0,y=0,A=0,e=0,R=L/4,O=O/4,q=0;q<O;q++)for(var ba=0;ba<R;ba++)r=B+4*(q*R+ba),n[0]=d[r],n[1]=d[r+1],E=n[0]&31,c=
n[0]&2016,k=n[0]&63488,y=n[1]&31,A=n[1]&2016,e=n[1]&63488,n[2]=5*E+3*y>>3|5*c+3*A>>3&2016|5*k+3*e>>3&63488,n[3]=5*y+3*E>>3|5*A+3*c>>3&2016|5*e+3*k>>3&63488,E=d[r+2],c=4*q*L+4*ba,b[c]=n[E&3],b[c+1]=n[E>>2&3],b[c+2]=n[E>>4&3],b[c+3]=n[E>>6&3],c+=L,b[c]=n[E>>8&3],b[c+1]=n[E>>10&3],b[c+2]=n[E>>12&3],b[c+3]=n[E>>14],E=d[r+3],c+=L,b[c]=n[E&3],b[c+1]=n[E>>2&3],b[c+2]=n[E>>4&3],b[c+3]=n[E>>6&3],c+=L,b[c]=n[E>>8&3],b[c+1]=n[E>>10&3],b[c+2]=n[E>>12&3],b[c+3]=n[E>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,N,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);f&&a.generateMipmap(a.TEXTURE_2D)}else return p.error("No manual decoder for",t(r),"and no native support"),0;return I}function d(a,b,d,f,g){var m=new XMLHttpRequest;m.open("GET",d,!0);m.responseType="arraybuffer";m.onload=function(){if(200==m.status){a.bindTexture(a.TEXTURE_2D,f);var d=n(a,b,m.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&g(f)};m.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function t(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var p=r("__print"),B=r("__util"),m=b("DXT1"),x=b("DXT3"),g=b("DXT5");a.b_=n;a.c_=function(a,b,d){var f=new Uint32Array(d,0,13);if(55727696==f[0]){var g=f[7],m=f[6],n=f[11],p=52+f[12];switch(f[2]){case 0:var x=2,t=1;break;case 1:x=2;t=3;break;case 2:x=4;t=0;break;case 3:x=4;t=2;break;default:B.q("Unsupported PVR V3 format.")}}else if(559044176==
f[11]){g=f[2];m=f[1];n=f[3];p=f[0];n++;var r=f[4]&255,f=0<f[10];25==r?(x=4,t=f?2:0):24==r?(x=2,t=f?3:1):B.q("Unsupported PVR V2 format.")}else B.q("Unsupported PVR version.");r=2==x?8:4;f=4;switch(t){case 0:var O=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:O=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:O=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:O=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=r*f*x/8;for(x=0;x<n;x++){var t=Math.max(g>>x,1),E=Math.max(m>>x,1),c=t/r,k=E/f;2>c&&(c=2);2>k&&(k=2);c=
c*k*b;k=new Uint8Array(d,p,c);a.compressedTexImage2D(a.TEXTURE_2D,x,O,t,E,0,k);p+=c}};a.$I=function(a,b){switch(b){case "dds":var d=new Int32Array(a,0,31);return{width:d[4],height:d[3]};case "pvr":d=new Uint32Array(a,0,13);if(55727696==d[0])var f=d[7],d=d[6];else f=d[2],d=d[1];return{width:f,height:d}}};a.FU=function(a,b){var d=1;if("dds"==b){var f=new Int32Array(a,0,31),n=f[21];switch(n){case m:d=6;break;case x:case g:d=4;break;default:p.error("Unsupported FourCC code:",t(n))}}else if("pvr"==b)if(f=
new Uint32Array(a,0,13),55727696==f[0])switch(f[2]){case 0:d=12;break;case 1:d=16;break;case 2:d=6;break;case 3:d=8}else n=f[4]&255,f=0<f[10],25==n?d=f?8:6:24==n&&(d=f?16:12);return d};a.X5=function(a,b,g,f){var m=a.createTexture();d(a,b,g,m,f);return m}};b4w.module.__curve=function(a,r){function n(a,b,d,h,m){var f=h.length;m||(m=new Float32Array(f));for(var n=f+a,p=new Float32Array(n),t=1;t<=n-1;t++)p[t-1]=b>=d[t-1]&&b<d[t+1-1]?1:0;for(var r=2;r<=a;r++)for(t=1;t<=n-r;t++)p[t-1]=(0!=p[t-1]?(b-d[t-1])*p[t-1]/(d[t+r-1-1]-d[t-1]):0)+(0!=p[t+1-1]?(d[t+r-1]-b)*p[t+1-1]/(d[t+r-1]-d[t+1-1]):0);b==d[n-1]&&(p[f-1]=1);a=0;for(t=1;t<=f;t++)a+=p[t-1]*h[t-1];for(t=1;t<=f;t++)m[t-1]=0!=a?p[t-1]*h[t-1]/a:0;return m}function d(a){a=a.Ev;return a[a.length-1]}function b(a){a=
a.kH;return a[a.length-1]}function t(a,b,d,h,m,f,n,r){var B=a+(b-a)/2,L=p(B,h,m,f,n)-d;r=r?r:.01;return Math.abs(L)<r?B:0<L?t(a,B,d,h,m,f,n,r):t(B,b,d,h,m,f,n,r)}function p(a,b,d,h,m){var f=1-a;return b*f*f*f+3*d*f*f*a+3*h*f*a*a+m*a*a*a}r("__print");var B=r("__util"),m=r("__vec3");a.ES=function(a){var b={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var h=a.order_u;b.lk=h;a=a.points;var m=a.length/5,f=[],p=m+h,m=m+2;f[0]=0;for(var t=2;t<=p;t++)f[t-1]=t>h&&t<m?f[t-
2]+1:f[t-2];b.Ev=f;"2D"==d.dimensions?b.Zj=!1:"3D"==d.dimensions?b.Zj=!0:B.q("Wrong curve dimensions");h=[];f=[];for(d=0;d<a.length;d+=5)h.push(a[d]),h.push(a[d+1]),h.push(a[d+2]),b.Zj&&h.push(a[d+3]),f.push(a[d+4]);b.Tz=h;b.cE=f;a=[];for(var d=b.Tz,h=b.Zj?4:3,f=b.cE,p=b.Ev,m=b.lk,t=d.length/h,r=t+m,L=0,D=p[r-1]/999,N=0;1E3>N;N++){5E-6>p[r-1]-L&&(L=p[r-1]);for(var I=n(m,L,p,f),O=0;O<h;O++)for(var E=a[h*N+O]=0;E<t;E++)a[h*N+O]+=I[E]*d[h*E+O];L+=D}h=b.Zj?4:3;f=new Float32Array(1E3);f[0]=0;for(d=1;1E3>
d;d+=1)p=a[(d-1)*h],m=a[(d-1)*h+1],t=a[(d-1)*h+2],r=a[d*h],L=a[d*h+1],D=a[d*h+2],f[d]=f[d-1]+Math.sqrt((r-p)*(r-p)+(L-m)*(L-m)+(D-t)*(D-t));b.kH=f;return b};a.RY=function(a,b,l){l||(l=[]);var h=b,m=Math.max(h,0);b=m=Math.min(h,d(a));var h=a.Tz,m=a.Zj?4:3,f=a.cE,p=a.Ev,t=a.lk;a=h.length/m;var r=a+t;5E-6>p[r-1]-b&&(b=p[r-1]);r=new Float32Array(a);n(t,b,p,f,r);for(b=0;b<m;b++)for(f=l[b]=0;f<a;f++)l[b]+=r[f]*h[m*f+b]};a.OY=function(a,b,d){d||(d=[]);var h=a.Tz,m=a.Zj?4:3,f=a.cE,n=a.Ev,p=a.lk;a=h.length/
m;var t=a+p;5E-6>n[t-1]-b&&(b=n[t-1]);var t=new Float32Array(a),r=b;b=t;var B=f.length;b||(b=new Float32Array(B));var N=new Float32Array(B),I=new Float32Array(B),O=N,E=I;O||(O=new Float32Array(B));E||(E=new Float32Array(B));for(var c=B+p,k=new Float32Array(c),y=new Float32Array(c),A=1;A<=c-1;A++)k[A-1]=r>=n[A-1]&&r<n[A+1-1]?1:0;r==n[c-1]&&(k[B-1]=1);for(var e=2;e<=p;e++)for(A=1;A<=c-e;A++){var R=0!=k[A-1]?k[A-1]/(n[A+e-1-1]-n[A-1]):0,q=0!=k[A+1-1]?-k[A+1-1]/(n[A+e-1]-n[A+1-1]):0,ba=0!=y[A-1]?(r-n[A-
1])*y[A-1]/(n[A+e-1-1]-n[A-1]):0,J=0!=y[A+1-1]?(n[A+e-1]-r)*y[A+1-1]/(n[A+e-1]-n[A+1-1]):0;k[A-1]=(0!=k[A-1]?(r-n[A-1])*k[A-1]/(n[A+e-1-1]-n[A-1]):0)+(0!=k[A+1-1]?(n[A+e-1]-r)*k[A+1-1]/(n[A+e-1]-n[A+1-1]):0);y[A-1]=R+q+ba+J}for(A=1;A<=B;A++)O[A-1]=k[A-1],E[A-1]=y[A-1];n=0;for(p=1;p<=B;p++)n+=N[p-1]*f[p-1];r=0;for(p=1;p<=B;p++)r+=I[p-1]*f[p-1];for(p=1;p<=B;p++)b[p-1]=0!=n?I[p-1]*f[p-1]/n+N[p-1]*f[p-1]*r/(n*n):0;for(f=0;f<m;f++)for(n=d[f]=0;n<a;n++)d[f]+=t[n]*h[m*n+f]};a.Y7=d;a.QY=b;a.PY=function(a,
g){if(0>=g)return 0;var l=d(a);if(g>=b(a))return l;var h=a.kH,m=B.Kt(h,g,0,h.length-1);return l*(m+(g-h[m])/(h[m+1]-h[m]))/1E3};a.Gv=function(a,b,d,h,m){return d+(m-h)*(a-d)/(b-h)};a.PJ=function(a,b,d){var h=b[0];b=b[1];d=(d[1]-b)/(d[0]-h);return d*a+(b-d*h)};a.UF=function(a,b,d,h,m,f){return p(t(0,1,a,b[0],d[0],h[0],m[0],f),b[1],d[1],h[1],m[1])};a.yz=function(a,b,d,h,n){var f=new Float32Array(3),p=new Float32Array(3),t=new Float32Array(3),r=new Float32Array(3),B=new Float32Array(3),D=new Float32Array(3);
m.copy(a[1],p);null==b?(m.copy(d[1],t),f[0]=2*p[0]-t[0],f[1]=2*p[1]-t[1]):m.copy(b[1],f);null==d?(m.copy(b[1],f),t[0]=2*p[0]-f[0],t[1]=2*p[1]-f[1]):m.copy(d[1],t);m.subtract(p,f,r);m.subtract(t,p,B);b=m.length(r);d=m.length(B);0==b&&(b=1);0==d&&(d=1);if("AUTO"==h||"AUTO"==n)D[0]=B[0]/d+r[0]/b,D[1]=B[1]/d+r[1]/b,f=2.5614*m.length(D),0!=f&&("AUTO"==h&&m.scaleAndAdd(p,D,-(b/f),a[0]),"AUTO"==n&&m.scaleAndAdd(p,D,d/f,a[2]));"VECTOR"==h&&m.scaleAndAdd(p,r,-1/3,a[0]);"VECTOR"==n&&m.scaleAndAdd(p,B,1/3,a[2])};
a.aS=function(a,b,d,h){var m=[],f=[],n,p,t;m[0]=a[0]-b[0];m[1]=a[1]-b[1];f[0]=h[0]-d[0];f[1]=h[1]-d[1];t=h[0]-a[0];n=Math.abs(m[0]);p=Math.abs(f[0]);0!=n+p&&n+p>t&&(n=t/(n+p),b[0]=a[0]-n*m[0],b[1]=a[1]-n*m[1],d[0]=h[0]-n*f[0],d[1]=h[1]-n*f[1])}};b4w.module.__shaders=function(a,r){function n(a,b,c){var e=a.Hi;"string"==typeof c?(a=d(a,c))&&(c=a[1]):c=String(c);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;break}}function d(a,b){for(var c=a.Hi,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in V)){var d=f(q.shaders_path,a),e=f(q.shaders_path,b),d=K(d),e=K(e),k;for(k in e)d[k]=e[k];e=[];for(k in d)e.push([k,d[k]]);V[c]=e}return V[c]}function t(a,b){return a+b}function p(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(t,0)}function B(a,b){var c=w(a.type),d=w(b.type),e=a.nl,f=b.nl;return c>d?-1:c<d?1:e>f?-1:e<f?1:0}function m(a){if(e.cc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=fa}else b=M;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],nl:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return g(a,Z,R.Nv)}function x(a,b,c){a=a.split(";").map(function(a){return(a=a.match(v))&&{type:a[2],nl:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return g(a,b,c)}function g(a,b,c){function d(){for(var c=0;n<a.length;){var e=a[n];if(3!=w(e.type))break;c+=h(e.type)*e.nl;n++}g=m+c;if(g>ca)return!1;l(b,m,c,0,3);return!0}function e(){for(var c=ca-g,d=c,f=c;n<a.length;){var k=a[n];if(2!=w(k.type))break;k=h(k.type)*k.nl;if(k<=d)d-=k;else if(k<=f)f-=k;else return!1;n++}f=c-f;l(b,g,c-d,0,2);l(b,ca-f,f,2,2);return!0}function f(){for(;n<a.length;){for(var d=a[n],d=h(d.type)*d.nl,e=-1,k=c+1,g=-1,m=0;4>m;m++){var u=H;
u[0]=0;u[1]=1;var q;q=b;for(var y=m,p=d,v=u;Q<q.length&&15===q[Q];)Q++;for(;0<ca&&15===q[ca];)ca--;if(ca-Q<p)q=!1;else{for(var y=1<<y,t=0,x=-1,w=q.length+1,A=!1,r=Q;r<=ca;r++)r<ca&&!(q[r]&y)?A||(t=r,A=!0):(A&&(A=r-t,A>=p&&A<w&&(w=A,x=t)),A=!1);0>x?q=!1:(v[0]=x,v[1]=w,q=!0)}q&&u[1]<k&&(g=u[0],k=u[1],e=m)}if(0>e)return!1;l(b,g,d,e,1);n++}return!0}if(!a.length)return!0;for(var k=0;k<c;k++)b[k]=0;ca=c;a.sort(B);var g=0,m=0,n=0;return function(){for(;n<a.length;){var c=a[n];if(4!=w(c.type))break;m+=h(c.type)*
c.nl;n++}if(m>ca)return!1;Q=m;l(b,0,m,0,4);return!0}()&&d()&&e()&&f()}function l(a,b,c,d,e){for(var f=0,k=0;k<e;k++)f|=1<<d+k;for(k=0;k<c;k++)a[b+k]|=f}function h(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function w(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}
function f(a,b){var c=a+b;if(J[c])return J[c];if(F){var d=F[b];if(!d)return null;d=r("__gpp_parser").t6.parse(d)}else if(d=r("shader_texts")[b],!d)return null;return J[c]=d}function C(a,b){for(var c={},d=b.Hi||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.jg.length;f++)c["USE_NODE_"+b.jg[f].id]=["1"];e.cc?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=e.mq?["sampler2DShadow"]:["sampler2D"];for(var k in c)c[k][0].constructor!=String&&y.warn("Warning! The value of a directive '"+k+"' is not of type string.");return c}
function K(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=f(q.shaders_path,q.VL+a.o),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var e=0;e<a.length;e++)c(a[e],b,d);else if(a instanceof Object&&a){b&&b(a);for(e in a)c(a[e],b,d);d&&d(a)}}var d={};c(a,b);return d}function G(a,b,c){function d(b){b=b.d;for(var c=0;c<b.length;c++){var e=b[c];switch(e.a){case "cond":a:for(var e=e.d,n=0;n<e.length;n++){var w=e[n];switch(w.a){case "if":case "elif":if(k(w.g)){d(w.h);break a}break;
case "else":d(w.h);break a;case "ifdef":w.c in v&&d(w.h);break;case "ifndef":w.c in v||d(w.h)}}break;case "include":e=e.o;n=f(q.shaders_path,q.VL+e);x.push("include/"+e);d(n);x.pop();break;case "var":break;case "define":v[e.c]=e.b;break;case "error":A.q("Shader error: #error "+e.b.join(" "));break;case "line":break;case "pragma":p.push("#pragma "+e.c+" "+e.b.join(" "));break;case "undef":delete v[e.c];break;case "warning":y.warn("Shader warning: #warning "+e.b.join(" "));break;case "extension":e=
m(e.b,v,t,!1);p.push("#extension "+e.join(" "));break;case "version":e=m(e.b,v,t,!1),p.push("#version "+e.join(" "));case "#":break;case "node":r[e.c]=e;break;case "nodes_global":e=u;for(n=0;n<e.length;n++){var w=e[n],E=r[w.id];if(E)for(var F=0,C=0;C<E.l.length;C++){var B=E.l[C];if("node_param"==B.a){var M;if("PARTICLE_INFO"==w.id&&B.e)if(1==v.PARTICLE_BATCH)switch(M=!1,F){case 0:M=O(w.Rb,"PART_INFO_IND")||O(w.Rb,"PART_INFO_AGE")||O(w.Rb,"PART_INFO_LT")||O(w.Rb,"PART_INFO_SIZE");break;case 1:M=O(w.Rb,
"PART_INFO_LOC");break;case 2:M=O(w.Rb,"PART_INFO_VEL");break;case 3:M=O(w.Rb,"PART_INFO_A_VEL");break;case 4:M=O(w.Rb,"PART_INFO_IND")}else M=!1;else M=!0;M&&(B=B.f.join(" ")+" ","vert"==a?B+=w.li[F]:"frag"==a&&(B+=w.qb[F],null!==w.hw[F]&&(B+="="+w.hw[F])),B+=";",l(g(B)));F++}}}break;case "nodes_main":e=u;for(n=0;n<e.length;n++)if(w=e[n],E=r[w.id]){F={};R=D=Q=0;C=E;B=w;M=C;for(var G={},J=0;J<M.m.length;J++){var I=M.m[J];G[I.c]=[I.b.join("")]}M=G;for(G=0;G<B.Rb.length;G++)J=B.Rb[G][0],J in M&&(M[J]=
[B.Rb[G][1]]);for(G=J=0;G<C.l.length;G++)I=C.l[G],"node_out"==I.a&&(M["USE_OUT_"+I.c]=[-1<H.indexOf(B.fb[J])|0],J++);C=M;B=w;M=E.l;G=F;J=C;for(I=0;I<M.length;I++){var K=M[I];switch(K.a){case "node_in":var N=B.L[Q];if(null!==B.iB[Q]){if(("MATERIAL_BEGIN"==B.id&&3===Q||!J.MATERIAL_EXT&&("MATERIAL_BEGIN"==B.id&&4===Q||"MATERIAL_END"==B.id&&3===Q||"MATERIAL_END"==B.id&&4===Q||"MATERIAL_END"==B.id&&5===Q)||"TEXTURE_COLOR"==B.id||"TEXTURE_NORMAL"==B.id)&&K.e){G[K.c]=B.iB[Q];Q++;continue}var ca=K.f.join(" ")+
" ",ca=ca+(N+"="+B.iB[Q]+";");l(g(ca))}G[K.c]=N;Q++;break;case "node_out":N=B.fb[D];if(!K.e||-1<H.indexOf(N))ca=K.f.join(" ")+" ",ca+=N+";",l(g(ca)),G[K.c]=N;D++;break;case "node_param":"vert"==a?N=B.li[R]:"frag"==a&&(N=B.qb[R]),G[K.c]=N,R++}}p.push("{");h(w,E.j,F,C);p.push("}")}break;case "txt":l(e.b);break;default:A.q("Unknown element type: "+e.a)}}}function k(a,b){var c;c=m(a,v,t,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].a){case "conditional_expr":var f=d.pop(),
h=d.pop();d.pop()?d.push(h):d.push(f);break;case "logical_or_expr":for(var h=d.pop(),g=0;g<c[e].i-1;g++)f=d.pop(),h=h||f;d.push(h);break;case "logical_and_expr":h=d.pop();for(g=0;g<c[e].i-1;g++)f=d.pop(),h=h&&f;d.push(h);break;case "logical_bitor_expr":h=d.pop();for(g=0;g<c[e].i-1;g++)h|=d.pop();d.push(h);break;case "logical_bitxor_expr":h=d.pop();for(g=0;g<c[e].i-1;g++)h^=d.pop();d.push(h);break;case "logical_bitand_expr":h=d.pop();for(g=0;g<c[e].i-1;g++)h&=d.pop();d.push(h);break;case "equal_expr":f=
d.pop();h=d.pop();d.push(h==f);break;case "non_equal_expr":f=d.pop();h=d.pop();d.push(h!=f);break;case "le_expr":f=d.pop();h=d.pop();d.push(h<=f);break;case "ge_expr":f=d.pop();h=d.pop();d.push(h>=f);break;case "l_expr":f=d.pop();h=d.pop();d.push(h<f);break;case "g_expr":f=d.pop();h=d.pop();d.push(h>f);break;case "left_shift_expr":h=d.pop();f=d.pop();d.push(h<<f);break;case "right_shift_expr":h=d.pop();f=d.pop();d.push(h>>f);break;case "add_expr":h=d.pop();f=d.pop();d.push(h+f);break;case "sub_expr":h=
d.pop();f=d.pop();d.push(h-f);break;case "mul_expr":h=d.pop();f=d.pop();d.push(h*f);break;case "div_expr":h=d.pop();f=d.pop();d.push(h/f);break;case "mod_expr":h=d.pop();f=d.pop();d.push(h%f);break;case "pre_inc_expr":case "post_inc_expr":f=d.pop();d.push(++f);break;case "pre_dec_expr":case "post_dec_expr":f=d.pop();d.push(--f);break;case "positive_expr":f=d.pop();d.push(+f);break;case "negative_expr":f=d.pop();d.push(-f);break;case "one_compl_expr":f=d.pop();d.push(~f);break;case "logic_negative_expr":f=
d.pop();d.push(!f);break;default:A.q("Unknown operation type: "+c[e].a)}else f=c[e],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(f)?(d.push(0),0!=f.indexOf("USE_NODE_")&&(h=x[x.length-1],h in w||(w[h]=[]),-1==w[h].indexOf(f)&&(w[h].push(f),y.error("Undefined directive '"+f+"' in shader '"+h+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[e]));1==d.length?c=d[0]:(A.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function h(a,b,c,d){for(var e=0;e<b.length;e++){var f=
b[e];switch(f.a){case "node_cond":a:for(var g=a,f=f.d,m=c,n=d,u=0;u<f.length;u++){var q=f[u];switch(q.a){case "node_if":case "node_elif":if(k(q.g,n)){h(g,q.j,m,n);break a}break;case "node_else":h(g,q.j,m,n);break a;case "node_ifdef":(q.c in v||q.c in n)&&h(g,q.j,m,n);break;case "node_ifndef":q.c in v||q.c in n||h(g,q.j,m,n)}}break;case "txt":g=[];for(m=0;m<f.b.length;m++)n=f.b[m],n in c?g.push(c[n]):g.push(n);l(g,d)}}}function g(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function l(b,c){var d=
b;e.cc||"frag"!=a||(d=d.join(" "),B&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),B=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),B=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=m(b,v,t,!1,c),p.push(d.join(" ")))}function m(a,b,c,d,e){var f=[];n(a,b,c,d,f,e);return f}function n(a,b,c,d,e,f){for(var k=0;k<a.length;k++){var h=a[k];if(f&&h in f)h=f[h];else if(h in b)h=b[h];else{e.push(h);continue}0==
h.length&&d?e.push(0):n(h,b,c,d,e,f)}}var u=c.jg,p=[],v=C(a,c),t={},x=[c[a]],w={},r={},H=[],E;for(E in u)for(var F in u[E].L)H.push(u[E].L[F]);var B=!1;d(b);var Q=0,D=0,R=0;return p.join("\n")}function L(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function D(a){ua.deleteProgram(a.Zh);ua.deleteShader(a.yx);ua.deleteShader(a.Eu);delete ba[a.dD]}function N(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return I(a);case 2:return"vec2("+I(a[0])+","+I(a[1])+")";case 3:return"vec3("+
I(a[0])+","+I(a[1])+","+I(a[2])+")";case 4:return"vec4("+I(a[0])+","+I(a[1])+","+I(a[2])+","+I(a[3])+")";case 9:return"mat3("+I(a[0])+","+I(a[1])+","+I(a[2])+","+I(a[3])+","+I(a[4])+","+I(a[5])+","+I(a[6])+","+I(a[7])+","+I(a[8])+")";case 16:return"mat4("+I(a[0])+","+I(a[1])+","+I(a[2])+","+I(a[3])+","+I(a[4])+","+I(a[5])+","+I(a[6])+","+I(a[7])+","+I(a[8])+","+I(a[9])+","+I(a[10])+","+I(a[11])+","+I(a[12])+","+I(a[13])+","+I(a[14])+","+I(a[15])+")";default:A.q("Wrong glsl value dimension")}}function I(a){return a%
1?String(a):String(a)+".0"}function O(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var E=r("__assets"),c=r("__config"),k=r("__debug"),y=r("__print"),A=r("__util"),e=c.A,R=c.Ci,q=c.Ae,ba={},J={},F=null,V={},U="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Wy=0;a.RN=1;a.QN=2;a.UN=4;a.TN=8;a.SN=16;a.MN=32;var aa=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,v=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,fa=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,M=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
H=new Int16Array(2),Z=null,ha=null,u=null,Q=0,ca=0,ja=[],ua=null,pa=!1;a.If=function(a){ua=a};a.ga=n;a.JU=d;a.TX=function(a){a.Hi=A.Eh(b(a.tg,a.Te));n(a,"PRECISION",c.A.precision);"highp"==c.A.precision?n(a,"EPSILON",N(1E-6)):n(a,"EPSILON",N(1E-4));n(a,"CONSTANTS_HACK",e.cD|0);n(a,"SRGB",e.srgb_type);n(a,"COMPARED_MODE",e.mq|0)};a.c5=function(a){return a.tg};a.c4=function(a){return a.Te};a.EU=function(a){var b=JSON.stringify(a.tg)+JSON.stringify(a.Te)+JSON.stringify(a.Hi)+JSON.stringify(a.jg),c=ba[b];
if(c)return c;var d=a.Te,h=f(q.shaders_path,a.tg),d=f(q.shaders_path,d);if(!h||!d)return null;var h=G("vert",h,a),d=G("frag",d,a),c=0,g=p(d,aa);a.GM=g;g>R.IB&&(c|=1);Z||(Z=new Uint32Array(R.Nv));ha||(ha=new Uint32Array(R.Mv));u||(u=new Uint32Array(R.Br));x(d,ha,R.Mv)||(c|=2);x(h,u,R.Br)||(c|=4);g=e.cc?(h.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(h.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.KF=g;g>R.JB&&(c|=8);m(d)||(c|=16);a.status=c;if(0===
a.status){var c=ua,l=L(c,h,c.VERTEX_SHADER),n=L(c,d,c.FRAGMENT_SHADER),g=c.createProgram();c.attachShader(g,l);c.attachShader(g,n);c.linkProgram(g);for(var l={yx:l,Eu:n,Zh:g,attributes:{},Im:{},Mr:A.Lj(),hC:A.Lj(),iC:{},Er:!0,Xv:!1,TM:A.Lj(),SM:A.Lj(),hb:A.Eh(a),dD:b,Tf:!0},y=c.getProgramParameter(g,c.ACTIVE_ATTRIBUTES),n=0;n<y;n++){var v=c.getActiveAttrib(g,n).name;l.attributes[v]=c.getAttribLocation(g,v)}y=c.getProgramParameter(g,c.ACTIVE_UNIFORMS);for(n=0;n<y;n++)v=c.getActiveUniform(g,n).name.split("[0]").join(""),
l.Im[v]=c.getUniformLocation(g,v);ba[b]=c=l;g=!ua.getShaderParameter(c.Eu,ua.COMPILE_STATUS);l=!ua.getShaderParameter(c.yx,ua.COMPILE_STATUS);n=!ua.getProgramParameter(c.Zh,ua.LINK_STATUS);g?k.WK(c.Eu,b,d):l?k.WK(c.yx,b,h):n&&k.zX(c.Zh,b,h,d);if(g||l||n)a.status|=32,c=null}else c=null;return c};a.gW=function(){pa=!1;if(b4w.module_check("shader_texts"))pa=!0;else{for(var a=[],b=E.Jx,c=0;c<U.length;c++){var d=A.aj(q.shaders_path+U[c]);a.push({id:U[c],type:b,url:d})}b=function(a,b){F||(F={});F[b]=a};
a.length?E.Ud(a,b,function(){pa=!0}):y.error("Shaders have not been found.")}};a.wG=function(){return pa};a.K2=function(){return ja};a.iI=function(){return ba};a.sa=function(){for(var a in ba)D(ba[a]);for(var b in J)delete J[b];for(var c in ja)delete ja[c];u=ha=Z=null;V={}};a.TR=D;a.L2=function(a){var b=a.Hi;y.log("Shader: "+a.tg+" "+a.Te+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)y.log("  "+b[a][0],b[a][1])};a.M=N;a.xG=function(a,b){return b in a.Im?!0:!1};a.reset=function(){ua=
null}};b4w.module.__assets=function(a,r){function n(){return C.tJ()?r(C.Ae.Ot).data:null}function d(){var a={xt:null,YP:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.xt=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=n();b&&a.xt in b&&(a.status=200,b[a.xt]&&(a.response=a.YP(b[a.xt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=O.xW)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.Os:t(e,"arraybuffer");break;case a.Vm:t(e,"json");break;case a.Jx:t(e,"text");break;case a.Hx:p(e);break;case a.Ps:B(e);break;case a.Ix:m(e);break;case a.Rs:x(e);break;
case a.Qs:g(e);break;default:D.q("Wrong asset type: "+e.type)}}}function t(b,c){var e=b.url.split("?t=")[0];if(e in y)"json"==c?b.Yb(D.P(y[e]),b.id,b.type,b.url,b.Ib):b.Yb(y[e],b.id,b.type,b.url,b.Ib);else{var f=n(),k=f&&b.url in f?new d:new XMLHttpRequest,f=null;if("GET"==b.ai)k.open("GET",b.url,!0);else if("POST"==b.ai)switch(k.open("POST",b.url,!0),b.ko){case a.iE:f="text/plain";break;case a.hE:f="application/json"}if(b.pk)for(var h in b.pk)"Content-Type"==h?f=b.pk[h]:k.setRequestHeader(h,b.pk[h]);
f&&k.setRequestHeader("Content-Type",f);"text"==c?(k.overrideMimeType("text/plain"),k.responseType="text"):"json"==c?(k.overrideMimeType("application/json"),k.responseType="text"):k.responseType=c;k.onreadystatechange=function(){if(40!=b.state&&4==k.readyState){if(200==k.status||0==k.status){var a=k.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.OV)}catch(d){G.error(d+" (parsing JSON "+b.url+")");b.Yb(null,b.id,b.type,b.url,b.Ib);return}b.Vg&&(y[e]="json"==c?D.P(a):a);b.Yb(a,
b.id,b.type,b.url,b.Ib)}else G.error("empty responce when trying to get "+b.url),b.Yb(null,b.id,b.type,b.url,b.Ib)}else G.error(k.status+" when trying to get "+b.url),b.Yb(null,b.id,b.type,b.url,b.Ib);b.state=30}};k.addEventListener("progress",function(a){a.lengthComputable&&b.IK(a.loaded/a.total)},!1);k.send(b.vm)}}function p(a){var b=a.url.split("?t=")[0];if(b in R)a.Yb(R[b],a.id,a.type,a.url,a.Ib),a.state=30;else{"GET"!=a.ai&&D.q("Unsupported request type for audio buffer");var c=(b=n())&&a.url in
b?new d:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?L.pT(b,function(b){a.Yb(b,a.id,a.type,a.url,a.Ib);a.state=30;a.Vg&&(R[a.url.split("?t=")[0]]=b)},function(){a.Yb(null,a.id,a.type,a.url,a.Ib);G.error("failed to decode "+a.url);a.state=30}):(a.Yb(null,a.id,a.type,a.url,a.Ib),G.error("empty responce when trying to get "+a.url),a.state=30)}else a.Yb(null,a.id,
a.type,a.url,a.Ib),G.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.vm)}}function B(a){var b=a.url.split("?t=")[0];if(b in A)a.Yb(A[b],a.id,a.type,a.url,a.Ib),a.state=30;else{"GET"!=a.ai&&D.q("Unsupported request type for image element");var c=document.createElement("img");I.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Ib),a.state=30,a.Vg&&(A[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.Yb(null,
a.id,a.type,a.url,a.Ib),G.error("could not load image: "+a.url),a.state=30)},!1);if((b=n())&&a.url in b)if(b[a.url]){var d=h(a.url);c.src="data:"+d+";base64,"+b[a.url]}else K.or()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function m(a){var b=a.url.split("?t=")[0];if(b in e)a.Yb(e[b],a.id,a.type,a.url,a.Ib),a.state=30;else{"GET"!=a.ai&&D.q("Unsupported request type for audio element");var c=document.createElement("audio");
I.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Ib),a.state=30,a.Vg&&(e[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url,a.Ib),G.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url,a.Ib),G.error("could not load sound: "+a.url),a.state=30)},!1);if((b=n())&&a.url in b)if(b[a.url]){var d=
w(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Ib),a.state=30)}else K.or()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,I.is_mobile_device&&c.load();I.MB&&(c.autoplay=!0,c.pause());setTimeout(function(){c.GY=1},5E3)}}function x(a){function b(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url),G.error("could not load video: "+a.url,a.Ib),a.state=30)}var c=a.url.split("?t=")[0];
if(c in A)a.Yb(A[c],a.id,a.type,a.url,a.Ib),a.state=30;else{"GET"!=a.ai&&D.q("Unsupported request type for video element");var d=document.createElement("video");d.muted=!0;I.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.Yb(d,a.id,a.type,a.url,a.Ib),a.state=30,a.Vg&&(A[a.url.split("?t=")[0]]=d))},!1);d.addEventListener("error",b,!1);if((c=n())&&a.url in c)if(c[a.url]){var e=f(a.url);d.src="data:"+e+";base64,"+
c[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.Yb(d,a.id,a.type,a.url,a.Ib);a.state=30},!1)}else K.or()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=a.url,I.is_mobile_device&&d.load();I.MB&&(d.autoplay=!0,d.pause());setTimeout(function(){d.GY=1},1E4)}}function g(b){function c(a){b.Yb(a,b.id,b.type,b.url,b.Ib);b.state=30;b.Vg&&(A[b.url.split("?t=")[0]]=a)}var e=b.url.split("?t=")[0];if(e in
A)b.Yb(A[e],b.id,b.type,b.url,b.Ib),b.state=30;else{"GET"!=b.ai&&D.q("Unsupported request type for seq video element");var f=(e=n())&&b.url in e?new d:new XMLHttpRequest;if(null==b.ko&&null==b.vm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.ko){case a.iE:f.setRequestHeader("Content-type","text/plain");break;case a.hE:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?l(a,c):(b.Yb(null,b.id,b.type,b.url,b.Ib),G.error("empty responce when trying to get "+b.url),b.state=30)}else b.Yb(null,b.id,b.type,b.url,b.Ib),G.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.IK(a.loaded/a.total)},!1);f.send(b.vm)}}function l(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],aG:[],Rg:c[4]},k=20,h=0;h<e;h++){var g=c[k/4],l=new Blob([d.subarray(k+4,k+4+g)],
{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(l);f.images.push(m);f.aG.push(l);k+=g+8-g%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.aG;b(f)}}function h(a){var b="image";switch(D.QA(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function w(a){var b="audio";switch(D.QA(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function f(a){var b="video";switch(D.QA(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var C=r("__config"),K=r("__compat"),G=r("__print"),L=r("__sfx"),D=r("__util"),N=r("__version"),I=C.A,O=C.Pd;a.Os=10;a.Vm=20;a.Jx=30;a.Hx=40;a.Ps=50;a.Ix=60;a.Rs=70;a.Qs=80;a.hE=a.Vm;a.iE=a.Jx;var E=[],c=0,k={},y={},A={},e={},R={};a.Fm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.L4=function(a){if(k[a])return k[a];var b=O.prevent_caching?a+N.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return k[a]=b;D.q("Error XHR: responce is empty, GET "+a)}else D.q("Error XHR: "+c.status+", GET "+a)};a.sa=function(){for(var a=0;a<E.length;a++)E[a].state=40;E=[];c=0;k={}};a.Ud=function(a,d,e,f,k){for(var h=0;h<a.length;h++){var g=a[h],g={id:g.id,type:g.type,url:g.url,
Vg:g.Vg,ai:g.ai?g.ai:"GET",ko:g.ko?g.ko:null,pk:g.pk?g.pk:null,vm:g.vm?g.vm:null,Ib:g.Ib?g.Ib:null,state:10,Yb:d||function(){},tK:e||function(){},IK:f||function(){},OV:k||null,uK:c};if(O.prevent_caching){var l=n();l&&g.url in l||(g.url+=N.timestamp())}E.push(g)}b(E);c++};a.update=function(){b(E);for(var a=E,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.uK===a[c].uK?30!==f.state&&(d=!1):(d&&(a[e-1].tK(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].tK(),a.splice(c))}};
a.IR=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.VR=function(){y={};A={};e={};R={}}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__data=function(a,r){function n(a,b){Aa[b.id]=null;Xa[b.id]=null}function d(a,b,c,d){a instanceof ArrayBuffer&&(a=la.$I(a,d));d=a.width;a=a.height;xa.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(vb)&&c&&xa.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.Pg)||ka.q("Nothing requested");X.Ud([{id:d,type:X.Vm,url:d,Vg:b.bk}],function(d,f,k,h){if(d){xa.log("%cLOAD METADATA","color: #616",h);f=ka.qM(d.b4w_format_version);
switch(ka.uN(f,Ba.km)){case -1:f[0]<Ba.km[0]?ka.q("JSON version is too old relative to B4W engine: "+ka.Vk(f)+", required: "+ka.Vk(Ba.km)+". Reexport scene with the latest B4W addon to fix it."):xa.warn("JSON version is a bit old relative to B4W engine: "+ka.Vk(f)+", required: "+ka.Vk(Ba.km)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>Ba.km[0]?ka.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
xa.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Ba.BB=f;for(var g in d)a[g]=d[g];b.Mb&&(Fa=T.Au(a.scenes));(d=a.binaries[0].binfile)?b.XF=d:(ea.Rw(b,"load_binaries"),ea.Rw(b,"prepare_bindata"));Ba.is_mobile_device||ea.Rw(b,"mobile_media_start");Ba.antialiasing&&Ba.smaa||ea.Rw(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)g=a.b4w_export_errors[d],(b.Mb&&"PRIMARY"==g.type||
"ALL"==g.type)&&xa.NT(g.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)g=a.b4w_export_warnings[d],(b.Mb&&"PRIMARY"==g.type||"ALL"==g.type)&&xa.OT(g.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.bk&&D(a);e(b,c)}else ea.pF(b)},null,function(a){f(b,c,a)})}function t(a,b,c,d,e,f){(d=S(b.Pg)+b.XF)||ka.q("Binary data is missing");X.Ud([{id:d,
type:X.Os,url:d,Vg:b.bk}],function(d,f,k,h){d?(xa.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,d=m(d),f=ka.qM(a.b4w_format_version),d[0]!=f[0]&&ka.q("BIN version does not match to JSON version: "+ka.Vk(d)+", required: "+ka.Vk(Ba.km)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&xa.warn("BIN version does not match to JSON version: "+ +ka.Vk(d)+", required: "+ka.Vk(Ba.km)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):ea.pF(b)},null,function(a){f(b,
c,a)})}function p(a,b,c,d,e){Mb.wG()&&e(b,c)}function B(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],k=a.objects,h=a.meshes;a=a.actions;var g=ka.GR();m(d);for(var l=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],u=["normal","tangent"],y=["group"],p=["color"],q=0;q<h.length;q++)for(var v=h[q].submeshes,t=0;t<v.length;t++){for(var w in v[t]){var A=v[t][w][1];if(-1!=l.indexOf(w)){var r=v[t][w][0]*ka.rE+f["int"]+12,H=v[t],E=w,C=d;if(g)var z=new Uint32Array(C,r,A);else for(var z=new Uint32Array(A),
C=new DataView(C),B=0;B<A;B++)z[B]=C.getUint32(r+B*ka.rE,!0);H[E]=z}else if(-1!=n.indexOf(w))r=v[t][w][0]*ka.uj+f["float"]+12,v[t][w]=x(d,r,A,g);else if(-1!=u.indexOf(w)){r=v[t][w][0]*ka.tp+f["short"]+12;H=v[t];E=w;C=d;z=new Float32Array(A);C=new DataView(C);for(B=0;B<A;B++)z[B]=C.getInt16(r+B*ka.tp,!0)/32767;H[E]=z}else if(-1!=y.indexOf(w)){r=v[t][w][0]*ka.tp+f.ushort+12;H=v[t];E=w;C=d;z=new Float32Array(A);C=new DataView(C);for(B=0;B<A;B++)z[B]=C.getUint16(r+B*ka.tp,!0)/65535;H[E]=z}else if(-1!=
p.indexOf(w)){r=v[t][w][0]*ka.Lx+f.uchar+12;H=v[t];E=w;C=d;z=new Float32Array(A);C=new DataView(C);for(B=0;B<A;B++)z[B]=C.getUint8(r+B*ka.Lx,!0)/255;H[E]=z}}A=v[t];if(h[q].b4w_shape_keys.length)for(r=A.base_length,H=A.normal.length/r/3,A.tbn_quat=ka.Wq(A.normal.subarray(0,3*r),A.tangent.subarray(0,4*r),new Float32Array(A.normal.length/3*4)),E=1;E<H;E++)for(C=E*r,z=0;z<r;z++){var F=A.normal.subarray(3*z,3*(z+1)),B=W.add(A.normal.subarray(3*(C+z),3*(C+z+1)),F,mb);if(A.tangent.length){var Q=A.tangent.subarray(4*
z,4*(z+1)),O=Qa.add(A.tangent.subarray(4*(C+z),4*(C+z+1)),Q,jb),F=ka.RI(F,Q,ib),B=ka.RI(B,O,kc);Ka.invert(F,ib);B=Ka.multiply(B,F,ib)}else B=Ka.rotationTo(F,B,ib);A.tbn_quat.set(B,4*(C+z))}else A.tbn_quat=ka.Wq(A.normal,A.tangent)}for(w=0;w<k.length;w++)for(h=k[w].particle_systems,l=0;l<h.length;l++)n=h[l],n.transforms=x(d,n.transforms[0]*ka.uj+f["float"]+12,n.transforms[1],g);for(k=0;k<a.length;k++){w=a[k];h=w.fcurves;l=w.frame_range;u=l[0];y=l[1];p=za.CU(u,y);l=null;0>p&&(p=0);var v=q=!1,D;for(D in h)q|=
-1<D.indexOf("rotation_euler"),v|=-1<D.indexOf("rotation_quaternion");n=[];for(D in h)if(q&&v&&-1<D.indexOf("rotation_euler"))delete h[D];else{var t=h[D],R;for(R in t)A=t[R],r=x(d,f["float"]+A.bin_data_pos[0]*ka.uj+12,A.bin_data_pos[1],g),H=new Float32Array(p),null===l&&(l=new Int8Array(p)),za.DQ(A,r,H,l,u,y),A.uf=H;-1<D.indexOf("rotation_euler")&&(za.XT(h[D]),n.push(D))}for(u=0;u<n.length;u++)y=n[u],p=y.replace("euler","quaternion"),h[p]=h[y],delete h[y];w.UP=l}e(b,c)}function m(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function x(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*ka.uj,!0)}return d}function g(a,b,d,e,f){var g=a.cameras,l=a.groups,m=a.materials,n=a.meshes,u=a.node_groups,y=a.objects,p=a.particles,q=a.scenes,v=a.speakers,t=a.lamps,x=a.textures,A=a.worlds;u||(xa.warn('"node_groups" datablock undefined. reexport main scene.'),u=a.node_groups=[]);
for(var r="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),H={},E=0;E<r.length;E++)for(var z=a[r[E]],B=0;B<z.length;B++){var F=z[B];H[F.uuid]=F}for(var Q=0;Q<q.length;Q++){for(var O=q[Q],R=O.objects,M=0;M<R.length;M++)k(R,M,H);O.camera&&k(O,"camera",H);O.world&&k(O,"world",H)}for(Q=0;Q<l.length;Q++)for(var G=l[Q].objects,M=0;M<G.length;M++)k(G,M,H);for(Q=0;Q<y.length;Q++){var I=y[Q];I.dupli_group&&
k(I,"dupli_group",H);I.parent&&k(I,"parent",H);I.dg_parent&&k(I,"dg_parent",H);if(I.animation_data){var N=I.animation_data;N.action&&k(N,"action",H);if(N.nla_tracks)for(M=0;M<N.nla_tracks.length;M++)for(var ca=N.nla_tracks[M],J=0;J<ca.strips.length;J++)ca.strips[J].action&&k(ca.strips[J],"action",H)}switch(I.type){case "MESH":I.data||ka.q("mesh not found for object "+I.name);k(I,"data",H);for(var P=!1,L=I.modifiers,M=0;M<L.length;M++){var U=L[M];"ARMATURE"==U.type?(P&&xa.warn('Object "'+I.name+'" has more than one armature modifiers. Only the first one will be used.'),
P=!0,k(U,"object",H)):"CURVE"==U.type&&k(U,"object",H)}var V=I.particle_systems;if(V)for(M=0;M<V.length;M++)k(V[M],"settings",H);break;case "ARMATURE":k(I,"data",H);for(var fa=I.pose.bones,Z=I.data.bones,M=0;M<fa.length;M++){var ja=fa[M];ja.bone=Z[ja.bone];var ha=ja.constraints;if(ha)for(J=0;J<ha.length;J++){var Y=ha[J];Y.target&&k(Y,"target",H)}for(var X=ja.parent_recursive,J=0;J<X.length;J++)X[J]=fa[X[J]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":k(I,"data",H)}if(ha=I.constraints)for(M=
0;M<ha.length;M++)Y=ha[M],Y.target&&k(Y,"target",H);var W=I.lod_levels;if(W)for(M=0;M<W.length;M++){var ua=W[M];ua.object&&k(ua,"object",H)}}for(Q=0;Q<n.length;Q++)for(var ba=n[Q].materials,M=0;M<ba.length;M++)k(ba,M,H);for(Q=0;Q<m.length;Q++){for(var pa=m[Q],la=pa.texture_slots,M=0;M<la.length;M++)k(la[M],"texture",H);var oa=pa.node_tree;oa&&c(oa,H)}for(Q=0;Q<u.length;Q++)(oa=u[Q].node_tree)&&c(oa,H);for(Q=0;Q<x.length;Q++){var da=x[Q],ea=da.type;"IMAGE"!=ea&&"ENVIRONMENT_MAP"!=ea||k(da,"image",
H)}for(Q=0;Q<g.length;Q++){var ia=g[Q];ia.dof_object&&k(ia,"dof_object",H)}for(Q=0;Q<v.length;Q++){var ma=v[Q];ma.sound&&k(ma,"sound",H);if(ma.animation_data&&(N=ma.animation_data,N.action&&k(N,"action",H),N.nla_tracks))for(M=0;M<N.nla_tracks.length;M++)for(ca=N.nla_tracks[M],J=0;J<ca.strips.length;J++)ca.strips[J].action&&k(ca.strips[J],"action",H)}for(Q=0;Q<p.length;Q++){for(var qa=p[Q],la=qa.texture_slots,M=0;M<la.length;M++)k(la[M],"texture",H);qa.dupli_group&&k(qa,"dupli_group",H);qa.dupli_object&&
k(qa,"dupli_object",H)}for(Q=0;Q<t.length;Q++){var ta=t[Q];if(ta.animation_data&&(N=ta.animation_data,N.action&&k(N,"action",H),N.nla_tracks))for(M=0;M<N.nla_tracks.length;M++)for(ca=N.nla_tracks[M],J=0;J<ca.strips.length;J++)ca.strips[J].action&&k(ca.strips[J],"action",H)}for(Q=0;Q<A.length;Q++){var sa=A[Q];if(la=sa.texture_slots)for(M=0;M<la.length;M++)k(la[M],"texture",H);if(sa.animation_data&&(N=sa.animation_data,N.action&&k(N,"action",H),N.nla_tracks))for(M=0;M<N.nla_tracks.length;M++)for(ca=
N.nla_tracks[M],J=0;J<ca.strips.length;J++)ca.strips[J].action&&k(ca.strips[J],"action",H)}Na.BR(a);D(a);for(var na=S(b.Pg),wa=a.textures,ya=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Fa.b4w_anisotropic_filtering,Aa=0;Aa<wa.length;Aa++)b.Mb||"SCENE"!=wa[Aa].b4w_source_type||(wa[Aa].b4w_source_id=""),eb.dT(wa[Aa],ya,a.scenes,b.id,na);for(var Ba={},Da=a.objects,Ea=0;Ea<Da.length;Ea++){var Ca=Da[Ea];if("MESH"===Ca.type&&!Ca.particle_systems.length)for(var Ha=Ca.data,Ka=Ha.name,Oa=Ha.submeshes,Pa=Ha.materials,
Ia=0;Ia<Oa.length;Ia++)0!==Oa[Ia].base_length||Ba[Ka]||(Pa[Ia]&&xa.warn('material "'+Pa[Ia].name+'" is not assigned to any face (object "'+Ca.name+'").'),Ba[Ka]=!0)}for(var Qa=a.meshes,Ra=0;Ra<Qa.length;Ra++){var La=Qa[Ra];La.materials.length||La.uv_textures.length&&xa.warn('mesh "'+La.name+'" has a UV map but has no exported material.')}a.materials.push(Na.tS());for(var Ma=a.meshes,Ua=ka.Dd("name","DEFAULT",a.materials),Ta=0;Ta<Ma.length;Ta++){var Za=Ma[Ta];0==Za.materials.length&&Za.materials.push(Ua)}for(var bb=
a.actions,cb=b.id,ab=0;ab<bb.length;ab++){var mb=bb[ab];mb.VP=cb;za.dQ(mb)}for(var jb=a.scenes,ib=0;ib<jb.length;ib++){for(var yb=jb[ib],vb=[],ub=[],Mb=jb[ib].objects,qb=0;qb<Mb.length;qb++){var Nb=Mb[qb];aa(Mb,Nb,null,vb,ub);var Wa=Nb.dupli_group;if(Wa)for(var $a=Wa.objects,Ob=0;Ob<$a.length;Ob++)aa($a,$a[Ob],Nb,vb,ub)}for(qb=0;qb<ub.length;qb++)for(var hc=ub[qb],Qb=[yb],Rb=0;Rb<Qb.length;Rb++){for(var kc=Qb[Rb].objects,Qc=0;Qc<kc.length;Qc++){var xc=kc[Qc].dupli_group;if(xc){var Jc=xc.objects,ic=
Jc.indexOf(hc);-1<ic&&Jc.splice(ic,1)}}var ic=kc.indexOf(hc);-1<ic&&kc.splice(ic,1)}for(qb=0;qb<vb.length;qb++)ka.yQ(vb[qb][0],vb[qb][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[T.Au(a.scenes)],xa.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var hd=b.Mb?Fa:T.Au(a.scenes);Sa.YX(Fa.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Fa),1),a.scenes.unshift(Fa));for(var Lc=0;Lc<a.scenes.length;Lc++){var sc=a.scenes[Lc];sc.s={};sc.nF=sc==hd;sc.WP=b.Mb;zb.enabled&&
sc.b4w_enable_physics&&(b.Mb||!va.xw(Fa)&&sc==T.Au(a))&&va.yV(sc)}for(var Bb=0;Bb<a.scenes.length;Bb++){for(var Kc=a.scenes[Bb],kd=w(Kc),sd=0;sd<kd.length;sd++){var jc=kd[sd];ra.CR(jc,Kc,a)&&(jc.rd||(jc.rd=[]),jc.rd.push(b.Mb?Kc:Fa))}for(var nd=kd,td=0;td<nd.length;td++){var cd=nd[td];if(cd.rd&&"WORLD"!=cd.type)for(var ud=cd.particle_systems,od=0;od<ud.length;od++){var tc=ud[od].settings;if("HAIR"==tc.type)if("OBJECT"==tc.render_type){var Mc=tc.dupli_object;Mc.rd||(Mc.rd=cd.rd.slice())}else if("GROUP"==
tc.render_type)for(var vd=tc.dupli_group,Vc=0;Vc<vd.objects.length;Vc++)Mc=vd.objects[Vc],Mc.rd||(Mc.rd=cd.rd.slice())}}}for(var wd=a.scenes,ld=[],Lb=0;Lb<wd.length;Lb++)C(wd[Lb].objects,0,b.Mb,ld);Xa[b.id]=[];for(Lb=0;Lb<ld.length;Lb++)for(var xd=ld[Lb],jd=0;jd<xd.length;jd++)for(var Kd=xd[jd],Ad=0;Ad<Kd.length;Ad++)Xa[b.id].push(Kd[Ad]);for(var Bd=a.particles,Lb=0;Lb<Bd.length;Lb++){var pd=Bd[Lb].dupli_object;pd&&(pd.mF=!0,Xa[b.id].push(pd));var Ld=Bd[Lb].dupli_group;if(Ld)for(var Md=Ld.objects,
jd=0;jd<Md.length;jd++)pd=Md[jd],pd.mF=!0,Xa[b.id].push(pd)}for(var Cd=Xa[b.id],Lb=Cd.length-1;0<=Lb;Lb--)Cd[Lb].rd||Cd.splice(Lb,1);for(var Nd=Xa[b.id],Bb=0;Bb<Nd.length;Bb++)if(jc=Nd[Bb],!b.Mb&&jc.parent&&-1<Cc.indexOf(jc.parent.type)&&(jc.parent=""),"MESH"==jc.type){var Dd=Na.BQ(jc);Dd&&(a.meshes.push(Dd),jc.data=Dd)}for(var Ed=0;Ed<a.scenes.length;Ed++){var Od=a.scenes[Ed],Fd=Od.world;Fd.rd||(Fd.rd=[]);Fd.rd.push(b.Mb?Od:Fa)}for(var Pd=a.node_groups,Qd=a.materials,md=0;md<Pd.length;md++){var qd=
Pd[md].node_tree;if(qd){var yd=[];h(qd,yd,!0);qd.Zy=yd}}for(md=0;md<Qd.length;md++)if(qd=Qd[md].node_tree)yd=[],h(qd,yd,!1),qd.Zy=yd;for(var Gd=0;Gd<a.scenes.length;Gd++){var Hd=a.scenes[Gd];if(Hd.b4w_use_logic_editor){var Rd=w(Hd);Na.IQ(Rd,Hd)}}for(var Id=0;Id<a.scenes.length;Id++){var Sd=a.scenes[Id],Jd=b.Mb?Sd:Fa;Boolean(K(b.id,Jd,"SPEAKER").length)&&!Jd.Nc&&ga.NQ(Jd)}f(b,d)}function l(a,b){for(var c=S(b.Pg),d=[],e=[],f=0;f<a.speakers.length;f++){var k=a.speakers[f],h=k.sound.uuid;if(-1==e.indexOf(h)){e.push(h);
switch(k.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var g=X.Hx;break;case "BACKGROUND_MUSIC":g=X.Ix}k=ka.aj(c+k.sound.filepath);X.Fm(k);ba(d,h,g,k,b.bk)}}d.length&&X.Ud(d,function(){},function(){})}function h(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],f=e.type;if("GROUP"==f&&e.node_group){if(e=e.node_group.node_tree)if(c)h(e,b,!0);else for(e=e.Zy,f=0;f<e.length;f++){var k=e[f];-1==b.indexOf(k)&&b.push(k)}}else-1!=Nb.indexOf(f)&&-1==b.indexOf(f)&&b.push(f)}}function w(a){var b=
[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);f(a.objects,"ALL",b);return b}function f(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||c.push(e);(e=e.dupli_group)&&f(e.objects,b,c)}}function C(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var k=a[f],h=qa(k);e[h]=e[h]||[];(c||-1==Cc.indexOf(k.type))&&-1==e[h].indexOf(k)&&e[h].push(k);(k=k.dupli_group)&&C(k.objects,b+1,c,d)}}function K(a,b,c){var d=[];a=Xa[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==
c||"ALL"==c)for(var k=0;k<f.rd.length;k++)b==f.rd[k]&&d.push(f)}return d}function G(a,b,c,d,e){var f=Xa[b.id],k=a.worlds;d=b.id;for(var h=0;h<f.length;h++){for(var g=f[h],l=wa.sq(g.name,g.type,g.origin_name),m=0;m<g.rd.length;m++)wa.Fp(l,g.rd[m]);g.nb=l;ra.Pk(g,l);l.k.Qe=d;l.nr=g.mF||!1}for(d=0;d<k.length;d++){h=k[d];g="%meta_world%"+h.name;g=wa.sq(g,"WORLD",g);for(l=0;l<h.rd.length;l++)wa.Fp(g,h.rd[l]);h.nb=g;ra.a_(h,g)}d=ra.Tj(b.id);for(h=0;h<f.length;h++)g=f[h],l=g.nb,na.Pk(g,l);for(h=0;h<k.length;h++)g=
k[h],na.Pk(g,g.nb);if(b.Mb)for(k=b.id,h=0;h<a.scenes.length;h++)for(var g=a.scenes[h],l=0,m=ra.jc(g,"LAMP",k),n=0;n<m.length;n++)wa.ja(m[n],g).im=l++;for(h=0;h<f.length;h++)g=f[h],l=g.nb,l.nr||(ra.OZ(g,l),ia.D(l));for(a=0;a<f.length;a++)if(k=f[a],h=k.nb,wa.Rc(h)||wa.$j(h))if(g=k.lod_levels.length)for(l=h,h.k.Pn=!0,m=0;m<g;m++)if(n=k.lod_levels[m].object){n=n.nb;n.k.Pn=!0;n.k.Zg=h.k.Zg;l.k.af=k.lod_levels[m].distance;n.k.Yg=k.lod_levels[m].distance;if(k.lod_levels[m+1])n.k.af=k.lod_levels[m+1].distance;
else{n.k.af=wa.np;break}l=n}else{l.k.af=k.lod_levels[m].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(k=a.Ft)){var k=k.k,h=a.k.zi,g=[],u;for(u in h)l=h[u],g.push(4*l.mA,4*l.Dj);k.Ov.push(g);k.zo.push(a.k)}f=u=-1;a=za.vI();for(k=0;k<d.length;k++)h=d[k],g=h.k,wa.Rc(h)&&g.ck&&(h=g.$g,h>u&&(u=h),a>=h&&h>f&&(f=h));for(k=0;k<d.length;k++)h=d[k],g=h.k,wa.Rc(h)&&g.ck&&(g.Ol=!0,u<a?g.$g=u:g.$g<=a?g.$g=f:(xa.warn('too many bones for "'+h.name+'" / '+g.$g+" bones (max "+a+" with blending, "+
2*a+" without blending). Blending between frames will be disabled."),g.$g=u,g.Ol=!1),g.Ol=g.Ol&&!Ca.NH);for(u=0;u<d.length;u++)if(f=d[u],f.Xe)if(a=f.kf,"CHASSIS"==a.cf){f.v={};f.v.Qq=a.Qq;f.v.Vp=a.Vp;f.v.rD=a.rD;f.v.tD=a.tD;f.v.sD=a.sD;f.v.dE=a.dE;f.v.HC=a.HC;f.v.HB=a.HB;f.v.wn=0;f.v.Up=1;f.v.Ho=0;f.v.speed=0;f.v.wm=[];f.v.Tr=[];f.v.Jo=null;h=(k=wa.Sg(f))?wa.OA(k,d):d;for(k=0;k<h.length;k++)g=h[k],g.Xe&&(l=g.kf,va.CV(g)&&a.name==l.name?(l=va.A_(g.kf.cf),f.v.wm[l]=g,f.v.Tr[l]=new Float32Array(8)):
va.CJ(g)&&a.name==l.name?(f.v.Jo=g,f.v.Io=l.Io,f.v.ts=l.ts,f.v.kr=l.kr,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,g.k.n,l),f.v.oM=g,l=new Float32Array([1,0,0]),Ta.xd(l,g,l),f.v.nM=l):va.BJ(g)&&a.name==l.name?(f.v.kD=g,f.v.ss=l.ss,f.v.Xn=l.Xn,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,g.k.n,l),f.v.jM=g,l=new Float32Array([1,0,0]),Ta.xd(l,g,l),f.v.iM=l):va.DJ(g)&&a.name==l.name&&(f.v.vD=g,f.v.zq=l.zq,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,g.k.n,l),f.v.AM=g,l=new Float32Array([1,0,0]),
Ta.xd(l,g,l),f.v.zM=l));4!=f.v.wm.length&&ka.q("Not enough wheels for chassis "+f.name)}else if("HULL"==a.cf)for(f.v={},f.v.wm=[],f.v.Tr=[],f.v.Qq=a.Qq,f.v.Vp=a.Vp,f.v.Ml=a.Ml,f.v.Qm=a.Qm,f.v.Rm=a.Rm,f.v.wn=0,f.v.Up=1,f.v.Ho=0,f.v.speed=0,f.v.Jo=null,h=(k=wa.Sg(f))?wa.OA(k,d):d,k=0;k<h.length;k++)g=h[k],g.Xe&&(l=g.kf,va.BV(g)&&a.name==l.name?(f.v.wm.push(g),f.v.Tr.push(new Float32Array(8))):va.CJ(g)&&a.name==l.name?(f.v.Jo=g,f.v.Io=l.Io,f.v.ts=l.ts,f.v.kr=l.kr,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,
g.k.n,l),f.v.oM=g,l=new Float32Array([1,0,0]),Ta.xd(l,g,l),f.v.nM=l):va.BJ(g)&&a.name==l.name?(f.v.kD=g,f.v.ss=l.ss,f.v.Xn=l.Xn,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,g.k.n,l),f.v.jM=g,l=new Float32Array([1,0,0]),Ta.xd(l,g,l),f.v.iM=l):va.DJ(g)&&a.name==l.name&&(f.v.vD=g,f.v.zq=l.zq,l=Ta.invert(f.k.n,Ta.create()),g=Ta.multiply(l,g.k.n,l),f.v.AM=g,l=new Float32Array([1,0,0]),Ta.xd(l,g,l),f.v.zM=l));for(u=0;u<d.length;u++)if(f=d[u],f.cm&&(a=f.zn,"MAIN_BODY"==a.cf))for(f.Xf={},f.Xf.Ml=a.Ml,f.Xf.Qm=
a.Qm,f.Xf.Rm=a.Rm,f.Xf.Nt=[],k=(k=wa.Sg(f))?wa.OA(k,d):d,h=0;h<k.length;h++)g=k[h],g.cm&&(l=g.zn,va.FV(g)&&a.name==l.name&&(f.Xf.Nt.push(g),g.cG=g.zn.yM));e(b,c)}function L(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.wj=f.camera.nb}for(d=0;d<a.scenes.length;d++){var f=b.Mb?a.scenes[d]:Fa,k=b.Mb?ra.jc(f,"LAMP",b.id):ra.jc(f,"LAMP",0),h=ra.jc(f,"ALL",b.id),g=K(b.id,f,"MESH"),l=K(b.id,f,"EMPTY");K(b.id,f,"WORLD");b.Mb&&T.kQ(f,h,k,g,l);for(var h=!1,m=0;m<l.length;m++)for(var n=l[m].nb,
u=n.I,y=0;y<u.length;y++){var p=u[y].xb,q=T.YM(p,n);f.name==p.name&&(h=h||q)}b.Mb&&f.s.Jc&&!h&&xa.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');l=[];T.Bw(f);ta.yU(f,g,k,l);m=K(b.id,f,"LINE");ta.xU(f,m);n=T.RA(f);if(b.Mb){h=f.s.Sw;m=f.world;if(h.VK||h.procedural_skydome)u=m.nb,ta.pQ(f,h,u),ta.Xz(u,n,f);T.TH(f,n);(h=f.s.cp)&&h.Ds&&ta.hQ(f,m.nb)}for(m=0;m<g.length;m++)ta.Xz(g[m].nb,n,f);for(m=0;m<l.length;m++)ta.Xz(l[m],n,f),ra.LW(l[m]);h=ra.jc(f,"ALL",b.id);T.JQ(f,h,
k);for(m=0;m<h.length;m++)n=h[m],n.k.Ge&&ra.OD(n),wa.JR(n)&&(n.fK=!0)}T.lQ(Fa,a.textures,b.id);b.Mb&&Fa.s.$o.length&&(b.dB=!0);e(b,c)}function D(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c],e=Boolean("FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==Ba.nq);d.zh=e;d.zp=e?"dds":""}if((Oa.lA||Oa.qw)&&Ba.gN)for(a=0;a<b.length;a++){for(var d=b[a],f=d.texture_slots,c=0;c<f.length;c++){var e=f[c],k=e.texture;if("IMAGE"==k.type||"ENVIRONMENT_MAP"==k.type){var h=k.image;h&&
!h.zh&&(e=!k.b4w_disable_compression&&!e.use_map_normal&&"ENVIRONMENT_MAP"!=k.type&&!k.b4w_shore_dist_map&&"MOVIE"!=h.source,N(h,e))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){f=d[c];e=!1;if("TEXTURE"==f.type){if((k=f.texture)&&(h=k.image)&&!h.zh&&(e=!k.b4w_disable_compression&&"MOVIE"!=k.image.source&&"ENVIRONMENT_MAP"!=k.type)){a:{e=f.outputs;for(f=0;f<e.length;f++)if(k=e[f],k.is_linked&&"Normal"==k.identifier){e=!0;break a}e=!1}e=!e}}else"TEX_IMAGE"==f.type?(h=f.image)&&!h.zh&&(e="MOVIE"!=
h.source):"TEX_ENVIRONMENT"==f.type&&(e=!1);h&&!h.zh&&N(h,e)}}}function N(a,b){-1<a.filepath.indexOf(".dds")?(a.zh=!0,a.zp="dds"):(a.zh=b)?(a.zp=Ba.nq,a.filepath="dds"==Ba.nq?a.filepath+".dds":X.Fm(a.filepath)[0]+".pvr"):a.zp=""}function I(a,b,c,d,e){d=a.groups;for(var f=a.objects,k={},h={},g={},l={},m=0;m<d.length;m++){var n=d[m];k[n.uuid]=n;g[n.uuid]=n}for(m=0;m<f.length;m++)n=f[m],h[n.uuid]=n,l[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)O(a[m].objects,null,l,g,null);for(var u in g)u in k||d.push(g[u]);
for(u in l)u in h||f.push(l[u]);e(b,c)}function O(a,b,c,d,e){for(var f=[],k=0;k<a.length;k++){var h=a[k],g=c[h.uuid];if(h=g.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var l=c[h.uuid],m=l.constraints,h=0;h<m.length;h++){var n=ka.Eh(m[h]);n.name+="_CLONE";g.constraints.push(n)}"b4w_proxy_inherit_anim"in g&&!g.b4w_proxy_inherit_anim||(g.animation_data&&(l.animation_data=ka.Eh(g.animation_data)),l.b4w_use_default_animation=g.b4w_use_default_animation,l.b4w_auto_skel_anim=g.b4w_auto_skel_anim,
l.b4w_anim_behavior=g.b4w_anim_behavior,l.b4w_cyclic_animation=g.b4w_cyclic_animation)}}for(k=0;k<f.length;k++)g=ka.WU(a,f[k]),-1<g&&a.splice(g,1);f={};if(b)for(k=0;k<a.length;k++)h=a[k],g=c[h.uuid],m=ka.Eh(g),l="origin_name"in g?g.origin_name:g.name,m.name=wa.SH(b.name,l),m.origin_name=l,m.dg_parent={uuid:b.uuid},E(m),c[m.uuid]=m,f[h.uuid]=m.uuid,h.uuid=m.uuid,e&&e[g.uuid]&&(m.b4w_cluster_data=e[g.uuid]);for(k=0;k<a.length;k++)h=a[k],g=c[h.uuid],g.dupli_group&&(h=g.dupli_group,e=d[h.uuid],m=ka.Eh(e),
m.name=ka.ws(e.name+"_CLONE"),m.uuid=ya.iJ("Group"+m.name),d[m.uuid]=m,h.uuid=m.uuid,O(m.objects,g,c,d,g.b4w_cluster_data));if(b)for(k=0;k<a.length;k++){h=a[k];g=c[h.uuid];g.parent&&g.parent.uuid in f?g.parent.uuid=f[g.parent.uuid]:g.parent&&(xa.warn("Object's \""+g.name+'" parent is not in dupli group. Disabling parenting.'),g.parent=null);m=g.constraints;for(h=0;h<m.length;h++)b=m[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=g.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=
d[h].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=g.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((g=g.lod_levels)&&g.length)for(h=0;h<g.length;h++)b=g[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var u in f)Za[u]=f[u]}function E(a){a.uuid=ya.iJ("Object"+a.name)}function c(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&
k(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in Za&&(e.lamp.uuid=Za[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&k(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||k(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];y(f,"from_node",c);y(f,"to_node",c);A(f,"from_socket",f.from_node.outputs);A(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&k(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=
c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&k(e.strips[f],"action",b)}function k(a,b,c){(c=c[a[b].uuid])||xa.error("Dangling link found:",b,a);a[b]=c}function y(a,b,c){c=ka.Dd("name",a[b].name,c);a[b]=c}function A(a,b,c){c=ka.Dd("identifier",a[b].identifier,c);a[b]=c}function e(a,b,c,e,f,k){var h=[],g={};e=a.images;for(var l=eb.uI(),m=S(b.Pg),n=0;n<e.length;n++){var u=e[n],y=u.uuid;if(y){var p=ka.aj(m+u.filepath),q=u.source;if("FILE"===q){var q=u.zh?X.Os:X.Ps,v=X.Fm(p),t=v[1].toLowerCase();
if(!X.IR(t)){xa.error("image ",u," has unsupported format.");continue}Oa.LB&&Ba.use_min50&&("dds"==v[1]?(p=X.Fm(v[0]),p=p[0]+".min50."+p[1]+".dds"):p=v[0]+".min50."+v[1])}else if("MOVIE"===q)if(Ba.gs)v=X.Fm(p),p=v[0]+".altconv.seq",q=X.Qs;else{v=X.Fm(p);t=v[1].toLowerCase();q=ga.uT(t);if(""==q){xa.error("failed to load video file (unsupported format)",p);continue}p=q!=t?v[0]+".altconv."+q:v[0]+"."+v[1];q=X.Rs}else{xa.error('Image "'+u.name+'" has unsupported format "'+q+'".');continue}if(!b.bk)for((y in
g)||(g[y]=[]),v=0;v<l.length;v++)t=l[v],t.Ln==y&&t.Yl==u.zp&&g[y].push(t);g[y].length&&h.push({id:y,type:q,url:p,Vg:b.bk})}}if(h.length){var w=0;X.Ud(h,function(e,f,l,m){if(e){var n=l;if(!b.bk){f=g[f];for(n=0;n<f.length;n++){var u=f[n];if(l==X.Qs)u.es=e.Rg,eb.ys(u,e.images,b.id);else if(eb.ys(u,e,b.id),"ENVIRONMENT_MAP"==u.source)for(u=0;u<a.scenes.length;u++)T.RD(a.scenes[u])}n=f[0].Yl}l==X.Rs||l==X.Qs?(l==X.Rs?(l=e.videoWidth,e=e.videoHeight):(l=e.images[0].width,e=e.images[0].height),xa.log("%cLOAD VIDEO "+
l+"x"+e,"color: #"+(2048<l||2048<e?"a00":1024<l||1024<e?"aa0":"0a0"),m),-1==m.indexOf(vb)&&xa.warn("video",m,"is not from app root.")):d(e,m,!0,n)}m=++w/h.length;k(b,c,m)},function(){xa.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function R(a,b,c,d,e){a=T.UA();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(h=!1);na.UZ(f,h,b.id)}}e(b,c)}function q(a,b,c,d,e,f){a=S(b.Pg);var h=[],k={};d=ra.Tj(b.id);for(var g=0;g<d.length;g++){var l=
d[g];if(J(l)){var m=l.W.qj;"BACKGROUND_MUSIC"==ga.WA(l)?(m=ka.GA(),b.bB=!0):"NONE"!=ga.WA(l)&&Ba.hB&&(b.gB=!0);if(!(m in k)){k[m]=[];var n=ka.aj(a+l.W.Pg);switch(ga.hM(l)){case ga.Gx:var u=X.Hx;break;case ga.jE:u=X.Ix}ba(h,m,u,n,b.bk)}k[m].push(l)}}if(h.length){var y=0;X.Ud(h,function(a,d,e,g){if(a)for(xa.log("%cLOAD SOUND","color: #0aa",g),-1==g.indexOf(vb)&&xa.warn("sound",g,"is not from app root."),d=k[d],e=0;e<d.length;e++)ga.ZZ(d[e],a);a=++y/h.length;f(b,c,a)},function(){xa.log("%cLOADED ALL SOUNDS",
"color: #0aa");e(b,c)})}else e(b,c)}function ba(a,b,c,d,e){var f=X.Fm(d),h=f[1].toLowerCase(),k=ga.sT(h);""!=k?(d=k!=h?f[0]+".altconv."+k:f[0]+"."+f[1],a.push({id:b,type:c,url:d,Vg:e})):xa.error("failed to load audio file (unsupported format)",d)}function J(a){return wa.fm(a)&&ga.hM(a)!=ga.kE}function F(a,b,c){a=ra.jc(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];wa.fm(d)&&(ga.AV(d)||c)&&ga.zK(d)}}function V(a,b){for(var c=a.s.$o,d=0;d<c.length;d++){var e=c[d].s;a.b4w_use_nla&&c[d].b4w_nla_video||
!c[d].use_auto_refresh||b!=e.Ls||(eb.ZK(e),eb.BK(e))}}function U(a,b,c,d,e){na.start();xa.log("%cSTART NLA","color: #0a0");e(b,c)}function aa(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,h=0;h<f;h++){var k=b.lod_levels[h],g=k.object;if(g){var l=ka.fq(g);l.name=b.name+"_LOD_"+String(h+1);l.b4w_cluster_data=b.b4w_cluster_data;E(l);l.lod_levels=[];c&&(l.dg_parent=c);d.push([a,l]);e.push(g);k.object=l}}}function v(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!va.MR(a.scenes[f])){d=
!1;break}d&&(e(b,c),xa.log("%cPHYSICS READY","color: #0a0"))}function fa(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Mb)var h=va.xw(f);else h=va.xw(Fa)||va.xw(f),f=Fa;if(zb.enabled&&h)for(h=0;h<Rb.length;h++)for(var k=ra.jc(f,Rb[h],b.id),g=0;g<k.length;g++){var l=k[g];l.k.Qe==b.id&&(va.fn(l,f),b.QJ&&va.na(l)&&va.rA(l))}}e(b,c)}function M(a,b,c,e,f){var h={};e=[];for(var k=a.scenes,g=0;g<a.scenes.length;g++){var l=k[g];if(l.s.Jc){var m=l.s.Jc.Ek;if(m&&"FILE"===m.source){var l=
m.uuid,n=ka.aj(S(b.Pg)+m.filepath);e.push({id:l,type:m.zh?X.Os:X.Ps,url:n});h[l]=m}}}e.length?X.Ud(e,function(a,c,e,f){if(a){d(a,f,!0);e=[];f=eb.uI();for(var g=0;g<f.length;g++){var l=f[g];l.uri===c&&e.push(l)}for(c=0;c<e.length;c++)eb.ys(e[c],a,b.id);for(c=0;c<k.length;c++)if(e=k[c],e.s.Jc&&(f=e.s.Jc.Ek,f===m)){var l=a,n=document.createElement("canvas");f=m.size[0];g=m.size[1];n.width=f;n.height=g;n=n.getContext("2d");n.drawImage(l,0,0);l=n.getImageData(0,0,f,g).data;n=new Float32Array(4);n[0]=1/
16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=g;for(var g=new Float32Array(f),u=0;u<f;u++)g[u]=n[1]*l[4*u+2]+n[2]*l[4*u+3];e.s.fD=g}}else for(a=h[c],c=0;c<k.length;c++)e=k[c],f=e.s.Jc.Ek,f===a&&(e.s.Jc.Ek=null,xa.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function H(a,b,c,e,f){e=a.scenes[0];a=[];for(var h=[Pa.pt,Pa.vp,Pa.qt,Pa.Ty],k=0;k<h.length;k++){var g=T.Ma(e,h[k]);g&&a.push(g)}if(a.length){e=[];k=X.Ps;e.push({id:"SEARCH_TEXTURE",type:k,
Pg:oa.Ae.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:k,url:oa.Ae.smaa_area_texture_path});for(k=0;k<a.length;k++)if(h=a[k],h.type==Pa.vp){a=h.Ya;for(k=0;k<a.length;k++)if(h=a[k],"u_search_tex"==h.to)var l=h.jb;else if("u_area_tex"==h.to)var m=h.jb;break}e.length?X.Ud(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?l:m,c.source="IMAGE",eb.ys(c,a,b.id),eb.QC(c,eb.K,eb.K))},function(){f(b,c)}):f(b,c)}else f(b,c)}function Z(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];
b.Mb||(e=Fa);for(var f=ra.jc(e,"LAMP",b.id),h=0;h<f.length;h++){var k=f[h];k.k.Qe==b.id&&d.bz.push({xb:e,da:k})}f=ra.jc(e,"ALL",b.id);for(h=0;h<f.length;h++)k=f[h],"LAMP"!=k.type&&k.k.Qe==b.id&&(b.QJ&&wa.Rc(k)&&T.$p(k,!0),d.bz.push({xb:e,da:k}))}}function ha(a,b,c,d,e,f){var h=d.bz;e=d.lK;if(h.length){a=h[e].da;var k=h[e].xb;e=wa.ja(a,k);T.fn(k,a,!1);!a.anchor||k.s.kv||k.s.anaglyph_use||sa.append(a);d=++d.lK/h.length;h=e.Ei;if(-1!=a.k.Rd&&h){var g=W.copy(a.k.kb.G,mb);T.XM(h,g)}h=a.Zr;if(h.length&&
k.s.$h)for(k=Ta.F(a.k.n),a=Ta.R(a.k.n),e=e.Xh,g=0;g<e.length;g++)T.aN(e[g],k,a),wa.bN(h,e[g].p.mc)}else d=1;f(b,c,d)}function u(a,b,c,d,e){if(b.Mb){d=T.Mh();T.RD(d);var f=T.UA();for(a=0;a<f.length;a++){var h=f[a];T.RD(h);T.hX(h,d)}T.Bw(d)}else T.cN(Fa);d=ra.Tj(b.id);ra.PZ(d);for(f=0;f<d.length;f++)for(h=d[f],a=0;a<h.I.length;a++)for(var k=h.I[a].U,g=0;g<k.length;g++)null==k[g].yb&&k.splice(g--,1);e(b,c)}function Q(a,b,c,d,e){if(b.Mb)for(a=T.UA(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&
Ha.wV(f,b.id)}e(b,c)}function ca(a,b,c,d,e){if(b.Mb)for(d=0;d<a.scenes.length;d++)V(a.scenes[d],b.id),F(a.scenes[d],b.id,!1);else V(Fa,b.id),F(Fa,b.id,!1);e(b,c)}function ja(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;Ba.media_auto_activation&&(b.dB||b.bB||b.gB)?ab||ua(a,e,b,c):e(b,c)}function ua(a,b,c,d){var e=Ob.parentElement;Ua=e.style.zIndex;e.style.zIndex="999";ab=document.createElement("div");ab.style.position="relative";ab.style.height="88px";ab.style.width="88px";var f=
Math.round(Ob.offsetWidth/2-44);ab.style.top=Math.round(Ob.offsetHeight/2-44).toString()+"px";ab.style.left=f.toString()+"px";ab.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
ab.style.backgroundSize="88px";bb=document.createElement("div");bb.style.position="relative";bb.style.height=Ob.offsetHeight.toString()+"px";bb.style.width=Ob.offsetWidth.toString()+"px";bb.style.background="rgba(0, 0, 0, 0.5)";bb.style.zIndex="999";e.appendChild(bb);bb.appendChild(ab);ab.addEventListener("click",function(){c.dB&&(eb.play(),eb.pause(),eb.reset());if(c.bB){if(c.Mb)for(var e=0;e<a.scenes.length;e++)F(a.scenes[e],c.id,!0);else F(Fa,c.id,!0);ga.pause()}c.gB&&ga.AK();pa();b(c,d)},!1)}
function pa(){if(ab){var a=Ob.parentElement;a.style.zIndex=Ua;bb.removeChild(ab);a.removeChild(bb);ab=bb=null;Ua=0}}function S(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function Y(a){za.Ac(a)&&za.remove(a);Da.qX(a);ra.Tt(a);P.bq(a)&&P.as(a);va.na(a)&&va.$r(a);T.rX(a);wa.fm(a)&&ga.KY(a);sa.uv(a)&&sa.remove(a)}function qa(a){var b=za.fI(a);return(a=b&&b.parent==a?null:a.parent||b)?1+qa(a):0}var sa=r("__anchors"),za=r("__animation"),X=r("__assets"),ta=r("__batch"),oa=r("__config"),
P=r("__controls"),la=r("__texcomp"),z=r("__debug"),ma=r("__extensions"),Ea=r("__input"),ea=r("__loader"),ya=r("__md5"),na=r("__nla"),Ha=r("__logic_nodes"),Da=r("__particles"),Ra=r("__nodemat"),ra=r("__objects"),wa=r("__obj_util"),va=r("__physics"),xa=r("__print"),Ka=r("__quat"),Na=r("__reformer"),da=r("__renderer"),T=r("__scenes"),ga=r("__sfx"),Mb=r("__shaders"),Pa=r("__subscene"),eb=r("__textures"),Sa=r("__time"),ia=r("__transform"),Ta=r("__tsr"),ka=r("__util"),W=r("__vec3"),Qa=r("__vec4"),Ca=oa.ll,
Ba=oa.A,Oa=oa.Pd,zb=oa.C,cb=oa.W,Aa=null,Xa=null,vb="",Fa=null,Za={},mb=new Float32Array(3),jb=new Float32Array(4),ib=new Float32Array(4),kc=new Float32Array(4),ab=null,bb=null,Ua=0,yb=!1,Cc=["LAMP","CAMERA"],Rb=["MESH","CAMERA","EMPTY"],Nb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],Ob=null;a.Wg=function(a){return ea.Wg(a)};a.update=function(){ea.VZ(Aa)};a.uY=function(a){Ob=a};a.MZ=function(a,b){if(ab){bb.style.height=b.toString()+"px";bb.style.width=a.toString()+"px";var c=Math.round(a/2-44);ab.style.top=
Math.round(b/2-44).toString()+"px";ab.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,h){var k={load_main:{Nb:ea.ug,Qb:!1,L:[],Ub:!1,Wb:500,hc:!1,Zb:b},duplicate_objects:{Nb:ea.qe,Qb:!1,L:["load_main"],Ub:!1,Wb:50,hc:!1,Zb:I},load_binaries:{Nb:ea.ug,Qb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:t},wait_for_shaders:{Nb:ea.qe,Qb:!1,L:[],Ub:!1,Wb:50,hc:!0,Fj:p},prepare_bindata:{Nb:ea.qe,Qb:!1,L:["duplicate_objects","load_binaries"],Ub:!1,Wb:100,hc:!1,Zb:B},prepare_bpy_data:{Nb:ea.qe,Qb:!1,L:["duplicate_objects",
"prepare_bindata"],Ub:!1,Wb:100,hc:!1,Zb:g},process_objects:{Nb:ea.qe,Qb:!1,L:["prepare_bpy_data"],Ub:!1,Wb:150,hc:!1,Zb:G},process_scenes:{Nb:ea.qe,Qb:!1,L:["process_objects","wait_for_shaders"],Ub:!1,Wb:300,hc:!1,Zb:L},load_smaa_textures:{Nb:ea.ug,Qb:!1,L:["process_scenes"],Ub:!1,Wb:30,hc:!0,Zb:H},load_shoremap:{Nb:ea.ug,Qb:!1,L:["process_scenes"],Ub:!1,Wb:30,hc:!0,Zb:M},load_images:{Nb:ea.ug,Qb:!0,L:["process_scenes"],Ub:!0,Wb:500,hc:!1,Zb:e},update_scenes_nla:{Nb:ea.qe,Qb:!1,L:["process_scenes",
"load_images"],Ub:!1,Wb:50,hc:!1,Zb:R},wait_physics_workers:{Nb:ea.qe,Qb:!1,L:["load_shoremap"],Ub:!1,Wb:20,hc:!1,Fj:v},add_physics_objects:{Nb:ea.qe,Qb:!1,L:["wait_physics_workers"],Ub:!1,Wb:50,hc:!1,Zb:fa},add_objects:{Nb:ea.qe,Qb:!1,L:["add_physics_objects"],Ub:!1,Wb:600,hc:!1,Zb:Z,Fj:ha,Xp:u,Yp:{bz:[],lK:0}},init_logic_nodes:{Nb:ea.qe,Qb:!1,L:["update_scenes_nla","add_objects"],Ub:!1,Wb:50,hc:!1,Zb:Q},load_speakers:{Nb:ea.ug,Qb:!0,L:["add_objects"],Ub:!0,Wb:100,hc:!1,Zb:q},mobile_media_start:{Nb:ea.qe,
Qb:!1,L:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Ub:!0,Wb:5,hc:!1,Zb:ja,Fj:ja},synchronize_media:{Nb:ea.qe,Qb:!0,L:["mobile_media_start"],Ub:!0,Wb:50,hc:!1,Zb:ca},start_nla:{Nb:ea.qe,Qb:!0,L:["mobile_media_start"],Ub:!1,Wb:5,hc:!0,Zb:U}},l=ea.VA();l||(l=ea.ZG(),Aa={},Xa={},Za={});Aa[l.oh.length]={};return ea.dH(k,a,c,d,n,f||cb.LF,Ba.do_not_load_resources,h,!1)};a.mx=function(a){var b=ea.VA();if(!b||!b.oh.length||a&&!ea.hZ(b.oh[a]))xa.error("Unable to unload data!");else{if(0==
a)xa.log("%cUNLOAD ALL","color: #00a"),sa.sa(),za.sa(),ga.sa(),ta.sa(),T.sa(),ea.sa(),P.sa(),va.sa(),ra.sa(),ka.sa(),da.sa(),Ra.sa(),Mb.sa(),ma.sa(),X.sa(),eb.sa(),Ha.sa(),Da.sa(),Ea.sa(),z.sa(),Xa=null,Za={},Aa=Fa=null,yb=!1;else{xa.log("%cUNLOAD DATA "+a,"color: #00a");za.oX(a);for(var b=ra.Tj(ra.Dc),c=0;c<b.length;c++){var d=b[c];wa.TA(d)!=a&&ra.aw(d,!1,!1,!1)}b=ra.Tj(a);for(c=b.length-1;0<=c;c--)d=b[c],Y(d),ra.$r(d);b=ra.Tj(ra.Dc);for(c=0;c<b.length;c++)ra.aw(b[c],!0,!0,!0)}na.sa(a);pa()}};a.gX=
Y;a.pL=function(a){vb=a};a.tF=function(){yb||Ba.media_auto_activation||(eb.play(),eb.pause(),eb.reset(),F(Fa,ra.Dc,!0),ga.pause(),Ba.hB&&ga.AK(),yb=!0)};a.reset=function(){Ob=null};a.CK=function(a,c,d){var f={load_main:{Nb:ea.ug,Qb:!1,L:[],Ub:!1,Wb:500,hc:!1,Zb:b},load_binaries:{Nb:ea.ug,Qb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:t},load_images:{Nb:ea.ug,Qb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:e},preload_sounds:{Nb:ea.ug,Qb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:l}},h=ea.VA();h||(h=ea.ZG(),
Aa={},Xa={},Za={});Aa[h.oh.length]={};return ea.dH(f,a,c,d,n,!1,Ba.do_not_load_resources,!1,!0)};a.VM=function(){X.VR()}};b4w.module.__controls=function(a,r){function n(a,b){b||(b=w.We());return{type:a,value:0,Y:null,element:b,La:!1,key:0,$b:"",Dh:!1,Mz:null,Lz:function(){},Kz:null,FG:function(){},ei:null,from:new Float32Array(3),to:new Float32Array(3),sJ:!1,nv:!1,Wr:0,RK:function(){},axis:"",Mf:0,Qo:new Float32Array(3),rw:new Float32Array(4),threshold:0,LK:new Float32Array(4),Ht:0,Gt:0,bL:0,It:0,Gf:0,repeat:!1,BH:!1,Rl:0,callback:function(){}}}function d(a){function b(){return{Jj:new Float32Array(2),gm:!0,da:null,identifier:-1,
Av:!0}}a||(a=w.We());for(var d=0;d<R.length;d++){var e=R[d];if(a==e.element)return e}e={element:a,qr:!0,ye:0,Bv:!0,Sv:0,Tv:0,lm:0,mm:0,Qr:0,Rr:0,ph:new Float32Array(2),ne:new Float32Array(2),qh:new Float32Array(2),De:new Float32Array(2),gx:0,KD:0,OM:0,Se:new Uint8Array(256),Dx:0,ZA:null,Vh:b(),Hm:Array(10),qB:!1,cJ:L.create(),cv:0,bv:0,av:0,aB:0,$A:0,$u:Infinity,bC:null,aC:null,RB:null,NB:null,PB:null,ID:null,HD:null,QB:null,OB:null,lC:null,Q5:null,JD:null,GD:null,FD:null,cj:{}};for(d=0;10>d;++d)e.Hm[d]=
b();e.bC=function(a){e.qB||(f.jV(a,e.cJ),e.qB=!0)};e.aC=function(a){a=O.copy(a,J);e.av=a[0];e.bv=a[1];e.cv=a[2];Infinity==e.$u&&(e.$u=a[0],e.$A=a[1],e.aB=a[2])};e.RB=function(a){e.Dx+=a*E.EW};e.NB=function(a){var b=f.ia(f.bd,e.element),b=f.Oi(b,f.si,q);e.Sv=b[0];e.Tv=b[1];e.lm=b[0];e.mm=b[1];if(3==e.ye||0==e.ye)e.ye=1;e.which=a};e.PB=function(){var a=f.ia(f.bd,e.element),a=f.Oi(a,f.si,q),a=w.Vt(a[0],a[1],q);e.Vh.gm=!1;e.Vh.Jj[0]=a[0];e.Vh.Jj[1]=a[1]};e.ID=function(a){for(var b=0;b<a.length;++b){for(var c=
a[b],d=null,f=null,h=0;h<e.Hm.length;h++){var k=e.Hm[h];if(k.identifier==c.identifier){k.Av&&(f=k);break}else!d&&k.Av&&(d=k,d.identifier=c.identifier)}if(c=f||d)d=w.Vt(a[b].clientX,a[b].clientY,q),c.gm=!1,c.Av=!1,c.Jj[0]=d[0],c.Jj[1]=d[1]}};e.HD=function(a){for(var b=0;b<e.Hm.length;++b){for(var c=e.Hm[b],d=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){d=!0;break}d||(c.gm=!0,c.Av=!0,c.da=null)}};e.QB=function(a){var b=f.ia(f.bd,e.element),b=f.Oi(b,f.si,q);e.Sv=b[0];e.Tv=b[1];e.lm=b[0];e.mm=
b[1];0<e.ye&&(e.ye=3);e.which=a};e.OB=function(a){if(!c.Jn||e.ye)e.lm=a[0],e.mm=a[1]};e.lC=function(a){if(!c.Jn||e.ye)e.Qr+=a[0],e.Rr+=a[1]};e.FJ=function(a){2!=e.Se[a]&&(e.Se[a]=1,e.qr=!1)};e.HJ=function(){for(var a=0;a<e.Se.length;a++)0!=e.Se[a]&&(e.Se[a]=3,e.qr=!1)};e.IJ=function(a){e.qr=!1;e.Se[a]=3};e.JD=function(a){e.Bv=!1;if(1==a.length)e.ph[0]=a[0].clientX,e.ph[1]=-1,e.qh[0]=a[0].clientY,e.qh[1]=-1;else if(1<a.length){e.gx=e.KD=g(a);e.ph[0]=a[0].clientX;e.ph[1]=a[1].clientX;e.qh[0]=a[0].clientY;
e.qh[1]=a[1].clientY;var b=a[0];a=a[1];e.OM=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}e.ne.set(e.ph);e.De.set(e.qh)};e.GD=function(a){1===a.length?(e.ne[0]=a[0].clientX,e.ne[1]=-1,e.De[0]=a[0].clientY,e.De[1]=-1):1<a.length&&(e.ne[0]=a[0].clientX,e.ne[1]=a[1].clientX,e.De[0]=a[0].clientY,e.De[1]=a[1].clientY,e.gx=g(a))};e.FD=function(a){0==a.length&&(e.Bv=!0)};R.push(e);return e}function b(a,b){if(b in a.cj&&0<a.cj[b])a.cj[b]+=1;else switch(a.cj[b]=1,b){case "orientation_quat":var c=f.ia(f.uh);
c&&f.yd(c,f.Xm,a.bC);break;case "orientation_angles":(c=f.ia(f.uh))&&f.yd(c,f.Xm,a.aC);break;case "mouse_wheel":(c=f.ia(f.bd,a.element))&&f.yd(c,f.pp,a.RB);break;case "mouse_down_which":(c=f.ia(f.bd,a.element))&&f.yd(c,f.$k,a.NB);break;case "mouse_select":(c=f.ia(f.bd,a.element))&&f.yd(c,f.$k,a.PB);break;case "touch_select":if(c=f.ia(f.wg,a.element))f.yd(c,f.el,a.ID),f.yd(c,f.cl,a.HD);break;case "mouse_up_which":(c=f.ia(f.bd,a.element))&&f.yd(c,f.op,a.QB);break;case "mouse_location":(c=f.ia(f.bd,
a.element))&&f.yd(c,f.si,a.OB);break;case "mouse_pointerlock":(c=f.ia(f.bd,a.element))&&f.yd(c,f.CE,a.lC);break;case "keyboard_downed_keys":if(c=f.ia(f.gp,a.element))f.yd(c,f.lp,a.FJ),f.yd(c,f.tE,a.HJ),f.yd(c,f.mp,a.IJ);break;case "touch_start":(c=f.ia(f.wg,a.element))&&f.yd(c,f.el,a.JD);break;case "touch_move":(c=f.ia(f.wg,a.element))&&f.yd(c,f.wp,a.GD);break;case "touch_end":(c=f.ia(f.wg,a.element))&&f.yd(c,f.cl,a.FD)}}function t(a,b){if(!(!b in a.cj)&&0<a.cj[b]&&(--a.cj[b],!a.cj[b]))switch(b){case "orientation_quat":var c=
f.ia(f.uh);c&&f.Bd(c,f.ft,a.bC);break;case "orientation_angles":(c=f.ia(f.uh))&&f.Bd(c,f.Xm,a.aC);break;case "mouse_wheel":(c=f.ia(f.bd,a.element))&&f.Bd(c,f.pp,a.RB);break;case "mouse_down_which":(c=f.ia(f.bd,a.element))&&f.Bd(c,f.$k,a.NB);break;case "mouse_select":(c=f.ia(f.bd,a.element))&&f.Bd(c,f.$k,a.PB);break;case "touch_select":if(c=f.ia(f.wg,a.element))f.Bd(c,f.el,a.ID),f.Bd(c,f.cl,a.HD);break;case "mouse_up_which":(c=f.ia(f.bd,a.element))&&f.Bd(c,f.op,a.QB);break;case "mouse_location":(c=
f.ia(f.bd,a.element))&&f.Bd(c,f.si,a.OB);break;case "mouse_pointerlock":(c=f.ia(f.bd,a.element))&&f.Bd(c,f.CE,a.lC);break;case "keyboard_downed_keys":if(c=f.ia(f.gp,a.element))f.Bd(c,f.lp,a.FJ),f.Bd(c,f.tE,a.HJ),f.Bd(c,f.mp,a.IJ);break;case "touch_start":(c=f.ia(f.wg,a.element))&&f.Bd(c,f.el,a.JD);break;case "touch_move":(c=f.ia(f.wg,a.element))&&f.Bd(c,f.wp,a.GD);break;case "touch_end":(c=f.ia(f.wg,a.element))&&f.Bd(c,f.cl,a.FD)}}function p(a,b){a.value=Number(b)}function B(a){for(var b=a.zk,c=a.MX,
d=0;d<b.length;d++)c[d]=b[d].value;return a.nW(c)}function m(a,b){a=a||y;var c=a.mh;if(c){var d=a.Am;if(b){var f=c[b];if(f){for(var h=f.zk,g=0;g<h.length;g++){var l=h[g],n;n=A.indexOf(l);n=-1<n?e[n]:[];1==n.length?(x(l),l=A.indexOf(l),-1<l?(A.splice(l,1),e.splice(l,1)):I.q("Sensors cache is corrupted")):1<n.length&&n.splice(n.indexOf(f),1)}delete c[b];g=d.indexOf(f);-1<g?d.splice(g,1):I.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=k.indexOf(a),-1<c?k.splice(c,1):K.error("Wrong object"))}}else{d=
[];for(b in c)d.push(b);for(g=0;g<d.length;g++)m(a,d[g])}V=!0}}function x(a){switch(a.type){case 90:G.yC(a.Mz,a.$b,a.Lz);a.La=!0;break;case 100:G.Hz(a.Kz);a.La=!0;break;case 110:G.zC(a.Wr);a.La=!0;break;case 140:a.La=!0;break;case 20:var b=d(a.element);t(b,"keyboard_downed_keys");a.La=!0;break;case 30:b=d(a.element);t(b,"mouse_wheel");a.La=!0;break;case 40:b=d(a.element);t(b,"mouse_down_which");t(b,"mouse_up_which");t(b,"mouse_location");a.La=!0;break;case 260:b=d(a.element);t(b,"mouse_pointerlock");
a.La=!0;break;case 50:b=d(a.element);t(b,"mouse_down_which");t(b,"mouse_up_which");a.La=!0;break;case 60:b=d(a.element);t(b,"touch_start");t(b,"touch_move");t(b,"touch_end");a.La=!0;break;case 70:b=d(a.element);t(b,"touch_start");t(b,"touch_move");a.La=!0;break;case 75:b=d(a.element);t(b,"touch_start");t(b,"touch_move");a.La=!0;break;case 80:b=d(a.element);t(b,"touch_start");t(b,"touch_end");a.La=!0;break;case 170:b=d(a.element);t(b,"mouse_select");t(b,"touch_select");t(b,"touch_start");t(b,"touch_end");
t(b,"mouse_down_which");t(b,"mouse_up_which");a.La=!0;break;case 180:case 190:b=d(a.element);t(b,"orientation_angles");a.La=!0;break;case 200:b=d(a.element);t(b,"orientation_quat");a.La=!0;break;case 210:case 220:a.La=!0}}function g(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function l(a){return 0==a?f.ia(f.Ts):1==a?f.ia(f.Tx):2==a?f.ia(f.Ux):f.ia(f.Vx)}var h=r("__config"),w=r("__container"),f=r("__input"),C=r("__objects"),K=r("__print"),G=r("__physics"),
L=r("__quat"),D=r("__time"),N=r("__tsr"),I=r("__util"),O=r("__vec3"),E=h.controls,c=h.A,k=[],y={},A=[],e=[],R=[],q=new Float32Array(2),ba=new Float32Array(2),J=O.create(),F=L.create(),V=!1,U=0;a.qf=10;a.ub=20;a.Qx=30;a.vg=40;a.fp=50;a.Px=60;a.nt=0;a.mt=1;a.lt=2;a.Sy=3;var aa=1;a.update=function(b,e){for(var h=0;h<R.length;h++){var g=R[h];g.Vh.gm||(g.Vh.da=C.Or(g.Vh.Jj[0],g.Vh.Jj[1]),g.Vh.gm=!0,g.ZA=g.Vh.da);for(var m=0;10>m;++m){var n=g.Hm[m];n.gm||(n.da=C.Or(n.Jj[0],n.Jj[1]),n.gm=!0,g.ZA=n.da)}}for(h=
0;h<A.length;h++)if(g=A[h],n=b,m=e)switch(g.type){case 120:var u=g.ei,t=N.fc(u.k.n,J),u=N.Xd(u.k.n,F),w=O.dist(g.Qo,t),x=g.LK;L.invert(g.rw,x);L.multiply(u,x,x);L.normalize(x,x);x=Math.abs(2*Math.acos(x[3]));w/=m;g.Ht=I.vc(w,g.Ht,m,.3);g.Y[0]=w;w=x/m;g.Gt=I.vc(w,g.Gt,m,.3);g.Y[1]=w;g.Ht>=g.threshold||g.Gt>=g.bL?p(g,1):p(g,0);O.copy(t,g.Qo);L.copy(u,g.rw);g.Mf=n;break;case 130:u=g.ei;t=N.fc(u.k.n,J);u=Math.abs(t[1]-g.Qo[1])/m;g.It=I.vc(u,g.It,m,.3);g.Y=u;g.It>=g.threshold?p(g,1):p(g,0);O.copy(t,g.Qo);
g.Mf=n;break;case 140:!g.La&&0<=g.Gf&&n-g.Mf>=g.Gf&&(p(g,1),g.repeat?g.Mf=n:g.Gf=-g.Gf);break;case 150:g.Mf||(g.Mf=n);p(g,n-g.Mf);g.Mf=n;break;case 160:p(g,n);break;case 180:n=d(g.element);g.Y[0]=n.cv-n.aB;g.Y[1]=n.bv-n.$A;g.Y[2]=n.av-n.$u;break;case 190:n=d(g.element);g.Y[0]=n.cv;g.Y[1]=n.bv;g.Y[2]=n.av;break;case 200:n=d(g.element);L.copy(n.cJ,g.Y);break;case 210:m=f.ia(f.Je);f.Oi(m,f.gt,g.Y);break;case 220:m=f.ia(f.Je);f.Oi(m,f.ht,g.Y);break;case 240:m=l(g.Rl);g.value=f.UU(m,g.key);break;case 250:m=
l(g.Rl);g.value=f.TU(m,g.key);break;case 230:p(g,g.callback());break;case 30:n=d(g.element);p(g,n.Dx);break;case 40:n=d(g.element);if(!c.Jn||1==n.ye||2==n.ye)switch(t=n.lm-n.Sv,u=n.mm-n.Tv,g.Y.coords[0]=n.lm,g.Y.coords[1]=n.mm,g.axis){case "X":p(g,t);break;case "Y":p(g,u);break;case "XY":m=Math.sqrt(t*t+u*u),p(g,m)}break;case 260:n=d(g.element);c.Jn||(t=n.Qr,u=n.Rr,w=I.vc(t,0,m,.1*aa),m=I.vc(u,0,m,.1*aa),.01<Math.abs(t)||.01<Math.abs(u)?(n.Qr-=w,n.Rr-=m,g.Y.coords[0]=w,g.Y.coords[1]=m):(g.Y.coords[0]=
0,g.Y.coords[1]=0),p(g,Math.sqrt(t*t+u*u)));break;case 50:n=d(g.element);p(g,0<n.ye|0);g.Y.which=n.which;g.Y.coords[0]=n.lm;g.Y.coords[1]=n.mm;break;case 170:n=d(g.element);p(g,0);if(g.BH)n.ZA==g.ei&&p(g,1);else if(n.ye&&n.Vh.da==g.ei)p(g,1);else if(!n.Bv)for(m=0;10>m;++m)if(n.Hm[m].da==g.ei){p(g,1);break}break;case 20:n=d(g.element);g.Y=n.Se[g.key];1==g.Y||n.Se[0]&&16==g.key?p(g,1):g.Y||p(g,0);break;case 60:n=d(g.element);if(-1==n.ne[1]&&-1==n.De[1]){t=n.ne[0]-n.ph[0];u=n.De[0]-n.qh[0];m=Math.sqrt(t*
t+u*u);if(-1!=n.ph[1]&&-1!=n.qh[1]){var w=n.ne[0]-n.ph[1],x=n.De[0]-n.qh[1],r=Math.sqrt(w*w+x*x);r<m&&(t=w,u=x,m=r)}g.Y.gesture=a.nt}else m=q,m[0]=(n.ne[0]+n.ne[1])/2,m[1]=(n.De[0]+n.De[1])/2,u=ba,u[0]=(n.ph[0]+n.ph[1])/2,u[1]=(n.qh[0]+n.qh[1])/2,t=m[0]-u[0],u=m[1]-u[1],m=Math.sqrt(t*t+u*u),g.Y.gesture=a.lt;g.Y.coords[0]=n.ne[0];g.Y.coords[1]=n.De[0];switch(g.axis){case "X":p(g,t);break;case "Y":p(g,u);break;case "XY":p(g,m)}break;case 70:n=d(g.element);m=n.gx-n.KD;g.Y=a.mt;p(g,m);break;case 75:n=
d(g.element);-1!=n.ne[1]&&(m=Math.atan2(n.De[0]-n.De[1],n.ne[0]-n.ne[1]),g.Y=a.Sy,p(g,m-n.OM));break;case 80:n=d(g.element),g.Y.coords[0]=n.ne[0],g.Y.coords[1]=n.De[0],n.Bv?p(g,0):p(g,1)}for(h=0;h<k.length;h++)for(n=k[h],g=n.Am,m=0;m<g.length;m++)if(t=g[m],t.Ok!=U){t.Ok=U;x=t;u=0;switch(x.type){case a.qf:u=(w=B(x))?1:0;break;case a.ub:u=x.Ti;(w=B(x))?(u=1,x.Ti=1):1==u?(u=-1,x.Ti=-1):u=0;break;case a.Qx:u=x.Ti;(w=B(x))&&-1==u?(u=1,x.Ti=1):w||1!=u?u=0:(u=-1,x.Ti=-1);break;case a.vg:u=x.Ti;(w=B(x))&&
-1==u?(u=1,x.Ti=1):w||1!=u?u=0:(u=0,x.Ti=-1);break;case a.fp:w=B(x);x.MJ!=w?(u=1,x.MJ=w):u=0;break;case a.Px:w=x.zk;x=x.SV;for(r=0;r<w.length;r++){var E=w[r].value;u||E==x[r]||(u=1);x[r]=E}break;default:I.q("Wrong sensor manifold type: "+x.type)}if(u&&(w=n==y?null:n,V=!1,t.callback(w,t.id,u,t.qR),V)){h=-1;break}}for(h=0;h<k.length;h++)for(n=k[h],g=n.Am,m=0;m<g.length;m++)for(t=g[m],n=t.zk,t=0;t<n.length;t++)switch(u=n[t],u.type){case 30:p(u,0);break;case 40:p(u,0);break;case 60:p(u,0);break;case 70:p(u,
0);break;case 75:p(u,0);break;case 80:p(u,0);break;case 140:p(u,0)}for(h=0;h<R.length;h++){g=R[h];if(!g.qr){for(m=0;m<g.Se.length;m++)1==g.Se[m]?g.Se[m]=2:3==g.Se[m]&&(g.Se[m]=0);g.qr=!0}1==g.ye?g.ye=2:3==g.ye&&(g.ye=0);g.Dx=0;g.Sv=g.lm;g.Tv=g.mm;g.Se[0]=0;g.ph.set(g.ne);g.qh.set(g.De);g.KD=g.gx;g.aB=g.cv;g.$A=g.bv;g.$u=g.av;g.qB=!1}U++};a.Wz=function(a){var b=n(10);p(b,a);return b};a.Pc=function(a){var b=n(20,document);b.key=a;b.La=!0;return b};a.cu=function(a,b){var c=n(240,document);b=b||f.pI();
c.Rl=b;c.key=a;c.La=!0;return c};a.mn=function(a,b){var c=n(250,document);b=void 0==b?f.pI():b;c.Rl=b;c.key=a;c.La=!0;return c};a.Vz=function(a,b,c){if(!a||!G.na(a))return K.error("Wrong collision object"),null;var d=n(90);d.Mz=a;d.$b=b;d.Dh=c;d.Y={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Lz=function(a,b,c,e,f){p(d,a);a=d.Y;a.coll_obj=b;d.Dh&&(a.coll_pos.set(c),a.coll_norm.set(e),a.coll_dist=f)};d.La=!0;return d};a.NG=function(a){if(!a||
!a.C)return K.error("Wrong collision impulse object"),null;var b=n(100);b.Kz=a;b.FG=function(a){p(b,a)};b.La=!0;return b};a.YG=function(a,b,c,d,e,f,h){var k=n(110);k.ei=a;k.from=b;k.to=c;k.$b=d;k.sJ=e;k.Dh=f;k.nv=h;k.Y={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Wr:0};k.RK=function(a,b,c,d,e,f){k.sJ?p(k,-1==b?0:1):p(k,b);k.Y.hit_fract=b;k.Y.obj_hit=c;k.Y.hit_time=d;k.Dh&&(k.Y.hit_pos.set(e),k.Y.hit_norm.set(f))};k.La=!0;return k};a.rq=function(a){a=
n(50,a);a.La=!0;a.Y={coords:new Float32Array(2),which:null};return a};a.Zz=function(a){a=n(30,a);a.La=!0;return a};a.on=function(a,b){var c=n(40,b);c.axis=a||"XY";c.Y={coords:new Float32Array(2)};c.La=!0;return c};a.gu=function(a,b){var c=n(60,b);c.axis=a||"XY";c.Y={coords:new Float32Array(2),gesture:0};c.La=!0;return c};a.eA=function(a){a=n(70,a);a.Y=0;a.La=!0;return a};a.hH=function(a){a=n(75,a);a.Y=0;a.La=!0;return a};a.gH=function(a){a=n(80,a);a.Y={coords:new Float32Array(2)};a.La=!0;return a};
a.VG=function(a,b,c){if(!a)return K.error("Wrong collision object"),null;var d=n(120);d.ei=a;var e=N.F(a.k.n);a=N.R(a.k.n);d.LK=new Float32Array(4);d.Qo=new Float32Array(e);d.rw=new Float32Array(a);d.Ht=0;d.Gt=0;d.threshold=b||.1;d.bL=c||.1;d.Mf=0;d.Y=new Float32Array([0,0]);return d};a.iH=function(a,b){if(!a)return K.error("Wrong collision object"),null;var c=n(130);c.ei=a;var d=N.R(a.k.n);c.Qo=new Float32Array(N.F(a.k.n));c.rw=new Float32Array(d);c.It=0;c.threshold=b||1;c.Mf=0;c.Y=0;return c};a.fH=
function(a,b){var c=n(140);c.Gf=a;c.repeat=b;c.La=!0;return c};a.YK=function(a,b,c,d){a=a||y;a=a.mh;if(!a||!a[b])return K.error("reset_timer_sensor(): wrong object"),null;b=a[b].zk[c];if(!b)return K.error("reset_timer_sensor(): sensor not found"),null;b.Mf=D.ar();b.Gf=d};a.bu=function(){var a=n(150);a.Mf=0;return a};a.RG=function(){var a=n(180,window);a.Y=new Float32Array(3);f.ia(f.uh)?p(a,1):p(a,0);a.La=!0;return a};a.QG=function(){var a=n(190,window);a.Y=new Float32Array(3);f.ia(f.uh)?p(a,1):p(a,
0);a.La=!0;return a};a.SG=function(){var a=n(200,window);a.Y=L.create();f.ia(f.uh)?p(a,1):p(a,0);a.La=!0;return a};a.UG=function(){var a=n(210,window);a.Y=L.create();f.ia(f.Je)?p(a,1):p(a,0);a.La=!0;return a};a.TG=function(){var a=n(220,window);a.Y=O.create();f.ia(f.Je)?p(a,1):p(a,0);a.La=!0;return a};a.eH=function(){return n(160)};a.eu=function(a,b){var c=n(170);c.ei=a;c.BH=b;c.La=!0;return c};a.Uz=function(a,b){var c=n(230);c.callback=a;p(c,b);return c};a.WG=function(a){a=n(260,a);a.Y={coords:new Float32Array(2)};
a.La=!0;return a};a.XG=function(a){a=n(270,a);a.La=!0;return a};a.LX=p;a.ag=function(a,b,c){a=a||y;a=a.mh;if(!a||!a[b])return K.error("get_sensor_value(): wrong object"),null;b=a[b].zk[c];return b?b.value:(K.error("get_sensor_value(): sensor not found"),null)};a.Nh=function(a,b,c){a=a||y;a=a.mh;if(!a||!a[b])return K.error("get_sensor_payload(): wrong object"),null;b=a[b].zk[c];return b?b.Y:(K.error("get_sensor_payload(): sensor not found"),null)};a.sa=function(){k=[];y={};for(var a=0;a<A.length;a++)x(A[a]);
A.length=0;e.length=0};a.bq=function(a,b){a=a||y;if(!a.mh)return!1;if(b&&a.mh[b])return!0;if(!b)for(var c in a.mh)return!0;return!1};a.ua=function(a,c,h,g,l,n,u){a=a||y;a.Am=a.Am||[];a.mh=a.mh||{};var p=a.mh,q=a.Am;p[c]&&m(a,c);h={id:c,type:h,zk:g.slice(0),nW:l,MX:Array(g.length),callback:n,qR:u,Ti:-1,MJ:0,SV:Array(g.length),Ok:-1};p[c]=h;q.push(h);-1==k.indexOf(a)&&k.push(a);g=h.zk;for(a=0;a<g.length;a++){p=c=g[a];if(p.La){switch(p.type){case 90:G.fz(p.Mz,p.$b,p.Lz,p.Dh);break;case 100:G.hz(p.Kz,
p.FG);break;case 110:p.Wr=G.Ct(p.ei,p.from,p.to,p.$b,p.RK,!1,!1,p.Dh,p.nv);p.Y.Wr=p.Wr;break;case 140:p.Mf=D.ar();0>p.Gf&&(p.Gf=-p.Gf);break;case 20:q=d(p.element);b(q,"keyboard_downed_keys");break;case 30:q=d(p.element);b(q,"mouse_wheel");break;case 40:q=d(p.element);b(q,"mouse_down_which");b(q,"mouse_up_which");b(q,"mouse_location");break;case 260:q=d(p.element);b(q,"mouse_pointerlock");break;case 270:f.ZP(p);break;case 50:q=d(p.element);b(q,"mouse_down_which");b(q,"mouse_up_which");break;case 60:q=
d(p.element);b(q,"touch_start");b(q,"touch_move");b(q,"touch_end");break;case 70:q=d(p.element);b(q,"touch_start");b(q,"touch_move");break;case 75:q=d(p.element);b(q,"touch_start");b(q,"touch_move");break;case 80:q=d(p.element);b(q,"touch_start");b(q,"touch_end");break;case 170:q=d(p.element);b(q,"mouse_select");b(q,"touch_select");b(q,"touch_start");b(q,"touch_end");b(q,"mouse_down_which");b(q,"mouse_up_which");break;case 180:case 190:q=d(p.element);b(q,"orientation_angles");break;case 200:q=d(p.element);
b(q,"orientation_quat");break;case 240:0==p.Rl?f.ia(f.Ts):1==p.Rl?f.ia(f.Tx):2==p.Rl?f.ia(f.Ux):f.ia(f.Vx)}p.La=!1}p=A.indexOf(c);-1==p?(A.push(c),e.push([h])):e[p].push(h)}V=!0};a.mu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.nu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.as=m;a.reset=function(){for(var a=0;a<k.length;a++){var b=k[a],c=b.mh,b=b.Am,d;for(d in c)delete c[d];b.length=0}for(a=0;a<A.length;a++)x(A[a]);k.length=
0;A.length=0;e.length=0};a.debug=function(){K.log(String(k.length)+" objects with manifolds",k);K.log(String(A.length)+" sensors",A);for(var a=[],b=[],c=0;c<A.length;c++){var d=A[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}K.log(String(a.length)+" collision sensors",a);K.log(String(b.length)+" ray sensors",b)};a.EL=function(a){aa=a}};b4w.module.__loader=function(a,r){function n(b,f,g,l){var c=D,k=K.create(),m;for(m in f){var n=d(f[m]);(l&&n.Ub||!b&&n.hc)&&h(n);K.J(k,n)}for(m in f)for(n=f[m],n.name=m,b=0;b<n.L.length;b++)K.r(k,f[n.L[b]],n,null);f=d({name:"out",Nb:a.NN,Zb:function(a,b,d,e,f){b.Mb&&(c.mD=!0);C(b)||(b.status=2);b.RJ(b.id,!0);f(b,d);G.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Wb:5});if(g)g=K.$q(k);else{m=K.clone(k);do{g=K.$q(m);n=[];for(b=0;b<g.length;b++){l=g[b];var e=K.Va(m,l);e.Qb&&n.push(l)}for(b=
0;b<n.length;b++)K.pg(m,n[b]);n.length&&K.Gz(m)}while(n.length)}K.J(k,f);for(b=0;b<g.length;b++)l=g[b],e=K.Va(k,l),f.L.push(e.name),K.r(k,e,f,null);return k}function d(a){a.Qb=a.Qb||!1;a.Nb||0===a.Nb||(a.Nb=a.qe);a.L=a.L||[];a.bm=a.bm||!1;a.iD=a.iD||!1;a.Wb=a.Wb||0;a.Ub=a.Ub||!1;a.hc=a.hc||!1;a.status=0;a.Z5=0;a.AB=0;a.Yp=a.Yp||null;return a}function b(a,b){for(var d=[],f=[],c=0;c<b.length;c++){var h=b[c];K.Va(a.fi,h).bm&&(K.Lk(a.fi,h,function(c){var f=!0;K.ii(a.fi,c,function(a,b){if(!b.bm)return f=
!1,1});f&&-1==d.indexOf(c)&&-1==b.indexOf(c)&&d.push(c)}),f.push(c))}for(c=f.length-1;0<=c;c--)b.splice(f[c],1);return d}function t(a){function d(b,c){var e=K.Va(a.fi,b),f=K.Va(a.fi,c),h=f.Nb-e.Nb;0==h&&(h=e.Qb-f.Qb);return h}var f=[],h=a.jj,c=!1;do{var k=b(a,h);f.push.apply(f,h);0<k.length&&(c=!0);h=k}while(0<k.length);c&&f.sort(d);a.jj=f;return a.jj.length}function p(a,b,d){if(b.iD)return b.bm=!0,m(a,b),!1;if(!b.Zb&&!b.Fj&&!b.Xp)return m(a,b),!1;if(0==b.status&&(b.status++,b.Zb))return b.Zb(d,a,
b,b.Yp,m,x),!0;if(1==b.status){if(b.Fj)return b.Fj(d,a,b,b.Yp,m,x),!0;b.status++}return 2==b.status&&(b.status++,b.Xp)?(b.Xp(d,a,b,b.Yp,m,x),!0):!1}function B(a){if(0==a.$w)return 100;var b=0;K.oa(a.fi,function(d,f){a.do_not_load_resources&&f.Ub||(b+=f.AB*f.Wb)});return L.trunc(100*b/a.$w)}function m(a,b){b.bm=!0;b.status=3;g(a,b,1)}function x(a,b,d){1>d?g(a,b,d):b.status++}function g(a,b,d){var f=D;if(b.Zb||b.Fj||b.Xp)if(b.AB=d,b=B(a),a.mH!=b||1==d)a.lD(b,performance.now()-a.LM),a.mH=b,f.CB=!0}function l(a,
b){var d=null;K.oa(a.fi,function(a,c){if(c.name==b)return d=c,1});return d}function h(a){a.iD=!0;a.AB=1}function w(a){a.lD=null;a.Nz=null;a.fi=null;a.jj=null}function f(){return 0==D.zt}function C(a){return a&&(3==a.status||4==a.status)}var K=r("__graph"),G=r("__print"),L=r("__util");a.qe=0;a.ug=1;a.NN=2;var D=null;a.VA=function(){return D};a.ZG=function(){var a={oh:[],jA:0,zt:0,mD:!1,CB:!1};return D=a};a.dH=function(a,b,d,f,c,h,g,l,e){var m=D,p=m.oh.length,t={id:p,Mb:0==p,status:0,Pg:b,XF:"",RJ:d||
function(){},QJ:l||!1,U8:h,LM:0,mH:0,$w:0,EC:!1,lD:f||function(){},Nz:c||function(){},fi:null,jj:null,dB:!1,bB:!1,gB:!1,bk:e};a=n(t.Mb,a,h,g);t.fi=a;b=[];d=K.bV(a);for(f=0;f<d.length;f++)b.push(d[f]);t.jj=b;K.oa(a,function(a,b){!(b.Zb||b.Fj||b.Xp)||t.do_not_load_resources&&b.Ub||(t.$w+=b.Wb)});m.oh.push(t);m.zt++;return t.id};a.VZ=function(b){var d=D;if(d&&!f())if(d.CB)d.CB=!1;else{var h=performance.now();do{var g=d.oh[d.jA],c=b[g.id];if(!C(g))if(0==g.status&&(g.status=1,g.LM=performance.now(),g.lD(0,
0)),t(g)){var k=g,l=k.jj.length;do{var m=K.Va(k.fi,k.jj[0]),e=p(k,m,c);m.Nb==a.ug&&(k.EC=!0);m=k.jj.shift();k.jj.push(m);l--}while(!e&&0!=l)}else k=d,l=g,l.Nz(c,l),l.status=3,k.zt--,w(l);d.mD&&(d.jA=(d.jA+1)%d.oh.length);if(g.EC){g.EC=!1;break}}while(16>performance.now()-h)}};a.pF=function(a){var b=D;a.Nz(null,a);a.status=3;b.zt--;w(a);a.status=4;a.Mb&&(b.mD=!0);a.RJ(a.id,!1)};a.b8=x;a.Rw=function(a,b){var d=l(a,b);null!==d&&h(d)};a.bm=f;a.hZ=C;a.Wg=function(a){var b=D;if(!b)return!1;a|=0;return b.oh[a]&&
(3==b.oh[a].status||2==b.oh[a].status)};a.iV=function(){G.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.sa=function(){D=null}};b4w.module.__md5=function(a){function r(a,m){var p=a[0],g=a[1],l=a[2],h=a[3],p=d(p,g,l,h,m[0],7,-680876936),h=d(h,p,g,l,m[1],12,-389564586),l=d(l,h,p,g,m[2],17,606105819),g=d(g,l,h,p,m[3],22,-1044525330),p=d(p,g,l,h,m[4],7,-176418897),h=d(h,p,g,l,m[5],12,1200080426),l=d(l,h,p,g,m[6],17,-1473231341),g=d(g,l,h,p,m[7],22,-45705983),p=d(p,g,l,h,m[8],7,1770035416),h=d(h,p,g,l,m[9],12,-1958414417),l=d(l,h,p,g,m[10],17,-42063),g=d(g,l,h,p,m[11],22,-1990404162),p=d(p,g,l,h,m[12],7,1804603682),h=d(h,p,g,l,
m[13],12,-40341101),l=d(l,h,p,g,m[14],17,-1502002290),g=d(g,l,h,p,m[15],22,1236535329),p=b(p,g,l,h,m[1],5,-165796510),h=b(h,p,g,l,m[6],9,-1069501632),l=b(l,h,p,g,m[11],14,643717713),g=b(g,l,h,p,m[0],20,-373897302),p=b(p,g,l,h,m[5],5,-701558691),h=b(h,p,g,l,m[10],9,38016083),l=b(l,h,p,g,m[15],14,-660478335),g=b(g,l,h,p,m[4],20,-405537848),p=b(p,g,l,h,m[9],5,568446438),h=b(h,p,g,l,m[14],9,-1019803690),l=b(l,h,p,g,m[3],14,-187363961),g=b(g,l,h,p,m[8],20,1163531501),p=b(p,g,l,h,m[13],5,-1444681467),h=
b(h,p,g,l,m[2],9,-51403784),l=b(l,h,p,g,m[7],14,1735328473),g=b(g,l,h,p,m[12],20,-1926607734),p=n(g^l^h,p,g,m[5],4,-378558),h=n(p^g^l,h,p,m[8],11,-2022574463),l=n(h^p^g,l,h,m[11],16,1839030562),g=n(l^h^p,g,l,m[14],23,-35309556),p=n(g^l^h,p,g,m[1],4,-1530992060),h=n(p^g^l,h,p,m[4],11,1272893353),l=n(h^p^g,l,h,m[7],16,-155497632),g=n(l^h^p,g,l,m[10],23,-1094730640),p=n(g^l^h,p,g,m[13],4,681279174),h=n(p^g^l,h,p,m[0],11,-358537222),l=n(h^p^g,l,h,m[3],16,-722521979),g=n(l^h^p,g,l,m[6],23,76029189),p=
n(g^l^h,p,g,m[9],4,-640364487),h=n(p^g^l,h,p,m[12],11,-421815835),l=n(h^p^g,l,h,m[15],16,530742520),g=n(l^h^p,g,l,m[2],23,-995338651),p=t(p,g,l,h,m[0],6,-198630844),h=t(h,p,g,l,m[7],10,1126891415),l=t(l,h,p,g,m[14],15,-1416354905),g=t(g,l,h,p,m[5],21,-57434055),p=t(p,g,l,h,m[12],6,1700485571),h=t(h,p,g,l,m[3],10,-1894986606),l=t(l,h,p,g,m[10],15,-1051523),g=t(g,l,h,p,m[1],21,-2054922799),p=t(p,g,l,h,m[8],6,1873313359),h=t(h,p,g,l,m[15],10,-30611744),l=t(l,h,p,g,m[6],15,-1560198380),g=t(g,l,h,p,m[13],
21,1309151649),p=t(p,g,l,h,m[4],6,-145523070),h=t(h,p,g,l,m[11],10,-1120210379),l=t(l,h,p,g,m[2],15,718787259),g=t(g,l,h,p,m[9],21,-343485551);a[0]=p+a[0]&4294967295;a[1]=g+a[1]&4294967295;a[2]=l+a[2]&4294967295;a[3]=h+a[3]&4294967295}function n(a,b,d,g,l,h){b=(b+a&4294967295)+(g+h&4294967295)&4294967295;return(b<<l|b>>>32-l)+d&4294967295}function d(a,b,d,g,l,h,p){return n(b&d|~b&g,a,b,l,h,p)}function b(a,b,d,g,l,h,p){return n(b&g|d&~g,a,b,l,h,p)}function t(a,b,d,g,l,h,p){return n(d^(b|~g),a,b,l,
h,p)}var p="0123456789abcdef".split("");a.iJ=function(a){var b=a,d=b.length;a=[1732584193,-271733879,-1732584194,271733878];var g;for(g=64;g<=b.length;g+=64){for(var l=b.substring(g-64,g),h=[],n=void 0,n=0;64>n;n+=4)h[n>>2]=l.charCodeAt(n)+(l.charCodeAt(n+1)<<8)+(l.charCodeAt(n+2)<<16)+(l.charCodeAt(n+3)<<24);r(a,h)}b=b.substring(g-64);l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(g=0;g<b.length;g++)l[g>>2]|=b.charCodeAt(g)<<(g%4<<3);l[g>>2]|=128<<(g%4<<3);if(55<g)for(r(a,l),g=0;16>g;g++)l[g]=0;l[14]=8*
d;r(a,l);for(b=0;b<a.length;b++){d=a[b];g="";for(l=0;4>l;l++)g+=p[d>>8*l+4&15]+p[d>>8*l&15];a[b]=g}return a.join("")}};b4w.module.__logic_nodes=function(a,r){function n(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.zw;f++)if(I.ag(a,b,f))for(var h=0;h<c.yw.length;h++)if(c.yw[h]==f){e.nm==c.HM?(K.ak(e.qa)&&(c.state=-1),d.Lf.Cf||(c.state=1,c.ns=c.Hv[h])):(c.state=1,c.ns=c.Hv[h]);return}c.state=0}}}function d(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.zw;f++)if(I.ag(a,b,f)&&f==c.hL){if(K.ak(e.qa)&&e.nm==c.HM)c.state=-1;else if(!d.Lf.Cf||c.S.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Pa:a.slot_idx_order,ns:a.slot_idx_jump,va:a.frame_range[0],Za:a.frame_range[1],hU:a.frame_range_mask?a.frame_range_mask[0]:!0,gU:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,zw:-1,hL:-1,PW:a.param_name,NW:a.operation,kc:a.mute,Fq:a.object,da:null,gc:null,pc:null,eb:{},Rf:a.anim_name,xc:w.bl,RW:a.parse_json_vars,QW:a.parse_json_paths,Hc:a.objects_paths,jK:a.nodes_paths,Gb:a.floats,S:a.bools,T:a.variables,kj:a.strings,
DB:a.materials_names,UL:a.shader_nd_type,te:a.common_usage_names,IT:a.encode_json_vars,HT:a.encode_json_paths,HM:b,HK:H[a.type]?H[a.type]:m,pw:!1,fx:0,yw:null,eW:a.links,Hv:[]}}function t(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function p(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function B(a,b,c){switch(b.state){case 2:c.la=a.Pa}}function m(a,b,c){switch(b.state){case 1:L.error("Unknown node type: "+a.type);break;case 2:c.la=a.Pa}}function x(a){return G.rc(G.Kc,a.Fq||[],0)}function g(a,c){var d=a.b4w_logic_nodes,
e=c.je;c.state=1;for(var f=0;f<d.length;f++){var h={X:[],Lf:{xb:a,la:0,Cf:!1,BD:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(h);for(var k=e[e.length-1],g=d[f],l=0;l<g.length;l++){var m=b(g[l],k);k.X.push(m)}for(g=0;g<k.X.length;g++)m=k.X[g],m.kc||m.HK(m,c,h.Lf,0,0)}var d=a.timeline_markers,n;for(n in d)c.os.push(d[n]);c.os.sort(function(a,b){return a-b});c.state=2;Z.push(c)}function l(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function h(a){switch(typeof a){case "string":return l(a,1);case "number":return l(a,0);default:return l(a,1)}}var w=r("__animation"),f=r("__assets"),C=r("__camera"),K=r("__nla"),G=r("__objects"),L=r("__print"),D=r("__scenes"),N=r("__config"),I=r("__controls"),O=r("__batch"),E=r("__geometry"),c=r("__mat3"),k=r("__mat4"),y=r("__physics"),A=r("__quat"),e=r("__sfx"),R=r("__time"),q=r("__transform"),ba=r("__tsr"),J=r("__util"),F=r("__vec3"),V=new Float32Array(4);new Float32Array(4);var U=new Float32Array(3),
aa=new Float32Array(3),v=new Float32Array(2),fa=new Float32Array(9),M=new Float32Array(16);a.MO=0;a.NO=1;a.GO=0;a.FO=1;a.HO=2;a.IO=3;a.EO=4;a.EE=0;a.GE=1;a.FE=2;a.HE=3;a.IE=4;a.DE=5;a.LO=0;a.KO=1;a.JO=2;a.xO=0;a.yO=1;a.vO=2;a.wO=3;a.zO=0;a.AO=1;var H={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.la=a.Pa}},HIDE:function(a,b,c){switch(b.state){case 1:a.da=x(a);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:D.$p(a.da,!0),c.la=a.Pa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.da=x(a);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:D.$p(a.da,!1),c.la=a.Pa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.T.vd;b=b.u;var e=c.u,f;a:{f=a.PW;var h=a.Gb.ptp,k=a.S.hsh,g=N.get("url_params");if(g&&f in g)f=Number(g[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),g=0;g<k.length;g++){var m=k[g].split("=");if(1<m.length&&m[0]==f){f=l(m[1],h);break a}}f=0}}p(d,b,e,f);c.la=a.Pa}},
SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.je[c.BD];var d=G.Ru();a.yw=[];a.Hv=[];for(var e in a.Hc){var f=G.rc(G.Kc,a.Hc[e],0),h=d.indexOf(f);if(-1==h){L.error("logic script error: non-selectable object:",a.Hc[e][a.Hc[e].length-1]);break a}a.yw.push(h);a.Hv.push(a.eW[e])}a.state=-1;a.zw=d.length;e=[];for(h=0;h<d.length;h++)e.push(I.eu(d[h],!1));I.ua(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,I.vg,e,I.nu,n(),[a,b,c])}break;case 2:if(-1==a.state){b=b.je[c.BD].X;for(f=0;f<b.length;f++)d=
b[f],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.la=a.state?a.ns:a.Pa,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.je[c.BD];var e=x(a),f=G.Ru(),h=f.indexOf(e);if(-1==h)L.error("logic script error: non-selectable object:",a.Fq[a.Fq.length-1]);else{a.state=-1;a.zw=f.length;a.hL=h;for(var h=[],k=0;k<f.length;k++)h.push(I.eu(f[k],!1));I.ua(e,"LOGIC_NODES_SELECT_"+a.label,I.vg,h,I.nu,d(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.la=a.state?a.ns:
a.Pa;a.state=-1;break}a.S.not_wait&&(c.la=a.Pa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:K.pM();a.state=-1;a.S.not_wait||(a.S.not_wait=!1);break;case 2:switch(a.state){case -1:if(K.ak(b.qa))if(b.hA==b.nm&&c.Cf)break;else{var e=b.nm;if(e){e.Lf.la=e.X[e.Lf.la].Pa;e.X[e.Lf.la].state=-1;for(var e=b.nm.X,f=0;f<e.length;f++){var h=e[f];"PLAY"==h.type&&(h.state=-1)}}}c.Cf=!a.S.not_wait;b.nm=b.hA;a.state=0;a.hU&&(K.hY(a.va),K.AL(d));if(a.gU)K.YC(a.Za);else{d=K.Zq(d);var e=-1,k;for(k in b.os)if(d<b.os[k]){e=
k;break}0<=e?K.YC(b.os[e]):K.YC(K.rI())}K.aX();a.S.not_wait&&(c.la=a.Pa,a.state=-1,c.Cf=!1);break;case 0:K.ak()||(c.la=a.Pa,a.state=-1,c.Cf=!1);break;case 1:c.la=a.Pa;a.state=-1;b.nm=null;c.Cf=!1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.S.url?l(t(a.T.url,b.u,c.u),1):a.kj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.T.v1[1]?a.Gb.inp1:l(t(a.T.v1,b.u,c.u),0),e=-1==a.T.v2[1]?a.Gb.inp2:
l(t(a.T.v2,b.u,c.u),0),f=0;switch(a.NW){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&J.q("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}p(a.T.vd,b.u,c.u,f);c.la=a.Pa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.S.str?1:0,e=a.S.str?a.kj:a.Gb,f=-1==a.T.v1[1]?e.inp1:l(t(a.T.v1,b.u,c.u),d);b=-1==a.T.v2[1]?e.inp2:l(t(a.T.v2,b.u,c.u),d);d=!1;switch(a.te.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;
case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.la=d?a.ns:a.Pa}},REGSTORE:function(a,b,c){switch(b.state){case 2:p([a.S.gl||a.T.vd[0],a.T.vd[1]],b.u,c.u,(1==a.te.variable_type?a.kj:a.Gb).inp1),c.la=a.Pa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.da=a.S.env?G.Wu(a.Fq[0],0):x(a);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:switch(0!=a.state||w.ak(a.da,a.xc)||(a.state=1),a.state){case -1:for(var d in b.je){var e=
b.je[d].Lf.la;-1!=e&&(e=b.je[d].X[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.da==a.da&&(e.state=1))}b=a.te.param_anim_behavior;if(""==a.Rf)w.Dt(a.da),w.ks(a.da,b,w.bl);else{a:{d=a.da;for(var e=a.Rf,f=-1,h=0;8>h;h++){var k=d.ha[h];if(k&&k.xi&&w.sM(k.xi)==w.sM(e))if(-1!=f)f=h;else{d=-1;break a}}d=f}-1==d?(a.xc=w.CY(a.da,a.Rf),w.apply(a.da,null,a.Rf,a.xc)):a.xc=d;w.ks(a.da,b,a.xc)}a.S.not_wait||(c.Cf=!0);w.play(a.da,null,a.xc);a.state=0;a.S.not_wait&&(c.la=a.Pa,a.state=-1);break;case 0:break;case 1:a.S.not_wait||
(c.Cf=!1);c.la=a.Pa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:B,SEND_REQ:function(a,b,c){function d(a,e,f,h,k){a=JSON.stringify(a);p(k[0].T.dst,b.u,c.u,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.S.url?l(t(a.T.url,b.u,c.u),1):a.kj.url,h={};a.S.ct&&(h["Content-Type"]=a.kj.ct);"GET"==a.te.request_type?f.Ud([{id:e,type:f.Vm,url:e,pk:h,Ib:[a,c.u]}],d,null,null,null):"POST"==a.te.request_type&&f.Ud([{id:e,type:f.Vm,url:e,pk:h,
ai:"POST",ko:f.Vm,vm:l(t(a.T.dst1,b.u,c.u),1),Ib:[a,c.u]}],d,null,null,null);break;case 1:a.state=-1,c.la=a.Pa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.eb["id"+b]=G.rc(G.Kc,a.Hc["id"+b],0),a.eb["id"+b]||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:O.vV(a.eb.id0,a.DB.id0,a.eb.id1,a.DB.id1),c.la=a.Pa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Hc.id0&&(a.eb.id0=G.rc(G.Kc,a.Hc.id0,0),a.Hc.id0||(L.error("Logic script error: object not found. Node: ",
a.name),a.kc=!0),a.jK.id0.unshift(a.DB.id0));break;case 2:var d=a.eb.id0,e=a.jK.id0,f=e[0],h=O.Lq(d,f,"MAIN");c.la=a.Pa;if(null===h){L.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.UL){var k=O.Hn(h.dh,e);O.VC(d,f,k,a.S.id0?l(t(a.T.id0,b.u,c.u),0):a.Gb.id0,a.S.id1?l(t(a.T.id1,b.u,c.u),0):a.Gb.id1,a.S.id2?l(t(a.T.id2,b.u,c.u),0):a.Gb.id2)}"ShaderNodeValue"==a.UL&&(k=O.Hn(h.eh,e),O.WC(d,f,k,a.S.id0?l(t(a.T.id0,b.u,c.u),0):a.Gb.id0))}},DELAY:function(a,
b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.fx=0,c.Cf=!0):0==a.state&&(a.fx+=e,(a.S.dl?l(t(a.T.dl,b.u,c.u),0):a.Gb.dl)<a.fx&&(a.state=-1,c.la=a.Pa,c.Cf=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.eb.id0=G.rc(G.Kc,a.Hc.id0,0);b||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);c=a.te.sk;E.Ez(b)?E.nV(b,c)||(L.error("Wrong key name:",c),a.kc=!0):(L.error("No shape keys in object:",b.name),a.kc=!0);break;case 2:E.CQ(a.eb.id0,a.te.sk,a.S.skv?l(t(a.T.skv,
b.u,c.u),0):a.Gb.skv),c.la=a.Pa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.eb.id0=G.rc(G.Kc,a.Hc.id0,0);d||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);d&&d.k&&d.k.Uc||(L.error("Can't evaluate 'Outline' logic node: wrong object"),a.kc=!0);break;case 2:d=a.eb.id0;switch(a.te.outline_operation){case "PLAY":b=d.k.Wh;G.gn(d,b.mk,b.nk,b.ok);break;case "STOP":G.Tt(d);break;case "INTENSITY":d.k.gh=a.S["in"]?l(t(a.T["in"],b.u,c.u),0):a.Gb["in"]}c.la=a.Pa}},MOVE_CAMERA:function(a,
b,d){function e(a,b,c,d){switch(C.Wl(a)){case C.Jb:C.ls(a,b,c);break;case C.od:case C.xg:q.gj(a,d);break;case C.cd:F.sub(c,b,U),F.normalize(U,U),C.Hw(a,c),c=b=0,aa[0]=U[0],aa[1]=0,aa[2]=U[2],b=F.dot(aa,U),c=Math.acos(b/(F.length(aa)*F.length(U))),b=U[2]?Math.atan(U[0]/U[2]):0<U[0]?0:Math.PI,0<U[2]&&0<U[0]?v[1]=-(Math.PI+v[1]):0<U[2]&&0>U[0]?v[1]=-(Math.PI+v[1]):0>U[2]&&0>U[0]?(v[0]+=Math.PI,b=-(Math.PI-b)):0>U[2]&&0<U[0]&&(v[0]+=Math.PI,b-=Math.PI),C.cs(a,b+Math.PI,-c,!0,!0)}q.D(a);y.H(a)}function f(a,
b,d,e){k.lookAt(b,d,J.ad,M);k.invert(M,M);c.fromMat4(M,fa);A.fromMat3(fa,V);A.normalize(V,V);ba.ci(b,ba.Yd(a.k.n),V,e)}switch(b.state){case 1:d=null;d=a.eb.ca=G.rc(G.Kc,a.Hc.id0,0);d||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.eb.tr=G.rc(G.Kc,a.Hc.id1,0);a.eb.tr||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.eb.ta=G.rc(G.Kc,a.Hc.id2,0);a.eb.ta||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.state=-1;a.pc={QM:new Float32Array(3),
PM:new Float32Array(3),lB:new Float32Array(3),xD:new Float32Array(3),CM:new Float32Array(3),kB:new Float32Array(3),Nk:new Float32Array(8),ji:new Float32Array(8),jr:new Float32Array(8)};break;case 2:var h=a.eb.ca,g=ba.F(a.eb.tr.k.n),m=ba.F(a.eb.ta.k.n);switch(a.state){case -1:b=a.S.dur?l(t(a.T.dur,b.u,d.u),0):a.Gb.dur;if(0==b){f(h,g,m,a.pc.ji);e(h,g,m,a.pc.ji);d.la=a.Pa;break}F.copy(ba.F(h.k.n),a.pc.QM);var n=C.Wl(h);n==C.cd?F.copy(h.k.Tb,a.pc.xD):n==C.xg||n==C.od?(ba.copy(h.k.n,a.pc.Nk),f(h,g,m,a.pc.ji)):
F.copy(h.k.pivot,a.pc.xD);F.copy(g,a.pc.PM);F.copy(m,a.pc.CM);a.state=0;var p=R.en(0,1,1E3*b,function(b){D.Ca()&&(n==C.xg||n==C.od?ba.mB(a.pc.Nk,a.pc.ji,J.Dm(b),a.pc.jr):(a.pc.kB=F.lerp(a.pc.xD,a.pc.CM,J.Dm(b),a.pc.kB),a.pc.lB=F.lerp(a.pc.QM,a.pc.PM,J.Dm(b),a.pc.lB)),e(h,a.pc.lB,a.pc.kB,a.pc.jr),1==b&&(a.state=1))});break;case 1:R.St(p),a.state=-1,d.la=a.Pa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.eb.ca=G.rc(G.Kc,a.Hc.id0,0);d||(L.error("Logic script error: object not found. Node: ",
a.name),a.kc=!0);b=d.k;a.rR={Kk:b.Kk,use_panning:b.use_panning,lb:b.lb,ka:b.ka,sb:b.sb,yc:b.yc,zc:b.zc,ae:b.ae,Jh:b.Jh};break;case 2:var d=a.eb.ca,e=d.k,f=a.rR;C.Ns(d);switch(a.te.camera_move_style){case 0:e.tb=C.xg;break;case 2:e.tb=C.od;var h=ba.F(e.n);C.QL(d,h,null,f.lb,f.ka);break;case 3:e.tb=C.cd;var h=ba.F(e.n),k=U;a.S.pvo?(k=G.rc(G.Kc,a.Hc.id1,0),k=ba.F(k.k.n)):(k[0]=a.S.pvx?l(t(a.T.pvx,b.u,c.u),0):a.Gb.pvx,k[1]=a.S.pvy?l(t(a.T.pvy,b.u,c.u),0):a.Gb.pvy,k[2]=a.S.pvz?l(t(a.T.pvz,b.u,c.u),0):
a.Gb.pvz);C.RL(d,h,k,f.sb,f.ka,f.yc,f.zc,f.Jh);break;case 1:e.tb=C.Jb,h=ba.F(e.n),k=U,a.S.pvo?(k=G.rc(G.Kc,a.Hc.id1,0),k=ba.F(k.k.n)):(k[0]=a.S.pvx?l(t(a.T.pvx,b.u,c.u),0):a.Gb.pvx,k[1]=a.S.pvy?l(t(a.T.pvy,b.u,c.u),0):a.Gb.pvy,k[2]=a.S.pvz?l(t(a.T.pvz,b.u,c.u),0):a.Gb.pvz),C.SL(d,h,k,f.lb,f.ka,f.S2,f.ae,f.use_panning)}aa[0]=a.S.vtr?l(t(a.T.vtr,b.u,c.u),0):a.Gb.vtr;aa[1]=a.S.vro?l(t(a.T.vro,b.u,c.u),0):a.Gb.vro;aa[2]=a.S.vzo?l(t(a.T.vzo,b.u,c.u),0):a.Gb.vzo;aa[0]=J.V(aa[0],0,Infinity);aa[1]=J.V(aa[1],
0,Infinity);aa[2]=J.V(aa[2],0,.99);e.Tk=aa[0];e.Sk=aa[1];e.Uk=aa[2];q.D(d);y.H(d);C.Nn(d);c.la=a.Pa}},MOVE_TO:function(a,b,c){function d(a,b){q.gj(a,b);q.D(a);y.H(a)}switch(b.state){case 1:a.eb.ob=G.rc(G.Kc,a.Hc.id0,0);a.eb.ob||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.eb.de=G.rc(G.Kc,a.Hc.id1,0);a.eb.de||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.state=-1;a.gc={vH:new Float32Array(8),oA:new Float32Array(8),rJ:new Float32Array(8)};break;
case 2:var e=a.eb.ob;ba.copy(a.eb.ob.k.n,a.gc.vH);ba.copy(a.eb.de.k.n,a.gc.oA);switch(a.state){case -1:b=a.S.dur?l(t(a.T.dur,b.u,c.u),0):a.Gb.dur;if(0==b){d(e,a.gc.oA);c.la=a.Pa;break}a.state=0;var f=R.en(0,1,1E3*b,function(b){D.Ca()&&(a.gc.E5=ba.mB(a.gc.vH,a.gc.oA,J.Dm(b),a.gc.rJ),d(e,a.gc.rJ),1==b&&(a.state=1))});break;case 1:R.St(f),a.state=-1,c.la=a.Pa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?q.gj(a,b):q.Mw(a,b);q.D(a);y.H(a)}switch(b.state){case 1:a.eb.ob=G.rc(G.Kc,a.Hc.id0,
0);a.eb.ob||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);a.state=-1;a.gc={Yw:0,Nk:new Float32Array(8),ji:new Float32Array(8),jr:new Float32Array(8)};break;case 2:var e=a.eb.ob;switch(a.state){case -1:aa[0]=a.S.trx?l(t(a.T.trx,b.u,c.u),0):a.Gb.trx;aa[1]=a.S["try"]?l(t(a.T["try"],b.u,c.u),0):a.Gb["try"];aa[2]=a.S.trz?l(t(a.T.trz,b.u,c.u),0):a.Gb.trz;U[0]=a.S.rox?l(t(a.T.rox,b.u,c.u),0)*Math.PI/180:a.Gb.rox;U[1]=a.S.roy?l(t(a.T.roy,b.u,c.u),0)*Math.PI/180:a.Gb.roy;U[2]=a.S.roz?
l(t(a.T.roz,b.u,c.u),0)*Math.PI/180:a.Gb.roz;var f=a.S.sc?t(a.T.sc,b.u,c.u):a.Gb.sc;J.Pj(U,V);ba.ci(aa,f,V,a.gc.ji);a.gc.Yw=a.te.space_type;switch(a.gc.Yw){case 0:q.br(e,a.gc.Nk);break;case 1:q.cr(e,a.gc.Nk);break;case 2:q.cr(e,a.gc.Nk),ba.multiply(a.gc.Nk,a.gc.ji,a.gc.ji)}b=a.S.dur?l(t(a.T.dur,b.u,c.u),0):a.Gb.dur;if(0==b){d(e,a.gc.ji,a.gc.Yw);c.la=a.Pa;break}a.state=0;f=R.en(0,1,1E3*b,function(b){D.Ca()&&(ba.mB(a.gc.Nk,a.gc.ji,J.Dm(b),a.gc.jr),d(e,a.gc.jr,a.gc.Yw),1==b&&(a.state=1))});break;case 1:R.St(f),
a.state=-1,c.la=a.Pa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.da=G.rc(G.Kc,a.Hc.id0,0);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);void 0==a.S.not_wait&&(a.S.not_wait=!0);break;case 2:switch(e.KV(a.da)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.je){var f=b.je[d].Lf.la;-1!=f&&(f=b.je[d].X[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.da==a.da&&(f.state=1))}a.S.not_wait||(c.Cf=!0);e.zK(a.da);a.state=0;break;case 0:a.S.not_wait&&(c.la=
a.Pa,a.state=-1);break;case 1:a.S.not_wait||(c.Cf=!1);c.la=a.Pa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.da=G.rc(G.Kc,a.Hc.id0,0);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:e.stop(a.da),c.la=a.Pa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.da=a.S.env?G.Wu(a.Fq[0],0):x(a);a.da||(L.error("Logic script error: object not found. Node: ",a.name),a.kc=!0);break;case 2:w.stop(a.da,
w.bl),a.S.rst&&w.RC(a.da,w.bl),c.la=a.Pa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.S.rst&&K.AL(d),K.pM(),c.la=a.Pa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.T)d[a.T[e][1]]=t(a.T[e],b.u,c.u);L.log(a.te.msg,JSON.stringify(d));c.la=a.Pa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.S.id0?l(t(a.T.id0,b.u,c.u),1):a.kj.id0,e=a.S.id1?l(t(a.T.id1,b.u,c.u),1):a.kj.id1,f=0;switch(a.te.string_operation){case 0:f=d+e;break;case 1:f=d.indexOf(e);break;
case 2:f=d.replace(e,a.S.id2?l(t(a.T.id2,b.u,c.u),1):a.kj.id2);break;case 3:var h=a.T,f=d.substring(0,d.indexOf(e));p(h.dst1,b.u,c.u,d.substring(d.indexOf(e)+1,d.length));""==t(h.dst,b.u,c.u)&&(f=t(h.dst1,b.u,c.u),p(h.dst1,b.u,c.u,""));break;case 4:switch(a.te.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}p(a.T.dst,b.u,c.u,f);c.la=a.Pa}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.S.nla?
l(K.Zq(d),0):l(R.Zq(d),0),p(a.T.vd,b.u,c.u,d),c.la=a.Pa}},JSON:function(a,b,c){function d(a,b,c,e){for(var f=0;f<b.length;f++){for(var k=b[f].split("."),g=a,l=c[f],m=0;m<k.length&&(g=g[k[m]],void 0!==g&&null!==g);m++);g=h(g);e[l]=g}}function e(a,b,c,d){d||(d={});for(var f=0;f<b.length;f++){var k=b[f].split("."),g=d,l=c[f];if(!(!l in a)){for(var m=0;m<k.length-1;m++)void 0===g[k[m]]&&(g[k[m]]=isNaN(k[m+1])?{}:[]),g=g[k[m]];g[k[k.length-1]]=h(a[l])}}}switch(b.state){case 2:switch(a.te.json_operation){case "PARSE":try{var f=
JSON.parse(l(t(a.T.jsn,b.u,c.u),1));d(f,a.QW,a.RW,c.u)}catch(k){L.error("logic script error: non valid JSON string")}break;case "ENCODE":f={},e(c.u,a.HT,a.IT,f),f=l(JSON.stringify(f),1),p(a.T.jsn,b.u,c.u,f)}c.la=a.Pa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.S.cb?l(t(a.T.cb,b.u,c.u),1):a.kj.cb,e=[],f=0,k="id"+f,g=a.te.js_cb_params;k in g;)k=0==g[k]?G.rc(G.Kc,a.Hc[k],0):t(a.T[k],b.u,c.u),e.push(k),f++,k="id"+f;g=[];f=0;for(k="out"+f;k in a.T;)k=t(a.T[k],b.u,c.u),g.push(k),f++,
k="out"+f;f=1;if(d in ha){if(f=!ha[d](e,g))for(d=0;d<g.length;d++)k="out"+d,k in a.T&&p(a.T[k],b.u,c.u,h(g[d]))}else L.error("logic script error: no custom callback with id "+d);f&&(c.la=a.Pa)}},EMPTY:B},Z=[],ha={};a.wV=function(a,b){var c={Qe:b,fL:a.name,state:0,nm:null,xb:a,hA:null,je:[],os:[],u:{}};a.m1=c;g(a,c)};a.update=function(a,b){var c=K.dV();if(!(0>=c))for(var d=0;d<Z.length;d++)for(var e=d,f=a,h=b,k=c,g=Z[e],l=0;l<Z[e].je.length;l++){g.hA=Z[e].je[l];var m=Z[e].je[l],n=g,p=f,y=h,q=k,t=m.X;
if(t.length){for(var w=0;w<t.length;w++)t[w].pw=!1;for(w=0;w<t.length;w++){if(0<=m.Lf.la)var v=t[m.Lf.la];else break;if(v.pw)break;if(v.kc)if("ENTRYPOINT"==v.type)break;else m.Lf.la=v.Pa,v.pw=!0;else v.HK(v,n,m.Lf,p,y,q),v.pw=!0}}}};a.q1=function(a,b){ha[a]=b};a.H6=function(a){delete ha[a]};a.T6=function(a,b){for(var c=0;c<Z.length;c++)if(Z[c].fL==a){for(var c=Z[c],d=0;d<c.je.length;d++){var e=c.je[d].X[0];if(e.name==b){e.S.js&&(e.kc=!1);c.je[d].Lf.la=0;break}}break}};a.sa=function(){Z.length=0;ha=
{}}};b4w.module.__reformer=function(a,r){function n(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function d(a){if(a=a.nla_tracks)for(var d=0;d<a.length;d++)for(var c=a[d],f=0;f<c.strips.length;f++){var h=c.strips[f];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));
"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={nD:[],XK:"undefined",type:a});D[c].nD.push(b.name)}function t(a,b,c){c=c+">>"+a;c in D||(D[c]={nD:[],XK:"deprecated",type:a});D[c].nD.push(b.name)}function p(a){l.warn(a)}function B(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var f=w.Eh(a);a.materials=c;a.submeshes=d;f.name=b;f.materials=a.materials.slice(0);
f.submeshes=[];for(c=0;c<d.length;c++){var h=w.fq(d[c]);f.submeshes.push(h)}return f}var m=r("__boundings"),x=r("__curve"),g=r("__mat4"),l=r("__print"),h=r("__quat"),w=r("__util"),f=r("__vec3"),C=r("__mat3"),K=r("__logic_nodes"),G=r("__animation"),L=[5,4],D={},N=C.create(),I=h.create();a.vG=function(a){return-1!=w.uN(a,L)};a.BR=function(a){D={};var f=a.worlds;if(0==f.length){l.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var c={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};f.push(c)}for(var f=a.worlds,h=0;h<f.length;h++){c=f[h];"use_sky_blend"in c||(b("world",c,"use_sky_blend"),c.use_sky_blend=!1);"use_sky_paper"in c||(b("world",c,"use_sky_paper"),
c.use_sky_paper=!1);"use_sky_real"in c||(b("world",c,"use_sky_real"),c.use_sky_real=!1);"b4w_sky_settings"in c&&"rayleigh_brightness"in c.b4w_sky_settings||(b("world",c,"rayleigh_brightness"),c.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
c||(b("world",c,"fog_settings"),c.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in c&&(c.fog_settings.use_custom_color=!0,c.fog_settings.color=c.b4w_fog_color),"b4w_fog_density"in c&&0<c.b4w_fog_density&&(c.fog_settings.depth=1/c.b4w_fog_density));"render_sky"in c.b4w_sky_settings||(b("world",c,"render_sky"),c.b4w_sky_settings.render_sky=!1);for(var g=c.texture_slots,m=0;m<g.length;m++){var e=g[m];"blend_type"in
e||(e.blend_type="MIX",b("world_texture_slot",e,"blend_type"));"use_map_blend"in e||(e.use_map_blend=!1,b("world_texture_slot",e,"use_map_blend"));"use_map_horizon"in e||(e.use_map_horizon=!0,b("world_texture_slot",e,"use_map_horizon"));"use_map_zenith_up"in e||(e.use_map_zenith_up=!1,b("world_texture_slot",e,"use_map_zenith_up"));"use_rgb_to_intensity"in e||(e.use_rgb_to_intensity=!1,b("world_texture_slot",e,"use_rgb_to_intensity"));"invert"in e||(e.invert=!1,b("world_texture_slot",e,"invert"));
"color"in e||(e.color=[1,0,1],b("world_texture_slot",e,"color"));"blend_factor"in e||(e.blend_factor=0,b("world_texture_slot",e,"blend_factor"));"horizon_factor"in e||(e.horizon_factor=1,b("world_texture_slot",e,"horizon_factor"));"zenith_up_factor"in e||(e.zenith_up_factor=0,b("world_texture_slot",e,"zenith_up_factor"));"zenith_down_factor"in e||(e.zenith_down_factor=0,b("world_texture_slot",e,"zenith_down_factor"));"default_value"in e||(e.default_value=1,b("world_texture_slot",e,"default_value"))}"b4w_use_default_animation"in
c||(b("world",c,"b4w_use_default_animation"),c.b4w_use_default_animation=!1);"b4w_anim_behavior"in c||(b("world",c,"b4w_anim_behavior"),c.b4w_anim_behavior="CYCLIC")}m=a.scenes;for(h=0;h<m.length;h++)g=m[h],e=g.world,"timeline_markers"in g||(g.timeline_markers=null,b("scene",g,"timeline_markers")),"b4w_reflection_quality"in g||(g.b4w_reflection_quality="MEDIUM",b("scene",g,"b4w_reflection_quality")),"b4w_use_nla"in g||(g.b4w_use_nla=!1,b("scene",g,"b4w_use_nla")),"fps"in g||(g.fps=24,b("scene",g,
"fps")),"b4w_nla_cyclic"in g||(g.b4w_nla_cyclic=!1,b("scene",g,"b4w_nla_cyclic")),"b4w_logic_nodes"in g||(g.b4w_logic_nodes=[],b("scene",g,"b4w_logic_nodes")),"b4w_detect_collisions"in g&&(t("scene",g,"b4w_detect_collisions"),delete g.b4w_detect_collisions),"audio_doppler_speed"in g||(g.audio_doppler_speed=343.3),"audio_doppler_factor"in g||(g.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in g||(g.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",g,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in g||(g.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in g||(g.b4w_enable_bloom=!1,b("scene",g,"b4w_enable_bloom")),"b4w_enable_motion_blur"in g||(g.b4w_enable_motion_blur=!1,b("scene",g,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in g||(g.b4w_enable_color_correction=!1,b("scene",g,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in g||(g.b4w_antialiasing_quality="MEDIUM",b("scene",g,"b4w_antialiasing_quality")),
"b4w_tags"in g||(g.b4w_tags={title:"",description:""},b("scene",g,"b4w_tags")),"b4w_enable_object_selection"in g||(g.b4w_enable_object_selection="AUTO",b("scene",g,"b4w_enable_object_selection")),"b4w_enable_outlining"in g||(g.b4w_enable_outlining="AUTO",b("scene",g,"b4w_enable_outlining")),"b4w_enable_glow_materials"in g||(g.b4w_enable_glow_materials="AUTO",b("scene",g,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in g||(g.b4w_enable_anchors_visibility="AUTO",b("scene",g,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in g||(g.b4w_outline_color=[1,1,1],b("scene",g,"b4w_outline_color")),"b4w_outline_factor"in g||(g.b4w_outline_factor="b4w_glow_factor"in g?g.b4w_glow_factor:1,b("scene",g,"b4w_outline_factor")),"b4w_shadow_settings"in g||(b("scene",g,"b4w_shadow_settings"),f=e.b4w_shadow_settings,g.b4w_shadow_settings=f?f:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=g.b4w_shadow_settings,"csm_resolution"in f||(b("scene",g,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"blur_samples"in f||(b("scene",g,"b4w_shadow_settings.blur_samples"),f.blur_samples="16x"),"soft_shadows"in f||(b("scene",g,"b4w_shadow_settings.soft_shadows"),f.soft_shadows=!0),"self_shadow_polygon_offset"in f||(b("scene",g,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in f||(b("scene",g,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(b("scene",g,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(b("scene",g,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(b("scene",g,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(b("scene",g,"b4w_shadow_settings.first_cascade_blur_radius"),
f.first_cascade_blur_radius=3),"csm_last_cascade_border"in f||(b("scene",g,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(b("scene",g,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(b("scene",g,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(b("scene",g,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in
g||(b("scene",g,"b4w_ssao_settings"),f=e.b4w_ssao_settings,g.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=g.b4w_ssao_settings,"dist_factor"in f||(b("scene",g,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(b("scene",g,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(b("scene",g,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(b("scene",g,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(b("scene",g,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in g||(b("scene",g,"b4w_bloom_settings"),f=e.b4w_bloom_settings,g.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.key"),g.b4w_bloom_settings.key=.2),"blur"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.blur"),g.b4w_bloom_settings.blur=4),"edge_lum"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.edge_lum"),g.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in g||(b("scene",g,"b4w_motion_blur_settings"),f=e.b4w_motion_blur_settings,g.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in g.b4w_motion_blur_settings||(b("scene",g,"b4w_motion_blur_settings.motion_blur_factor"),g.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in g.b4w_motion_blur_settings||(b("scene",g,"b4w_motion_blur_settings.motion_blur_decay_threshold"),g.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in g||(b("scene",g,"b4w_color_correction_settings"),f=e.b4w_color_correction_settings,g.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in g||(b("scene",g,"b4w_god_rays_settings"),f=e.b4w_god_rays_settings,g.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in g.b4w_god_rays_settings||(b("scene",g,"b4w_god_rays_settings.steps_per_pass"),g.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in g||(b("scene",g,"b4w_glow_settings"),g.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=g.b4w_glow_settings,"b4w_render_glow_over_blend"in e&&(f.render_glow_over_blend=e.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in e&&(f.small_glow_mask_coeff=e.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in e&&(f.large_glow_mask_coeff=e.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
e&&(f.small_glow_mask_width=e.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in e&&(f.large_glow_mask_width=e.b4w_large_glow_mask_width)),e=g.b4w_render_shadows,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(g.b4w_render_shadows=e?"ON":"OFF"),e=g.b4w_render_reflections,"OFF"!=e&&"ON"!=e&&(g.b4w_render_reflections=e?"ON":"OFF"),e=g.b4w_render_refractions,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(g.b4w_render_refractions=e?"ON":"OFF"),"b4w_render_dynamic_grass"in g||(b("scene",g,"b4w_render_dynamic_grass"),g.b4w_render_dynamic_grass=
"AUTO"),g.b4w_nla_script&&t("scene",g,"b4w_nla_script"),"audio_distance_model"in g||(b("scene",g,"audio_distance_model"),g.audio_distance_model="INVERSE_CLAMPED");g=a.meshes;for(h=0;h<g.length;h++){e=g[h];e.b4w_boundings||(b("mesh",e,"b4w_boundings"),e.b4w_boundings={},f=e.b4w_boundings,f.bb=e.b4w_bounding_box?e.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},f.bb_src=e.b4w_bounding_box_source?e.b4w_bounding_box_source:e.b4w_bounding_box,f.bs_cen=e.b4w_bounding_sphere_center?e.b4w_bounding_sphere_center:
[0,0,0],f.bc_cen=e.b4w_bounding_cylinder_center?e.b4w_bounding_cylinder_center:[0,0,0],f.be_cen=e.b4w_bounding_ellipsoid_center?e.b4w_bounding_ellipsoid_center:[0,0,0],e.b4w_bounding_ellipsoid_axes?f.be_ax=e.b4w_bounding_ellipsoid_axes:(m=f.bb,f.be_ax=[(m.max_x-m.min_x)/2,(m.max_y-m.min_y)/2,(m.max_z-m.min_z)/2]),e.b4w_rotated_bounding_box?f.rbb=e.b4w_rotated_bounding_box:(m=f.bb,f.rbb={rbb_c:[(m.max_x+m.min_x)/2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]}),f.caxis_x=e.b4w_cov_axis_x?
e.b4w_cov_axis_x:[1,0,0],f.caxis_y=e.b4w_cov_axis_y?e.b4w_cov_axis_y:[0,1,0],f.caxis_z=e.b4w_cov_axis_z?e.b4w_cov_axis_z:[0,0,1]);e.uv_textures||(b("mesh",e,"uv_textures"),e.uv_textures=[]);"b4w_shape_keys"in e||(e.b4w_shape_keys=[],b("mesh",e,"b4w_shape_keys"));f=!0;for(c=0;c<e.submeshes.length;c++){var r=e.submeshes[c];"boundings"in r||(f=!1,r.boundings={be_ax:e.b4w_bounding_ellipsoid_axes,be_cen:e.b4w_bounding_ellipsoid_center,bb:{max_x:e.b4w_bounding_box.max_x,max_y:e.b4w_bounding_box.max_y,max_z:e.b4w_bounding_box.max_z,
min_x:e.b4w_bounding_box.min_x,min_y:e.b4w_bounding_box.min_y,min_z:e.b4w_bounding_box.min_z}});"be_ax"in r.boundings||(r.boundings.be_ax=e.b4w_bounding_ellipsoid_axes);"be_cen"in r.boundings||(r.boundings.be_cen=e.b4w_bounding_ellipsoid_center);"bb"in r.boundings||(r.boundings.bb=e.b4w_bounding_box);"rbb"in r.boundings||(m=e.b4w_bounding_box,r.boundings.rbb={rbb_c:[(m.max_x+m.min_x)/2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in r.boundings||(r.boundings.caxis_x=[1,0,0]);
"caxis_y"in r.boundings||(r.boundings.caxis_y=[0,1,0]);"caxis_z"in r.boundings||(r.boundings.caxis_z=[0,0,1])}f||b("mesh",e,"submesh_bd");m=e;f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];c=null;for(r=0;r<f.length;r++)m[f[r]]&&(c?(m[f[r]]=!1,l.warn('WARNING property "'+f[r]+'" of object "'+m.name+'" has been set to "false". Foreground property "'+c+'" already exists.')):c=f[r]);for(m=0;m<e.b4w_vertex_anim.length;m++)f=e.b4w_vertex_anim[m],
"allow_nla"in f||(b('mesh["b4w_vertex_anim"]',e,"allow_nla"),f.allow_nla=!0)}m=a.cameras;for(h=0;h<m.length;h++)g=m[h],g.type||(g.type="PERSP",b("camera",g,"type")),"b4w_eye_target_dist"in g&&(delete g.b4w_eye_target_dist,t("camera",g,"b4w_eye_target_dist")),"b4w_hover_zero_level"in g||(g.b4w_hover_zero_level=0,b("camera",g,"b4w_hover_zero_level")),"b4w_trans_velocity"in g||(g.b4w_trans_velocity=1,b("camera",g,"b4w_trans_velocity")),"b4w_rot_velocity"in g||(g.b4w_rot_velocity=1,b("camera",g,"b4w_rot_velocity")),
"b4w_zoom_velocity"in g||(g.b4w_zoom_velocity=.1,b("camera",g,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in g||(g.b4w_use_target_distance_limits=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_target_distance_limits")),"b4w_use_zooming"in g||(g.b4w_use_zooming=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_zooming")),"b4w_distance_min"in g||(g.b4w_distance_min=1,b("camera",g,"b4w_distance_min")),"b4w_distance_max"in g||(g.b4w_distance_max=100,b("camera",g,"b4w_distance_max")),
"b4w_horizontal_translation_min"in g||(g.b4w_horizontal_translation_min=-100,b("camera",g,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in g||(g.b4w_horizontal_translation_max=100,b("camera",g,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in g||(g.b4w_vertical_translation_min=-100,b("camera",g,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in g||(g.b4w_vertical_translation_max=100,b("camera",g,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
g||(g.b4w_use_horizontal_clamping=!1,b("camera",g,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in g||(g.b4w_rotation_left_limit=-Math.PI,b("camera",g,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in g||(g.b4w_rotation_right_limit=Math.PI,b("camera",g,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in g||(g.b4w_horizontal_clamping_type="LOCAL",b("camera",g,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in g||(g.b4w_use_vertical_clamping=!1,b("camera",g,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in g||(g.b4w_rotation_down_limit=-Math.PI/2,b("camera",g,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in g||(g.b4w_rotation_up_limit=Math.PI/2,b("camera",g,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in g||(g.b4w_vertical_clamping_type="LOCAL",b("camera",g,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in g||(g.b4w_hover_angle_min=Math.PI/6,b("camera",g,"b4w_hover_angle_min")),"b4w_hover_angle_max"in g||(g.b4w_hover_angle_max=Math.PI/6,b("camera",g,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in g||(g.b4w_enable_hover_hor_rotation=!0,b("camera",g,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in g||(g.b4w_use_panning=!0,b("camera",g,"b4w_use_panning")),"b4w_use_pivot_limits"in g||(g.b4w_use_pivot_limits=!1,g.b4w_pivot_z_min=0,g.b4w_pivot_z_max=10,b("camera",g,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in g||(g.b4w_dof_bokeh=!1,b("camera",g,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in g||(g.b4w_dof_bokeh_intensity=.3,b("camera",g,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in g||(g.b4w_dof_foreground_blur=!1,b("camera",g,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in g||(g.b4w_dof_front_start=0,b("camera",g,"b4w_dof_front_start")),"b4w_dof_front_end"in g||(g.b4w_dof_front_end=g.b4w_dof_front,b("camera",g,"b4w_dof_front_end")),"b4w_dof_rear_start"in g||(g.b4w_dof_rear_start=0,b("camera",g,"b4w_dof_rear_start")),"b4w_dof_rear_end"in g||(g.b4w_dof_rear_end=g.b4w_dof_rear,b("camera",g,"b4w_dof_rear_end"));m=a.lamps;for(h=0;h<m.length;h++)g=
m[h],"b4w_generate_shadows"in g||(g.b4w_generate_shadows=!1,b("lamp",g,"b4w_generate_shadows")),"b4w_dynamic_intensity"in g||(g.b4w_dynamic_intensity=!1,b("lamp",g,"b4w_dynamic_intensity")),"use_diffuse"in g||(g.use_diffuse=!0,b("lamp",g,"use_diffuse")),"use_specular"in g||(g.use_specular=!0,b("lamp",g,"use_specular")),"clip_start"in g||(g.clip_start=.1,b("lamp",g,"clip_start")),"clip_end"in g||(g.clip_end=30,b("lamp",g,"clip_end")),"POINT"!=g.type&&"SPOT"!=g.type||"use_sphere"in g||(g.use_sphere=
!1,b("lamp",g,"use_sphere"));m=a.speakers;for(h=0;h<m.length;h++)g=m[h],"b4w_behavior"in g||(g.b4w_behavior=g.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in g||(g.b4w_auto_play=!1,b("speaker",g,"b4w_auto_play")),"b4w_enable_doppler"in g||(g.b4w_enable_doppler=!1,b("speaker",g,"b4w_enable_doppler")),"b4w_delay"in g||(g.b4w_delay=0),"b4w_delay_random"in g||(g.b4w_delay_random=0),"b4w_volume_random"in g||(g.b4w_volume_random=0),"b4w_pitch_random"in g||(g.b4w_pitch_random=0),
"b4w_fade_in"in g||(g.b4w_fade_in=0),"b4w_fade_out"in g||(g.b4w_fade_out=0),"b4w_loop"in g||(g.b4w_loop=!1),"b4w_loop_start"in g||(g.b4w_loop_start=0,b("speaker",g,"b4w_loop_start")),"b4w_loop_end"in g||(g.b4w_loop_end=0,b("speaker",g,"b4w_loop_end")),g.animation_data&&d(g.animation_data);m=a.textures;for(h=0;h<m.length;h++)g=m[h],"b4w_anisotropic_filtering"in g||(g.b4w_anisotropic_filtering="OFF",b("texture",g,"b4w_anisotropic_filtering")),"b4w_water_foam"in g||(g.b4w_water_foam=!1,b("texture",g,
"b4w_water_foam")),"b4w_foam_uv_freq"in g||(g.b4w_foam_uv_freq=[1,1],b("texture",g,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in g||(g.b4w_foam_uv_magnitude=[1,1],b("texture",g,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in g||(g.b4w_parallax_steps=5,b("material",g,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in g||(g.b4w_parallax_lod_dist=10,b("material",g,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in g||(g.b4w_shore_dist_map=!1,b("texture",g,"b4w_shore_dist_map")),"b4w_shore_boundings"in
g||(g.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",g,"b4w_shore_boundings")),"b4w_max_shore_dist"in g||(g.b4w_max_shore_dist=100,b("texture",g,"b4w_max_shore_dist")),"b4w_disable_compression"in g||(g.b4w_disable_compression=!1,b("texture",g,"b4w_disable_compression")),"b4w_source_type"in g||(g.b4w_source_type="",b("texture",g,"b4w_source_type")),"b4w_source_id"in g||(g.b4w_source_id="",b("texture",g,"b4w_source_id")),"b4w_source_size"in g||(g.b4w_source_size=1024,b("texture",g,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in g||(g.b4w_enable_canvas_mipmapping=!0,b("texture",g,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in g||(g.b4w_nla_video=!1,b("texture",g,"b4w_nla_video"));m=a.images;for(h=0;h<m.length;h++)g=m[h],"colorspace_settings_name"in g||(g.colorspace_settings_name="sRGB",b("image",g,"colorspace_settings_name"));f=a.materials;for(h=0;h<f.length;h++){c=f[h];"ALPHA_ANTIALIASING"==c.game_settings.alpha_blend&&(c.game_settings.alpha_blend="CLIP");"use_tangent_shading"in c||(c.use_tangent_shading=
!1,b("material",c,"use_tangent_shading"));"b4w_node_mat_type"in c&&t("material",c,"b4w_node_mat_type");"b4w_skydome"in c&&t("material",c,"b4w_skydome");"b4w_procedural_skydome"in c&&t("material",c,"b4w_procedural_skydome");"b4w_lens_flares"in c||(c.b4w_lens_flares=!1,b("material",c,"b4w_lens_flares"));"LENS_FLARES"===c.name&&(c.b4w_lens_flares||l.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),c.b4w_lens_flares=!0);c.b4w_water&&("b4w_water_shore_smoothing"in
c||(c.b4w_water_shore_smoothing=!1,b("material",c,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in c||(c.b4w_water_dynamic=!1,b("material",c,"b4w_water_dynamic")),"b4w_waves_height"in c||(c.b4w_waves_height=1,b("material",c,"b4w_waves_height")),"b4w_waves_length"in c||(c.b4w_waves_length=1,b("material",c,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in c||(c.b4w_water_dst_noise_scale0=.05,b("material",c,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in c||(c.b4w_water_dst_noise_scale1=
.03,b("material",c,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in c||(c.b4w_water_dst_noise_freq0=1.3,b("material",c,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in c||(c.b4w_water_dst_noise_freq1=1,b("material",c,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in c||(c.b4w_water_dir_min_shore_fac=.4,b("material",c,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in c||(c.b4w_water_dir_freq=.5,b("material",c,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
c||(c.b4w_water_dir_noise_scale=.05,b("material",c,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in c||(c.b4w_water_dir_noise_freq=.07,b("material",c,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in c||(c.b4w_water_dir_min_noise_fac=.5,b("material",c,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in c||(c.b4w_water_dst_min_fac=.2,b("material",c,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in c||(c.b4w_water_waves_hor_fac=5,b("material",c,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in c||(c.b4w_water_absorb_factor=6,b("material",c,"b4w_water_absorb_factor")),"b4w_water_fog_color"in c||(c.b4w_water_fog_color=[.5,.7,.7],b("material",c,"b4w_water_fog_color")),"b4w_foam_factor"in c||(c.b4w_foam_factor=5,b("material",c,"b4w_foam_factor")),"b4w_generated_mesh"in c||(c.b4w_generated_mesh=!1,b("material",c,"b4w_generated_mesh")),"b4w_water_num_cascads"in c||(c.b4w_water_num_cascads=5,b("material",c,"b4w_water_num_cascads")),"b4w_water_subdivs"in c||(c.b4w_water_subdivs=
64,b("material",c,"b4w_water_subdivs")),"b4w_water_detailed_dist"in c||(c.b4w_water_detailed_dist=1E3,b("material",c,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in c||(c.b4w_water_enable_caust=!1,b("material",c,"b4w_water_enable_caust")),"b4w_water_caust_scale"in c||(c.b4w_water_caust_scale=.25,b("material",c,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in c||(c.b4w_water_caust_brightness=.5,b("material",c,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in c||(c.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in c||(c.b4w_dynamic_grass_color="");"diffuse_intensity"in c||(c.diffuse_intensity=1,b("material",c,"diffuse_intensity"));"b4w_use_ghost"in c||(c.b4w_use_ghost=!1);"b4w_collision_margin"in c||(c.b4w_collision_margin=.04,b("material",c,"b4w_collision_margin"));"b4w_collision_group"in c||(c.b4w_collision_group=128,b("material",c,"b4w_collision_group"));"b4w_collision_mask"in c||(c.b4w_collision_mask=127,b("material",c,"b4w_collision_mask"));"b4w_do_not_render"in c||(c.b4w_do_not_render=
!1,b("material",c,"b4w_do_not_render"));"HALO"!=c.type||"b4w_halo_sky_stars"in c||(c.b4w_halo_sky_stars=!1,b("material",c,"b4w_halo_sky_stars"));"HALO"!=c.type||"b4w_halo_stars_blend_height"in c||(c.b4w_halo_stars_blend_height=10,b("material",c,"b4w_halo_stars_blend_height"));"HALO"!=c.type||"b4w_halo_stars_min_height"in c||(c.b4w_halo_stars_min_height=0,b("material",c,"b4w_halo_stars_min_height"));"specular_shader"in c||(c.specular_shader="COOKTORR",b("material",c,"specular_shader"));"diffuse_shader"in
c||(c.diffuse_shader="LAMBERT",b("material",c,"diffuse_shader"));"roughness"in c||(c.roughness=.5,b("material",c,"roughness"));"diffuse_fresnel"in c||(c.diffuse_fresnel=.1,b("material",c,"diffuse_fresnel"));"diffuse_fresnel_factor"in c||(c.diffuse_fresnel_factor=.5,b("material",c,"diffuse_fresnel_factor"));"specular_slope"in c||(c.specular_slope=.2,b("material",c,"specular_slope"));"specular_toon_size"in c||(c.specular_toon_size=.5,b("material",c,"specular_toon_size"));"specular_toon_smooth"in c||
(c.specular_toon_smooth=.1,b("material",c,"specular_toon_smooth"));"specular_alpha"in c||(c.specular_alpha=1,b("material",c,"specular_alpha"));"b4w_wettable"in c||(c.b4w_wettable=!1,b("material",c,"b4w_wettable"));"b4w_refractive"in c||(c.b4w_refractive=!1,b("material",c,"b4w_refractive"));"b4w_refr_bump"in c||(c.b4w_refr_bump=0,b("material",c,"b4w_refr_bump"));"b4w_shallow_water_col"in c||(c.b4w_shallow_water_col=[0,.8,.3],b("material",c,"b4w_shallow_water_col"));"b4w_shore_water_col"in c||(c.b4w_shore_water_col=
[0,.9,.2],b("material",c,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in c||(c.b4w_shallow_water_col_fac=1,b("material",c,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in c||(c.b4w_shore_water_col_fac=.5,b("material",c,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in c||(c.b4w_water_sss_strength=5.9,b("material",c,"b4w_water_sss_strength"));"b4w_water_sss_width"in c||(c.b4w_water_sss_width=.45,b("material",c,"b4w_water_sss_width"));"b4w_render_above_all"in c||(c.b4w_render_above_all=
!1,b("material",c,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in c||(c.b4w_water_norm_uv_velocity=.05,b("material",c,"b4w_water_norm_uv_velocity"));"specular_ior"in c||(c.specular_ior=1,b("material",c,"specular_ior"));"darkness"in c||(c.darkness=0,b("material",c,"darkness"));"diffuse_toon_size"in c||(c.diffuse_toon_size=0,b("material",c,"diffuse_toon_size"));"diffuse_toon_smooth"in c||(c.diffuse_toon_smooth=0,b("material",c,"diffuse_toon_smooth"));"pass_index"in c||(c.pass_index=0,b("material",
c,"pass_index"));g=c.texture_slots;for(m=0;m<g.length;m++)e=g[m],"blend_type"in e||(e.blend_type="MIX",b("texture_slot",e,"blend_type"));if(c.node_tree){g=c.node_tree.nodes;for(m=0;m<g.length;m++)n(g[m]);c.node_tree.animation_data&&d(c.node_tree.animation_data)}}e=a.node_groups;for(h=0;h<e.length;h++)for(g=e[h].node_tree.nodes,m=0;m<g.length;m++)n(g[m]);g=a.objects;for(h=0;h<g.length;h++){e=g[h];switch(e.type){case "MESH":"b4w_dynamic_geometry"in e||(e.b4w_dynamic_geometry=!1);"b4w_reflexible"in e||
(e.b4w_reflexible=!1);"b4w_reflexible_only"in e||(e.b4w_reflexible_only=!1);"b4w_reflective"in e||(e.b4w_reflective=!1);"b4w_reflection_type"in e||(e.b4w_reflection_type="PLANE",b("object",e,"b4w_reflection_type"));"b4w_wind_bending"in e||(e.b4w_wind_bending=!1,b("object",e,"b4w_wind_bending"));"b4w_wind_bending_angle"in e||(e.b4w_wind_bending_angle=10,e.b4w_wind_bending_freq=.25,b("object",e,"wind bending params"));"b4w_detail_bending_amp"in e||(e.b4w_detail_bending_amp=.1,e.b4w_branch_bending_amp=
.3,b("object",e,"detail bending params"));"b4w_detail_bending_freq"in e||(e.b4w_detail_bending_freq=1,b("object",e,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in e||(e.b4w_main_bend_stiffness_col="",b("object",e,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in e||(e.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",e,"b4w_detail_bend_colors"));"b4w_caustics"in e||(e.b4w_caustics=!1);"vertex_groups"in e&&e.vertex_groups.length&&
e.data&&0==e.data.vertex_groups.length&&(e.data.vertex_groups=e.vertex_groups,delete e.vertex_groups,b("object",e,"vertex_groups"));"b4w_vertex_anim"in e&&e.b4w_vertex_anim.length&&e.data&&0==e.data.b4w_vertex_anim.length&&(e.data.b4w_vertex_anim=e.b4w_vertex_anim,delete e.b4w_vertex_anim,b("object",e,"b4w_vertex_anim"));"b4w_do_not_render"in e||(e.b4w_do_not_render=!1);"b4w_hidden_on_load"in e||(e.b4w_hidden_on_load=!1);"use_ghost"in e.game||(e.game.use_ghost=!1);"use_sleep"in e.game||(e.game.use_sleep=
!1);"velocity_min"in e.game||(e.game.velocity_min=0);"velocity_max"in e.game||(e.game.velocity_max=0);"collision_group"in e.game||(e.game.collision_group=1);"collision_mask"in e.game||(e.game.collision_mask=255);m=e;f=m.game;c=f.collision_bounds_type;f.use_collision_bounds&&"BOX"!=c&&"CYLINDER"!=c&&"CONE"!=c&&"SPHERE"!=c&&"CAPSULE"!=c&&"EMPTY"!=c&&(l.error("Wrong collision bounds type "+c+". Disable physics for object "+m.name),m.b4w_collision=!1,m.b4w_floating=!1,m.b4w_vehicle=!1,m.b4w_character=
!1);"b4w_vehicle_settings"in e?e.b4w_vehicle_settings&&("steering_ratio"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_ratio=10),"steering_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_max=1),"inverse_control"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.inverse_control=!1),"force_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.force_max=1500),"brake_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.brake_max=100),"speed_ratio"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.water_rot_damp=.9)):(e.b4w_vehicle_settings=null,b("object",e,"b4w_vehicle_settings"));"b4w_floating_settings"in e?e.b4w_floating_settings&&("floating_factor"in e.b4w_floating_settings||(e.b4w_floating_settings.floating_factor=3),"water_lin_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_rot_damp=
.8)):(e.b4w_floating_settings=null,b("object",e,"b4w_floating_settings"));"b4w_character_settings"in e?e.b4w_character_settings&&("walk_speed"in e.b4w_character_settings||(e.b4w_character_settings.walk_speed=4),"run_speed"in e.b4w_character_settings||(e.b4w_character_settings.run_speed=8),"step_height"in e.b4w_character_settings||(e.b4w_character_settings.step_height=.25),"jump_strength"in e.b4w_character_settings||(e.b4w_character_settings.jump_strength=5),"waterline"in e.b4w_character_settings||
(e.b4w_character_settings.waterline=0)):(e.b4w_character_settings=null,b("object",e,"b4w_character_settings"));"b4w_selectable"in e||(e.b4w_selectable=!1,b("object",e,"b4w_selectable"));"b4w_outlining"in e||(e.b4w_outlining=!1,b("object",e,"b4w_outlining"));"b4w_outline_on_select"in e||(e.b4w_outline_on_select=!1,b("object",e,"b4w_outline_on_select"));"b4w_billboard"in e||(e.b4w_billboard=!1,b("object",e,"b4w_billboard"));"b4w_billboard_geometry"in e||(e.b4w_billboard_geometry="SPHERICAL",b("object",
e,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in e||(e.b4w_pres_glob_orientation=!1,b("object",e,"b4w_pres_glob_orientation"));"b4w_outline_settings"in e||("b4w_glow_settings"in e?e.b4w_outline_settings=e.b4w_glow_settings:(e.b4w_outline_settings={},e.b4w_outline_settings.outline_duration=1,e.b4w_outline_settings.outline_period=1,e.b4w_outline_settings.outline_relapses=0),b("object",e,"b4w_outline_settings"));"b4w_lod_transition"in e||(e.b4w_lod_transition=.01,b("object",e,"b4w_lod_transition"));
"lod_levels"in e||(e.lod_levels=[],b("object",e,"lod_levels"));"b4w_animation_mixing"in e||(e.b4w_animation_mixing=!1,b("object",e,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in e||(e.b4w_anchor=null,b("object",e,"b4w_anchor")),!e.b4w_anchor||"max_width"in e.b4w_anchor||(e.b4w_anchor.max_width=250)}"collision_margin"in e.game||(e.game.collision_margin=.04,b("object",e,"collision_margin"));"b4w_anim_behavior"in e||(e.b4w_anim_behavior=e.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
e,"b4w_anim_behavior"));if(!("rotation_quaternion"in e)){m=[0,0,0,1];w.Pj(e.rotation_euler,m);var f=m,c=m[0],r=m[1],q=m[2];f[0]=m[3];f[1]=c;f[2]=r;f[3]=q;e.rotation_quaternion=m;b("object",e,"rotation_quaternion")}"webgl_do_not_batch"in e&&(e.b4w_do_not_batch=e.webgl_do_not_batch)&&t("object",e,"webgl_do_not_batch");"b4w_shadow_cast_only"in e||(e.b4w_shadow_cast_only=!1,b("object",e,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in e||(e.b4w_correct_bounding_offset="AUTO",b("object",e,"b4w_correct_bounding_offset"));
f=e.particle_systems;for(m=0;m<f.length;m++)c=f[m],r=c.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,b("particle_settings",r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,b("particle_settings",r,"use_whole_group")),c.transforms||(c.transforms=new Float32Array,b("particle_system",c,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",b("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=!1,b("object",r,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,b("object",r,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,b("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type="Z",b("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,b("particle_settings",r,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in r||(r.b4w_hair_billboard=
!1,b("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",b("particle_settings",r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,b("particle_settings",r,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,b("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in r||(r.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",b("particle_settings",r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",b("particle_settings",r,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",b("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name="",b("particle_settings",r,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",b("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system="LOCAL",b("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,b("particle_settings",r,"b4w_allow_nla")),"b4w_enable_soft_particles"in r||(r.b4w_enable_soft_particles=!1,b("particle_settings",r,"b4w_enable_soft_particles")),"b4w_particles_softness"in r||(r.b4w_particles_softness=1,b("particle_settings",r,"b4w_particles_softness")),
"billboard_tilt"in r||(r.billboard_tilt=0,b("particle_settings",r,"billboard_tilt")),"billboard_tilt_random"in r||(r.billboard_tilt_random=0,b("particle_settings",r,"billboard_tilt_random")),"use_rotations"in r||(r.use_rotations=!1,b("particle_settings",r,"use_rotations"));"constraints"in e||(e.constraints=[],b("object",e,"constraints"));f=e.modifiers;for(m=0;m<f.length;m++){a:{c=f[m];switch(c.type){case "ARRAY":if(!("fit_type"in c)){l.error("WARNING Incomplete modifier "+String(c.type)+' for "'+
e.name+'", reexport "'+a.b4w_filepath_blend+'" scene');c=!1;break a}}c=!0}c||(f.splice(m,1),m--)}"animation_data"in e||(e.animation_data={action:null,nla_tracks:[]},b("object",e,"animation_data"));e.animation_data&&("action"in e.animation_data||(e.animation_data.action=null,p("no action in animation data "+e.name)),"nla_tracks"in e.animation_data||(e.animation_data.nla_tracks=[],p("no NLA in animation data "+e.name)),d(e.animation_data));"b4w_collision_id"in e||(e.b4w_collision_id="",b("object",e,
"b4w_collision_id"));"b4w_viewport_alignment"in e||(e.b4w_viewport_alignment=null,b("object",e,"b4w_viewport_alignment"));"pinverse_tsr"in e||(e.pinverse_tsr=null,b("object",e,"pinverse_tsr"));"b4w_cluster_data"in e||(e.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",e,"b4w_cluster_data"));"pass_index"in e||(e.pass_index=0,b("object",e,"pass_index"));(0>e.scale[0]||0>e.scale[1]||0>e.scale[2])&&p('negative scale for object "'+e.name+'", can lead to some errors');m=
e.scale;0==m[0]&&0==m[1]&&0==m[2]?m=!0:(f=Math.abs((m[1]-m[2])/m[1]),m=.005>Math.abs((m[0]-m[1])/m[0])&&.005>f);m||p("non-uniform scale for object "+e.name)}for(var x in D)h=D[x],m=x.match(/.*?(?=>>|$)/i)[0],l.warn('Property "'+String(m)+'" is '+h.XK+' for "'+h.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.xR=function(a,b){"num_channels"in a||(a.num_channels=1,p('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.BQ=function(a){var b;a:{b=
a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=B(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var l=a[c];switch(l.type){case "ARRAY":for(var d=b,n=l,e=0,p=0,q=0,t=new Float32Array(16),l=[],r=1;r<n.count;r++){n.use_constant_offset&&(e+=n.constant_offset_displace[0],p+=n.constant_offset_displace[1],q+=n.constant_offset_displace[2]);if(n.use_relative_offset)var F=d.b4w_bounding_box,e=e+(F.max_x-F.min_x)*n.relative_offset_displace[0],
p=p+(F.max_y-F.min_y)*n.relative_offset_displace[1],q=q+(F.max_z-F.min_z)*n.relative_offset_displace[2];w.kZ(e,p,q,t);for(var D=F=B(d),G=t,K=C.fromMat4(G,N),K=h.fromMat3(K,I),v=0;v<D.submeshes.length;v++){var L=D.submeshes[v];w.jo(L.position,G,L.position,0);w.OK(L.tbn_quat,K,L.tbn_quat,0)}l.push(F)}for(r=0;r<l.length;r++)for(n=d,e=l[r],p=0;p<n.submeshes.length;p++){q=n.submeshes[p];t=e.submeshes[p];F=q.base_length;D=q.indices.length;q.base_length+=t.base_length;for(var M in q)if("base_length"!=M&&
"boundings"!=M)if("indices"==M)for(q[M]=w.tZ(q[M],t[M]),G=D;G<q.indices.length;G++)q.indices[G]+=F;else"vertex_colors"!=M&&(q[M]=w.cU(q[M],t[M]))}break;case "CURVE":for(d=b,r=x.ES(l.object),n=new Float32Array(16),p=r.Zj?4:3,e=new Float32Array(p),p=new Float32Array(p),q=new Float32Array(3),t=new Float32Array(4),F=new Float32Array(4),D=new Float32Array(3),G=new Float32Array(3),K=new Float32Array(3),new Float32Array(4),new Float32Array(4),v=0;v<d.submeshes.length;v++){var H=d.submeshes[v],L=H.position,
H=H.tbn_quat,Z;a:{Z=l.deform_axis;switch(Z){case "POS_X":case "NEG_X":Z=0;break a;case "POS_Y":case "NEG_Y":Z=1;break a;case "POS_Z":case "NEG_Z":Z=2;break a;default:w.q("Wrong deform axis value "+Z)}Z=void 0}D[0]=0;D[1]=0;D[2]=0;D[Z]=1;for(var ha=x.QY(r),u=0;u<L.length/3;u++){K[0]=L[3*u];K[1]=L[3*u+1];K[2]=L[3*u+2];var Q=K[Z],ca=x.PY(r,Q);x.RY(r,ca,e);q[0]=e[0];q[1]=e[1];q[2]=e[2];x.OY(r,ca,p);G[0]=p[0];G[1]=0;G[2]=p[2];f.normalize(G,G);h.rotationTo(D,G,t);0>Q?(e[0]=G[0],e[1]=G[1],e[2]=G[2],f.scale(e,
Q,e),f.add(q,e,q)):Q>ha&&(e[0]=G[0],e[1]=G[1],e[2]=G[2],f.scale(e,Q-ha,e),f.add(q,e,q));g.fromRotationTranslation(t,q,n);r.Zj&&(h.setAxisAngle(D,e[3],F),f.transformQuat(K,F,K));K[Z]=0;f.transformMat4(K,n,K);L[3*u]=K[0];L[3*u+1]=K[1];L[3*u+2]=K[2];H.length&&(I[0]=H[4*u],I[1]=H[4*u+1],I[2]=H[4*u+2],I[3]=H[4*u+3],h.multiply(I,t,I),H[4*u]=I[0],H[4*u+1]=I[1],H[4*u+2]=I[2],H[4*u+3]=I[3])}}}m.mX(b)}return b};a.tS=function(){return{name:"DEFAULT",uuid:w.GA(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,
.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.IQ=function(a,b){function c(b,c){for(var d in b){var e=b[d],f=e[0];if(1<e.length)for(var h=1;h<e.length;h++)f+="*"+e[h];for(h=0;h<a.length;h++)if(e=a[h],e.name==f)for(var g in c)e[g]=c[g]}}for(var d=b.b4w_logic_nodes,f=0;f<d.length;f++)for(var g=d[f],e=0;e<g.length;e++){var h=g[e],l={register1:"variable1",register2:"variable2",registerd:"variabled"},m;for(m in l)m in h&&(h[l[m]]=h[m]);for(var n in h.variables)"boolean"!=
typeof h.variables[n][0]&&(h.variables[n]=[!1,h.variables[n]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(h.type)&&("variable1"in h&&(h.variables.v1=[!1,h.variable1]),"variable2"in h&&(h.variables.v2=[!1,h.variable2]),"variabled"in h&&(h.variables.vd=[!1,h.variabled]));switch(h.type){case "SELECT":for(var t=0;t<a.length;t++)l=a[t],l.name==h.object&&(l.b4w_selectable=!0);h.bools||(h.bools={});h.bools.not_wait||(h.bools.not_wait=!1);p('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(h.objects_paths,
{b4w_selectable:!0});if(h.links instanceof Array){p('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var l={},r=0;for(t in h.objects_paths)l[t]=h.links[r],r++;h.links=l}break;case "SELECT_PLAY":p('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');h.mute=!0;break;case "SELECT_PLAY_ANIM":p('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(h.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(h.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(h.objects_paths,{b4w_do_not_batch:!0});switch(h.common_usage_names.space_type){case "WORLD":h.common_usage_names.space_type=K.LO;break;case "PARENT":h.common_usage_names.space_type=K.KO;break;case "LOCAL":h.common_usage_names.space_type=K.JO}break;case "OUTLINE":c(h.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":h.condition&&(h.common_usage_names.condition=
h.condition);if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=K.EE;break;case "LEQUAL":h.common_usage_names.condition=K.GE;break;case "GREATER":h.common_usage_names.condition=K.FE;break;case "LESS":h.common_usage_names.condition=K.HE;break;case "NOTEQUAL":h.common_usage_names.condition=K.IE;break;case "EQUAL":h.common_usage_names.condition=K.DE}void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&
(h.input2=h.number2);h.bools||(h.bools={});void 0===h.bools.str&&(h.bools.str=!1,h.floats.inp1=h.input1,h.floats.inp2=h.input2);break;case "SEND_REQ":h.bools||(h.bools={});h.strings||(h.strings={});void 0===h.bools.ct&&(h.bools.ct=!1);void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "MATH":void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&(h.input2=h.number2);void 0!=h.input1&&(h.floats.inp1=h.input1);void 0!=h.input2&&(h.floats.inp2=h.input2);break;case "REGSTORE":h.floats||
(h.floats={});h.strings||(h.strings={});void 0!=h.number1&&(h.input1=h.number1);if(void 0!=h.input1)switch(typeof h.input1){case "number":h.floats.inp1=h.input1;h.common_usage_names.variable_type="NUMBER";break;default:h.strings.inp1=h.input1,h.common_usage_names.variable_type="STRING"}switch(h.common_usage_names.variable_type){case "NUMBER":h.common_usage_names.variable_type=K.MO;break;case "STRING":h.common_usage_names.variable_type=K.NO}break;case "PAGEPARAM":h.bools||(h.bools={});void 0===h.bools.hsh&&
(h.bools.hsh=!1);h.floats||(h.floats={});void 0===h.floats.ptp&&(h.floats.ptp=0);break;case "PLAY_ANIM":c(h.objects_paths,{b4w_do_not_batch:!0});h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);(l=h.common_usage_names.param_anim_behavior)||(l="FINISH_STOP");h.common_usage_names.param_anim_behavior=G.ez(l);break;case "STOP_ANIM":h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);break;case "STRING":switch(h.common_usage_names.string_operation){case "JOIN":h.common_usage_names.string_operation=
K.GO;break;case "FIND":h.common_usage_names.string_operation=K.FO;break;case "REPLACE":h.common_usage_names.string_operation=K.HO;break;case "SPLIT":h.common_usage_names.string_operation=K.IO;break;case "COMPARE":h.common_usage_names.string_operation=K.EO}if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=K.EE;break;case "LEQUAL":h.common_usage_names.condition=K.GE;break;case "GREATER":h.common_usage_names.condition=
K.FE;break;case "LESS":h.common_usage_names.condition=K.HE;break;case "NOTEQUAL":h.common_usage_names.condition=K.IE;break;case "EQUAL":h.common_usage_names.condition=K.DE}break;case "REDIRECT":void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "SET_CAMERA_MOVE_STYLE":switch(h.common_usage_names.camera_move_style){case "STATIC":h.common_usage_names.camera_move_style=K.xO;break;case "TARGET":h.common_usage_names.camera_move_style=K.yO;break;case "EYE":h.common_usage_names.camera_move_style=
K.vO;break;case "HOVER":h.common_usage_names.camera_move_style=K.wO}break;case "ENTRYPOINT":h.bools||(h.bools={});void 0===h.bools.js&&(h.bools.js=!1);h.bools.js&&(h.mute=!0);break;case "JS_CALLBACK":for(m in h=h.common_usage_names.js_cb_params,h)switch(h[m]){case "OBJECT":h[m]=K.zO;break;case "VARIABLE":h[m]=K.AO}}}}};b4w.module.camera=function(a,r){function n(a,b){g.Bb("camera.set_pivot","camera.target_set_trans_pivot");d.Fa(a)?(C.copy(b,a.k.pivot),h.D(a),x.H(a)):g.error("set_pivot(): Wrong object or camera move style")}var d=r("__camera");r("__config");var b=r("__constraints"),t=r("__container"),p=r("__mat4"),B=r("__math"),m=r("__obj_util"),x=r("__physics"),g=r("__print"),l=r("__scenes"),h=r("__transform"),w=r("__tsr"),f=r("__util"),C=r("__vec3"),K=r("__vec4"),G=r("__quat"),L=new Float32Array(2),D=new Float32Array(3),
N=new Float32Array(3);new Float32Array(4);var I=G.create();new Float32Array(9);var O={},E={};a.xg=d.xg;a.Jb=d.Jb;a.od=d.od;a.cd=d.cd;a.g8=function(a,b){if(m.wa(a)){d.Ns(a);a.k.tb=d.xg;if(b){var f=b.pos||w.F(a.k.n);b.look_at?d.Iw(a,f,b.look_at):h.Vc(a,f)}h.D(a);x.H(a);d.Nn(a)}else g.error("static_setup(): Wrong camera object")};a.e8=function(a,b,f){d.Rn(a)?(b=b||w.F(a.k.n),f?d.Iw(a,b,f):h.Vc(a,b),h.D(a),x.H(a)):g.error("static_set_look_at(): Wrong camera object or camera move style")};a.f8=function(a,
b){d.Rn(a)?(h.bi(a,b),h.D(a),x.H(a)):g.error("static_set_rotation(): Wrong camera object or camera move style")};a.d8=function(a,b){if(!d.Rn(a))return g.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return h.In(a,b)};a.n3=function(a,b){m.wa(a)?b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right)?g.error("eye_setup(): Wrong horizontal limits object."):b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||
"number"!=typeof b.vert_rot_lim.up)?g.error("eye_setup(): Wrong vertical limits object."):(d.Ns(a),a.k.tb=d.od,b&&d.QL(a,b.pos||w.F(a.k.n),b.look_at,b.horiz_rot_lim,b.vert_rot_lim),h.D(a),x.H(a),d.Nn(a)):g.error("eye_setup(): Wrong camera object")};a.m3=function(a,f,l){d.tc(a)?(f=f||w.F(a.k.n),l?d.eY(a,f,l):h.Vc(a,f),b.Kj(a,a.k.lf,!0),h.D(a),x.H(a)):g.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Kq=function(a,b,f){var l,e;d.tc(a)?(d.bs(a,b,f,l||!1,e||!1),h.D(a),x.H(a)):
g.error("eye_rotate(): Wrong camera object or camera move style")};a.VT=function(a,b){d.tc(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.ML(a,b),h.D(a),x.H(a)):g.error("eye_set_vertical_limits(): Incorrect limits object."):g.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.l3=function(a,b,f){if(!d.tc(a))return g.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.ka?(b=b||{},f?(b.down=a.ka.un,b.up=a.ka.Uo):(b.down=
a.ka.down,b.up=a.ka.up),b.camera_space=f||!1,b):null};a.UT=function(a,b){d.tc(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.zL(a,b),h.D(a),x.H(a)):g.error("eye_set_horizontal_limits(): Incorrect limits object."):g.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.k3=function(a,b,f){if(!d.tc(a))return g.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.lb?(b=b||{},f?(b.left=a.lb.Vn,b.right=a.lb.po):(b.left=
a.lb.left,b.right=a.lb.right),b.camera_space=f||!1,b):null};a.q8=function(a,b){if(m.wa(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){g.error("target_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);
b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.Pr&&("number"!=typeof b.Pr.min_y||"number"!=typeof b.Pr.max_y||b.Pr.min_y>b.Pr.max_y)?g.error("target_setup(): Wrong pivot limits object"):(d.Ns(a),a.k.tb=d.Jb,d.SL(a,b.pos||w.F(a.k.n),b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Pr,b.use_panning||!1),h.D(a),x.H(a),d.Nn(a))}else g.error("target_setup(): Wrong vertical limits object");else g.error("target_setup(): Wrong horizontal limits object");else g.error("target_setup(): Wrong camera object")};
a.vs=function(a,b,f){var l,e;d.Fa(a)?(d.ww(a,b,f,l||!1,e||!1),h.D(a),x.H(a)):g.error("target_rotate(): Wrong camera object or camera move style")};a.p8=function(a,b,f){d.Fa(a)?(b=b||w.F(a.k.n),f=f||a.k.pivot,d.ls(a,b,f),h.D(a),x.H(a)):g.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.o8=function(a,b){d.Fa(a)?(d.kY(a,b),h.D(a),x.H(a)):g.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.dZ=function(a,b){if(d.Fa(a)){var f=h.co(a,a.k.pivot),
l=Math.max(0,b);h.ah(a,0,0,l-f);h.D(a);x.H(a)}else g.error("target_set_distance(): Wrong camera object or camera move style")};a.wD=function(a){return d.Fa(a)?h.co(a,a.k.pivot):(g.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.s8=function(a,b){if(d.Fa(a)){var f=h.Nu(b,!1,D),n=h.Ou(b),e=l.B(),e=m.ja(a,e).ba[0],e=d.ZH(e)/2,n=n/Math.sin(e),e=h.co(a,f);d.ls(a,w.F(a.k.n),f);h.D(a);h.ah(a,0,0,n-e);h.D(a);x.H(a)}else g.error("target_zoom_object(): Wrong camera object or camera move style")};
a.bZ=function(a,b){if(!d.Fa(a))return g.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);C.copy(a.k.pivot,b);return b};a.DM=function(a,b){if(d.Fa(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){g.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.UX(a,b);h.D(a);x.H(a)}else g.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.j8=
function(a,b){if(!d.Fa(a))return g.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.sb?(b=b||{},b.min=f.sb.min,b.max=f.sb.max,b):null};a.fZ=function(a,b){d.Fa(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.ML(a,b),h.D(a),x.H(a)):g.error("target_set_vertical_limits(): Wrong limits object"):g.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.m8=function(a,b,f){if(!d.Fa(a))return g.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.ka?(b=b||{},f?(b.down=a.ka.un,b.up=a.ka.Uo):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=f||!1,b):null};a.eZ=function(a,b){d.Fa(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.zL(a,b),h.D(a),x.H(a)):g.error("target_set_horizontal_limits(): Wrong limits object"):g.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.k8=function(a,b,f){if(!d.Fa(a))return g.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.lb?(b=b||{},f?(b.left=a.lb.Vn,b.right=a.lb.po):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=f||!1,b):null};a.n8=function(a,b){d.Fa(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?g.error("target_set_pivot_limits(): Wrong limits object"):(d.gY(a,b),h.D(a),x.H(a)):g.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.l8=function(a,b){if(!d.Fa(a))return g.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var f=a.k;return f.ae?(b=b||{},b.min_z=f.ae.min_z,b.max_z=f.ae.max_z,b):null};a.cZ=function(a,b,f){if(d.Fa(a)){var l=a.k;l.use_panning&&(D[0]=b,D[1]=-f,D[2]=0,w.xd(D,l.n,D),C.add(l.pivot,D,l.pivot),b=w.F(l.n),C.add(b,D,b),h.D(a),x.H(a))}else g.error("target_pan_pivot(): wrong object")};a.r8=function(a,b){if(!d.Fa(a))return g.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.A5=function(b,g){a.uV(b,{pos:g.pos,pivot:g.pivot});var l="undefined"==
typeof g.dist_interval?0:Math.max(g.dist_interval,0),m="undefined"==typeof g.angle_interval?0:Math.max(g.angle_interval,0),e="undefined"==typeof g.t?.5:f.V(g.t,0,1),n=a.lJ(b,O);n.min=Math.max(n.min-e*l,0);n.max+=(1-e)*l;l=a.mJ(b,E);l.down=f.V(l.down+e*m,-Math.PI/2,0);l.up=f.V(l.up-(1-e)*m,-Math.PI/2,0);d.lv(b,n);d.mv(b,l);h.D(b);x.H(b);d.Nn(b)};a.uV=function(a,b){if(m.wa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){g.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up)?g.error("hover_setup(): Wrong hover angle limits object"):b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max)?g.error("hover_setup(): Wrong horizontal translation limits object"):
b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max)?g.error("hover_setup(): Wrong vertical translation limits object"):(d.Ns(a),a.k.tb=d.cd,d.RL(a,b.pos||w.F(a.k.n),b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1),h.D(a),x.H(a),d.Nn(a))}else g.error("hover_setup(): Wrong camera object")};a.nJ=function(a,b,f){var l,e;d.$a(a)?(d.cs(a,b,f,l||!1,e||!1),h.D(a),x.H(a)):
g.error("hover_rotate(): Wrong camera object or camera move style")};a.z5=function(a,b){d.$a(a)?(d.Hw(a,b),h.D(a),x.H(a)):g.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.x5=function(a,b){if(!d.$a(a))return g.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);C.copy(a.k.Tb,b);return b};a.rV=function(a){return d.$a(a)?h.co(a,a.k.Tb):(g.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.mv=
function(a,b){d.$a(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?g.error("hover_set_vertical_limits(): Wrong limits object"):(d.mv(a,b),h.D(a),x.H(a)):g.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.mJ=function(a,b){if(!d.$a(a))return g.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var f=a.k;b=b||{};b.down=f.ka.down;b.up=f.ka.up;return b};a.lv=function(a,b){d.$a(a)?"number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max?g.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.lv(a,b),h.D(a),x.H(a)):g.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.lJ=function(a,b){if(!d.$a(a))return g.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.k;b=b||{};b.min=f.sb.min;b.max=f.sb.max;return b};a.tV=function(a,b){d.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?
g.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.qY(a,b),h.D(a),x.H(a)):g.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.y5=function(a,b){if(!d.$a(a))return g.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.zc?(b=b||{},b.min=f.zc.min,b.max=f.zc.max,b):null};a.sV=function(a,b){d.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?g.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(d.$X(a,b),h.D(a),x.H(a)):g.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.w5=function(a,b){if(!d.$a(a))return g.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.yc?(b=b||{},b.min=f.yc.min,b.max=f.yc.max,b):null};a.B5=function(a,b){if(!d.$a(a))return g.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Jh=b};a.Rn=d.Rn;a.Fa=d.Fa;a.tc=d.tc;a.$a=d.$a;a.UC=function(a,b){if(!m.wa(a))return g.error("set_move_style(): Wrong camera object"),
!1;if(b!=d.xg&&b!=d.od&&b!=d.Jb&&b!=d.cd)return g.error("set_move_style(): Wrong move style"),!1;d.UC(a,b);h.D(a);x.H(a);return!0};a.Wl=function(a){return m.wa(a)?d.Wl(a):(g.error("get_move_style(): Wrong camera object"),null)};a.Vc=function(a,b){if(m.wa(a)){var f=a.k;if(d.Fa(a)){var l=w.F(f.n),l=C.subtract(b,l,D);C.add(l,f.pivot,f.pivot)}else d.$a(a)&&(l=w.F(f.n),l=C.subtract(b,l,D),C.add(l,f.Tb,f.Tb));h.Vc(a,b);h.D(a);x.H(a)}else g.error("set_translation(): Wrong camera object")};a.Bf=function(a,
b){if(!m.wa(a))return g.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return h.Bf(a,b)};a.O6=function(a,b,f,l,e){m.wa(a)?(l=l||!1,e=e||!1,d.Fa(a)?d.ww(a,b,f,l,e):d.tc(a)?d.bs(a,b,f,l,e):d.$a(a)?d.cs(a,b,f,l,e):d.Rn(a)?g.warn("rotate_camera(): not supported for STATIC cameras"):g.error("rotate_camera(): Wrong camera move style"),h.D(a),x.H(a)):g.error("rotate_camera(): Wrong camera object")};a.oY=function(a,b){if(m.wa(a)){var d=a.k;"number"==typeof b.trans&&(d.Tk=f.V(b.trans,
0,Infinity));"number"==typeof b.rot&&(d.Sk=f.V(b.rot,0,Infinity));"number"==typeof b.zoom&&(d.Uk=f.V(b.zoom,0,.99))}else g.error("set_velocities(): Wrong camera object")};a.Oh=function(a,b){if(!m.wa(a))return g.error("get_velocities(): Wrong camera object"),null;var d=a.k;b=b||{};b.trans=d.Tk;b.rot=d.Sk;b.zoom=d.Uk;return b};a.L5=function(a){return m.wa(a)?0<=f.lc(w.R(a.k.n),f.$c,D)[1]:(g.error("is_look_up(): Wrong camera object"),!1)};a.En=function(a,b){if(!m.wa(a))return g.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);d.En(a,b);return b};a.Ju=function(a,b){if(!m.wa(a))return g.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.Ju(a,b);return b};a.H3=function(a,b){b=b||new Float32Array(2);var h=C.normalize(a,D),h=f.JC(f.$c,h,I);f.Sz(h,!0);d.NA(h,b);return b};a.JL=function(a,b){if(m.wa(a))for(var f=l.B(),f=m.ja(a,f).ba,h=0;h<f.length;h++){var e=f[h];e.type!=d.Mc&&e.type!=d.ed&&e.type!=d.Le&&e.type!=d.Me||d.jY(e,b,e.hf)}else g.error("set_stereo_distance(): Wrong camera object")};
a.QI=function(a){if(!m.wa(a))return g.error("get_stereo_distance(): Wrong camera object"),0;var b=l.B();a=m.ja(a,b).ba;for(b=0;b<a.length;b++){var f=a[b];if(f.type==d.Mc||f.type==d.ed)return f.Hk}return 0};a.PC=function(a,b){if(m.wa(a)){var f=l.B(),f=m.ja(a,f).ba;d.PC(f,b)}else g.error("set_eye_distance(): Wrong camera object")};a.W3=function(a){if(!m.wa(a))return g.error("get_eye_distance(): Wrong camera object"),0;var b=l.B();a=m.ja(a,b).ba;for(b=0;b<a.length;b++){var f=a[b];if(f.type==d.Mc||f.type==
d.ed||f.type==d.Le||f.type==d.Me)return f.hf}return 0};a.L7=function(a,b){m.wa(a)?(C.copy(b,a.k.lf),h.D(a),x.H(a)):g.error("set_vertical_axis(): Wrong camera object")};a.Y4=function(a,b){if(m.wa(a))return b||(b=C.create()),C.copy(a.k.lf,b),b;g.error("get_vertical_axis(): Wrong camera object")};a.y8=function(a,b,f,h){if(m.wa(a)){var e=l.B();a=m.ja(a,e).ba;for(e=0;e<a.length;e++){var n=a[e];n.mc||d.Bk(n,n.zb);var q=D;q[0]=-b;q[1]=-f;q[2]=0;p.translate(n.wb,q,n.wb);p.rotateZ(n.wb,h,n.wb);d.hG(n);d.xz(n)}}else g.error("translate_view(): Wrong camera object")};
a.b5=function(a,b){if(!m.wa(a))return g.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);f.lc(w.R(a.k.n),f.$c,b);return b};a.QU=function(a){if(!m.wa(a))return g.error("get_fov(): Wrong camera object"),0;var b=l.B();a=m.ja(a,b).ba;return f.Lb(a[0].Vd)};a.h7=function(a,b){if(m.wa(a))for(var h=l.B(),h=m.ja(a,h).ba,n=0;n<h.length;n++){var e=h[n];e.Vd=f.df(b);e.mc||d.Bk(e,e.zb);d.hG(e);d.xz(e)}else g.error("set_fov(): Wrong camera object")};a.TC=function(a,b,f){var h;if(!(h=
m.wa(a)))a:{if(m.wa(a)){h=l.B();h=m.ja(a,h).ba;for(var e=0;e<h.length;e++){var n=h[e];if(n.type==d.Le||n.type==d.Me){h=!0;break a}}}else g.error("is_hmd_camera(): Wrong camera object");h=!1}h?b&&f&&d.TC(a,b,f):g.error("set_hmd_fov(): Wrong camera object")};a.Kj=function(a,d,f){m.wa(a)?(d=d||a.k.lf,b.Kj(a,d,f||!1),h.D(a),x.H(a)):g.error("correct_up(): Wrong camera object")};a.x7=function(a,b){if(m.wa(a)&&d.zv(a)){var f=a.k;if(d.Fa(a)){var h=w.F(f.n),h=C.dist(h,f.pivot);f.Yj=b/2*f.Xj/h}else d.$a(a)?
(h=w.F(f.n),h=C.distance(h,f.Tb),f.Yj=b/2*f.Xj/h):(f=l.B(),m.ja(a,f).ba[0].top=b/2);d.QZ(a)}else g.error("set_ortho_scale(): Wrong camera object")};a.w4=function(a){if(!m.wa(a)||!d.zv(a))return g.error("get_ortho_scale(): Wrong camera object"),0;var b=l.B();return 2*m.ja(a,b).ba[0].top};a.zv=function(a){return m.wa(a)?d.zv(a):(g.error("is_ortho_camera(): Wrong camera object"),!1)};a.U1=function(a,b,n,p){if(!m.wa(a))return g.error("calc_ray(): Wrong camera object"),null;var e=l.B(),r=m.ja(a,e).ba[0];
p&&3==p.length?g.N('dest parameter in the function "calc_ray" should be type of parametric line.'):p=p||new Float32Array(6);switch(r.type){case d.Od:case d.yh:case d.Mc:case d.ed:var q=Math.tan(r.Vd*Math.PI/360),x=q*r.zb,e=D;b=t.Qt(b,n,L,r);e[0]=(2*b[0]/r.width-1)*x;e[1]=(1-2*b[1]/r.height)*q;e[2]=-1;w.xd(e,a.k.n,e);C.normalize(e,e);3==p.length?C.copy(e,p):(a=h.Bf(a,N),B.DL(p,a),B.XC(p,e));return p;case d.se:return e=D,b=t.Qt(b,n,L,r),e[0]=(2*b[0]/r.width-1)*r.top*r.zb,e[1]=(1-2*b[1]/r.height)*r.top,
e[2]=0,w.Wc(e,a.k.n,e),C.copy(e,p),C.transformQuat(f.$c,w.R(a.k.n),e),B.XC(p,e),p;default:return g.error("calc_ray(): Non-compatible camera"),p}};a.oC=function(a,b,f){if(!m.wa(a))return g.error("project_point(): Wrong camera object"),null;f=f||new Float32Array(2);return d.oC(a,b,f)};a.i5=function(a){return(d.Fa(a)||d.$a(a))&&null!==a.k.sb};a.r5=function(a){return(d.tc(a)||d.Fa(a)||d.$a(a))&&null!==a.k.ka};a.q5=function(a){g.Bb("has_vertical_limits","has_vertical_rot_limits");return d.Fa(a)||d.tc(a)?
null!==a.k.ka:(g.error("has_vertical_limits(): Wrong camera object"),!1)};a.k5=function(a){return(d.Fa(a)||d.tc(a))&&null!==a.k.lb};a.j5=function(a){g.Bb("has_horizontal_limits","has_horizontal_rot_limits");return d.Fa(a)||d.tc(a)?null!==a.k.lb:(g.error("has_horizontal_limits(): Wrong camera object"),!1)};a.s5=function(a){return d.$a(a)&&null!==a.k.zc};a.l5=function(a){return d.$a(a)&&null!==a.k.yc};a.d6=function(a,b,f){g.Bb("move_pivot","target_pan_pivot");if(d.Fa(a)){var l=a.k;if(l.use_panning){var e=
w.F(l.n),m=C.subtract(e,l.pivot,N);D[0]=b;D[1]=0;D[2]=f;C.scale(D,C.len(m),D);w.xd(D,l.n,D);C.add(l.pivot,D,l.pivot);C.add(e,D,e);h.D(a);x.H(a)}}else g.error("move_pivot(): wrong object")};a.K7=function(a,b){g.Bb("set_velocity_params","set_velocities");if(m.wa(a)){var d=a.k;d.Tk=f.V(b[0],0,Infinity);d.Sk=f.V(b[1],0,Infinity);d.Uk=f.V(b[2],0,.99)}else g.error("set_velocity_params(): Wrong camera object")};a.X4=function(a,b){g.Bb("get_velocity_params","get_velocities");if(!m.wa(a))return g.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var d=a.k;b[0]=d.Tk;b[1]=d.Sk;b[2]=d.Uk;return b};a.q2=function(a){g.N('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');m.wa(a)?d.Fa(a)||d.tc(a)?a.k.lb=null:d.$a(a)&&(a.k.yc=null):g.error("clear_horizontal_limits(): Wrong camera object")};a.u2=function(a){g.N('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
m.wa(a)?d.Fa(a)||d.tc(a)?a.k.ka=null:d.$a(a)&&(a.k.zc=null):g.error("clear_vertical_limits(): Wrong camera object")};a.r2=function(){g.N("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.Iw=function(a,f,l,m){g.Kh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);m=m||a.k.lf;d.Iw(a,f,l);b.Kj(a,m,!0);h.D(a);x.H(a)};a.bs=function(a,b,f,l,e){g.Kh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);d.tc(a)?(d.bs(a,
b,f,l,e),h.D(a),x.H(a)):g.error("rotate_eye_camera(): wrong object")};a.ww=function(a,b,f,l,e){g.Kh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);d.Fa(a)?(d.ww(a,b,f,l,e),h.D(a),x.H(a)):g.error("rotate_target_camera(): wrong object")};a.ls=function(a,b,f){g.Bb("camera.set_trans_pivot","camera.target_set_trans_pivot");d.Fa(a)?(d.ls(a,b,f),h.D(a),x.H(a)):g.error("set_trans_pivot(): Wrong object or camera move style")};a.V8=function(a,b){g.Bb("camera.zoom_object","camera.target_zoom_object");
if(d.Fa(a)){h.Nu(b,!1,D);n(a,D);h.D(a);var f=h.Ou(b),p=l.B(),p=m.ja(a,p).ba[0],p=d.ZH(p)/2,f=f/Math.sin(p),p=h.co(a,D);h.ah(a,0,0,f-p);h.D(a);x.H(a)}else g.error("zoom_object(): wrong object")};a.y7=n;a.cs=function(a,b,f,l,e){g.Bb("camera.rotate_hover_camera","camera.hover_rotate");d.$a(a)?(d.cs(a,b,f,l,e),h.D(a),x.H(a)):g.error("rotate_hover_camera(): wrong object")};a.j4=function(a,b){g.Bb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!d.$a(a))return g.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));C.copy(a.k.Tb,b);return b};a.oI=function(a,b){g.Bb("camera.get_eye","camera.get_translation");return m.wa(a)?d.oI(a,b):(g.error("get_eye(): Wrong object"),null)};a.z4=function(a,b){g.Bb("camera.get_pivot","camera.target_get_pivot");if(!d.Fa(a))return g.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));C.copy(a.k.pivot,b);return b};a.v5=function(a,b){g.Bb("camera.hover_cam_set_translation","camera.set_translation");if(d.$a(a)){var f=
a.k,l=C.subtract(b,w.F(f.n),D);C.add(l,f.Tb,f.Tb);h.Vc(a,b);h.D(a);x.H(a)}else g.error("hover_cam_set_translation(): wrong object")};a.Hw=function(a,b){g.Bb("camera.set_hover_pivot","camera.hover_set_pivot_translation");d.$a(a)?(d.Hw(a,b),h.D(a),x.H(a)):g.error("set_hover_pivot(): Wrong object or camera move style")};a.i4=function(a,b){g.Bb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!d.$a(a))return g.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.ka.down;b[1]=a.k.ka.up;return b};a.G3=function(a,b){g.Kh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!d.$a(a)&&!d.Fa(a))return g.error("get_cam_dist_limits(): wrong object"),null;if(a.k.sb)b=b||new Float32Array(2),b[0]=a.k.sb.max,b[1]=a.k.sb.min;else return null;return b};a.I1=function(b,f,l,m){g.Kh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(d.Fa(b)){var e=O;e.down=f;e.up=l;e.camera_space=m==h.cn;a.fZ(b,e)}else d.tc(b)?(e=O,e.down=f,e.up=l,e.camera_space=m==h.cn,a.VT(b,e)):d.$a(b)?(e=O,e.min=f,e.max=l,a.tV(b,e)):g.error("apply_vertical_limits(): wrong object")};a.F1=function(b,d,f){g.Bb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");O.down=d;O.up=f;a.mv(b,O)};a.B1=function(b,f,h){g.Kh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(d.Fa(b)){var l=O;
l.min=f;l.max=h;a.DM(b,l)}else d.$a(b)?(l=O,l.min=f,l.max=h,a.lv(b,l)):g.error("apply_distance_limits(): wrong object")};a.o2=function(b){g.Bb("camera.clear_distance_limits","camera.target_set_distance_limits");a.DM(b,null)};a.Z4=function(a,b){g.Kh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!d.Fa(a)&&!d.tc(a)&&!d.$a(a))return g.error("get_vertical_limits(): wrong object"),null;var f=a.k;b=b||new Float32Array(2);
if(d.tc(a)||d.Fa(a)){if(f.ka)return b[0]=f.ka.down,b[1]=f.ka.up,b}else if(d.$a(a)&&f.zc)return b[0]=f.zc.min,b[1]=f.zc.max,b;return null};a.E1=function(b,f,l,m){g.Kh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(d.Fa(b)){var e=O;e.left=f;e.right=l;e.camera_space=m==h.cn;a.eZ(b,e)}else d.tc(b)?(e=O,e.left=f,e.right=l,e.camera_space=m==h.cn,a.UT(b,e)):d.$a(b)?(e=O,e.min=f,e.max=l,a.sV(b,e)):g.error("apply_horizontal_limits(): wrong object")};
a.h4=function(a,b){g.Kh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!d.Fa(a)&&!d.tc(a)&&!d.$a(a))return g.error("get_horizontal_limits(): wrong object"),null;var f=a.k;b=b||new Float32Array(2);if(d.tc(a)||d.Fa(a)){if(f.lb)return b[0]=f.lb.left,b[1]=f.lb.right,b}else if(d.$a(a)&&f.yc)return b[0]=f.yc.min,b[1]=f.yc.max,b;return null};a.g4=function(a,b){if(!m.wa(a))return g.error("get_frustum_planes(): Wrong camera object"),
null;var d=l.B(),d=m.ja(a,d).ba[0].Lh;K.copy(d.left,b.left);K.copy(d.right,b.right);K.copy(d.top,b.top);K.copy(d.bottom,b.bottom);K.copy(d.near,b.near);K.copy(d.far,b.far);return b}};b4w.module.config=function(a,r){var n=r("__config"),d=r("__compat"),b=r("__debug"),t=r("__data"),p=r("__print");a.sp=n.sp;a.al=n.al;a.Zm=n.Zm;a.TE=n.TE;a.rp=n.rp;a.set=n.set;a.get=n.get;a.reset=n.reset;a.DC=n.DC;a.K4=n.Hu;a.Hu=n.Hu;a.hn=function(a){t.Wg()?p.error("Cannot change quality profile after a scene is loaded."):(n.set("quality",a),b.Mu()&&(n.hn(),d.yL(b.Mu(),!1)))}};b4w.module.constraints=function(a,r){var n=r("__camera"),d=r("__constraints"),b=r("__obj_util"),t=r("__physics"),p=r("__print"),B=r("__transform");a.y1=function(a,b,g,l,h){h=h||1;b instanceof Array&&2==b.length?d.qQ(a,b[0],b[1],g,l,h):d.zF(a,b,g,l,h);B.D(a);t.H(a)};a.w1=function(a,b,g,l){d.oQ(a,b,g,l);B.D(a);t.H(a)};a.x1=function(a,b,g,l,h,r,f,C){n.tc(a)?(h=h||-Math.PI/2,r=r||Math.PI/2,f=f||Math.PI/2,C=C||-Math.PI/2,d.nQ(a,b,g,l,h,r,f,C),B.D(a),t.H(a)):p.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.u1=function(a,b,g,l){if(n.tc(a)){if(!l||0>l)l=.25;d.mQ(a,b,g,l);B.D(a);t.H(a)}else p.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.sQ=function(a,b){d.tQ(a,b);B.D(a);t.H(a)};a.p1=function(a,b,g){d.gQ(a,b,g);B.D(a);t.H(a)};a.z1=function(a,b,g,l){d.uQ(a,b,g,l);B.D(a);t.H(a)};a.A1=function(a,b){3==b.length?d.xQ(a,b):d.wQ(a,b);B.D(a);t.H(a)};a.s1=function(a,b,g,l){3==b.length?d.jQ(a,b,g,l):d.iQ(a,b,g,l);B.D(a);t.H(a)};a.gz=function(a,b,g){d.gz(a,b,g);
B.D(a);t.H(a)};a.remove=function(a){a.ic&&d.remove(a)};a.Pu=function(a){p.Bb("constraints.get_parent","objects.get_parent");return b.Pu(a)}};b4w.module.container=function(a,r){var n=r("__container"),d=r("__print");a.Fn=n.Fn;a.hI=n.hI;a.We=n.We;a.sv=function(a,t){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&t&&n.sv(a,t)};a.jL=n.jL;a.WM=n.WM;a.Vt=n.Vt;a.EA=n.EA;a.resize=function(a,t,p){a&&t||d.warn("Wrong canvas container dimensions: "+a+"x"+t+". Zero dimensions aren't allowed. Resized to: "+n.Sx+"x"+n.Rx+".");n.resize(a,t,p)};a.wk=function(a){n.wk(a||!1)}};b4w.module.controls=function(a,r){var n=r("__controls"),d=r("__print");a.qf=n.qf;a.ub=n.ub;a.Qx=n.Qx;a.vg=n.vg;a.fp=n.fp;a.Px=n.Px;a.i0=8;a.W0=9;a.r0=13;a.S0=16;a.m0=17;a.g0=18;a.O0=19;a.k0=20;a.t0=27;a.U0=32;a.xE=37;a.AE=38;a.yE=39;a.wE=40;a.X_=49;a.Y_=50;a.Z_=51;a.$_=52;a.a0=53;a.b0=54;a.c0=55;a.d0=56;a.e0=57;a.uE=65;a.h0=66;a.lO=67;a.vE=68;a.q0=69;a.mO=70;a.v0=71;a.x0=72;a.y0=73;a.z0=74;a.nO=75;a.oO=76;a.A0=77;a.C0=78;a.N0=79;a.qO=80;a.Q0=81;a.rO=82;a.zE=83;a.tO=84;a.X0=85;a.Y0=86;a.BE=87;a.Z0=
88;a.$0=89;a.a1=90;a.D0=96;a.E0=97;a.F0=98;a.G0=99;a.H0=100;a.I0=101;a.J0=102;a.K0=103;a.L0=104;a.M0=105;a.B0=106;a.f0=107;a.V0=109;a.o0=110;a.p0=111;a.R0=186;a.s0=187;a.l0=188;a.n0=189;a.P0=190;a.u0=191;a.w0=192;a.pO=219;a.j0=220;a.sO=221;a.T0=222;a.nt=n.nt;a.mt=n.mt;a.lt=n.lt;a.Sy=n.Sy;a.mu=n.mu;a.nu=n.nu;a.cu=n.cu;a.mn=n.mn;a.Wz=n.Wz;a.Pc=n.Pc;a.Vz=function(a,d,p){return n.Vz(a,d||"ANY",p||!1)};a.NG=n.NG;a.YG=function(a,d,p,r,m,x,g){return n.YG(a,d,p,r||"ANY",m||!1,x||!1,g||!1)};a.rq=n.rq;a.Zz=
n.Zz;a.on=n.on;a.WG=n.WG;a.XG=n.XG;a.gu=n.gu;a.eA=n.eA;a.hH=n.hH;a.gH=n.gH;a.VG=n.VG;a.iH=n.iH;a.QG=n.QG;a.SG=n.SG;a.RG=n.RG;a.UG=n.UG;a.TG=n.TG;a.fH=function(a,d){return n.fH(a,d||!1)};a.YK=n.YK;a.bu=n.bu;a.eH=n.eH;a.eu=function(a,d){return n.eu(a,d||!1)};a.Uz=function(a,d){return n.Uz(a,d||0)};a.b7=function(a,d){n.LX(a,d)};a.Q3=function(a){return a.value};a.ag=n.ag;a.Nh=n.Nh;a.ua=function(a,d,p,r,m,x,g){m=m||n.mu;n.ua(a,d,p,r,m,x,void 0===g?null:g)};a.nn=function(a,d,p,r,m){var x;r=n.Pc(r);n.ua(a,
d,p,[r],n.mu,m,void 0===x?null:x)};a.l2=function(a){return n.bq(a,null)};a.bq=n.bq;a.as=n.as;a.reset=n.reset;a.D6=function(){d.N("controls.register_keyboard_events() deprecated")};a.E6=function(){d.N("controls.register_mouse_events() deprecated")};a.G6=function(){d.N("controls.register_wheel_events() deprecated")};a.F6=function(){d.N("controls.register_touch_events() deprecated")};a.C6=function(){d.N("controls.register_device_orientation() deprecated")};a.E8=function(){d.N("controls.unregister_keyboard_events() deprecated")};
a.F8=function(){d.N("controls.unregister_mouse_events() deprecated")};a.H8=function(){d.N("controls.unregister_wheel_events() deprecated")};a.G8=function(){d.N("controls.unregister_touch_events() deprecated")};a.D8=function(){d.N("controls.unregister_device_orientation() deprecated")};a.EL=n.EL};b4w.module.data=function(a,r){var n=r("__data"),d=r("__loader");r("__print");a.load=n.load;a.mx=function(a){n.mx(a|0)};a.pL=n.pL;a.Wg=n.Wg;a.K5=d.bm;a.W5=n.load;a.sa=a.mx;a.tF=n.tF;a.CK=n.CK;a.VM=n.VM};b4w.module.debug=function(a,r){function n(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;L.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.FA.ALL_OPS-a.FA.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.FA,e=c.v_,f=t(c.gT),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";L.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);L.groupCollapsed("directives");for(var h=c.hb.Hi.slice().sort(),f=0;f<h.length;f++){var g=h[f];L.Zd(g[0],g[1])}L.groupEnd();L.groupCollapsed("node elements");h=c.hb.jg;for(f=0;f<h.length;f++)L.Zd(h[f]);L.groupEnd();L.groupCollapsed("vert source");L.Zd(c.t_);L.groupEnd();L.groupCollapsed("vert translated source");L.Zd(c.u_);L.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];L.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&L.Zd(k,e[k]);
L.groupEnd();L.groupCollapsed("vert assembly");L.Zd(c.s_);L.groupEnd();L.groupCollapsed("frag source");L.Zd(c.mU);L.groupEnd();L.groupCollapsed("frag translated source");L.Zd(c.nU);L.groupEnd();L.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&L.Zd(k,d[k]);L.groupEnd();L.groupCollapsed("frag assembly");L.Zd(c.dU);L.groupEnd();L.groupEnd()}}function t(a){for(var b=[],c=N.Xq(),d=0;d<c.length;d++)for(var e=c[d],f=C.jc(e,"MESH",C.Dc),h=0;h<f.length;h++){var g=K.ja(f[h],e);if(g&&g.U.length)for(var g=
g.U,k=0;k<g.length;k++){var l=g[k];if(l.yb==a)for(var m=0;m<l.td.length;m++){var n=l.td[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function p(a,b){function c(){R.push(c);q=b;return a.apply(a,arguments)}return c}function B(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var m=r("__config"),x=r("__compat"),g=r("__controls"),l=r("__container"),
h=r("__debug"),w=r("__extensions"),f=r("__loader"),C=r("__objects"),K=r("__obj_util"),G=r("__physics"),L=r("__print"),D=r("__renderer"),N=r("__scenes"),I=r("__scenegraph"),O=r("__sfx"),E=r("__shaders"),c=r("__subscene"),k=r("__textures"),y=r("__util"),A=r("__vec3"),e=m.A,R=[],q="",ba=!0,J=new Float32Array(2);a.Ws=h.Ws;a.Zx=h.Zx;a.Xs=h.Xs;a.Yx=h.Yx;a.Vs=h.Vs;a.Xx=h.Xx;a.Wx=h.Wx;a.jp=h.jp;a.w6=function(){G.oT()};a.v6=function(a){L.log("O",G.$T(a));for(var b=G.zU().wc.ra,c=0;c<b.length;c++){var d=b[c];
d.C.ea==a&&L.log("B",d)}};a.T8=function(){for(var a=N.B(),b=C.jc(a,"MESH",C.Dc),a=[N.Ma(a,c.Pb),N.Ma(a,c.Lc),N.Ma(a,c.ee)],d=0;d<a.length;d++){var e=a[d],f=subs.Ra;if(f.length){L.group(e.type,"DYNAMIC");for(var h=0;h<b.length;h++){var g=b[h],k=g.k;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<f.length;m++){for(var n=f[m].ra,p=0;p<n.length;p++){var q=n[p];if(q.ac&&q.bf==k){L.Zd(g.name,g);l=!0;break}}if(l)break}}L.groupEnd();L.groupCollapsed(e.type,"STATIC");for(h=0;h<b.length;h++)if(g=b[h],k=g.k,"DYNAMIC"!=
k.type)for(l=!1,m=0;m<f.length;m++){n=f[m].ra;for(p=0;p<n.length;p++)if(q=n[p],q.ac&&q.bf==k){L.Zd(g.name,g);l=!0;break}if(l)break}L.groupEnd()}}};a.o6=function(a){for(var b=N.B(),c=C.jc(b,"MESH",C.Dc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){L.log("Object",e);for(var f=N.JA(b),h=0;h<f.length;h++){for(var g=f[h],k=[],l=g.Ra,m=0;m<l.length;m++)for(var n=l[m].ra,p=0;p<n.length;p++)n[p].bf==e.k&&k.push(n[p]);L.log("Subscene "+g.type,k)}}}};a.p6=function(){var a=N.B();console.log("Armatures: "+C.jc(a,
"ARMATURE",C.Dc).length);console.log("Cameras: "+C.jc(a,"CAMERA",C.Dc).length);console.log("Curves: "+C.jc(a,"CURVE",C.Dc).length);console.log("Empties: "+C.jc(a,"EMPTY",C.Dc).length);console.log("Lamps: "+C.jc(a,"LAMP",C.Dc).length);console.log("Meshes: "+C.jc(a,"MESH",C.Dc).length);console.log("Speakers: "+C.jc(a,"SPEAKER",C.Dc).length)};a.Gr=function(){for(var a=0,b=N.B(),b=[N.Ma(b,c.Pb),N.Ma(b,c.Lc),N.Ma(b,c.ee)],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.Ra,f=0;f<e.length;f++)for(var h=
e[f].ra,g=0;g<h.length;g++){var k=h[g].za;k&&(a+=k.Gr)}}return a};a.om=function(){for(var a=0,b=N.B(),b=[N.Ma(b,c.Pb),N.Ma(b,c.Lc),N.Ma(b,c.ee)],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.Ra,f=0;f<e.length;f++)for(var h=e[f].ra,g=0;g<h.length;g++){var k=h[g].za;k&&(a+=k.om)}}return a};a.i6=function(){for(var a=N.B(),b=N.oD(a,[c.Pb,c.Lc,c.ee,c.Nd,c.sf]),d=0,e=0;e<b.length;e++)for(var f=b[e],f=f.Ra,h=0;h<f.length;h++)d+=f[h].ra.length;a=N.oD(a,[c.nd,c.Ke]);for(e=0;e<a.length;e++)for(f=a[e],f=f.Ra,
h=0;h<f.length;h++)d+=6*f[h].ra.length;return d};a.l6=function(){return y.Yq(E.iI())};a.D3=function(){for(var a=N.B(),b=N.JA(a),a={},d=0;d<b.length;d++){var e=b[d];if(e.type!=c.bn&&e.type!=c.rf)for(var f=e.Ra,h=0;h<f.length;h++)for(var g=f[h].ra,k=0;k<g.length;k++){var l=g[k].za,m=g[k].bf;l&&(e.type!=c.pf&&e.type!=c.yg||m.dw||m.cw)&&(a[l.id]=l)}}var d=b=0,n;for(n in a)e=a[n].Ba,e.pn&&(d+=e.pn/1048576),b+=e.rn/1048576;return{vbo_memory:b,ibo_memory:d}};a.m6=function(){for(var a=[],b=0,d=N.B(),d=[N.Ma(d,
c.Pb),N.Ma(d,c.Lc),N.Ma(d,c.ee)],e=0;e<d.length;e++){var f=d[e];if(f)for(var f=f.Ra,h=0;h<f.length;h++)for(var g=f[h].ra,k=0;k<g.length;k++){var l=g[k].za;if(l)for(var l=l.ya,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.rb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*4/1048576/n.oq,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.k6=function(){for(var a=[],b=0,d=N.B(),d=N.JA(d),e=0;e<d.length;e++){var f=d[e];if(f.type!=c.bn){var h=f.p,g=[h.qc,
h.Re];g.push.apply(g,f.hi);for(f=0;f<g.length;f++){var l=g[f];k.Sn(l)&&-1==a.indexOf(l)&&(a.push(l),b+=h.width*h.height*k.eV(l))}}}return{number:a.length,memory:b/1024/1024}};a.pW=function(){var a=N.B();(a=N.Ma(a,c.Pb))&&N.TJ(a.p,a,[1,1,0])};a.sW=function(){var a=N.B(),b=N.Ma(a,c.Pb),a=N.oD(a,[c.dd]);if(b)for(var d=0;d<a.length;d++){var e=a[d],f;switch(d){case 0:f=[1,0,0];break;case 1:f=[0,1,0];break;case 2:f=[0,0,1];break;default:f=[1,0,1]}N.TJ(e.p,b,f)}};a.V6=function(){for(var a=N.Xq(),b=0;b<a.length;b++)L.log("\n"+
I.lT(N.RA(a[b])))};a.W6=function(){};a.Y5=function(){L.log("\n"+f.iV())};a.z2=g.debug;a.n6=function(a,b){return A.dist(m_tsr.F(a.k.n),m_tsr.F(b.k.n))};a.aK=h.aK;a.zu=h.zu;a.GK=h.GK;a.kC=h.kC;a.p3=function(a,b){function c(){h.zu("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.L1=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),h=new Float32Array([0,-1,0]),g=new Float32Array([0,
0,-1]);if(!y.Gj(a,y.aF))throw"Wrong VEC3_IDENT";if(!y.Gj(b,y.$m))throw"Wrong QUAT4_IDENT";if(!y.Gj(c,y.oi))throw"Wrong AXIS_X";if(!y.Gj(d,y.pi))throw"Wrong AXIS_Y";if(!y.Gj(e,y.ad))throw"Wrong AXIS_Z";if(!y.Gj(f,y.Kx))throw"Wrong AXIS_MX";if(!y.Gj(h,y.Zk))throw"Wrong AXIS_MY";if(!y.Gj(g,y.$c))throw"Wrong AXIS_MZ";};a.g6=function(){for(var a=O.cV(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==O.WA(c)&&O.kc(c,!0)}};a.rG=function(a){h.rG(a)};a.d7=function(a){var b=N.B();if(b=N.Ma(b,c.rf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case h.Ws:case h.Zx:case h.Xs:case h.Yx:case h.Vs:case h.Xx:case h.Wx:case h.jp:N.RX(b,a.debug_view_mode);break;default:L.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&N.QX(b,a.debug_colors_seed);"number"==typeof a.wX&&N.iY(b,a.wX);"object"==typeof a.wireframe_edge_color&&N.tY(b,y.yf(a.wireframe_edge_color))}else L.error("Debugging is not available on the scene.")};a.V3=function(){return L.KU()};a.e5=function(){return L.gV()};
a.DG=function(){return L.DG()};a.n1=function(a){var c=E.iI(),e=0,f;for(f in c)a&&-1===f.indexOf(a)||e++;var e="of "+e+" analyzing...",g={};for(f in c)if(!a||-1!==f.indexOf(a)){var k=c[f],l;var m=k.yx;l=k.Eu;var p=w.HU();if(p){var q=p.getTranslatedShaderSource(m),p=p.getTranslatedShaderSource(l);if(x.qu())var q=q.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),r=d("/analyze_shader/vert_gles",q),t=d("/analyze_shader/frag_gles",p);else q=q.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),r=d("/analyze_shader/vert",q),t=d("/analyze_shader/frag",p);var y=n(r),C=n(t);l={t_:h.Mu().getShaderSource(m),u_:q,s_:r,v_:y,mU:h.Mu().getShaderSource(l),nU:p,dU:t,FA:C}}else L.error("WEBGL_debug_shaders extension not found"),l=void 0;q=k.hb;m=q.tg+" + "+q.Te;l.gT=k;l.hb=q;k=g[m]=g[m]||[];k.push(l);L.Zd(e)}for(m in g)L.group("%c"+m,"color: #800"),k=g[m],b(k),L.groupEnd()};a.GH=h.GH;a.FM=function(b){if(E.wG())if(w.PA()){var d=e.gl_debug;e.gl_debug=!0;var f=
I.xS();N.TH(null,f);for(var g=I.ec(f,c.qp),k=g.p,f=0;5>f;f++)D.vn(g);e.gl_debug=d;window.setTimeout(function(){h.iX(g);var a=g.xf;b(a,k.width*k.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.FM(b)},100)};a.gG=h.gG;a.YL=h.YL;a.FK=h.FK;a.c8=function(a){R=[];ba=!0;a=r(a);for(var b in a)"function"===typeof a[b]&&(a[b]=p(a[b],b))};a.d2=function(){return ba};a.test=function(a,b){try{return b(),!0}catch(c){return ba=!1,console.error(a+" test was failed. ",c),!1}};
a.y6=function(a){var b=l.WI(),c=l.VI(),d=b/2,e=c/2;l.resize(b,c,!1);b=N.B().s.Wa;(c=I.aU(b))||y.q("Couldn't find onscreen subscene");b=c.p;d=l.Qt(d,e,J,c.p);d[1]=b.height-d[1];d=D.vC(b.Ve,d[0],d[1]);B(a,d,1)};a.e3=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+q;};a.f3=B;a.d3=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.c3=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
r(a);for(var b in a)-1==R.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.q6=function(a){if(!Boolean(a))throw"Wrong result. Function: "+q;}};b4w.module.input=function(a,r){function n(a){var d=b.ia(b.Je);if(!d||!d.kh)return!1;if(f)return!0;var c=b.Oi(d,b.ON,h),k=b.Oi(d,b.PN,w);t.TC(a,c,k);if(c=b.Uu(d,G))k=g.B(),a=m.ja(a,k).ba,t.PC(a,c);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.Uu(b.it)!==b.Oy&&(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],
d.bp||(d.Bj&&d.Wj&&d.Cj?a.base_line_factor=(d.Bj-d.Cj)/d.Wj:d.Cj||(a.base_line_factor=d.Bj/d.Wj)),d.Qi&&d.Sm&&!d.bp&&(a.inter_lens_factor=d.Qi/d.Sm),C.enabled||(c=1+d.distortion_coefs[0]+d.distortion_coefs[1],g.bK(c,c)));g.Gw(a);B.wk(!0);b.CC(d);return f=!0}function d(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=r("__input"),t=r("__camera"),p=r("__config"),B=r("__container"),
m=r("__obj_util"),x=r("__print"),g=r("__scenes"),l=r("__vec4"),h=l.create(),w=l.create(),f=!1,C=p.yq,K=p.A;a.ny=b.ny;a.oy=b.oy;a.qy=b.qy;a.py=b.py;a.Cy=b.Cy;a.jy=b.jy;a.ky=b.ky;a.vy=b.vy;a.Ey=b.Ey;a.dt=b.dt;a.Dy=b.Dy;a.bt=b.bt;a.Fy=b.Fy;a.Gy=b.Gy;a.ly=b.ly;a.my=b.my;a.ry=b.ry;a.sy=b.sy;a.ty=b.ty;a.uy=b.uy;a.wy=b.wy;a.xy=b.xy;a.yy=b.yy;a.zy=b.zy;a.Ay=b.Ay;a.By=b.By;a.Ys=b.Ys;a.Zs=b.Zs;a.$s=b.$s;a.at=b.at;a.dy=b.dy;a.ey=b.ey;a.fy=b.fy;a.gy=b.gy;a.hy=b.hy;a.iy=b.iy;a.by=b.by;a.cy=b.cy;a.gt=b.gt;a.ht=
b.ht;a.it=b.it;a.pE=b.pE;a.qE=b.qE;a.oE=b.oE;a.Oy=b.Oy;var G=b.Ky;a.Ky=G;a.Jy=b.Jy;a.Hy=b.Hy;a.My=b.My;a.Ny=b.Ny;a.Ly=b.Ly;a.Iy=b.Iy;a.si=b.si;a.$k=b.$k;a.op=b.op;a.pp=b.pp;a.mp=b.mp;a.lp=b.lp;a.el=b.el;a.wp=b.wp;a.cl=b.cl;a.ft=b.ft;a.Xm=b.Xm;var L={};L[b.Je]=[b.gt,b.ht];L[b.bd]=[b.si];var D={};D[b.Je]=[b.it];var N={};N[b.bd]=[b.si,b.$k,b.op,b.pp];N[b.gp]=[b.mp,b.lp];N[b.wg]=[b.el,b.wp,b.cl];N[b.uh]=[b.ft,b.Xm];var I={};I[b.Je]=[b.Jy,b.Ky,b.Hy,b.My,b.Ny,b.Ly,b.Iy];a.uh=b.uh;a.Je=b.Je;a.bd=b.bd;a.gp=
b.gp;a.wg=b.wg;a.Bz=b.Bz;a.ia=b.ia;a.uD=function(a,d){a&&b.uD(a,d)};a.B6=function(){x.N("input.register_device() deprecated")};a.CC=function(a){a&&a.type==b.Je?b.CC(a):x.error("reset_device is undefined for device.")};a.Oi=function(a,d,c){if(a&&a.type in L&&0<=L[a.type].indexOf(d))return b.Oi(a,d,c);x.error("device hasn't param: ",d)};a.Uu=function(a,d){if(a&&a.type in D&&0<=D[a.type].indexOf(d))return b.Uu(a,d);x.error("device hasn't param: ",d)};a.yd=function(a,d,c){c=c||null;if(a&&a.type in N&&
0<=N[a.type].indexOf(d))return b.yd(a,d,c);x.error("device hasn't param: ",d)};a.Bd=function(a,d,c){c=c||null;if(a&&a.type in N&&0<=N[a.type].indexOf(d))return b.Bd(a,d,c);x.error("device hasn't param: ",d)};a.NC=function(a,d,c){if(a&&a.type in I&&0<=I[a.type].indexOf(d))return b.NC(a,d,c);x.error("device hasn't config: ",d)};a.M6=function(){if(g.Ca()){var a=g.Ul(g.B());if(a&&(n(a),a=b.ia(b.Je))){var d=a.Of;d&&!d.isPresenting&&(d.capabilities.canPresent?(a=B.Fn(),d.requestPresent([{source:a}]).then(function(){if(!K.is_mobile_device){var a=
d.getEyeParameters("left"),b=d.getEyeParameters("right");B.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){x.error("HMD fullscreen request failed.")})):x.error("HMD fullscreen request failed."))}}};a.b3=n;a.Q2=function(){var a=b.ia(b.Je);if(!(f||a&&a.kh))return!1;g.Gw({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);g.bK(a,a);B.wk(!0);return!0};a.j7=function(a,f,c){d();switch(a){case 0:a=b.Ts;break;case 1:a=b.Tx;break;
case 2:a=b.Ux;break;case 3:a=b.Vx;break;default:a=b.Ts}a=b.ia(a);b.NC(a,f,c)};a.DI=b.DI;a.wI=b.wI;a.FR=d};b4w.module.main=function(a,r){function n(){}function d(){}function b(){}function t(){window.performance||(J.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(J.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});fa.KL(0)}function p(a,b){for(var c=null,d=b?za:sa,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,u)}catch(h){}if(c)break}c&&D.tT(c);return c}function B(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();J.error("WebGL context lost");x()},!1);c.If(e);var h=c.Qu();h&&J.log("%cRENDERER INFO:","color: #00a",e.getParameter(h.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(h.UNMASKED_RENDERER_WEBGL));F.If(e);k.If(e);v.If(e);aa.If(e);E.If(e);N.If(e);O.uY(a);N.Ug(a,b);V.PL(a.width,a.height,1);U.Ug();d=f();l()}function m(){n=function(){}}function x(){g()||(pa=performance.now()/1E3,U.pause(),ba.pause(),v.pause(),C.pause())}function g(){return S<pa}function l(){var a="HMD"===Q.stereo&&
y.ZI();a?a.requestAnimationFrame(l):ta(l);var b=performance.now()/1E3;ua||(ua=b);var c=b-ua;if(!(c<1/Q.max_fps)){for(var e=fa.ar(),f=0;f<Y.length;f++)Y[f](e,c);g()||(S>ua&&(c-=S-Math.max(pa,ua)),e+=c,fa.KL(e),E.update(),G.update(),O.update(),w(e,c),d(c));ua=b;a&&a.isPresenting&&a.submitFrame()}}function h(a,b,c){if(ca)if(ca.iZ)ca.iZ(a,b,c);else{c=atob(ca.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);a(new Blob([d],{type:b||"image/png"}))}}
function w(a,b){if(O.Wg()&&(A.reset(),M.update(b),R.update(a,b),e.update(a,b),U.update(a,b),b&&K.update(b),O.Wg()&&(ba.update(a,b),O.Wg()&&(y.update(a),I.update(a,b),O.Wg()&&(C.update(!1),q.update(a,b),ha.update(),n(b,a),O.Wg()))))){V.update(a,b);C.fN();var c=qa.callback;c&&(qa.KJ&&URL.revokeObjectURL(qa.nz),h(function(a){qa.nz=URL.createObjectURL(a);c(qa.nz)},qa.format,qa.quality),qa.callback=null,qa.format="image/png",qa.quality=1)}}function f(){var a=60,c=0,d=Q.KH,e=Q.eU;return function(f){f<1/
Q.max_fps||(a=H.vc(1/f,a,f,d),f=ba.RU(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var C=r("__anchors"),K=r("__animation"),G=r("__assets"),L=r("__config"),D=r("__compat"),N=r("__container"),I=r("__controls"),O=r("__data"),E=r("__debug"),c=r("__extensions"),k=r("__geometry"),y=r("__input"),A=r("__hud"),e=r("__nla"),R=r("__logic_nodes"),q=r("__objects"),ba=r("__physics"),J=r("__print"),F=r("__renderer"),V=r("__scenes"),U=r("__sfx"),aa=r("__shaders"),v=r("__textures"),fa=r("__time"),M=r("__transform"),H=r("__util"),
Z=r("__version"),ha=r("__particles"),u=L.context,Q=L.A,ca=null,ja=null,ua=0,pa=0,S=0,Y=[],qa={callback:null,format:"image/png",quality:1,nz:"",KJ:!1,lH:!1},sa=["webgl","experimental-webgl"],za=["webgl2","experimental-webgl2"],X=null,ta=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/Q.max_fps)}}();a.Ug=function(a,b){L.fY();J.pY(Q.console_verbose);
var c=Z.XD()+" "+Z.type()+" ("+Z.kA()+")";J.log("%cINIT ENGINE","color: #00a",c);J.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;t();ca=a;b?(A.Ug(b),ja=b):(L.A.show_hud_debug_info=!1,L.W.Rv=!1);D.AQ();D.Fz("Chrome")||D.Fz("Firefox")||(Q.cc=!1);c=p(a,Q.cc);!c&&Q.cc&&(Q.cc=!1,c=p(a,!1));if(!c)return null;J.log("%cINIT WEBGL "+(Q.cc?"2":"1"),"color: #00a");X=c;B(ca,ja,c);L.hn();D.yL(c,!0);aa.gW();Q.Jn&&(a.style["touch-action"]="none");J.log("%cSET PRECISION:",
"color: #00a",Q.precision);return c};a.resize=function(a,b,c){J.Bb("main.resize","container.resize");N.resize(a,b,c)};a.WX=function(a){b=a};a.p2=function(){b=function(){}};a.B7=function(a){n=a};a.t2=function(){m()};a.g5=function(){J.Bb("main.global_timeline","time.get_timeline");return fa.ar()};a.pause=x;a.dj=function(){g()&&(S=performance.now()/1E3,U.dj(),ba.dj(),v.play(!0),C.dj())};a.pr=g;a.reset=function(){O.mx(0);O.reset();c.reset();F.reset();k.reset();v.BX();aa.reset();E.reset();N.reset();O.reset();
N.reset();fa.reset();U.reset();ja=ca=null;S=pa=ua=0;b=function(){};d=function(){};n=function(){};Y.length=0;X=null};a.W1=function(a,b,c,d){qa.lH="undefined"===typeof d?d:!0;qa.KJ=qa.lH;qa.callback=a;qa.format=b||qa.format;qa.quality=c||qa.quality};a.L3=function(){J.Bb("main.get_canvas_elem","container.get_canvas");return ca};a.qu=function(){return D.qu()};a.Ep=function(a){for(var b=0;b<Y.length;b++)if(Y[b]==a)return;Y.push(a)};a.pX=function(a){for(var b=0;b<Y.length;b++)if(Y[b]==a){Y.splice(b,1);
break}};a.Qu=function(){var a=c.Qu();return a?{vendor:X.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:X.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.physics=function(a,r){function n(a,b,d,l){return p.xT(a,l[d[0]],l[d[1]],l[d[2]])}function d(a,b,d,l,h){b=Math.abs(a[2]-b[2]);return b<h&&B.LV(a,d,l)?b:Number.MAX_VALUE}r("__config");var b=r("__physics"),t=r("__print"),p=r("__util"),B=r("__navmesh");r("__vec3");new Float32Array(3);a.KN=0;a.F_=1;a.E_=2;a.lE=3;a.AH=function(a){b.na(a)?b.AH(a):t.N("No physics for object "+a.name)};a.rA=function(a){b.na(a)?b.rA(a):t.N("No physics for object "+a.name)};a.o5=function(a){return b.na(a)};a.cB=function(a){return b.cB(a)};
a.fJ=function(a){return b.fJ(a)};a.xL=function(a,d){b.na(a)?b.xL(a,d):t.N("No physics for object "+a.name)};a.Kw=function(a,d,g){b.na(a)?b.Kw(a,d,g):t.N("No physics for object "+a.name)};a.H=function(a){b.na(a)?b.H(a):t.N("No physics for object "+a.name)};a.EF=function(a,d,g,l){b.na(a)?b.EF(a,d,g,l):t.N("No physics for object "+a.name)};a.FF=function(a,d,g,l){b.na(a)?b.FF(a,d,g,l):t.N("No physics for object "+a.name)};a.iz=function(a,d,g,l){b.na(a)?b.iz(a,d,g,l,!1):t.N("No physics for object "+a.name)};
a.D1=function(a,d,g,l){b.na(a)?b.iz(a,d,g,l,!0):t.N("No physics for object "+a.name)};a.DF=function(a,d,g,l){b.na(a)?b.DF(a,d,g,l):t.N("No physics for object "+a.name)};a.Yo=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.Yo(a,p.V(d,-1,1))):t.N("No physics for object "+a.name)};a.Q8=function(a,d,g){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=p.V(d,0,1);var l=a.v.wn;-1==g||1==g?l=Math.max(-1,Math.min(l+g*d,1)):0==g&&0<=l?(l-=d,l=Math.max(0,l)):0==g&&0>l?(l+=d,l=Math.min(0,
l)):t.error("Wrong steering direction");b.Yo(a,p.V(l,-1,1))}else t.N("No physics for object "+a.name)};a.Xo=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.Xo(a,p.V(d,-1,1))):t.N("No physics for object "+a.name)};a.P8=function(a,d,g){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=p.V(d,0,1);var l=a.v.Ho;-1==g||1==g?l=Math.max(-1,Math.min(l+g*d,1)):0==g&&0<=l?(l-=d,l=Math.max(0,l)):0==g&&0>l?(l+=d,l=Math.min(0,l)):t.error("Wrong steering direction");b.Xo(a,p.V(l,-1,1))}else t.N("No physics for object "+
a.name)};a.WD=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.WD(a,p.V(d,0,1))):t.N("No physics for object "+a.name)};a.O8=function(a,d){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=p.V(d,-1,1);var g=a.v.Up;b.WD(a,p.V(g+g*d,0,1))}else t.N("No physics for object "+a.name)};a.Ye=function(a){return b.Ye(a)};a.Ze=function(a){return b.Ze(a)};a.U4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.kf.name;t.error("Wrong object");
return null};a.W4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.wn;t.error("Wrong object");return null};a.V4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.Ho;t.error("Wrong object")};a.T4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.Up;t.error("Wrong object")};a.UI=function(a){if(!b.na(a))return t.N("No physics for object "+
a.name),null;if(b.Ye(a)||b.Ze(a))return b.UI(a);t.error("Wrong object")};a.dg=function(a){return b.dg(a)};a.MC=function(a,d,g){b.na(a)?b.MC(a,d,g):t.N("No physics for object "+a.name)};a.Dw=function(a,d){b.na(a)?b.Dw(a,d):t.N("No physics for object "+a.name)};a.oL=function(a,d){b.na(a)?b.oL(a,d):t.N("No physics for object "+a.name)};a.nL=function(a,d){b.na(a)?b.nL(a,d):t.N("No physics for object "+a.name)};a.kL=function(a,d){b.na(a)?b.kL(a,d):t.N("No physics for object "+a.name)};a.oG=function(a){b.na(a)?
b.oG(a):t.N("No physics for object "+a.name)};a.pG=function(a,d,g){b.na(a)?b.pG(a,d,g):t.N("No physics for object "+a.name)};a.Ew=function(a,d,g){b.na(a)?b.Ew(a,d,g):t.N("No physics for object "+a.name)};a.mL=function(a,d){b.na(a)?b.mL(a,d):t.N("No physics for object "+a.name)};a.lL=function(a,d){b.na(a)?b.lL(a,d):t.N("No physics for object "+a.name)};a.fz=function(a,d,g,l){b.na(a)?b.fz(a,d||"ANY",g,l||!1):t.N("No physics for object "+a.name)};a.yC=function(a,d,g){b.na(a)?b.yC(a,d||"ANY",g):t.N("No physics for object "+
a.name)};a.hz=function(a,d){b.na(a)?b.hz(a,d):t.N("No physics for object "+a.name)};a.Hz=function(a){b.na(a)?b.Hz(a):t.N("No physics for object "+a.name)};a.Ct=function(a,d,g,l,h,n){a=a||null;if(null==a||b.na(a))return b.Ct(a,d,g,l||"ANY",h,n||!1,!1,!1,!1);t.N("No physics for object "+a.name)};a.t1=function(a,d,g,l,h,n,f,p,r){a=a||null;if(null==a||b.na(a))return b.Ct(a,d,g,l||"ANY",h,n||!1,f||!1,p||!1,r||!1);t.N("No physics for object "+a.name)};a.zC=function(a){b.AJ(a)?b.zC(a):t.error("Wrong ray test ID")};
a.mG=function(a,d,g){b.AJ(a)?b.mG(a,d,g):t.error("Wrong ray test ID")};a.AF=function(a,d,g,l,h,n,f,p,r,B){b.na(d)&&b.na(h)?b.AF(a,d,g,l,h,n,f,p,r,B):t.error("Wrong objects")};a.CG=function(a){b.na(a)&&b.lV(a)?b.CG(a):t.error("Wrong object")};a.JK=function(a,d,g,l,h,n){b.na(a)&&b.na(l)?b.JK(a,d,g,l,h,n):t.error("Wrong objects")};a.dK=function(a,d,g){g||(g=n);if(b.na(a)){var l=a.C.Dr;return l?B.dK(l,d,g):(t.error(a.name+" is not a navigation mesh object"),null)}t.N("No physics for object "+a.name)};
a.cK=function(a,p,g,l){if(b.na(a)){var h=a.C.Dr;if(!h)return t.error(a.name+" is not a navigation mesh object"),null;l=l||{};a={};a.do_not_pull_string=Boolean(l.do_not_pull_string);a.distance_to_closest=l.distance_to_closest||n;a.distance_to_farthest=l.distance_to_farthest||d;a.island=l.island||0;a.allowed_distance=l.allowed_distance||Number.MAX_VALUE;a.return_normals=l.return_normals||!1;return B.cK(h,p,g,a)}t.N("No physics for object "+a.name)}};b4w.module.scenes=function(a,r){function n(){var a=t.Fn();return m.Or(a.clientWidth/2,a.clientHeight/2)}var d=r("__batch"),b=r("__camera"),t=r("__container"),p=r("__data"),B=r("__graph"),m=r("__objects"),x=r("__obj_util"),g=r("__print"),l=r("__scenes"),h=r("__subscene"),w=r("__util");a.Dc=m.Dc;a.Bw=function(a){var b=l.Xq();l.Bw(w.Dd("name",a,b))};a.B=function(){return l.Ca()?l.B().name:""};a.F4=function(){for(var a=l.Xq(),b=[],d=0;d<a.length;d++)b.push(a[d].name);return b};a.IA=function(){if(l.Ca())return l.Ul(l.B());
g.error("No active scene");return!1};a.q4=function(a,b){var d=m.rc(m.ay,a,b|0,!0);if(d)return d;g.error("get object "+a+": not found")};a.o4=function(a,b,d){if(a=m.rc(m.$x,a,b,d|0))return a;g.error("get object "+b+": not found")};a.p4=function(a,b){var d=m.rc(m.Kc,a,b|0);if(d)return d;g.error("get object "+a+": not found")};a.Wu=function(a,b){var d=m.Wu(a,b|0);if(d)return d;g.error("get object "+a+": not found")};a.TA=function(a){return x.TA(a)};a.Or=function(a,b){var d=l.Mh();return d?(d=l.Ma(d,
h.ti))&&d.enable_hmd_stereo?(g.N("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),n()):m.Or(a,b):(g.error("No active scene"),null)};a.x6=n;a.s6=function(a){return a&&a.k&&a.k.Uc};a.CL=function(a,b){a&&a.k&&a.k.Uc?m.CL(a,b):g.error("set_outline_intensity(): wrong object")};a.y4=function(a){if(a&&a.k&&a.k.Uc)return a.k.gh;g.error("get_outline_intensity(): wrong object")};a.gn=function(a,b,d,h){a&&a.k&&a.k.Uc?m.gn(a,b,d,h):g.error("apply_outline_anim(): wrong object")};
a.G1=function(a){if(a&&a.k&&a.k.Uc){var b=a.k.Wh;m.gn(a,b.mk,b.nk,b.ok)}else g.error("apply_outline_anim_def(): wrong object")};a.Tt=function(a){a&&a.k&&a.k.Uc?m.Tt(a):g.error("clear_outline_anim(): wrong object")};a.BL=l.BL;a.x4=function(a){var b=l.B();if(b=l.Ma(b,h.Ym))return a=a||new Float32Array(3),a.set(b.bj),a};a.Gw=function(a){l.Ca()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),l.Gw(a)):g.error("No active scene")};a.G4=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B(),b=l.Ma(a,h.dd);if(!b)return null;var d=a.s.wd,m=l.Ma(a,h.Pb),n=l.Ma(a,h.tf),p={};p.csm_resolution=d.csm_resolution;p.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
n&&(p.self_shadow_normal_offset=n.self_shadow_normal_offset);p.enable_csm=d.enable_csm;p.csm_num=d.csm_num;p.csm_first_cascade_border=d.csm_first_cascade_border;p.first_cascade_blur_radius=d.first_cascade_blur_radius;p.csm_last_cascade_border=d.csm_last_cascade_border;p.last_cascade_blur_radius=d.last_cascade_blur_radius;p.fade_last_cascade=d.fade_last_cascade;p.blend_between_cascades=d.blend_between_cascades;d.enable_csm?(p.csm_borders=l.GU(a,m.p),p.blur_radii=new Float32Array(d.csm_num),p.blur_radii.set(m.p.ho.subarray(0,
d.csm_num))):(p.csm_borders=null,p.blur_radii=null);return p};a.G7=function(a){if(l.Ca()){var m=l.B();"number"==typeof a.self_shadow_polygon_offset&&B.oa(m.s.Wa,function(b,d){d.type==h.dd&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var n=l.Ma(m,h.tf);n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius));var p=l.Ma(m,h.Lc);p&&("number"==typeof a.self_shadow_normal_offset&&
(p.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(p.pcf_blur_radius=a.pcf_blur_radius),p.Aa=!0);p=m.s.wd;"number"==typeof a.csm_first_cascade_border&&(p.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(p.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(p.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(p.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(n){for(var r=n.Ra,t=0;t<r.length;t++)for(var w=r[t].ra,I=0;I<w.length;I++){var O=w[I];if(O.bf.ce){var E=O.za;d.HF(E,p);d.Xc(E);h.Oc(n,O)}}n.Aa=!0}n=x.ja(m.wj,m).ba;for(t=0;t<n.length;t++)b.PD(n[t],p);l.LC(m)}else g.error("No active scene")};a.nI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.nI(a)};a.OC=function(a,b,d){if(l.Ca()){var m=l.B(),n=l.Ma(m,h.Pb);l.OC(m,a||0==a?parseFloat(a):n.Og,b||0==b?b:n.he,d||0==d?d:n.pe)}else g.error("No active scene")};
a.qI=function(a){if(!l.Ca())return g.error("No active scene"),!1;var b=l.B();return l.qI(b,a)};a.SC=function(a){if(l.Ca()){var b=l.B();l.SC(b,a)}else g.error("No active scene")};a.d4=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B(),b={};b.Pq=l.OU(a);b.fog_depth=l.MU(a);b.fog_start=l.PU(a);b.fog_height=l.NU(a);return b};a.g7=function(a){if(l.Ca()){var b=l.B();"number"==typeof a.Pq&&l.tL(b,a.Pq);"number"==typeof a.fog_depth&&l.rL(b,a.fog_depth);"number"==typeof a.fog_start&&l.uL(b,
a.fog_start);"number"==typeof a.fog_height&&l.sL(b,a.fog_height)}else g.error("No active scene")};a.OI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.OI(a)};a.IL=function(a){if(l.Ca()){var b=l.B();l.IL(b,a)}else g.error("No active scene")};a.M3=function(){if(!l.Ca())return g.error("No active scene"),null;var a=l.B(),a=l.Ma(a,h.Nx);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.Z6=
function(a){if(l.Ca()){var b=l.B();if(b=l.Ma(b,h.Nx))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Aa=!0}else g.error("No active scene")};a.MI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.MI(a)};a.GL=function(a){if(l.Ca()){var b=l.B();l.GL(b,a)}else g.error("No active scene")};a.kI=function(){if(!l.Ca())return g.error("No active scene"),
!1;var a=l.B();return l.Ma(a,h.ip)?l.kI(a):null};a.qL=function(a){if(l.Ca()){var b=l.B();l.qL(b,a)}else g.error("No active scene")};a.tI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.Ma(a,h.vj)?l.tI(a):null};a.wL=function(a){if(l.Ca()){var b=l.B();l.wL(b,a)}else g.error("No active scene")};a.eI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.Ma(a,h.dp)?l.eI(a):null};a.iL=function(a){if(l.Ca()){var b=l.B();l.iL(b,a)}else g.error("No active scene")};
a.sI=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.Ma(a,h.kp)?l.sI(a):null};a.vL=function(a){if(l.Ca()){var b=l.B();l.vL(b,a)}else g.error("No active scene")};a.aJ=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.aJ(a)};a.OL=function(a){if(l.Ca()){var b=l.B();m.OL(b,a)}else g.error("No active scene")};a.YI=function(a,b){if(!l.Ca())return g.error("No active scene"),0;var d=l.B();return d.s.Jc?l.YI(d,a,b):(g.error("No water parameters on the active scene"),
0)};a.NL=function(a){if(l.Ca()){var b=l.B();l.NL(b,a)}else g.error("No active scene")};a.XI=function(a){if(l.Ca()){var b=l.B();l.XI(b,a)}else g.error("No active scene")};a.L8=function(){if(l.Ca()){var a=l.B();l.cN(a)}else g.error("No active scene")};a.pV=function(a){var b;b=b||!1;!x.Rc(a)&&!x.$j(a)||x.Ea(a)?b?l.$p(a,!0):l.nG(a,!0):g.error("show/hide is only supported for dynamic objects.")};a.AY=function(a){var b;b=b||!1;!x.Rc(a)&&!x.$j(a)||x.Ea(a)?b?l.$p(a,!1):l.nG(a,!1):g.error("show/hide is only supported for dynamic objects.")};
a.pB=function(a){if(x.lr(a)||x.$j(a)||x.On(a))return l.pB(a);g.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Tn=function(a){return a.k.Tn};a.h2=function(a){g.Bb("scenes.check_object","scenes.check_object_by_name");return l.Ca()?m.MW(a,l.B()):(g.error("No active scene"),!1)};a.k2=function(a,b){return m.rc(m.ay,a,b|0,!0)?!0:!1};a.i2=function(a,b,d){return m.rc(m.$x,a,b,d|0)?!0:!1};a.j2=function(a,b){return m.rc(m.Kc,a,b|0)?!0:!1};a.Tj=function(a,b){var d=l.B();
a||(a="ALL");b||0===b||(b=m.Dc);return m.KI(d,a,b)};a.t4=function(a){return a?a.pm:(g.error("Wrong object name"),"")};a.u4=function(a){if(!a)return g.error("Wrong object name"),null;for(var b=[];a;)b.push(a.pm),a=x.Sg(a);return b.reverse()};a.v4=function(a){return a&&a.type?a.type:(g.error("Wrong object"),"UNDEFINED")};a.s4=function(a){g.Bb("scenes.get_object_dg_parent","objects.get_dg_parent");return x.Sg(a)};a.r4=function(a){return a.Pe.slice(0)};a.Lu=function(){return m.Lu(l.B())};a.LI=function(a,
b){b||0===b||(b=1);if(!l.Ca())return g.error("No active scene"),!1;var d=l.B();return l.LI(d,a,b)};a.gI=function(){return l.gI()};a.P4=function(a){return x.Rc(a)?a.k.type:null};a.Vl=function(){if(!l.Ca())return g.error("No active scene"),!1;var a=l.B();return l.Vl(a)};a.fn=function(a,b){if(a.k.vv){if(b)var d=l.Xq(),d=w.Dd("name",b,d);else d=l.B();l.fn(d,a,!0)}else g.error('object "'+a.name+'" has been created not by coping.')};a.$r=function(a){(x.Rc(a)||x.$j(a))&&x.Ea(a)?(m.aw(a,a.k.wv,!1,!1),p.gX(a),
m.aw(a,!0,!0,!0),m.$r(a)):g.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.UJ=function(a){var b=l.B();if(b.timeline_markers&&a in b.timeline_markers)return l.UJ(b,a);g.error('"'+a+'" marker not found.');return 0};a.n4=function(){var a=l.B();return(a=l.Ma(a,h.vh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.s7=function(a){var b=l.B();(b=l.Ma(b,h.vh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):g.error("The motion blur subscene doesn't exist.")};a.V1=function(){var a=l.B();return Boolean(l.Ma(a,h.pf))}};b4w.module.transform=function(a,r){var n=r("__obj_util"),d=r("__physics"),b=r("__print"),t=r("__quat"),p=r("__transform"),B=r("__tsr"),m=r("__util"),x=B.create(),g=new Float32Array(3),l=new Float32Array(4);a.cn=p.cn;a.$E=p.$E;a.Vc=function(a,l,f,m){n.Ea(a)?(g[0]=l,g[1]=f,g[2]=m,p.Vc(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Lw=function(a,l,f,m){n.Ea(a)?(g[0]=l,g[1]=f,g[2]=m,p.Lw(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.nY=function(a,
g){n.Ea(a)?(p.Vc(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.J7=function(a,g){n.Ea(a)?(p.Lw(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.I7=function(a,l,f,r,t){n.Ea(a)?(g[0]=l,g[1]=f,g[2]=r,m.Wc(g,1,B.R(t.k.n),B.F(t.k.n),g),p.Vc(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Bf=function(a,b){b||(b=new Float32Array(3));p.Bf(a,b);return b};a.SI=function(a,b){b||(b=new Float32Array(3));p.SI(a,b);return b};
a.bi=function(a,g,f,m,r){n.Ea(a)?(l[0]=g,l[1]=f,l[2]=m,l[3]=r,p.bi(a,l),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Jw=function(a,g,f,m,r){n.Ea(a)?(l[0]=g,l[1]=f,l[2]=m,l[3]=r,p.Jw(a,l),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.F7=function(a,g){n.Ea(a)?(p.bi(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.E7=function(a,g){n.Ea(a)?(p.Jw(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.In=
function(a,b){b||(b=new Float32Array(4));p.In(a,b);return b};a.HI=function(a,b){b||(b=new Float32Array(4));p.HI(a,b);return b};a.ZC=function(a,l,f,m){n.Ea(a)?(g[0]=l,g[1]=f,g[2]=m,p.ZC(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.FI=function(a,b){b||(b=new Float32Array(3));p.FI(a,b);return b};a.GI=function(a,b){b||(b=new Float32Array(3));p.GI(a,b);return b};a.$C=function(a,l,f,m){n.Ea(a)?(g[0]=l,g[1]=f,g[2]=m,p.$C(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.D7=function(a,g){n.Ea(a)?(p.ZC(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.C7=function(a,g){n.Ea(a)?(p.$C(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Hf=function(a,d){n.Ea(a)?(p.Hf(a,d),p.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.aD=function(a,d){n.Ea(a)?(p.aD(a,d),p.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yd=function(a){return p.Yd(a)};a.JI=function(a){return p.JI(a)};
a.X2=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var g=0;g<a.Pe.length;g++)if(!n.Ea(a.Pe[g])){b.error('Wrong object: "'+a.Pe[g].name+'" is not dynamic.');return}p.Vc(a,[0,0,0]);p.bi(a,[0,0,0,1]);p.Hf(a,1);p.D(a);d.H(a)}};a.Ou=function(a){return n.Rc(a)?p.Ou(a):(b.error("Wrong object: "+a.name),0)};a.Nu=function(a,d,f){if(!n.Rc(a))return b.error("Wrong object: "+a.name),null;f||(f=new Float32Array(3));return p.Nu(a,d,f)};a.ah=function(a,g,f,l){n.Ea(a)?(p.ah(a,g,f,l),p.D(a),
d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.P6=function(a,g){if(n.Ea(a)){var f=t.setAxisAngle(m.oi,g,l);p.IC(a,f);p.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Q6=function(a,g){if(n.Ea(a)){var f=t.setAxisAngle(m.Zk,g,l);p.IC(a,f);p.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.S6=function(a,g){if(n.Ea(a)){var f=t.setAxisAngle(m.ad,g,l);p.IC(a,f);p.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.BI=function(a){return p.BI(a)};a.gj=function(a,g){n.Ea(a)?(p.gj(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Mw=function(a,g){n.Ea(a)?(p.Mw(a,g),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.br=function(a,b){b||(b=new Float32Array(8));p.br(a,b);return b};a.cr=function(a,b){b||(b=new Float32Array(8));p.cr(a,b);return b};a.distance=function(a,b){return p.distance(a,b)};a.q7=function(a,g){n.Ea(a)?(B.Mi(g,x),p.gj(a,x),p.D(a),d.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.r7=function(a,g){n.Ea(a)?(B.Mi(g,x),p.Mw(a,x),p.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.l4=function(a,b){b||(b=new Float32Array(16));p.br(a,x);B.MM(x,b);return b};a.m4=function(a,b){b||(b=new Float32Array(16));p.cr(a,x);B.MM(x,b);return b}};b4w.module.util=function(a,r){var n=r("__compat"),d=r("__obj_util"),b=r("__print"),t=r("__quat"),p=r("__util"),B=r("__vec3"),m=new Float32Array(6);a.oi=new Float32Array([1,0,0]);a.pi=new Float32Array([0,1,0]);a.ad=new Float32Array([0,0,1]);a.Kx=new Float32Array([-1,0,0]);a.Zk=new Float32Array([0,-1,0]);a.$c=new Float32Array([0,0,-1]);a.bF=p.bF;a.iF=p.iF;a.jF=p.jF;a.dF=p.dF;a.fF=p.fF;a.lF=p.lF;a.cF=p.cF;a.hF=p.hF;a.Yy=p.Yy;a.eF=p.eF;a.gF=p.gF;a.kF=p.kF;a.yf=function(a){return p.yf(a||0)};a.assert=
p.assert;a.JJ=p.JJ;a.Dd=p.Dd;a.EB=function(a){return p.EB(a)};a.Pj=function(a,b){b||(b=new Float32Array(4));return p.Pj(a,b)};a.$B=function(a,b,d){d||(d=t.create());return p.$B(a,b,d)};a.NK=function(a,b,d){d||(d=B.create());return p.NK(a,b,d)};a.sw=function(a,b){b||(b=new Float32Array(3));return p.sw(a,b)};a.sign=p.sign;a.V=p.V;a.lc=p.lc;a.h5=function(a,b){return p.rC(a,p.$c,p.ad,p.pi,b)};a.zz=function(a,b){return p.zz(a,b)};a.rC=function(a,d,l,h,m){return 0!=B.dot(l,h)?(b.error("Wrong in-plane direction"),
null):p.rC(a,d,l,h,m)};a.hJ=p.hJ;a.vc=p.vc;a.Xw=p.Xw;a.ek=p.ek;a.Sz=p.Sz;a.MK=p.MK;a.PK=p.PK;a.kJ=p.kJ;a.yB=function(a,d,l,h,n){b.Bb("util.line_plane_intersect","math.line_plane_intersect");m[0]=l[0];m[1]=l[1];m[2]=l[2];m[3]=h[0];m[4]=h[1];m[5]=h[2];return p.yB(a,d,m,n)};a.Rc=function(a){b.Bb("util.is_mesh","objects.is_mesh");return d.Rc(a)};a.Ri=function(a){b.Bb("util.is_armature","objects.is_armature");return d.Ri(a)};a.vi=p.vi;a.Bg=p.Bg;a.Dm=p.Dm;a.lerp=p.lerp;a.Lb=p.Lb;a.df=p.df;a.pA=p.pA;a.or=
n.or;a.Wq=p.Wq};"object"==typeof module&&module.yA&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,r){r("__print");var n=r("__version");a.version=n.version;a.XD=n.XD;a.type=n.type;a.oH=n.oH;a.kA=n.kA};"object"==typeof module&&module.yA&&b4w.module.version(exports);b4w.module.objects=function(a,r){var n=r("__geometry"),d=r("__objects"),b=r("__batch"),t=r("__obj_util"),p=r("__print"),B=r("__scenes");a.Vl=function(a){if(a)return d.Vl(a)};a.copy=function(a,b,g){return t.Rc(a)?t.Ea(a)?n.eJ(a)||n.Ez(a)||!g?-1==d.jc(B.B(),"MESH",d.Dc).indexOf(a)?(p.error('object "'+a.name+'" does not belong to the active scene.'),!1):d.copy(a,b||"",g):(p.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),!1):(p.error('object "'+a.name+'" is not dynamic.'),!1):
(p.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.WC=function(a,d,g){p.Bb("set_nodemat_value","material.set_nodemat_value");if(t.lr(a)){var l=d[0],h=b.Lq(a,l,"MAIN");if(null===h)return p.error('Material "'+l+'" was not found in the object "'+a.name+'".'),null;h=b.Hn(h.eh,d);if(null===h)return p.error('Value node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null;b.WC(a,l,h,g)}else p.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.AI=
function(a,d){p.Bb("get_nodemat_value","material.get_nodemat_value");if(!t.lr(a))return p.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var g=d[0],l=b.Lq(a,g,"MAIN");if(null===l)return p.error('Material "'+g+'" was not found in the object "'+a.name+'".'),null;g=b.Hn(l.eh,d);return null===g?(p.error('Value node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null):b.AI(l,g)};a.VC=function(a,d,g,l,h){p.Bb("set_nodemat_rgb","material.set_nodemat_rgb");
if(t.lr(a)){var n=d[0],f=b.Lq(a,n,"MAIN");null===f?p.error('Material "'+n+'" was not found in the object "'+a.name+'".'):(f=b.Hn(f.dh,d),null===f?p.error('RGB node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'):b.VC(a,n,f,g,l,h))}else p.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.zI=function(a,d,g){p.Bb("get_nodemat_rgb","material.get_nodemat_rgb");if(!t.lr(a))return p.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),
null;var l=d[0],h=b.Lq(a,l,"MAIN");if(null===h)return p.error('Material "'+l+'" was not found in the object "'+a.name+'".'),null;l=b.Hn(h.dh,d);if(null===l)return p.error('RGB node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null;g||(g=new Float32Array(3));return b.zI(h,l,g)};a.OD=function(a){t.Rc(a)?n.eJ(a)||n.Ez(a)?d.OD(a):p.error('object "'+a.name+'" has not dynamic geometry.'):p.error('The type of the object "'+a.name+'" is not "MESH".')};a.Pu=t.Pu;a.Sg=t.Sg;a.Rc=t.Rc;a.Ri=
t.Ri;a.fm=t.fm;a.wa=t.wa;a.On=t.On;a.$j=t.$j;a.zJ=t.zJ;a.rr=t.rr;a.Ru=function(){return d.Ru()};a.CI=function(){return d.CI()};a.Ea=t.Ea};b4w.module.preloader=function(a,r){var n=r("container"),d,b,t,p,B,m,x,g,l=null;a.F2=function(a){var g="#000",f="#5276cf",l="#fff",m="#fff",r;for(r in a)switch(r){case "container_color":g=a.container_color;break;case "bar_color":f=a.bar_color;break;case "frame_color":l=a.frame_color;break;case "font_color":m=a.font_color}a=document.createElement("div");r=a.cloneNode();var x=a.cloneNode(),B=a.cloneNode(),N=n.We();x.appendChild(r);x.appendChild(B);a.appendChild(x);N.appendChild(a);a.style.cssText="background-color: "+
g+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";x.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+l+";";r.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+f+";height: 100%;";B.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+m+";";d=r;b=B;t=a;p="DEFAULT"};
a.CS=function(){var a={bg_color:"#ffffff",bar_color:"#556",background_container_id:"background_image_container",canvas_container_id:"main_canvas_container",preloader_fadeout:!0},g=null,f=null,m="#bf9221",n="#000",r;for(r in a)switch(r){case "canvas_container_id":g=a.canvas_container_id;break;case "background_container_id":f=a.background_container_id;break;case "bg_color":n=a.bg_color;break;case "bar_color":m=a.bar_color}a=document.createElement("div");r=document.createElement("div");a.id="simple_preloader_container";
var x=document.createElement("div"),D=document.createElement("div"),f=document.getElementById(f);l=document.getElementById(g);a.style.cssText="z-index: 4;background-color: "+n+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";x.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+
m+";border-radius: 0px;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+r.appendChild(x);r.appendChild(D);a.appendChild(r);document.body.appendChild(a);p="SIMPLE";t=a;d=x;b=D;B=f};a.G2=function(a){var d=null,f=null,g="rgba(0,0,0,0)",n="",r="",x="rgba(0,0,0,0)",D;for(D in a)switch(D){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":f=
a.background_container_id;break;case "frame_bg_color":g=a.frame_bg_color;break;case "bg_color":x=a.bg_color;break;case "frame_class":n=a.frame_class;break;case "anim_elem_class":r=a.anim_elem_class}a=document.createElement("div");D=document.createElement("div");var N=document.createElement("div"),I=document.createElement("div"),f=document.getElementById(f);l=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+x+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";
D.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+g+";";N.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";I.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";N.className=r;D.appendChild(N);D.className=n;D.appendChild(I);
a.appendChild(D);l.appendChild(a);p="ROTATION";t=a;m=N;b=I;B=f};a.D2=function(a){var m=a.preloader_width,m=m/(m-a.img_width),f=document.getElementById(a.preloader_bar_id),n=document.getElementById(a.fill_band_id),r=document.getElementById(a.preloader_caption_id),G=document.getElementById(a.preloader_container_id),L=document.getElementById(a.background_container_id);l=document.getElementById(a.canvas_container_id);p="ADVANCED";d=f;x=n;g=m;b=r;t=G;B=L};a.TZ=function(a){b.innerHTML=a+"%";"SIMPLE"==p?
d.style.width=a+"%":"ADVANCED"==p?(d.style.width=a/g+"%",x.style.width=100-a+"%"):"ROTATION"==p?m.style.transform="rotate("+a+"deg)":"DEFAULT"==p&&(d.style.width=a+"%");100==a&&(t.parentNode.removeChild(t),B&&B.parentNode.removeChild(B))}};b4w.module.anchors=function(a,r){var n=r("__anchors");r("__print");a.JF=n.JF;a.wH=n.wH;a.uv=n.uv;a.mI=n.mI;a.update=function(){n.update(!0)}};b4w.register("guitar_presentation",function(a,r){function n(a,f){f?(h.CS(),B.load(C+"guitar_presentation.json",b,d,!0)):console.log("b4w init failure")}function d(a){h.TZ(a)}function b(a,b){if(b){console.log("App started: "+(new Date).toString());console.log(typeof l);var d=document.getElementsByTagName("script");console.log("Used javascript file: "+d[d.length-1].src.toString());t.GT();d=x.Tj();console.log("Number of objects in the scene: "+d.length.toString());for(var f,h=0;h<d.length;h++){f=d[h];
var m=g.Vl(f);m&&(console.log("Object in scene #"+h+": % Name >>> "+f.name+"% Type: >>> "+m.category),"AnnBody"==f.name&&w.uv(f)&&console.log("AnnBody is anchor"));"ButtonToWeb"==f.name&&(x.pV(f),x.AY(f))}document.getElementById("enter_link").onclick=function(){var a=document.getElementById("welcome_container");a.parentElement.removeChild(a)}}else console.log("b4w load failure")}var t=r("app"),p=r("config"),B=r("data"),m=r("version"),x=r("scenes"),g=r("objects"),l=r("__logic_nodes"),h=r("preloader");
r("transform");var w=r("anchors"),f="DEBUG"===m.type(),C=p.Hu("guitar_presentation");a.Ug=function(){t.Ug({canvas_container_id:"main_canvas_container",callback:n,show_fps:f,console_verbose:f,autoresize:!0})}});b4w.require("guitar_presentation").Ug();
